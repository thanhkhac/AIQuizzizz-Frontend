import{d as G,q as j,l as X,u as K,B as W,i as T,j as ne,O as se,_ as J,r as v,E as V,o as n,w as u,b as t,c as r,f as w,t as d,a as l,F as S,D as A,s as le,M as Y,W as ie,k as O,e as q}from"./index-BhCEM7Qr.js";import{A as D}from"./ApiTestTemplate-GdvjRZpe.js";import{A as Z}from"./ApiFolder-BZCwdVbU.js";import{Q as F}from"./questionTypes-CS3lcRlq.js";import{I as ee}from"./Input-pAeduOdR.js";import{T as re}from"./TransferQuestionData-BxcXdBjq.js";import{V as de}from"./Validator-CWeiTIFe.js";import{S as ce}from"./ShareModal-sacErCxr.js";import{V as _e}from"./visibility-PZlBDoOn.js";import{F as H}from"./folderShareMode-BudLQ2R2.js";import"./ApiQuestionSet-DcHTXIEH.js";const ue=G({__name:"ShareToFolder",emits:["addToFolder"],setup(g,{expose:o,emit:m}){var R;const e=j(),y=X(),{t:k}=K(),I=[H.OWNER],c=W(()=>I.map(p=>({label:k(`folder_index.select_option.${p}`),value:p!==H.ALL?p:""}))),f=T([]),_=ne({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,folderName:((R=e.query.folderName)==null?void 0:R.toString())||"",shareMode:e.query.shareMode||c.value[0].value,totalCount:0,statusFilter:!1}),x=async()=>{try{let p=await Z.GetAllByLimit(_);if(p.data.success){let z=p.data.data;f.value=z.items,_.pageNumber=z.pageNumber,_.pageSize=z.pageSize,_.totalCount=z.totalCount}}catch(p){console.log("ERROR: GETALLBYLIMIT folder: "+p)}};se(()=>{var p;Object.keys(e.query).length===0&&(_.pageNumber=e.query.pageNumber||1,_.pageSize=e.query.pageSize||10,_.folderName=((p=e.query.folderName)==null?void 0:p.toString())||"",_.shareMode=e.query.shareMode||c.value[0].value,_.statusFilter=!0,x())});const M=(p,z)=>{_.pageNumber=p,_.pageSize=z,_.statusFilter=!0,x()},s=T(!1),b=()=>{s.value=!0},a=()=>{s.value=!1};o({openModal:b,closeModal:a});const h=m,N={route:e,router:y,t:k,optionKeys:I,folder_share_mode_options:c,folder_data:f,pageParams:_,getData:x,onPaginationChange:M,modal_open:s,openModal:b,closeModal:a,emit:h,handleAddToFolder:p=>{h("addToFolder",p)},Input:ee};return Object.defineProperty(N,"__isScriptSetup",{enumerable:!1,value:!0}),N}}),me={class:"modal-container"},pe={class:"modal-title-container"},ve={class:"content"},fe={class:"content-item"},ge={class:"title-container"},he={class:"main-title"},Te={class:"content-item-functions"},be={class:"filter-container"},ye={style:{width:"300px",padding:"0px"}},Ie={class:"folder-container"},xe=["onClick"],we={class:"folder-name"},Se={key:1,class:"w-100 m-2 d-flex justify-content-center"},Ee={class:"pagination-container"};function ke(g,o,m,e,y,k){const I=v("RouterLink"),c=v("a-col"),f=v("a-row"),_=v("a-select-option"),x=v("a-select"),M=v("a-empty"),s=v("a-pagination"),b=v("a-modal");return n(),V(b,{centered:"",width:"100%","wrap-class-name":"medium-modal large",open:e.modal_open,onCancel:e.closeModal},{footer:u(()=>o[9]||(o[9]=[])),default:u(()=>[t("div",me,[t("div",pe,[r(f,{class:"w-100 d-flex align-items-center"},{default:u(()=>[r(c,{span:1},{default:u(()=>[r(I,{onClick:e.closeModal,to:{name:""}},{default:u(()=>o[3]||(o[3]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[3]})]),_:1}),r(c,{class:"main-title",span:23},{default:u(()=>o[4]||(o[4]=[t("span",null,"Choose from folder test",-1)])),_:1,__:[4]})]),_:1})]),t("div",ve,[t("div",fe,[t("div",ge,[t("div",he,[t("span",null,d(g.$t("folder_index.title")),1),o[5]||(o[5]=w()),o[6]||(o[6]=t("br",null,null,-1)),t("span",null,d(g.$t("folder_index.sub_title")),1)])]),t("div",Te,[t("div",be,[r(x,{class:"me-3",value:e.pageParams.shareMode,"onUpdate:value":o[0]||(o[0]=a=>e.pageParams.shareMode=a),style:{width:"200px"},onChange:e.getData},{default:u(()=>[(n(!0),l(S,null,A(e.folder_share_mode_options,a=>(n(),V(_,{value:a.value},{default:u(()=>[w(d(a.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",ye,[r(e.Input,{onInput:e.getData,modelValue:e.pageParams.folderName,"onUpdate:modelValue":o[1]||(o[1]=a=>e.pageParams.folderName=a),placeholder:e.t("class_index.other.search_class_placeholder")},{icon:u(()=>o[7]||(o[7]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])])]),t("div",Ie,[e.folder_data.length>0?(n(!0),l(S,{key:0},A(e.folder_data,a=>(n(),l("div",{class:"folder",onClick:h=>e.handleAddToFolder(a)},[o[8]||(o[8]=t("div",{class:"folder-icon"},[t("div",{class:"folder-top"}),t("div",{class:"folder-body"})],-1)),t("div",we,d(a.name),1)],8,xe))),256)):(n(),l("div",Se,[r(M,null,{description:u(()=>[t("span",null,d(g.$t("folder_index.other.no_data_matches")),1)]),_:1})]))]),t("div",Ee,[r(s,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":o[2]||(o[2]=a=>e.pageParams.pageNumber=a),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(a,h)=>`${h[0]}-${h[1]} of ${a} ${e.t("folder_index.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("folder_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])])]),_:1},8,["open"])}const Me=J(ue,[["render",ke],["__scopeId","data-v-2d13cee5"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/ShareToFolder.vue"]]),ze=G({__name:"detail",setup(g,{expose:o}){o();const{t:m}=K(),e=j(),y=X(),k=T(!1),I=T(e.params.id),c=T({testTemplateId:"",name:"",createdBy:"",numberOfQuestion:0,dateCreated:0}),f=T([]),_=T([]),x=["All",F.MULTIPLE_CHOICE,F.MATCHING,F.ORDERING,F.SHORT_TEXT],M=W(()=>x.map(i=>({label:m(`create_QS.type.${i}`),value:i}))),s=T(M.value[0].value),b=T(""),a=async()=>{try{k.value=!0,de.isValidGuid(I.value.toString())||y.push({name:"404"});const i=await D.GetById(I.value.toString());i.data.success||y.push({name:"User_Library"}),c.value=i.data.data,f.value=i.data.data.questions.map(E=>re.transformResponseToRequest(E)),_.value=f.value,await Q()}catch{y.push({name:"404"})}finally{k.value=!1}},h=(i,E)=>{$(E).toggleClass("bx-chevron-up bx-chevron-down");const L=$(`#question-item-answer-${i}`);L&&$(L).slideToggle()},P=T(null),N=()=>{var i;(i=P.value)==null||i.openModal()},R=T(null),p=()=>{var i;(i=R.value)==null||i.openModal()},z=i=>{Y.confirm({title:m("detail_test_template.modal.add_to_folder_title"),content:m("detail_test_template.modal.add_to_folder_content",{name:c.value.name,folder_name:i.name}),okText:m("sidebar.buttons.ok"),cancelText:m("sidebar.buttons.cancel"),centered:!0,onOk:async()=>{var C;const E=await Z.AddTestTemplate(i.folderTestId,c.value.testTemplateId);if(!E.data.success&&Object.keys(E.data.errors).includes(ie.TEST_TEMPLATE_ALREADY_EXISTS_IN_FOLDER)){O.error(m("mesage.TEST_TEMPLATE_ALREADY_EXISTS_IN_FOLDER"));return}O.success(m("message.added_successfully")),(C=R.value)==null||C.closeModal()}})},te=()=>{y.push({name:"User_TestTemplate_Update",params:{id:c.value.testTemplateId}})},U=T({canEdit:!1,canDelete:!1}),Q=async()=>{const i=await D.GetPermissions(c.value.testTemplateId);i.data.success&&(U.value=i.data.data)},oe=()=>{Y.confirm({title:m("detail_test_template.modal.delete_title"),content:m("detail_test_template.modal.delete_content"),okText:m("sidebar.buttons.ok"),cancelText:m("sidebar.buttons.cancel"),onOk:async()=>{if(!(await D.Delete(c.value.testTemplateId)).data.success){O.error(m("message.deleted_failed"));return}O.success(m("message.deleted_successfully")),y.push("User_Library")}})},ae=()=>{let i=f.value;i=f.value.filter(E=>{const C=E.questionText.includes(b.value),L=s.value==="All"||s.value===E.type;return C&&L}),_.value=i};le(async()=>{await a()});const B={t:m,route:e,router:y,loading:k,question_set_id:I,quiz:c,quiz_questions:f,questions:_,optionKeys:x,question_type_options:M,selected_type_option:s,searchValue:b,getData:a,toggleDisplayAnswer:h,shareModalRef:P,onOpenShareModal:N,shareToFolderModalRef:R,openFolderModal:p,onAddToFolder:z,onRedirectToEdit:te,permission:U,getPermission:Q,onDelete:oe,onFilter:ae,get QUESTION_TYPE(){return F},Input:ee,ShareModal:ce,get VISIBILITY(){return _e},ShareToFolder:Me};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),qe={class:"content"},Ae={class:"content-item"},Re={key:0},Ce={key:1},Fe={class:"content-item-title"},Ne={key:0,class:"d-flex flex-row align-items-center justify-content-between quiz-header-functions"},Le={class:"quiz-credit"},Oe={class:"share-btn-container"},Pe={class:"share-btn-container"},De={class:"content-item"},Ve={class:"content-item-title"},Ue={class:"content-item-functions"},Qe={style:{width:"300px",padding:"0"}},Be={key:0},Ye={key:1,class:"preview-question-container"},He={class:"preview-question-item"},Ge={class:"question-item-content"},je={class:"d-flex pb-2"},Xe={class:"question-index"},Ke=["innerHTML"],We={key:1,class:"question-text"},Je=["id"],Ze={key:0,class:"multiple-choice-answer"},$e={key:0,class:"text-success"},et={class:"pair-answer"},tt={class:"pair-answer-item"},ot={class:"pair-answer-item"},at={key:2,class:"ordering-answer"},nt={class:"ordering-answer-item"},st={class:"ordering-answer-item"},lt={class:"ordering-answer-item"},it={class:"short-text-answer"},rt={class:"question-item-toogle-btn"},dt=["onClick"];function ct(g,o,m,e,y,k){const I=v("RouterLink"),c=v("a-skeleton"),f=v("a-tooltip"),_=v("a-button"),x=v("a-select-option"),M=v("a-select");return n(),l(S,null,[t("div",qe,[r(I,{class:"navigator-back-link d-flex align-items-center p-2",to:{name:"User_TestTemplate"}},{default:u(()=>[o[2]||(o[2]=t("i",{class:"me-1 bx bx-chevron-left"},null,-1)),w(" "+d(g.$t("detail_QS.other.library")),1)]),_:1,__:[2]}),t("div",Ae,[e.loading?(n(),l("div",Re,[r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"])])):(n(),l("div",Ce,[t("div",Fe,[t("div",null,[t("span",null," Mẫu đề thi: "+d(e.quiz.name),1)]),e.permission.canEdit||e.permission.canDelete?(n(),l("div",Ne,[r(f,null,{title:u(()=>[w(d(g.$t("question_sets_index.buttons.edit")),1)]),default:u(()=>[e.permission.canEdit?(n(),l("i",{key:0,class:"bx bx-edit",onClick:e.onRedirectToEdit})):q("v-if",!0)]),_:1}),r(f,null,{title:u(()=>[w(d(g.$t("question_sets_index.buttons.delete")),1)]),default:u(()=>[e.permission.canDelete?(n(),l("i",{key:0,class:"text-danger bx bx-trash-alt",onClick:e.onDelete})):q("v-if",!0)]),_:1})])):q("v-if",!0)]),t("div",Le,[t("div",Oe,[r(_,{type:"primary",class:"me-3 main-color-btn share-btn",size:"large",onClick:e.openFolderModal},{default:u(()=>[o[3]||(o[3]=t("i",{class:"bx bx-plus"},null,-1)),w(" "+d(g.$t("detail_test_template.buttons.add_to_folder")),1)]),_:1,__:[3]})]),t("div",Pe,[r(_,{type:"primary",class:"main-color-btn share-btn",size:"large",onClick:e.onOpenShareModal},{default:u(()=>[o[4]||(o[4]=t("i",{class:"bx bx-share-alt"},null,-1)),w(" "+d(g.$t("detail_QS.buttons.share_quiz")),1)]),_:1,__:[4]})])])]))]),t("div",De,[t("div",Ve,[t("div",null,[t("span",null,d(g.$t("detail_QS.other.questions",{number:e.quiz_questions.length})),1)])]),t("div",Ue,[r(M,{class:"me-3",value:e.selected_type_option,"onUpdate:value":o[0]||(o[0]=s=>e.selected_type_option=s),style:{width:"200px"},onChange:e.onFilter},{default:u(()=>[(n(!0),l(S,null,A(e.question_type_options,s=>(n(),V(x,{value:s.value},{default:u(()=>[w(d(s.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",Qe,[r(e.Input,{onInput:e.onFilter,modelValue:e.searchValue,"onUpdate:modelValue":o[1]||(o[1]=s=>e.searchValue=s),placeholder:e.t("question_sets_index.search_placeholder")},{icon:u(()=>o[5]||(o[5]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(n(),l("div",Be,[r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"])])):(n(),l("div",Ye,[(n(!0),l(S,null,A(e.questions,(s,b)=>(n(),l("div",He,[t("div",Ge,[t("div",je,[t("div",Xe,d(b+1),1),s.questionHTML?(n(),l("div",{key:0,class:"question-html",innerHTML:s.questionHTML},null,8,Ke)):(n(),l("div",We,d(s.questionText),1))]),t("div",{class:"question-item-answer",id:`question-item-answer-${b}`,style:{display:"none"}},[s.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(n(),l("div",Ze,[t("ul",null,[(n(!0),l(S,null,A(s.multipleChoices,a=>(n(),l("li",null,[w(d(a.text)+" ",1),a.isAnswer?(n(),l("span",$e," ("+d(a.isAnswer)+") ",1)):q("v-if",!0)]))),256))])])):q("v-if",!0),s.type===e.QUESTION_TYPE.MATCHING?(n(!0),l(S,{key:1},A(s.matchingPairs,a=>(n(),l("div",et,[t("span",tt,d(a.leftItem),1),o[6]||(o[6]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("span",ot,d(a.rightItem),1)]))),256)):q("v-if",!0),s.type===e.QUESTION_TYPE.ORDERING?(n(),l("div",at,[t("div",nt,[(n(!0),l(S,null,A(s.orderingItems,a=>(n(),l("div",null,d(a.text),1))),256))]),o[7]||(o[7]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("div",st,[(n(!0),l(S,null,A(s.orderingItems.sort((a,h)=>a.correctOrder-h.correctOrder),(a,h)=>(n(),l("div",lt,[t("span",null,"#"+d(h+1),1),w(" - "+d(a.text),1)]))),256))])])):q("v-if",!0),s.type===e.QUESTION_TYPE.SHORT_TEXT?(n(),l(S,{key:3},[o[8]||(o[8]=t("span",null,"Answer:",-1)),t("div",it,d(s.shortAnswer),1)],64)):q("v-if",!0)],8,Je)]),t("div",rt,[t("i",{class:"bx bx-chevron-down",onClick:a=>e.toggleDisplayAnswer(b,a.currentTarget)},null,8,dt)])]))),256))]))])]),r(e.ShareModal,{ref:"shareModalRef",id:e.quiz.testTemplateId,name:e.quiz.name,mode:"template",options:[e.VISIBILITY.PRIVATE],visibility:""},null,8,["id","name","options"]),r(e.ShareToFolder,{ref:"shareToFolderModalRef",onAddToFolder:e.onAddToFolder},null,512)],64)}const It=J(ze,[["render",ct],["__scopeId","data-v-a98a6135"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/test_template/detail.vue"]]);export{It as default};
