import{d as F,u as G,i as x,j as U,V as N,W as B,s as j,k as p,X as A,M as C,_ as J,r as I,a as Y,o as O,b as o,c,w as h,f as T,t as d,G as D,N as X,F as K}from"./index-C2jtDg6B.js";import{A as Z}from"./ApiTestTemplate-Ds5LzdWO.js";import{I as $}from"./Input-0Otcuoto.js";import{T as ee}from"./TextArea-SkV_8IH8.js";import{S as te,O as oe,M as re,a as ne,s as ie,b as se}from"./vue-virtual-scroller.esm-D8MvBVCq.js";import{G as ae,I as le}from"./GenerateQSModal-Cbah8nW_.js";import{Q as v}from"./questionTypes-CS3lcRlq.js";/* empty css                                                                 */import"./vue-draggable-plus-DALPiNCD.js";const ce=F({__name:"create",setup(l,{expose:a}){a();const{t:P}=G(),t=x(),r=U({name:"",description:"",questions:[]}),Q={title:[{required:"true",message:"This field is required",trigger:"change"},{length:100,message:"Limit 100",trigger:"change"}],description:[{length:200,message:"Limit 200",trigger:"change"}],tags:[{validator:(e,i)=>i&&i.length>5?Promise.reject("You can only add up to 5 tags."):Promise.resolve(),trigger:"change"}],questions:[{validator:(e,i)=>i&&i.length>500?Promise.reject("You can only add up to 5 questions."):Promise.resolve(),trigger:"change"}]},g={MultipleChoice:ne,Matching:re,Ordering:oe,ShortText:te},f=[{id:"q1",type:"MultipleChoice",questionText:"What is the capital of France ?",questionHTML:"<p><strong>What</strong> is <br/> the <em>capital</em> of <u>France</u>? <code>// geography</code></p>",explainText:"Paris is the capital city of France.",score:20,multipleChoices:[{id:"1",text:"Paris",isAnswer:!0},{id:"2",text:"London",isAnswer:!1},{id:"3",text:"Berlin",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q2",type:"Matching",questionText:"Match the countries to their capitals.",questionHTML:"<p><u>Match</u> the <strong>countries</strong> to their <em>capitals</em>. <code>// matching task</code></p>",explainText:"Each country must be paired with its capital.",score:10,multipleChoices:[],matchingPairs:[{id:"1",leftItem:"Japan",rightItem:"Tokyo"},{id:"2",leftItem:"Italy",rightItem:"Rome"},{id:"3",leftItem:"Vietnam",rightItem:"Hanoi"}],orderingItems:[],shortAnswer:""},{id:"q3",type:"Ordering",questionText:"Arrange the steps of the water cycle in the correct order.",questionHTML:"<p><strong>Arrange</strong> the steps of the <u>water cycle</u> in the <em>correct order</em>. <code>// science</code></p>",explainText:"The correct order is: Evaporation → Condensation → Precipitation → Collection.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[{id:"1",text:"Evaporation",correctOrder:0},{id:"2",text:"Condensation",correctOrder:1},{id:"3",text:"Precipitation",correctOrder:2},{id:"4",text:"Collection",correctOrder:3}],shortAnswer:""},{id:"q4",type:"ShortText",questionText:"What is the chemical symbol for water?",questionHTML:"<p><em>What</em> is the chemical <strong>symbol</strong> for <u>water</u>? <code>H2O</code></p>",explainText:"H2O is the formula for water.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[],shortAnswer:"H2O"},{id:"q5",type:"MultipleChoice",questionText:"Which planet is known as the Red Planet?",questionHTML:"<p>Which <strong>planet</strong> is known as the <em>Red Planet</em>? <u>Mars</u> <pre><code>// astronomy</code></pre></p>",explainText:"Mars is often called the Red Planet due to its reddish appearance.",score:30,multipleChoices:[{id:"1",text:"Mars",isAnswer:!0},{id:"2",text:"Venus",isAnswer:!1},{id:"3",text:"Jupiter",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q6",type:"MultipleChoice",questionText:"Which language is primarily used for web development?",questionHTML:"<p>Which <strong>language</strong> is primarily used for <em>web development</em>? <code>// programming</code></p>",explainText:"JavaScript is the most commonly used language for web development.",score:20,multipleChoices:[{id:"1",text:"JavaScript",isAnswer:!0},{id:"2",text:"Python",isAnswer:!1},{id:"3",text:"C++",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q7",type:"Matching",questionText:"Match the authors to their famous works.",questionHTML:"<p>Match the <strong>authors</strong> to their <em>famous works</em>. <code>// literature</code></p>",explainText:"Each author is known for a specific famous book.",score:15,multipleChoices:[],matchingPairs:[{id:"1",leftItem:"George Orwell",rightItem:"1984"},{id:"2",leftItem:"J.K. Rowling",rightItem:"Harry Potter"},{id:"3",leftItem:"Leo Tolstoy",rightItem:"War and Peace"}],orderingItems:[],shortAnswer:""},{id:"q8",type:"Ordering",questionText:"Arrange the historical periods in chronological order.",questionHTML:"<p><strong>Arrange</strong> the <em>historical periods</em> in <u>chronological</u> order. <code>// history</code></p>",explainText:"The order is: Ancient → Medieval → Renaissance → Modern.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[{id:"1",text:"Ancient",correctOrder:0},{id:"2",text:"Medieval",correctOrder:1},{id:"3",text:"Renaissance",correctOrder:2},{id:"4",text:"Modern",correctOrder:3}],shortAnswer:""},{id:"q9",type:"ShortText",questionText:"What is the square root of 144?",questionHTML:"<p>What is the <strong>square root</strong> of <em>144</em>? <code>// math</code></p>",explainText:"The square root of 144 is 12.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[],shortAnswer:"12"},{id:"q10",type:"MultipleChoice",questionText:"Which gas do plants absorb from the atmosphere?",questionHTML:"<p>Which <strong>gas</strong> do <u>plants</u> absorb from the <em>atmosphere</em>? <code>// biology</code></p>",explainText:"Plants absorb carbon dioxide (CO₂) during photosynthesis.",score:20,multipleChoices:[{id:"1",text:"Oxygen",isAnswer:!1},{id:"2",text:"Carbon Dioxide",isAnswer:!0},{id:"3",text:"Nitrogen",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""}],q=()=>({id:Date.now().toString(),type:"MultipleChoice",questionText:"",questionHTML:"",explainText:"",score:10,multipleChoices:[{id:(Date.now()+1).toString(),text:"",isAnswer:!0},{id:(Date.now()+2).toString(),text:"",isAnswer:!1},{id:(Date.now()+3).toString(),text:"",isAnswer:!1},{id:(Date.now()+4).toString(),text:"",isAnswer:!1}],matchingPairs:[{id:(Date.now()+1).toString(),leftItem:"",rightItem:""},{id:(Date.now()+2).toString(),leftItem:"",rightItem:""}],orderingItems:[{id:(Date.now()+1).toString(),text:"",correctOrder:0},{id:(Date.now()+2).toString(),text:"",correctOrder:1},{id:(Date.now()+3).toString(),text:"",correctOrder:2},{id:(Date.now()+4).toString(),text:"",correctOrder:3}],shortAnswer:""}),S=()=>{if(r.questions.length>=10){p.warning("Each question set could have at most 100 questions");return}r.questions=[...r.questions,q()],A(()=>{var e,i;(i=(e=w.value)==null?void 0:e.forceUpdate)==null||i.call(e),A(()=>{const u=r.questions.length;requestAnimationFrame(()=>{var y;(y=w.value)==null||y.scrollToItem(u)})})})},m=e=>{if(r.questions.length<=1){p.warning("Each question set must have at least 1 questions");return}r.questions=[...r.questions.slice(0,e),...r.questions.slice(e+1)]},_=()=>{let e=!1,i="Invalid question.",u=new Set;if(r.name.trim().length>100||r.name.trim().length===0){e=!0,i="Invalid title.",p.error(i);return}if(r.description.trim().length>250){e=!0,i="Invalid description.",p.error(i);return}[r.questions.filter(n=>{const s=n.questionText.replace(/^<p>/,"").replace(/<\/p>$/,"").trim();return s.length===0||s.length>=500}),r.questions.filter(n=>n.explainText.replace(/^<p>/,"").replace(/<\/p>$/,"").trim().length>=500),r.questions.filter(n=>n.type===v.MULTIPLE_CHOICE&&(n.multipleChoices.some(s=>s.text.trim().length===0||s.text.trim().length>500)||n.multipleChoices.filter(s=>s.isAnswer).length===0)),r.questions.filter(n=>n.type===v.MATCHING&&(n.matchingPairs.some(s=>s.leftItem.trim().length===0||s.leftItem.trim().length>500)||n.matchingPairs.some(s=>s.rightItem.trim().length===0||s.rightItem.trim().length>500))),r.questions.filter(n=>n.type===v.ORDERING&&n.orderingItems.some(s=>s.text.trim().length===0||s.text.trim().length>500)),r.questions.filter(n=>n.type===v.SHORT_TEXT&&(n.shortAnswer.trim().length===0||n.shortAnswer.trim().length>500))].forEach(n=>{n.length>0&&(e=!0,n.forEach(s=>u.add(s)))});let V=Array.from(u).map(n=>r.questions.indexOf(n)+1);e?C.error({title:"Cannot create new question set!",content:"There are errors at questions: "+V.sort().join(", ")}):M()},M=()=>{C.confirm({title:"Create new quiz!",content:"Make sure to review your contents before proceeding.",centered:!0,onOk:async()=>{let e=await Z.Create(r);e.data.success&&p.success(e.data.data)}})},k=x(null),H=()=>{var e;(e=k.value)==null||e.openImportModal()},R=x(null),z=()=>{var e;(e=R.value)==null||e.openGenerateAIModal()},E=e=>{r.questions.push(...e.map((i,u)=>({...i,id:`new_${r.questions.length+u}`}))),p.success(`Imported ${e.length} questions`)};N((e,i,u)=>{C.confirm({title:"Leave already?",content:"You have unsaved changes.",onOk:()=>{u()},onCancel:()=>u(!1)})});function b(e){e.preventDefault(),e.returnValue=""}B(()=>{window.removeEventListener("beforeunload",b)});const w=x(null),W=()=>{A(()=>{var e,i;(i=(e=w.value)==null?void 0:e.forceUpdate)==null||i.call(e)})};j(()=>{r.questions.push(...f),window.addEventListener("beforeunload",b)});const L={t:P,formRef:t,formState:r,rules:Q,componentMap:g,question_data_raw:f,createQuestionTemplate:q,onAddQuestion:S,onRemoveQuestion:m,onFinish:_,showModalConfirmation:M,importModalRef:k,onOpenImportModal:H,generateModalRef:R,openGenerateAIModal:z,onModalImport:E,handleBeforeUnload:b,scrollerRef:w,handleScroll:W,Input:$,TextArea:ee,ImportQSModal:le,GenerateQSModal:ae,get DynamicScroller(){return se},get DynamicScrollerItem(){return ie}};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}}),de={class:"page-container"},me={class:"title-container"},ue={class:"content"},he={class:"content-item"},pe={class:"content-item-title"},ge={class:"d-flex"},fe={class:"content-item"},qe={class:"content-item-title"},_e={class:"content-item-buttons"},we={class:"import-button"};function xe(l,a,P,t,r,Q){const g=I("RouterLink"),f=I("a-col"),q=I("a-row"),S=I("a-form");return O(),Y(K,null,[o("div",de,[o("div",me,[c(q,{class:"w-100 d-flex align-items-center"},{default:h(()=>[c(f,{span:1},{default:h(()=>[c(g,{to:{name:"User_TestTemplate"}},{default:h(()=>a[2]||(a[2]=[o("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[2]})]),_:1}),c(f,{class:"main-title",span:23},{default:h(()=>[o("span",null,d(l.$t("create_QS.title")),1),a[3]||(a[3]=T()),a[4]||(a[4]=o("br",null,null,-1)),o("span",null,d(l.$t("create_QS.sub_title")),1)]),_:1,__:[3,4]})]),_:1})]),o("div",ue,[c(S,{layout:"vertical",model:t.formState,rules:t.rules,ref:"formRef"},{default:h(()=>[o("div",he,[o("div",pe,[o("div",null,[o("span",null,d(l.$t("create_QS.quiz.question_detail_title")),1),o("span",null,d(l.$t("create_QS.quiz.question_detail_sub_title")),1)])]),c(t.Input,{class:"question-input-item",modelValue:t.formState.name,"onUpdate:modelValue":a[0]||(a[0]=m=>t.formState.name=m),isRequired:!0,placeholder:t.t("question_sets_index.search_placeholder"),label:t.t("create_QS.quiz.title"),"max-length":100},null,8,["modelValue","placeholder","label"]),o("div",ge,[c(t.TextArea,{class:"question-input-item",modelValue:t.formState.description,"onUpdate:modelValue":a[1]||(a[1]=m=>t.formState.description=m),placeholder:"textarea with clear icon","max-length":250,label:t.t("create_QS.quiz.description")},null,8,["modelValue","label"])])]),o("div",fe,[o("div",qe,[o("div",null,[o("span",null,d(l.$t("create_QS.quiz.question_question_title")),1),o("span",null,d(l.$t("create_QS.quiz.question_question_sub_title")),1)]),o("div",_e,[c(g,{onClick:t.onOpenImportModal,class:"import-button",to:{name:""}},{default:h(()=>[T(d(l.$t("create_QS.buttons.import"))+" ",1),a[5]||(a[5]=o("i",{class:"bx bx-download"},null,-1))]),_:1,__:[5]}),c(g,{onClick:t.openGenerateAIModal,class:"import-button",to:{name:""}},{default:h(()=>[T(d(l.$t("create_QS.buttons.generated_by_ai"))+" ",1),a[6]||(a[6]=o("i",{class:"bx bx-upload"},null,-1))]),_:1,__:[6]}),o("div",{class:"import-button",onClick:t.onFinish},d(l.$t("create_QS.buttons.create")),1),o("div",we,d(l.$t("create_QS.quiz.total",{number:t.formState.questions.length.toString().padStart(3,"0")})),1)])]),c(t.DynamicScroller,{ref:"scrollerRef",class:"scroller","key-field":"id",items:t.formState.questions,"min-item-size":650,buffer:800,prerender:10,onScroll:t.handleScroll},{default:h(({item:m,index:_})=>[(O(),D(t.DynamicScrollerItem,{item:m,key:m.id},{default:h(()=>[(O(),D(X(t.componentMap[m.type]),{question:m,index:_+1,displayScore:!1,onDeleteQuestion:M=>t.onRemoveQuestion(_)},null,40,["question","index","onDeleteQuestion"]))]),_:2},1032,["item"]))]),_:1},8,["items"]),o("div",{class:"add-question-btn",onClick:t.onAddQuestion},[a[7]||(a[7]=o("i",{class:"bx bx-plus"},null,-1)),T(" "+d(l.$t("create_QS.buttons.add_question")),1)])])]),_:1},8,["model"])])]),c(t.ImportQSModal,{ref:"importModalRef",title:t.formState.name,onImport:t.onModalImport},null,8,["title"]),c(t.GenerateQSModal,{ref:"generateModalRef",title:t.formState.name,onImport:t.onModalImport},null,8,["title"])],64)}const Oe=J(ce,[["render",xe],["__scopeId","data-v-6115bf3d"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/test_template/create.vue"]]);export{Oe as default};
