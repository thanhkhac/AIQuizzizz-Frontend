import{d as K,q as W,l as Y,g as X,u as Z,i as m,z as $,j as P,E as ee,s as ae,k as j,_ as se,r as d,c as f,o as u,b as l,a as o,e as te,f as v,t as c,w as i,F as N,B as V,C as le}from"./index-DlVciecZ.js";import{A as q}from"./ApiClass-CeJRP6bx.js";import{I as oe}from"./Input-DHZLWcQT.js";const J={ALL:"All",TEACHER:"Teacher",STUDENT:"Student",OWNER:"Owner"},ne=K({__name:"index",emits:["updateSidebar"],setup(b,{expose:a,emit:E}){var B;a();const e=W(),h=Y(),I=X(),{t:r}=Z(),w=E,L=m(I.getUserInfo()),C=Object.values(J),S=$(()=>C.map(n=>({label:r(`class_index.select_option.${n}`),value:n!==J.ALL?n:""}))),R=m(["12","24","36","48","60"]),t=P({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||12,name:((B=e.query.name)==null?void 0:B.toString())||"",shareMode:e.query.shareMode||S.value[0].value,totalCount:0,statusFilter:!1}),g=m([]),x=m(!1),_=async()=>{try{x.value=!0;let n=await q.GetAllByLimit(t);if(n.data.success){let p=n.data.data;g.value=p.items,t.pageNumber=p.pageNumber,t.pageSize=p.pageSize,t.totalCount=p.totalCount,t.statusFilter&&(t.pageNumber>p.totalPages&&t.totalCount>0?(t.pageNumber=1,h.push({name:"User_Class",query:{pageNumber:1,pageSize:t.pageSize,name:t.name,shareMode:t.shareMode}})):h.push({name:"User_Class",query:{pageNumber:t.pageNumber,pageSize:t.pageSize,name:t.name,shareMode:t.shareMode}}),t.statusFilter=!t.statusFilter)}}catch(n){console.log("ERROR: GETALLBYLIMIT class: "+n)}finally{x.value=!1}};ee(()=>Object.keys(e.query).length,()=>{var n;t.pageNumber=e.query.pageNumber||1,t.pageSize=e.query.pageSize||12,t.name=((n=e.query.name)==null?void 0:n.toString())||"",t.shareMode=e.query.shareMode||S.value[0].value,t.statusFilter=!0,_()});const k=(n,p)=>{t.pageNumber=n,t.pageSize=p,t.statusFilter=!0,_()},F={code:[{required:!0,message:r("message.required"),trigger:"change"}],name:[{required:!0,message:r("message.required"),trigger:"change"},{max:100,message:r("message.out_of_range",{max_length:100}),trigger:"change"}],topic:[{max:100,message:r("message.out_of_range",{max_length:100}),trigger:"change"}]},s=m(!1),y=m(),U=P({code:""}),A=m(!1),G=async()=>{A.value=!0;try{if(await y.value.validate(),!(await q.JoinClass(U)).data.success){j.error(r("message.join_class_failed"));return}s.value=!1,j.success(r("message.join_class_successfully")),await _()}catch(n){console.log(n)}finally{A.value=!1}},D=m(!1),O=m(),z=P({name:"",topic:""}),M=m(!1),H=async()=>{M.value=!0;try{await O.value.validate();let n;if(z.topic?n=await q.Create({name:z.name,topic:z.topic}):n=await q.Create({name:z.name}),!n.data.success){j.error(r("message.created_failed"));return}D.value=!1,j.success(r("message.created_successfully")),await _()}catch(n){console.log(n)}finally{M.value=!1}},Q=n=>{h.push({name:"User_Class_Exam",params:{id:n}})};ae(async()=>{w("updateSidebar","class"),await _()});const T={route:e,router:h,authStore:I,t:r,emit:w,user:L,optionKeys:C,class_credit_options:S,pageSizeOptions:R,pageParams:t,class_data:g,loading:x,getData:_,onPaginationChange:k,rules:F,modal_join_class_open:s,joinClassFormRef:y,joinClassFormState:U,isJoinLoading:A,onJoinClass:G,modal_create_class_open:D,createClassFormRef:O,createClassFormState:z,isCreateLoading:M,onCreateClass:H,onRedirectToClassDetail:Q,Input:oe};return Object.defineProperty(T,"__isScriptSetup",{enumerable:!1,value:!0}),T}}),ie={class:"page-container"},re={class:"title-container"},ce={class:"main-title"},de={class:"title-button-container"},me={class:"content"},_e={class:"content-item"},ue={class:"content-item-functions"},ge={class:"filter-container"},pe={style:{width:"300px",padding:"0px"}},fe={key:1,class:"class-container"},ve=["onClick"],be={class:"class-item-name"},Ce={class:"class-item-topic"},xe={class:"class-item-owner"},ye={key:1,class:"w-100 m-2 d-flex justify-content-center"},he={class:"pagination-container"},Se={class:"modal-container"},ze={class:"modal-title-container"},we={class:"modal-container"},ke={class:"modal-title-container"};function Fe(b,a,E,e,h,I){const r=d("a-button"),w=d("a-select-option"),L=d("a-select"),C=d("a-skeleton"),S=d("a-empty"),R=d("a-pagination"),t=d("RouterLink"),g=d("a-col"),x=d("a-row"),_=d("a-form"),k=d("a-modal"),F=d("a-form-item");return u(),f(N,null,[l("div",ie,[l("div",re,[l("div",ce,[l("span",null,c(b.$t("class_index.title")),1),a[12]||(a[12]=v()),a[13]||(a[13]=l("br",null,null,-1)),l("span",null,c(b.$t("class_index.sub_title")),1)]),l("div",de,[o(r,{type:"primary",class:"main-color-btn",size:"large",onClick:a[0]||(a[0]=s=>e.modal_join_class_open=!0)},{default:i(()=>[v(c(b.$t("class_index.buttons.join_class"))+" ",1),a[14]||(a[14]=l("i",{class:"bx bx-log-in"},null,-1))]),_:1,__:[14]}),o(r,{type:"primary",class:"ms-3 main-color-btn",size:"large",onClick:a[1]||(a[1]=s=>e.modal_create_class_open=!0)},{default:i(()=>[v(c(b.$t("class_index.buttons.create_class"))+" ",1),a[15]||(a[15]=l("i",{class:"bx bx-plus"},null,-1))]),_:1,__:[15]})])]),l("div",me,[l("div",_e,[l("div",ue,[l("div",ge,[o(L,{class:"me-3",value:e.pageParams.shareMode,"onUpdate:value":a[2]||(a[2]=s=>e.pageParams.shareMode=s),style:{width:"200px"},onChange:e.getData},{default:i(()=>[(u(!0),f(N,null,V(e.class_credit_options,s=>(u(),le(w,{value:s.value},{default:i(()=>[v(c(s.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),l("div",pe,[o(e.Input,{onInput:e.getData,modelValue:e.pageParams.name,"onUpdate:modelValue":a[3]||(a[3]=s=>e.pageParams.name=s),placeholder:e.t("class_index.other.search_class_placeholder")},{icon:i(()=>a[16]||(a[16]=[l("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])])]),e.loading?(u(),f(N,{key:0},[o(C,{active:"",loading:e.loading},null,8,["loading"]),o(C,{active:"",loading:e.loading},null,8,["loading"]),o(C,{active:"",loading:e.loading},null,8,["loading"])],64)):(u(),f("div",fe,[e.class_data.length>0?(u(!0),f(N,{key:0},V(e.class_data,s=>(u(),f("div",{class:"class-item",onClick:y=>e.onRedirectToClassDetail(s.classId)},[l("div",be,c(s.name),1),l("div",Ce,c(s.topic),1),l("div",xe,[a[17]||(a[17]=l("i",{class:"bx bxs-user"},null,-1)),v(" "+c(s.owner),1)])],8,ve))),256)):(u(),f("div",ye,[o(S,null,{description:i(()=>[l("span",null,c(b.$t("class_index.other.no_data_matches")),1)]),_:1})]))])),l("div",he,[o(R,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":a[4]||(a[4]=s=>e.pageParams.pageNumber=s),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"page-size-options":e.pageSizeOptions,"show-total":(s,y)=>`${y[0]}-${y[1]} of ${s} ${e.t("class_index.other.items")}`,"show-size-changer":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","page-size-options","show-total","locale"])])])])]),o(k,{centered:"","wrap-class-name":"medium-modal",open:e.modal_join_class_open,onCancel:a[7]||(a[7]=s=>e.modal_join_class_open=!1)},{footer:i(()=>[o(r,{loading:e.isJoinLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onJoinClass},{default:i(()=>[v(c(e.t("class_index.buttons.join")),1)]),_:1},8,["loading"])]),default:i(()=>[l("div",Se,[l("div",ze,[o(x,{class:"w-100 d-flex align-items-center"},{default:i(()=>[o(g,{span:4},{default:i(()=>[o(t,{onClick:a[5]||(a[5]=s=>e.modal_join_class_open=!1),to:{name:""}},{default:i(()=>a[18]||(a[18]=[l("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[18]})]),_:1}),o(g,{class:"main-title",span:20},{default:i(()=>[l("span",null,c(e.t("class_index.modal.join_title")),1)]),_:1})]),_:1})]),o(_,{ref:"joinClassFormRef",model:e.joinClassFormState,layout:"vertical",rules:e.rules},{default:i(()=>[o(e.Input,{label:e.t("class_index.modal.join_class_code_label"),name:"code",value:e.joinClassFormState.code,"onUpdate:value":a[6]||(a[6]=s=>e.joinClassFormState.code=s),placeholder:e.t("class_index.modal.join_class_code_placeholder"),"is-required":!0},null,8,["label","value","placeholder"])]),_:1},8,["model"])])]),_:1},8,["open"]),te(" create modal "),o(k,{centered:"","wrap-class-name":"medium-modal",open:e.modal_create_class_open,onCancel:a[11]||(a[11]=s=>e.modal_create_class_open=!1)},{footer:i(()=>[o(r,{loading:e.isCreateLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onCreateClass},{default:i(()=>[v(c(e.t("class_index.buttons.create")),1)]),_:1},8,["loading"])]),default:i(()=>[l("div",we,[l("div",ke,[o(x,{class:"w-100 d-flex align-items-center"},{default:i(()=>[o(g,{span:4},{default:i(()=>[o(t,{onClick:a[8]||(a[8]=s=>e.modal_create_class_open=!1),to:{name:""}},{default:i(()=>a[19]||(a[19]=[l("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[19]})]),_:1}),o(g,{class:"main-title",span:20},{default:i(()=>[l("span",null,c(e.t("class_index.modal.create_title")),1)]),_:1})]),_:1})]),o(_,{ref:"createClassFormRef",layout:"vertical",rules:e.rules,model:e.createClassFormState},{default:i(()=>[o(F,null,{default:i(()=>[o(e.Input,{label:e.t("class_index.modal.create_class_name_label"),name:"name",value:e.createClassFormState.name,"onUpdate:value":a[9]||(a[9]=s=>e.createClassFormState.name=s),placeholder:e.t("class_index.modal.create_class_name_placeholder"),"is-required":!0,"max-length":100},null,8,["label","value","placeholder"])]),_:1}),o(F,null,{default:i(()=>[o(e.Input,{label:e.t("class_index.modal.create_class_topic_label"),name:"topic",value:e.createClassFormState.topic,"onUpdate:value":a[10]||(a[10]=s=>e.createClassFormState.topic=s),placeholder:e.t("class_index.modal.create_class_topic_placeholder"),"max-length":100},null,8,["label","value","placeholder"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open"])],64)}const Ie=se(ne,[["render",Fe],["__scopeId","data-v-958f51f8"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/index.vue"]]);export{Ie as default};
