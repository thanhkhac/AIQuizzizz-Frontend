import{d as se,u as ne,q as ae,l as ie,i as _,B as oe,s as le,G as re,S as de,k as U,M as ce,T as ue,_ as _e,r as p,a as o,o as n,b as t,E as H,e as y,c as r,w as u,f as m,t as l,F as b,D as q}from"./index-CNJWNuZR.js";import{u as me}from"./user-zaK1_Zi8.js";import{A as R}from"./ApiQuestionSet-C3r9YaR0.js";import{Q as M}from"./questionTypes-CS3lcRlq.js";import{I as ve}from"./Input-CgwF4PuG.js";import{T as ge}from"./TransferQuestionData-BxcXdBjq.js";import{V as fe}from"./Validator-CWeiTIFe.js";import{S as pe}from"./ShareModal-vghrkydP.js";import{V as ye}from"./visibility-PZlBDoOn.js";/* empty css                                                              */import"./ApiClass-7_FfTsRe.js";import"./ApiTestTemplate-Bj-E37Ah.js";import"./ApiFolder-BcP0B10J.js";const he=se({__name:"detail",setup(v,{expose:s}){s();const{t:g}=ne(),e=ae(),f=ie(),Q=_(!1),k=_(e.params.id),d=_({id:"",name:"",description:"",totalQuestionCount:0,completedQuestionCount:0,ratingCount:0,ratingAverage:0,createBy:"",createdAt:"",createdById:"",tags:[],lastAccessByMe:"",visibilityMode:""}),I=_([]),S=_([]),L=["All",M.MULTIPLE_CHOICE,M.MATCHING,M.ORDERING,M.SHORT_TEXT],O=oe(()=>L.map(i=>({label:g(`create_QS.type.${i}`),value:i}))),x=_(O.value[0].value),V=_(""),E=async()=>{var i,h;try{Q.value=!0,fe.isValidGuid(k.value.toString())||f.push({name:"404"});const T=await R.GetDetailById(k.value.toString()),w=await R.GetQuestionById(k.value.toString());(!T.data.success||!w.data.success)&&f.push({name:"User_Library"}),d.value=T.data.data,d.value.createBy=T.data.data.createdBy.fullName,I.value=w.data.data.map(te=>ge.transformResponseToRequest(te)),S.value=I.value,await P(),await re()}catch(T){de.QUESTION_SET_NOT_FOUND in(((h=(i=T.response)==null?void 0:i.data)==null?void 0:h.errors)||{})&&f.push({name:"404"})}finally{Q.value=!1}},A=(i,h)=>{$(h).toggleClass("bx-chevron-up bx-chevron-down");const w=$(`#question-item-answer-${i}`);w&&$(w).slideToggle()},a=_(null),C=()=>{var i;(i=a.value)==null||i.openModal()},c=i=>{d.value.visibilityMode=i},z=_(null),F=()=>{var i;(i=z.value)==null||i.openModal()},j=()=>{f.push({name:"User_QuestionSet_Learn",params:{id:d.value.id}})},X=()=>{f.push({name:"User_QuestionSet_Test",params:{id:d.value.id}})},J=()=>{f.push({name:"User_QuestionSet_Update",params:{id:d.value.id}})},B=_(!1),N=_(0),D=async()=>{const i=await R.GetRating(d.value.id);i.data.success&&(N.value=i.data.data.rating)},K=async()=>{(await R.UpdateRating(d.value.id,{questionSetId:d.value.id,rating:N.value})).data.success?(U.success(g("message.updated_successfully")),B.value=!1,await E()):U.error(g("message.updated_failed"))},Y=_({canEdit:!1,canDelete:!1}),P=async()=>{const i=await R.GetPermissions(d.value.id);i.data.success&&(Y.value=i.data.data)},W=()=>{ce.confirm({title:g("detail_QS.modal.delete_title"),content:g("detail_QS.modal.delete_content"),okText:g("sidebar.buttons.ok"),cancelText:g("sidebar.buttons.cancel"),onOk:async()=>{if(!(await R.Delete(d.value.id)).data.success){U.error(g("message.deleted_failed"));return}U.success(g("message.deleted_successfully")),f.push({name:"User_Library"})}})},Z=i=>{const h=[i];sessionStorage.setItem("selected_tags",JSON.stringify(h)),f.push({name:"User_QuestionSet_Search"})},ee=()=>{let i=I.value;i=I.value.filter(h=>{const T=h.questionText.includes(V.value),w=x.value==="All"||x.value===h.type;return T&&w}),S.value=i};le(async()=>{await E(),D()});const G={t:g,route:e,router:f,loading:Q,question_set_id:k,quiz:d,quiz_questions:I,questions:S,optionKeys:L,question_type_options:O,selected_type_option:x,searchValue:V,getData:E,toggleDisplayAnswer:A,shareModalRef:a,onOpenShareModal:C,onUpdateVisibility:c,shareClassModalRef:z,onOpenShareClassModal:F,onRedirectToLearn:j,onRedirectToTest:X,onRedirectToEdit:J,modal_rate_open:B,rateValue:N,getRating:D,updateRating:K,permission:Y,getPermission:P,onDelete:W,onRedirectToSearch:Z,onFilter:ee,get user_image(){return me},get QUESTION_TYPE(){return M},Input:ve,get dayjs(){return ue},ShareModal:pe,get VISIBILITY(){return ye}};return Object.defineProperty(G,"__isScriptSetup",{enumerable:!1,value:!0}),G}}),be={class:"content"},Ie={class:"content-item"},Te={key:0},Se={key:1},we={class:"content-item-title"},qe={key:0,class:"d-flex flex-row align-items-center quiz-header-functions"},ke={class:"quiz-info"},xe={class:"quiz-tag-container"},Ce=["onClick"],ze={key:0,class:"quiz-credit"},Re={class:"share-btn-container"},Ee={class:"share-btn-container"},Me={class:"action-container"},Qe={class:"credit-user"},Le=["src"],Oe={class:"credit-user-info"},Ve={class:"d-flex"},Ue={class:"content-item"},Ae={class:"content-item-title"},Ne={class:"content-item-functions"},Be={style:{width:"300px",padding:"0"}},De={key:0},Ye={key:1,class:"preview-question-container"},Pe={class:"preview-question-item"},Ge={class:"question-item-content"},He={class:"d-flex pb-2"},Fe={class:"question-index"},je=["innerHTML"],Xe={key:1,class:"question-text"},Je=["id"],Ke={key:0,class:"multiple-choice-answer"},We={key:0,class:"text-success"},Ze={class:"pair-answer"},$e={class:"pair-answer-item"},et={class:"pair-answer-item"},tt={key:2,class:"ordering-answer"},st={class:"ordering-answer-item"},nt={class:"ordering-answer-item"},at={class:"ordering-answer-item"},it={class:"short-text-answer"},ot={class:"question-item-toogle-btn"},lt=["onClick"],rt={class:"title-container"},dt={class:"modal-rate-container"};function ct(v,s,g,e,f,Q){const k=p("RouterLink"),d=p("a-skeleton"),I=p("a-tooltip"),S=p("a-button"),L=p("a-select-option"),O=p("a-select"),x=p("a-col"),V=p("a-row"),E=p("a-rate"),A=p("a-modal");return n(),o(b,null,[t("div",be,[r(k,{class:"navigator-back-link d-flex align-items-center p-2",to:{name:"User_Library"}},{default:u(()=>[s[5]||(s[5]=t("i",{class:"me-1 bx bx-chevron-left"},null,-1)),m(" "+l(v.$t("detail_QS.other.library")),1)]),_:1,__:[5]}),t("div",Ie,[e.loading?(n(),o("div",Te,[r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"])])):(n(),o("div",Se,[t("div",we,[t("div",null,[t("span",null,l(e.quiz.name),1),t("span",null,l(e.quiz.description),1)]),e.permission.canEdit||e.permission.canDelete?(n(),o("div",qe,[r(I,null,{title:u(()=>[m(l(v.$t("question_sets_index.buttons.edit")),1)]),default:u(()=>[e.permission.canEdit?(n(),o("i",{key:0,class:"me-3 bx bx-edit",onClick:e.onRedirectToEdit})):y("v-if",!0)]),_:1}),r(I,null,{title:u(()=>[m(l(v.$t("question_sets_index.buttons.delete")),1)]),default:u(()=>[e.permission.canDelete?(n(),o("i",{key:0,class:"text-danger bx bx-trash-alt",onClick:e.onDelete})):y("v-if",!0)]),_:1})])):y("v-if",!0)]),t("div",ke,[t("div",{class:"quiz-rating",onClick:s[0]||(s[0]=a=>e.modal_rate_open=!0)},l(e.quiz.ratingAverage)+" ⭐️ ("+l(e.quiz.ratingCount)+" "+l(v.$t("detail_QS.other.reviews"))+") ",1),t("div",xe,[(n(!0),o(b,null,q(e.quiz.tags,a=>(n(),o("div",{class:"quiz-tag-item",onClick:C=>e.onRedirectToSearch(a)},l(a.name),9,Ce))),256))])]),e.permission.canDelete?(n(),o("div",ze,[t("div",Re,[r(S,{type:"primary",class:"me-3 main-color-btn share-btn",size:"large",onClick:e.onOpenShareClassModal},{default:u(()=>[s[6]||(s[6]=t("i",{class:"bx bx-share-alt"},null,-1)),m(" "+l(v.$t("detail_QS.buttons.share_class")),1)]),_:1,__:[6]})]),t("div",Ee,[r(S,{type:"primary",class:"main-color-btn share-btn",size:"large",onClick:e.onOpenShareModal},{default:u(()=>[s[7]||(s[7]=t("i",{class:"bx bx-share-alt"},null,-1)),m(" "+l(v.$t("detail_QS.buttons.share_quiz")),1)]),_:1,__:[7]})])])):y("v-if",!0),t("div",Me,[t("div",Qe,[t("img",{class:"user-image",src:e.user_image,alt:""},null,8,Le),t("div",Oe,[t("span",null,l(v.$t("detail_QS.other.created_by",{username:e.quiz.createBy})),1),t("span",null,l(e.dayjs(e.quiz.createdAt).format("DD/MM/YYYY")),1)])]),t("div",Ve,[t("div",{class:"action-item",onClick:e.onRedirectToLearn},[m(l(v.$t("detail_QS.buttons.learn"))+" ",1),s[8]||(s[8]=t("i",{class:"bx bx-analyse"},null,-1))]),t("div",{class:"action-item",onClick:e.onRedirectToTest},[m(l(v.$t("detail_QS.buttons.test"))+" ",1),s[9]||(s[9]=t("i",{class:"bx bx-detail"},null,-1))])])])]))]),t("div",Ue,[t("div",Ae,[t("div",null,[t("span",null,l(v.$t("detail_QS.other.questions",{number:e.quiz_questions.length})),1)])]),t("div",Ne,[r(O,{class:"me-3",value:e.selected_type_option,"onUpdate:value":s[1]||(s[1]=a=>e.selected_type_option=a),style:{width:"200px"},onChange:e.onFilter},{default:u(()=>[(n(!0),o(b,null,q(e.question_type_options,a=>(n(),H(L,{value:a.value},{default:u(()=>[m(l(a.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",Be,[r(e.Input,{onInput:e.onFilter,modelValue:e.searchValue,"onUpdate:modelValue":s[2]||(s[2]=a=>e.searchValue=a),placeholder:e.t("question_sets_index.search_placeholder")},{icon:u(()=>s[10]||(s[10]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(n(),o("div",De,[r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"])])):(n(),o("div",Ye,[(n(!0),o(b,null,q(e.questions,(a,C)=>(n(),o("div",Pe,[t("div",Ge,[t("div",He,[t("div",Fe,l(C+1),1),a.questionHTML?(n(),o("div",{key:0,class:"question-html",innerHTML:a.questionHTML},null,8,je)):(n(),o("div",Xe,l(a.questionText),1))]),t("div",{class:"question-item-answer",id:`question-item-answer-${C}`,style:{display:"none"}},[a.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(n(),o("div",Ke,[t("ul",null,[(n(!0),o(b,null,q(a.multipleChoices,c=>(n(),o("li",null,[m(l(c.text)+" ",1),c.isAnswer?(n(),o("span",We," ("+l(c.isAnswer)+") ",1)):y("v-if",!0)]))),256))])])):y("v-if",!0),a.type===e.QUESTION_TYPE.MATCHING?(n(!0),o(b,{key:1},q(a.matchingPairs,c=>(n(),o("div",Ze,[t("span",$e,l(c.leftItem),1),s[11]||(s[11]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("span",et,l(c.rightItem),1)]))),256)):y("v-if",!0),a.type===e.QUESTION_TYPE.ORDERING?(n(),o("div",tt,[t("div",st,[(n(!0),o(b,null,q(a.orderingItems,c=>(n(),o("div",null,l(c.text),1))),256))]),s[12]||(s[12]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("div",nt,[(n(!0),o(b,null,q(a.orderingItems.sort((c,z)=>c.correctOrder-z.correctOrder),(c,z)=>(n(),o("div",at,[t("span",null,"#"+l(z+1),1),m(" - "+l(c.text),1)]))),256))])])):y("v-if",!0),a.type===e.QUESTION_TYPE.SHORT_TEXT?(n(),o(b,{key:3},[s[13]||(s[13]=t("span",null,"Answer:",-1)),t("div",it,l(a.shortAnswer),1)],64)):y("v-if",!0)],8,Je)]),t("div",ot,[t("i",{class:"bx bx-chevron-down",onClick:c=>e.toggleDisplayAnswer(C,c.currentTarget)},null,8,lt)])]))),256))]))])]),e.loading?y("v-if",!0):(n(),H(e.ShareModal,{key:0,ref:"shareModalRef",id:e.quiz.id,name:e.quiz.name,mode:"quiz",options:[e.VISIBILITY.PUBLIC,e.VISIBILITY.PRIVATE],visibility:e.quiz.visibilityMode},null,8,["id","name","options","visibility"])),r(e.ShareModal,{ref:"shareClassModalRef",id:e.quiz.id,name:e.quiz.name,mode:"quiz",options:[e.VISIBILITY.IN_CLASS],visibility:e.VISIBILITY.IN_CLASS},null,8,["id","name","options","visibility"]),r(A,{"wrap-class-name":"medium-modal",open:e.modal_rate_open},{footer:u(()=>[r(S,{type:"primary",class:"main-color-btn",onClick:e.updateRating},{default:u(()=>s[16]||(s[16]=[m("Send")])),_:1,__:[16]})]),default:u(()=>[t("div",rt,[r(V,{class:"w-100 d-flex align-items-center justify-content-between"},{default:u(()=>[r(x,{span:1},{default:u(()=>[t("div",{onClick:s[3]||(s[3]=a=>e.modal_rate_open=!1)},s[14]||(s[14]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)]))]),_:1}),r(x,{class:"main-title",span:20},{default:u(()=>s[15]||(s[15]=[t("span",null,"Rate the question set",-1),m(),t("br",null,null,-1)])),_:1,__:[15]})]),_:1})]),t("div",dt,[r(E,{value:e.rateValue,"onUpdate:value":s[4]||(s[4]=a=>e.rateValue=a),style:{"font-size":"40px"}},null,8,["value"])])]),_:1},8,["open"])],64)}const wt=_e(he,[["render",ct],["__scopeId","data-v-307050af"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/question_sets/detail.vue"]]);export{wt as default};
