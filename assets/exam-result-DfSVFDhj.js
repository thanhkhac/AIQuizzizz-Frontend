import{d as O,q as B,l as V,u as Q,i as S,R as E,_ as X,r,E as N,o as m,w as o,b as e,c as l,t as i,a as w,e as A,f as P,B as W,j as Z,C as $,s as tt,G as et,F as j,D as at}from"./index-BQVBa0zY.js";import{A as st}from"./ApiClass-D-PydDFx.js";import{A as Y,T as z}from"./ApiTest-BfsMqDVR.js";import{T as nt,a as ot}from"./testGradeQuestionMethod-B_BacNS6.js";import{I as lt}from"./Input-DQE8nT6C.js";import{V as F}from"./Validator-CWeiTIFe.js";import"./lodash-Dm95q8_s.js";const it=O({__name:"UserTestAttempts",props:{testId:{type:String,required:!0},userId:{type:String,required:!0},testName:{type:String,required:!0},studentName:{type:String,required:!0},passingScore:{type:Number,required:!0}},setup(k,{expose:s}){const D=B(),t=V(),{t:f}=Q(),x=k,v=S(!1),d=async()=>{v.value=!0,await b()},_=()=>{v.value=!1};s({openModal:d,closeModal:_});const I=S([]),g=S(!1),b=async()=>{try{g.value=!0;let a=await Y.GetUserExamHistory(x.testId,x.userId);if(a.data.success){let p=a.data.data;I.value=p.items}}catch(a){console.log("ERROR: GETALLEXAMBYLIMIT user exam result: "+a)}finally{g.value=!1}},y={route:D,router:t,t:f,props:x,modal_open:v,openModal:d,closeModal:_,attemptData:I,loading:g,getData:b,columns:[{title:"No",key:"no",customRender:a=>a.index+1},{title:"Start",dataIndex:"timeStart",key:"timeStart",sorter:(a,p)=>E(a.timeStart).unix()-E(p.timeStart).unix()},{title:"Submit",dataIndex:"timeSubmit",key:"timeSubmit",sorter:(a,p)=>E(a.timeSubmit).unix()-E(p.timeSubmit).unix()},{title:"Student score",dataIndex:"score",key:"score",sorter:(a,p)=>a.score-p.score},{title:"Passing score",dataIndex:"passingScore",key:"passingScore",sorter:(a,p)=>a.score-p.score},{title:"Result",dataIndex:"status",key:"status"},{title:"Action",dataIndex:"action",key:"action"}],getTagColor:a=>{switch(a){case z.PASSED:return"#22C55E";case z.FAILED:return"#cd201f"}},onRedirectToReview:a=>{t.push({name:"User_Test_Review",params:{id:a}})},get dayjs(){return E}};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),rt={class:"modal-container"},dt={class:"modal-title-container"},ut={class:"content"},ct={class:"content-item"},mt={class:"content-item-title"},_t={key:0,class:"text-nowrap"},pt={key:1,class:"text-nowrap"},gt={key:2,class:"text-nowrap"},ft={key:1,class:"w-110 d-flex justify-content-center"};function yt(k,s,D,t,f,x){const v=r("RouterLink"),d=r("a-col"),_=r("a-row"),I=r("a-tag"),g=r("a-button"),b=r("a-table"),T=r("a-config-provider"),C=r("a-empty"),R=r("a-modal");return m(),N(R,{centered:"",width:"100%","wrap-class-name":"medium-modal large",open:t.modal_open,onCancel:t.closeModal},{footer:o(()=>s[2]||(s[2]=[])),default:o(()=>[e("div",rt,[e("div",dt,[l(_,{class:"w-100 d-flex align-items-center"},{default:o(()=>[l(d,{span:1},{default:o(()=>[l(v,{onClick:t.closeModal,to:{name:""}},{default:o(()=>s[0]||(s[0]=[e("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[0]})]),_:1}),l(d,{class:"main-title",span:23},{default:o(()=>[e("span",null,i(D.testName),1)]),_:1})]),_:1})]),e("div",ut,[e("div",ct,[e("div",mt,[e("div",null,[e("span",null,i(D.studentName),1)])]),t.attemptData.length>0?(m(),N(T,{key:0,locale:{Table:{cancelSort:"",triggerAsc:"",triggerDesc:""}}},{default:o(()=>[l(b,{columns:t.columns,"data-source":t.attemptData,"row-key":"studentId",pagination:!1},{bodyCell:o(({column:y,record:a})=>[y.key==="timeStart"?(m(),w("div",_t,i(t.dayjs(a.timeStart).format("DD/MM/YYYY HH:mm:ss")),1)):A("v-if",!0),y.key==="timeSubmit"?(m(),w("div",pt,i(t.dayjs(a.timeSubmit).format("DD/MM/YYYY HH:mm:ss")),1)):A("v-if",!0),y.key==="passingScore"?(m(),w("div",gt,i(D.passingScore)+"%",1)):A("v-if",!0),y.key==="status"?(m(),N(I,{key:3,color:t.getTagColor(a.status)},{default:o(()=>[P(i(a.status),1)]),_:2},1032,["color"])):A("v-if",!0),y.key==="action"?(m(),N(g,{key:4,type:"ghost",class:"main-color-btn-ghost",onClick:p=>t.onRedirectToReview(a.attemptId)},{default:o(()=>s[1]||(s[1]=[P(" Review ")])),_:2,__:[1]},1032,["onClick"])):A("v-if",!0)]),_:1},8,["data-source"])]),_:1})):(m(),w("div",ft,[l(C,null,{description:o(()=>[e("span",null,i(k.$t("class_index.other.no_data_matches")),1)]),_:1})]))])])])]),_:1},8,["open"])}const vt=X(it,[["render",yt],["__scopeId","data-v-84e7c737"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/UserTestAttempts.vue"]]),bt=O({__name:"exam-result",emits:["updateSidebar"],setup(k,{expose:s,emit:D}){var H,G;s();const t=B(),f=V(),{t:x}=Q(),v=D,d=S(!1),_=S(t.params.classId||""),I=S({classId:"",name:"",topic:""}),g=S(t.params.testId||""),b=S({name:"",classId:t.params.classId.toString()||"",timeLimit:0,startTime:"",endTime:"",questionCount:0,gradeAttemptMethod:ot.HIGHEST_SCORE,gradeQuestionMethod:nt.PARTIAL,isShowCorrectAnswerInReview:!0,isAllowReviewAfterSubmit:!0,numberOfShuffles:0,maxAttempt:0,passingScore:0,totalScore:0}),T=S([]),C=[{title:"No",key:"no",customRender:n=>n.index+1},{title:x("class_member.column.fullName"),dataIndex:"studentName",key:"studentName",sorter:(n,c)=>n.studentName.localeCompare(c.studentName)},{title:x("class_member.column.email"),dataIndex:"studentEmail",key:"email",sorter:(n,c)=>n.studentEmail.localeCompare(c.studentEmail)},{title:"Final score",dataIndex:"score",key:"score",sorter:(n,c)=>n.score-c.score},{title:"Result",dataIndex:"status",key:"status"}],R=Object.values(z),y=W(()=>R.map(n=>({label:n,value:n!==z.ALL?n:""}))),a=Z({pageNumber:t.query.pageNumber||1,pageSize:t.query.pageSize||10,studentName:((H=t.query.studentName)==null?void 0:H.toString())||"",isPassed:((G=t.query.isPassed)==null?void 0:G.toString())||null,totalCount:0,statusFilter:!1}),p=async()=>{try{if(!F.isValidGuid(_.value.toString())){f.push({name:"404"});return}_.value||f.push({name:"404"});let n=await st.GetById(_.value.toString());n.data.success||f.push({name:"404"}),I.value=n.data.data}catch(n){console.log("ERROR: GETBYID class: "+n)}},M=async()=>{try{if(!F.isValidGuid(g.value.toString())){f.push({name:"404"});return}g.value||f.push({name:"404"});let n=await Y.GetById(g.value.toString(),!1);n.data.success||f.push({name:"404"}),b.value=n.data.data}catch(n){console.log("ERROR: GETBYID test: "+n)}},u=async()=>{try{d.value=!0;let n=await Y.GetAllExamResultByLimit(g.value.toString(),a);if(n.data.success){let c=n.data.data;T.value=n.data.data.items,a.pageNumber=c.pageNumber,a.pageSize=c.pageSize,a.totalCount=c.totalCount,a.statusFilter&&(a.pageNumber>c.totalPages&&a.totalCount>0?(a.pageNumber=1,f.push({name:"User_Class_Exam_Result",params:{classId:_.value,testId:g.value},query:{pageNumber:1,pageSize:a.pageSize,studentName:a.studentName,isPassed:a.isPassed}})):f.push({name:"User_Class_Exam_Result",params:{classId:_.value,testId:g.value},query:{pageNumber:a.pageNumber,pageSize:a.pageSize,studentName:a.studentName,isPassed:a.isPassed}}),a.statusFilter=!a.statusFilter)}}catch(n){console.log("ERROR: GETALLEXAMBYLIMIT class exam result: "+n)}finally{d.value=!1}};$(()=>Object.keys(t.query).length,()=>{var n,c;a.pageNumber=t.query.pageNumber||1,a.pageSize=t.query.pageSize||11,a.studentName=((n=t.query.studentName)==null?void 0:n.toString())||"",a.isPassed=((c=t.query.isPassed)==null?void 0:c.toString())||null,a.statusFilter=!0,u()});const h=(n,c)=>{a.pageNumber=n,a.pageSize=c,a.statusFilter=!0,u()},q=S({studentId:"",studentName:"",studentEmail:"",score:0,status:""}),U=S(null),K=async n=>{var c;q.value=n,await et(),(c=U.value)==null||c.openModal()},J=n=>{switch(n){case z.PASSED:return"#22C55E";case z.FAILED:return"#cd201f"}};tt(async()=>{v("updateSidebar","class"),await p(),await M(),await u()});const L={route:t,router:f,t:x,emit:v,loading:d,classId:_,classData:I,testId:g,testData:b,testResultData:T,columns:C,optionKeys:R,test_status_options:y,pageParams:a,getClassData:p,getTestDetail:M,getData:u,onPaginationChange:h,chosenUser:q,userHistoryModalRef:U,openUserHistoryModal:K,getTagColor:J,Input:lt,get dayjs(){return E},UserTestAttempts:vt};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}}),St={class:"page-container"},wt={class:"title-container"},xt={class:"breadcrumb-container"},It={class:"title-breadcrumb-item"},ht={class:"title-breadcrumb-item"},Dt={class:"breadcrumb-item-topic"},kt={class:"content"},Tt={class:"content-item"},Rt={class:"content-item-title"},At={class:"test-info-container"},Nt={class:"d-flex justify-content-between"},Ct={class:"d-flex justify-content-between"},Et={class:"d-flex justify-content-between"},zt={class:"d-flex justify-content-between"},Mt={class:"content-item-functions"},Pt={style:{width:"300px",padding:"0px"}},jt=["onClick"],qt={key:1,class:"w-110 d-flex justify-content-center"},Yt={class:"pagination-container"};function Ut(k,s,D,t,f,x){var p,M;const v=r("RouterLink"),d=r("a-col"),_=r("a-row"),I=r("a-select-option"),g=r("a-select"),b=r("a-skeleton"),T=r("a-tag"),C=r("a-table"),R=r("a-config-provider"),y=r("a-empty"),a=r("a-pagination");return m(),w(j,null,[e("div",St,[e("div",wt,[e("div",xt,[e("ul",null,[e("li",It,[l(v,{to:{name:"User_Class"}},{default:o(()=>[e("span",null,i(k.$t("class_index.title")),1),s[3]||(s[3]=P()),s[4]||(s[4]=e("br",null,null,-1))]),_:1,__:[3,4]}),s[5]||(s[5]=e("i",{class:"bx bx-chevron-right"},null,-1))]),e("li",ht,[l(v,{to:{name:"User_Class_Exam",params:{id:t.classId}},class:"breadcrumb-item-class"},{default:o(()=>[e("span",null,i(t.classData.name),1),e("span",Dt,i(t.classData.topic),1)]),_:1},8,["to"])])])])]),e("div",kt,[e("div",Tt,[e("div",Rt,[e("div",null,[e("span",null,"Test name: "+i(t.testData.name),1),e("span",null,"Class: "+i(t.classData.name),1)])]),e("div",At,[l(_,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:o(()=>[l(d,{span:11,class:"test-info-item"},{default:o(()=>[e("div",Nt,[s[6]||(s[6]=e("span",null," StartTime:",-1)),e("span",null,i(t.dayjs(t.testData.startTime).format("DD/MM/YYYY HH:mm A")),1)]),e("div",Ct,[s[7]||(s[7]=e("span",null," EndTime:",-1)),e("span",null,i(t.dayjs(t.testData.endTime).format("DD/MM/YYYY HH:mm A")),1)])]),_:1}),l(d,{span:11,class:"test-info-item"},{default:o(()=>[e("div",Et,[s[8]||(s[8]=e("span",null," Time limit: ",-1)),e("span",null,i(t.testData.timeLimit)+" minutes",1)]),e("div",zt,[s[9]||(s[9]=e("span",null," Questions:",-1)),e("span",null,i(t.testData.questionCount)+" questions",1)])]),_:1})]),_:1}),l(_,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:o(()=>[l(d,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[s[10]||(s[10]=e("span",null," Grade attempt method:",-1)),e("span",null,i(t.testData.gradeAttemptMethod),1)]),_:1,__:[10]}),l(d,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[s[11]||(s[11]=e("span",null,"Max attempt:",-1)),e("span",null,i(t.testData.maxAttempt)+" times",1)]),_:1,__:[11]})]),_:1}),l(_,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:o(()=>[l(d,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[s[12]||(s[12]=e("span",null,"Grade question method:",-1)),e("span",null,i(t.testData.gradeQuestionMethod),1)]),_:1,__:[12]}),l(d,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[s[13]||(s[13]=e("span",null," Passing Score: ",-1)),e("span",null,i(t.testData.totalScore*(t.testData.passingScore/100))+" ("+i(t.testData.passingScore)+"%) ",1)]),_:1,__:[13]})]),_:1}),l(_,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:o(()=>[l(d,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[s[14]||(s[14]=e("span",null," Show correct answer in review:",-1)),e("span",null,i(t.testData.isShowCorrectAnswerInReview?"Yes":"No"),1)]),_:1,__:[14]}),l(d,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[s[15]||(s[15]=e("span",null,"Allow student to review after submit:",-1)),e("span",null,i(t.testData.isAllowReviewAfterSubmit?"Yes":"No"),1)]),_:1,__:[15]})]),_:1})]),e("div",Mt,[l(g,{value:t.pageParams.isPassed,"onUpdate:value":s[0]||(s[0]=u=>t.pageParams.isPassed=u),style:{width:"230px","margin-right":"10px"},onChange:t.getData},{default:o(()=>[(m(!0),w(j,null,at(t.test_status_options,u=>(m(),N(I,{value:u.value},{default:o(()=>[P(i(u.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),e("div",Pt,[l(t.Input,{onInput:t.getData,modelValue:t.pageParams.studentName,"onUpdate:modelValue":s[1]||(s[1]=u=>t.pageParams.studentName=u),placeholder:t.t("class_member.other.search_placeholder")},{icon:o(()=>s[16]||(s[16]=[e("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),t.loading?(m(),w(j,{key:0},[l(b,{loading:t.loading},null,8,["loading"]),l(b,{loading:t.loading},null,8,["loading"]),l(b,{loading:t.loading},null,8,["loading"])],64)):(m(),w(j,{key:1},[t.testResultData.length>0?(m(),N(R,{key:0,locale:{Table:{cancelSort:"",triggerAsc:"",triggerDesc:""}}},{default:o(()=>[l(C,{columns:t.columns,"data-source":t.testResultData,"row-key":"studentId",pagination:!1},{bodyCell:o(({column:u,record:h})=>[u.key==="studentName"?(m(),w("div",{key:0,class:"student-name",onClick:q=>t.openUserHistoryModal(h)},i(h.studentName),9,jt)):A("v-if",!0),u.key==="status"?(m(),N(T,{key:1,color:t.getTagColor(h.status)},{default:o(()=>[P(i(h.status),1)]),_:2},1032,["color"])):A("v-if",!0)]),_:1},8,["data-source"])]),_:1})):(m(),w("div",qt,[l(y,null,{description:o(()=>[e("span",null,i(k.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),e("div",Yt,[l(a,{onChange:t.onPaginationChange,current:t.pageParams.pageNumber,"onUpdate:current":s[2]||(s[2]=u=>t.pageParams.pageNumber=u),total:t.pageParams.totalCount,pageSize:t.pageParams.pageSize,"show-total":(u,h)=>`${h[0]}-${h[1]} of ${u} ${t.t("class_member.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:t.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])]),l(t.UserTestAttempts,{ref:"userHistoryModalRef","test-id":t.testId.toString(),"user-id":(p=t.chosenUser)==null?void 0:p.studentId,"test-name":t.testData.name,"passing-score":t.testData.passingScore,"student-name":(M=t.chosenUser)==null?void 0:M.studentEmail},null,8,["test-id","user-id","test-name","passing-score","student-name"])],64)}const Qt=X(bt,[["render",Ut],["__scopeId","data-v-09bf35d5"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/exam-result.vue"]]);export{Qt as default};
