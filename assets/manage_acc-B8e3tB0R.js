import{y as G,d as Ie,q as je,u as xe,g as Oe,z as se,s as qe,i as Ce,j as Ae,M as F,_ as Ne,r as x,c as C,o as w,e as b,b as O,a as k,w as v,t as L,F as W,B as ce,C as V,f as P}from"./index-CW61C-sU.js";import{I as Ue}from"./Input-BFv57ikI.js";import{A as z}from"./ApiAdmin-CXWS8Dec.js";var K,le;function we(){if(le)return K;le=1;function o(t){var i=typeof t;return t!=null&&(i=="object"||i=="function")}return K=o,K}var Q,ue;function Be(){if(ue)return Q;ue=1;var o=typeof G=="object"&&G&&G.Object===Object&&G;return Q=o,Q}var H,de;function ke(){if(de)return H;de=1;var o=Be(),t=typeof self=="object"&&self&&self.Object===Object&&self,i=o||t||Function("return this")();return H=i,H}var X,me;function Pe(){if(me)return X;me=1;var o=ke(),t=function(){return o.Date.now()};return X=t,X}var J,fe;function ze(){if(fe)return J;fe=1;var o=/\s/;function t(i){for(var e=i.length;e--&&o.test(i.charAt(e)););return e}return J=t,J}var Y,ge;function Me(){if(ge)return Y;ge=1;var o=ze(),t=/^\s+/;function i(e){return e&&e.slice(0,o(e)+1).replace(t,"")}return Y=i,Y}var Z,_e;function Re(){if(_e)return Z;_e=1;var o=ke(),t=o.Symbol;return Z=t,Z}var $,be;function Ee(){if(be)return $;be=1;var o=Re(),t=Object.prototype,i=t.hasOwnProperty,e=t.toString,s=o?o.toStringTag:void 0;function p(f){var g=i.call(f,s),m=f[s];try{f[s]=void 0;var a=!0}catch{}var l=e.call(f);return a&&(g?f[s]=m:delete f[s]),l}return $=p,$}var ee,ve;function De(){if(ve)return ee;ve=1;var o=Object.prototype,t=o.toString;function i(e){return t.call(e)}return ee=i,ee}var te,pe;function Ge(){if(pe)return te;pe=1;var o=Re(),t=Ee(),i=De(),e="[object Null]",s="[object Undefined]",p=o?o.toStringTag:void 0;function f(g){return g==null?g===void 0?s:e:p&&p in Object(g)?t(g):i(g)}return te=f,te}var re,ye;function Fe(){if(ye)return re;ye=1;function o(t){return t!=null&&typeof t=="object"}return re=o,re}var ae,he;function Le(){if(he)return ae;he=1;var o=Ge(),t=Fe(),i="[object Symbol]";function e(s){return typeof s=="symbol"||t(s)&&o(s)==i}return ae=e,ae}var ne,Te;function We(){if(Te)return ne;Te=1;var o=Me(),t=we(),i=Le(),e=NaN,s=/^[-+]0x[0-9a-f]+$/i,p=/^0b[01]+$/i,f=/^0o[0-7]+$/i,g=parseInt;function m(a){if(typeof a=="number")return a;if(i(a))return e;if(t(a)){var l=typeof a.valueOf=="function"?a.valueOf():a;a=t(l)?l+"":l}if(typeof a!="string")return a===0?a:+a;a=o(a);var _=p.test(a);return _||f.test(a)?g(a.slice(2),_?2:8):s.test(a)?e:+a}return ne=m,ne}var oe,Se;function Ve(){if(Se)return oe;Se=1;var o=we(),t=Pe(),i=We(),e="Expected a function",s=Math.max,p=Math.min;function f(g,m,a){var l,_,R,S,n,c,T=0,y=!1,q=!1,A=!0;if(typeof g!="function")throw new TypeError(e);m=i(m)||0,o(a)&&(y=!!a.leading,q="maxWait"in a,R=q?s(i(a.maxWait)||0,m):R,A="trailing"in a?!!a.trailing:A);function N(d){var j=l,B=_;return l=_=void 0,T=d,S=g.apply(B,j),S}function h(d){return T=d,n=setTimeout(r,m),y?N(d):S}function M(d){var j=d-c,B=d-T,ie=m-j;return q?p(ie,R-B):ie}function U(d){var j=d-c,B=d-T;return c===void 0||j>=m||j<0||q&&B>=R}function r(){var d=t();if(U(d))return u(d);n=setTimeout(r,M(d))}function u(d){return n=void 0,A&&l?N(d):(l=_=void 0,S)}function E(){n!==void 0&&clearTimeout(n),T=0,l=c=_=n=void 0}function D(){return n===void 0?S:u(t())}function I(){var d=t(),j=U(d);if(l=arguments,_=this,c=d,j){if(n===void 0)return h(c);if(q)return clearTimeout(n),n=setTimeout(r,m),N(c)}return n===void 0&&(n=setTimeout(r,m)),S}return I.cancel=E,I.flush=D,I}return oe=f,oe}Ve();const Ke=Ie({__name:"manage_acc",emits:["updateSidebar"],setup(o,{expose:t,emit:i}){var U;t();const e=i,s=je(),{t:p}=xe(),f=Oe(),g=f.getUserInfo(),m=["all","active","ban"],a=se(()=>m.map(r=>({label:p(`admin.manage_acc.acc_status.${r}`),value:r}))),l=["all","Administrator","Moderator","User"],_=se(()=>l.map(r=>({label:p(`admin.manage_acc.acc_role.${r}`),value:r}))),R=[{title:"ID",dataIndex:"id",customRender:({index:r})=>(Number(y.pageNumber)-1)*Number(y.pageSize)+r+1,width:50,align:"center"},{title:"Fullname",dataIndex:"fullName",key:"fullName",sorter:(r,u)=>r.fullName.localeCompare(u.fullName),width:350,align:"center"},{title:"Email",dataIndex:"email",key:"email",sorter:(r,u)=>r.email.localeCompare(u.email),width:450,align:"center"},{title:"Role",dataIndex:"role",key:"role",sorter:(r,u)=>r.role.localeCompare(u.role),width:100,align:"center"},{title:"",key:"ban",width:120,align:"center"}];qe(()=>{e("updateSidebar","account"),h()});const S=Ce([]);async function n(r){try{r.isBanned?F.confirm({title:"Confirm Ban User",content:"Are you sure you want to ban this user?",centered:!0,onOk:async()=>{await z.BanUser(r.id,{isBanned:!0}),await h()},onCancel:async()=>{await h()}}):F.confirm({title:"Confirm Active User",content:"Are you sure you want to activate this user?",centered:!0,onOk:async()=>{await z.BanUser(r.id,{isBanned:!1}),await h()},onCancel:async()=>{await h()}})}catch(u){console.error("Toggle active ERROR:",u)}}async function c(r){try{F.confirm({title:"Promote User to Moderator",content:"Are you sure you want to promote this user to Moderator?",centered:!0,onOk:async()=>{await z.AssignRole(r.id,{role:"Moderator"}),await h()},onCancel:async()=>{await h()}})}catch(u){console.error("Promote to Moderator:",u)}}async function T(r){try{F.confirm({title:"Demote Moderator to User",content:"Are you sure you want to demote this moderator to User?",centered:!0,onOk:async()=>{await z.AssignRole(r.id,{role:"User"}),await h()},onCancel:async()=>{await h()}})}catch(u){console.error("Toggle active ERROR:",u)}}const y=Ae({pageNumber:s.query.pageNumber||1,pageSize:s.query.pageSize||10,keyword:((U=s.query.keyword)==null?void 0:U.toString())||"",isBanned:s.query.isBanned||a.value[0].value,role:s.query.role||_.value[0].value,fieldName:"Email",totalCount:0,statusFilter:!1}),q=(r,u)=>{y.pageNumber=r,y.pageSize=u,y.statusFilter=!0,h()},A=r=>{if(r==="active")return!1;if(r==="ban")return!0},N=r=>r==="Administrator"?"Administrator":r==="Moderator"?"Moderator":r==="User"?"User":"",h=async()=>{try{const r={...y},u=A(r.isBanned);u!==void 0?r.isBanned=u:delete r.isBanned;const E=N(r.role);E!==void 0?r.role=E:delete r.isBanned;let D=await z.GetAllUser(r);if(D.data.success){let I=D.data.data;S.value=I.items,y.pageNumber=I.pageNumber,y.pageSize=I.pageSize,y.totalCount=I.totalCount}}catch(r){console.log("ERROR: "+r)}},M={emit:e,route:s,t:p,authStore:f,user_info:g,optionKeysAccStatus:m,account_status_credit_options:a,optionKeysAccRole:l,account_role_credit_options:_,columns:R,dataSource:S,onToggle:n,onPromoteToModerator:c,onDemoteToUser:T,pageParams:y,onPaginationChange:q,mapStatusToApi:A,mapRoleToApi:N,getUsersData:h,Input:Ue};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),Qe={class:"page-container"},He={class:"title-container"},Xe={class:"content"},Je={class:"filter-input-item"},Ye={class:"filter-input-full"},Ze={class:"account-table"},$e={key:0,class:"action-cell"},et=["onClick"],tt=["onClick"],rt={class:"pagination-container"};function at(o,t,i,e,s,p){const f=x("a-col"),g=x("a-row"),m=x("a-select-option"),a=x("a-select"),l=x("a-tooltip"),_=x("a-switch"),R=x("a-table"),S=x("a-pagination");return w(),C("div",Qe,[b(" header title "),O("div",He,[k(g,{class:"w-100"},{default:v(()=>[k(f,{class:"main-title",span:20},{default:v(()=>[O("span",null,L(e.t("admin.manage_acc.title")),1)]),_:1})]),_:1})]),O("div",Xe,[b(" filter area "),O("div",Je,[b(" filter text input  "),O("div",Ye,[k(e.Input,{class:"custom-input",value:e.pageParams.keyword,"onUpdate:value":t[0]||(t[0]=n=>e.pageParams.keyword=n),placeholder:e.t("admin.manage_acc.search_placeholder"),onInput:e.getUsersData},{icon:v(()=>t[4]||(t[4]=[O("i",{class:"bx bx-search"},null,-1)])),_:1},8,["value","placeholder"])]),b(" filter account status "),k(a,{style:{width:"calc(19%)"},value:e.pageParams.isBanned,"onUpdate:value":t[1]||(t[1]=n=>e.pageParams.isBanned=n),onChange:e.getUsersData},{default:v(()=>[(w(!0),C(W,null,ce(e.account_status_credit_options,n=>(w(),V(m,{key:n.value,value:n.value},{default:v(()=>[P(L(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),b(" filter account role "),k(a,{style:{width:"calc(19%)"},value:e.pageParams.role,"onUpdate:value":t[2]||(t[2]=n=>e.pageParams.role=n),onChange:e.getUsersData},{default:v(()=>[(w(!0),C(W,null,ce(e.account_role_credit_options,n=>(w(),V(m,{key:n.value,value:n.value},{default:v(()=>[P(L(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),b(" table list account "),O("div",Ze,[k(R,{"data-source":e.dataSource,columns:e.columns,"row-key":"id",pagination:!1},{bodyCell:v(({column:n,record:c})=>[n.key==="ban"?(w(),C("div",$e,[e.user_info.roles.includes("Administrator")?(w(),C(W,{key:0},[b(" icon assign moderator "),k(l,null,{title:v(()=>t[5]||(t[5]=[P(" Demote moderator to User ")])),default:v(()=>[c.role==="Moderator"?(w(),C("i",{key:0,class:"bx bx-id-card",style:{color:"#ff002e","font-size":"25px"},onClick:T=>e.onDemoteToUser(c)},null,8,et)):b("v-if",!0)]),_:2},1024),b(" icon assign user "),k(l,null,{title:v(()=>t[6]||(t[6]=[P(" Promote user to Moderator ")])),default:v(()=>[c.role==="User"?(w(),C("i",{key:0,class:"bx bx-id-card",style:{color:"#5813c1","font-size":"25px"},onClick:T=>e.onPromoteToModerator(c)},null,8,tt)):b("v-if",!0)]),_:2},1024)],64)):b("v-if",!0),b(" button ban.active user "),k(l,null,{title:v(()=>t[7]||(t[7]=[P(" Ban/Active ")])),default:v(()=>[c.role!=="Administrator"?(w(),V(_,{key:0,checked:c.isBanned,"onUpdate:checked":T=>c.isBanned=T,"checked-children":"","un-checked-children":"",onChange:T=>e.onToggle(c)},null,8,["checked","onUpdate:checked","onChange"])):b("v-if",!0)]),_:2},1024)])):b("v-if",!0)]),_:1},8,["data-source"])]),O("div",rt,[k(S,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":t[3]||(t[3]=n=>e.pageParams.pageNumber=n),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(n,c)=>`${c[0]}-${c[1]} of ${n} ${e.t("class_member.other.items")}`,"show-size-changer":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])}const st=Ne(Ke,[["render",at],["__scopeId","data-v-a9d2c947"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/admin/account/manage_acc.vue"]]);export{st as default};
