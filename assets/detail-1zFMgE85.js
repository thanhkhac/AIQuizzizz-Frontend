import{d as K,u as W,q as Z,l as ee,i as _,B as te,s as se,M as ne,k as D,P as ae,_ as oe,r as g,a as o,o as a,b as t,c as r,w as u,f as m,t as i,e as I,F as y,D as S,E as ie}from"./index-BhCEM7Qr.js";import{u as le}from"./user-zaK1_Zi8.js";import{A}from"./ApiQuestionSet-DcHTXIEH.js";import{Q as C}from"./questionTypes-CS3lcRlq.js";import{I as re}from"./Input-pAeduOdR.js";import{T as de}from"./TransferQuestionData-BxcXdBjq.js";import{V as ce}from"./Validator-CWeiTIFe.js";import{S as ue}from"./ShareModal-sacErCxr.js";import{V as _e}from"./visibility-PZlBDoOn.js";import"./ApiTestTemplate-GdvjRZpe.js";import"./ApiFolder-BZCwdVbU.js";const me=K({__name:"detail",setup(v,{expose:s}){s();const{t:f}=W(),e=Z(),p=ee(),z=_(!1),q=_(e.params.id),c=_({id:"",name:"",description:"",totalQuestionCount:0,completedQuestionCount:0,ratingCount:0,ratingAverage:0,createBy:"",createdAt:"",createdById:"",tags:[],lastAccessByMe:"",visibilityMode:""}),b=_([]),T=_([]),M=["All",C.MULTIPLE_CHOICE,C.MATCHING,C.ORDERING,C.SHORT_TEXT],Q=te(()=>M.map(l=>({label:f(`create_QS.type.${l}`),value:l}))),w=_(Q.value[0].value),E=_(""),L=async()=>{try{z.value=!0,ce.isValidGuid(q.value.toString())||p.push({name:"404"});const l=await A.GetDetailById(q.value.toString()),h=await A.GetQuestionById(q.value.toString());(!l.data.success||!h.data.success)&&p.push({name:"User_Library"}),c.value=l.data.data,c.value.createBy=l.data.data.createdBy.fullName,b.value=h.data.data.map(R=>de.transformResponseToRequest(R)),T.value=b.value,await U()}catch{}finally{z.value=!1}},O=(l,h)=>{$(h).toggleClass("bx-chevron-up bx-chevron-down");const V=$(`#question-item-answer-${l}`);V&&$(V).slideToggle()},n=_(null),x=()=>{var l;(l=n.value)==null||l.openModal()},d=_(null),k=()=>{var l;(l=d.value)==null||l.openModal()},Y=()=>{p.push({name:"User_QuestionSet_Learn",params:{id:c.value.id}})},P=()=>{p.push({name:"User_QuestionSet_Test",params:{id:c.value.id}})},H=()=>{p.push({name:"User_QuestionSet_Update",params:{id:c.value.id}})},G=_(!1),F=_(0),B=_({canEdit:!1,canDelete:!1}),U=async()=>{const l=await A.GetPermissions(c.value.id);l.data.success&&(B.value=l.data.data)},j=()=>{ne.confirm({title:f("detail_QS.modal.delete_title"),content:f("detail_QS.modal.delete_content"),okText:f("sidebar.buttons.ok"),cancelText:f("sidebar.buttons.cancel"),onOk:async()=>{if(!(await A.Delete(c.value.id)).data.success){D.error(f("message.deleted_failed"));return}D.success(f("message.deleted_successfully")),p.push("User_Library")}})},X=l=>{const h=[l];sessionStorage.setItem("selected_tags",JSON.stringify(h)),p.push({name:"User_QuestionSet_Search"})},J=()=>{let l=b.value;l=b.value.filter(h=>{const R=h.questionText.includes(E.value),V=w.value==="All"||w.value===h.type;return R&&V}),T.value=l};se(async()=>{await L()});const N={t:f,route:e,router:p,loading:z,question_set_id:q,quiz:c,quiz_questions:b,questions:T,optionKeys:M,question_type_options:Q,selected_type_option:w,searchValue:E,getData:L,toggleDisplayAnswer:O,shareModalRef:n,onOpenShareModal:x,shareClassModalRef:d,onOpenShareClassModal:k,onRedirectToLearn:Y,onRedirectToTest:P,onRedirectToEdit:H,modal_rate_open:G,rateValue:F,permission:B,getPermission:U,onDelete:j,onRedirectToSearch:X,onFilter:J,get user_image(){return le},get QUESTION_TYPE(){return C},Input:re,get dayjs(){return ae},ShareModal:ue,get VISIBILITY(){return _e}};return Object.defineProperty(N,"__isScriptSetup",{enumerable:!1,value:!0}),N}}),ve={class:"content"},ge={class:"content-item"},fe={key:0},pe={key:1},he={class:"content-item-title"},ye={key:0,class:"d-flex flex-row align-items-center quiz-header-functions"},be={class:"quiz-info"},Ie={class:"quiz-tag-container"},Te=["onClick"],Se={class:"quiz-credit"},qe={class:"share-btn-container"},we={class:"share-btn-container"},xe={class:"action-container"},ke={class:"credit-user"},Ce=["src"],ze={class:"credit-user-info"},Me={class:"d-flex"},Qe={class:"content-item"},Ee={class:"content-item-title"},Le={class:"content-item-functions"},Re={style:{width:"300px",padding:"0"}},Ve={key:0},Ae={key:1,class:"preview-question-container"},Oe={class:"preview-question-item"},Be={class:"question-item-content"},Ue={class:"d-flex pb-2"},Ne={class:"question-index"},De=["innerHTML"],Ye={key:1,class:"question-text"},Pe=["id"],He={key:0,class:"multiple-choice-answer"},Ge={key:0,class:"text-success"},Fe={class:"pair-answer"},je={class:"pair-answer-item"},Xe={class:"pair-answer-item"},Je={key:2,class:"ordering-answer"},Ke={class:"ordering-answer-item"},We={class:"ordering-answer-item"},Ze={class:"ordering-answer-item"},$e={class:"short-text-answer"},et={class:"question-item-toogle-btn"},tt=["onClick"],st={class:"title-container"},nt={class:"modal-rate-container"};function at(v,s,f,e,p,z){const q=g("RouterLink"),c=g("a-skeleton"),b=g("a-tooltip"),T=g("a-button"),M=g("a-select-option"),Q=g("a-select"),w=g("a-col"),E=g("a-row"),L=g("a-rate"),O=g("a-modal");return a(),o(y,null,[t("div",ve,[r(q,{class:"navigator-back-link d-flex align-items-center p-2",to:{name:"User_Library"}},{default:u(()=>[s[5]||(s[5]=t("i",{class:"me-1 bx bx-chevron-left"},null,-1)),m(" "+i(v.$t("detail_QS.other.library")),1)]),_:1,__:[5]}),t("div",ge,[e.loading?(a(),o("div",fe,[r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"])])):(a(),o("div",pe,[t("div",he,[t("div",null,[t("span",null,i(e.quiz.name),1),t("span",null,i(e.quiz.description),1)]),e.permission.canEdit||e.permission.canDelete?(a(),o("div",ye,[r(b,null,{title:u(()=>[m(i(v.$t("question_sets_index.buttons.edit")),1)]),default:u(()=>[e.permission.canEdit?(a(),o("i",{key:0,class:"me-3 bx bx-edit",onClick:e.onRedirectToEdit})):I("v-if",!0)]),_:1}),r(b,null,{title:u(()=>[m(i(v.$t("question_sets_index.buttons.delete")),1)]),default:u(()=>[e.permission.canDelete?(a(),o("i",{key:0,class:"text-danger bx bx-trash-alt",onClick:e.onDelete})):I("v-if",!0)]),_:1})])):I("v-if",!0)]),t("div",be,[t("div",{class:"quiz-rating",onClick:s[0]||(s[0]=n=>e.modal_rate_open=!0)},i(e.quiz.ratingAverage)+" ⭐️ ("+i(e.quiz.ratingCount)+" "+i(v.$t("detail_QS.other.reviews"))+") ",1),t("div",Ie,[(a(!0),o(y,null,S(e.quiz.tags,n=>(a(),o("div",{class:"quiz-tag-item",onClick:x=>e.onRedirectToSearch(n)},i(n.name),9,Te))),256))])]),t("div",Se,[t("div",qe,[r(T,{type:"primary",class:"me-3 main-color-btn share-btn",size:"large",onClick:e.onOpenShareClassModal},{default:u(()=>[s[6]||(s[6]=t("i",{class:"bx bx-share-alt"},null,-1)),m(" "+i(v.$t("detail_QS.buttons.share_class")),1)]),_:1,__:[6]})]),t("div",we,[r(T,{type:"primary",class:"main-color-btn share-btn",size:"large",onClick:e.onOpenShareModal},{default:u(()=>[s[7]||(s[7]=t("i",{class:"bx bx-share-alt"},null,-1)),m(" "+i(v.$t("detail_QS.buttons.share_quiz")),1)]),_:1,__:[7]})])]),t("div",xe,[t("div",ke,[t("img",{class:"user-image",src:e.user_image,alt:""},null,8,Ce),t("div",ze,[t("span",null,i(v.$t("detail_QS.other.created_by",{username:e.quiz.createBy})),1),t("span",null,i(e.dayjs(e.quiz.createdAt).format("DD/MM/YYYY")),1)])]),t("div",Me,[t("div",{class:"action-item",onClick:e.onRedirectToLearn},[m(i(v.$t("detail_QS.buttons.learn"))+" ",1),s[8]||(s[8]=t("i",{class:"bx bx-analyse"},null,-1))]),t("div",{class:"action-item",onClick:e.onRedirectToTest},[m(i(v.$t("detail_QS.buttons.test"))+" ",1),s[9]||(s[9]=t("i",{class:"bx bx-detail"},null,-1))])])])]))]),t("div",Qe,[t("div",Ee,[t("div",null,[t("span",null,i(v.$t("detail_QS.other.questions",{number:e.quiz_questions.length})),1)])]),t("div",Le,[r(Q,{class:"me-3",value:e.selected_type_option,"onUpdate:value":s[1]||(s[1]=n=>e.selected_type_option=n),style:{width:"200px"},onChange:e.onFilter},{default:u(()=>[(a(!0),o(y,null,S(e.question_type_options,n=>(a(),ie(M,{value:n.value},{default:u(()=>[m(i(n.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",Re,[r(e.Input,{onInput:e.onFilter,modelValue:e.searchValue,"onUpdate:modelValue":s[2]||(s[2]=n=>e.searchValue=n),placeholder:e.t("question_sets_index.search_placeholder")},{icon:u(()=>s[10]||(s[10]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(a(),o("div",Ve,[r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"])])):(a(),o("div",Ae,[(a(!0),o(y,null,S(e.questions,(n,x)=>(a(),o("div",Oe,[t("div",Be,[t("div",Ue,[t("div",Ne,i(x+1),1),n.questionHTML?(a(),o("div",{key:0,class:"question-html",innerHTML:n.questionHTML},null,8,De)):(a(),o("div",Ye,i(n.questionText),1))]),t("div",{class:"question-item-answer",id:`question-item-answer-${x}`,style:{display:"none"}},[n.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(a(),o("div",He,[t("ul",null,[(a(!0),o(y,null,S(n.multipleChoices,d=>(a(),o("li",null,[m(i(d.text)+" ",1),d.isAnswer?(a(),o("span",Ge," ("+i(d.isAnswer)+") ",1)):I("v-if",!0)]))),256))])])):I("v-if",!0),n.type===e.QUESTION_TYPE.MATCHING?(a(!0),o(y,{key:1},S(n.matchingPairs,d=>(a(),o("div",Fe,[t("span",je,i(d.leftItem),1),s[11]||(s[11]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("span",Xe,i(d.rightItem),1)]))),256)):I("v-if",!0),n.type===e.QUESTION_TYPE.ORDERING?(a(),o("div",Je,[t("div",Ke,[(a(!0),o(y,null,S(n.orderingItems,d=>(a(),o("div",null,i(d.text),1))),256))]),s[12]||(s[12]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("div",We,[(a(!0),o(y,null,S(n.orderingItems.sort((d,k)=>d.correctOrder-k.correctOrder),(d,k)=>(a(),o("div",Ze,[t("span",null,"#"+i(k+1),1),m(" - "+i(d.text),1)]))),256))])])):I("v-if",!0),n.type===e.QUESTION_TYPE.SHORT_TEXT?(a(),o(y,{key:3},[s[13]||(s[13]=t("span",null,"Answer:",-1)),t("div",$e,i(n.shortAnswer),1)],64)):I("v-if",!0)],8,Pe)]),t("div",et,[t("i",{class:"bx bx-chevron-down",onClick:d=>e.toggleDisplayAnswer(x,d.currentTarget)},null,8,tt)])]))),256))]))])]),r(e.ShareModal,{ref:"shareModalRef",id:e.quiz.id,name:e.quiz.name,mode:"quiz",options:[e.VISIBILITY.PUBLIC,e.VISIBILITY.PRIVATE],visibility:e.quiz.visibilityMode},null,8,["id","name","options","visibility"]),r(e.ShareModal,{ref:"shareClassModalRef",id:e.quiz.id,name:e.quiz.name,mode:"quiz",options:[e.VISIBILITY.IN_CLASS],visibility:e.VISIBILITY.IN_CLASS},null,8,["id","name","options","visibility"]),r(O,{"wrap-class-name":"medium-modal",open:e.modal_rate_open},{footer:u(()=>[r(T,{type:"primary",class:"main-color-btn"},{default:u(()=>s[16]||(s[16]=[m("Send")])),_:1,__:[16]})]),default:u(()=>[t("div",st,[r(E,{class:"w-100 d-flex align-items-center justify-content-between"},{default:u(()=>[r(w,{span:1},{default:u(()=>[t("div",{onClick:s[3]||(s[3]=n=>e.modal_rate_open=!1)},s[14]||(s[14]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)]))]),_:1}),r(w,{class:"main-title",span:20},{default:u(()=>s[15]||(s[15]=[t("span",null,"Rate the question set",-1),m(),t("br",null,null,-1)])),_:1,__:[15]})]),_:1})]),t("div",nt,[r(L,{value:e.rateValue,"onUpdate:value":s[4]||(s[4]=n=>e.rateValue=n),style:{"font-size":"40px"}},null,8,["value"])])]),_:1},8,["open"])],64)}const ft=oe(me,[["render",at],["__scopeId","data-v-307050af"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/question_sets/detail.vue"]]);export{ft as default};
