var Ae=Object.defineProperty;var xe=(a,t,g)=>t in a?Ae(a,t,{enumerable:!0,configurable:!0,writable:!0,value:g}):a[t]=g;var se=(a,t,g)=>xe(a,typeof t!="symbol"?t+"":t,g);import{a as s,I as De,d as ve,u as he,i as y,j as fe,z as we,E as be,s as Te,k as F,M as Z,_ as ye,r as b,C as oe,o as i,w as r,b as n,f,t as o,ao as de,p as B,c as _,F as O,B as z,e as q,H as ce,v as Ie,L as Ee,D as ge,ap as Me,aq as Ce,S as Oe}from"./index-DYogllWd.js";import{A as qe}from"./ApiTestTemplate-CaG46kYt.js";import{A as Le}from"./ApiQuestionSet-CIMPze6n.js";import{Q as pe}from"./questionTypes-CS3lcRlq.js";import{S as ie}from"./languages-DtYW231W.js";import{T as Ge}from"./vue-draggable-plus-BTPt8NmM.js";var Qe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function Se(a){for(var t=1;t<arguments.length;t++){var g=arguments[t]!=null?Object(arguments[t]):{},e=Object.keys(g);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(g).filter(function(L){return Object.getOwnPropertyDescriptor(g,L).enumerable}))),e.forEach(function(L){Ue(a,L,g[L])})}return a}function Ue(a,t,g){return t in a?Object.defineProperty(a,t,{value:g,enumerable:!0,configurable:!0,writable:!0}):a[t]=g,a}var ue=function(t,g){var e=Se({},t,g.attrs);return s(De,Se({},e,{icon:Qe}),null)};ue.displayName="InboxOutlined";ue.inheritAttrs=!1;const _e={ALL:"all",VALID:"valid",IN_VALID:"invalid"},Fe=ve({__name:"ImportQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(a,{expose:t,emit:g}){const{t:e}=he(),L=a,V=g,G=y(!1),v=y([]),I=y([]),w=y([]),k=y(""),E=async()=>{if(!k.value)try{const c=await Le.DownloadFileImport();c.data.success&&(k.value=c.data.data)}catch(c){console.log(c)}},T=fe({checkAll:!1,indeterminate:!1,checkedList:[]}),M=async()=>{await E(),T.checkedList=[],G.value=!0},S=()=>{G.value=!1};t({openImportModal:M});const l=y([]),Q=y(null),U=y(!1),A=()=>{var c;(c=Q.value)==null||c.click()},u=async c=>{if(c){if(c.type!=="application/vnd.ms-excel"&&c.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"){F.error(e("message.file_support_only",{fileTypes:"XLS, XLSX"}));return}l.value=[],F.success(e("message.uploaded_successfully",{name:c.name})),l.value.push(c);const m=await qe.ImportFile(l.value[0]);m.data.success&&(v.value=[...m.data.data.validQuestions,...m.data.data.invalidQuestions],I.value=[...m.data.data.validQuestions,...m.data.data.invalidQuestions],w.value=m.data.data.invalidQuestions,T.checkedList=[]);return}F.error(e("message.uploaded_failed"))},R=async c=>{var j;const m=c.target,h=(j=m.files)==null?void 0:j[0];h&&(u(h),m.value="")},x=c=>{var h;const m=((h=c.dataTransfer)==null?void 0:h.types)||[];Array.from(m).includes("files")&&(U.value=!0)},Y=c=>{var h;const m=(h=c.dataTransfer)==null?void 0:h.files[0];U.value=!1,m&&u(m)},J=c=>{var m;(m=l.value)==null||m.splice(c,1),T.checkedList=[],v.value=[],w.value=[],I.value=[]},ee=Object.values(_e),X=we(()=>ee.map(c=>({label:e(`import_qs_modal.uploaded_question_status.${c}`),value:c}))),K=y(X.value[0].value),te=()=>{var m,h;T.checkedList=[];let c=v.value;switch(K.value){case _e.VALID:{c=(m=v.value)==null?void 0:m.filter(j=>{var W;return!((W=w.value)!=null&&W.includes(j))});break}case _e.IN_VALID:{c=(h=v.value)==null?void 0:h.filter(j=>{var W;return(W=w.value)==null?void 0:W.includes(j)});break}}I.value=c||[]},ne=c=>{Object.assign(T,{checkedList:c.target.checked?I.value:[],indeterminate:!1})};be(()=>T.checkedList,c=>{var m;T.indeterminate=!!c.length&&c.length<I.value.length,T.checkAll=c.length===((m=I.value)==null?void 0:m.length)});const ae=(c,m)=>{$(m).toggleClass("bx-chevron-up bx-chevron-down");const j=$(`#question-item-answer-${c}`);j&&$(j).slideToggle()},C=()=>{if(T.checkedList.length===0){F.warning(e("message.minimum_question",{number:1}));return}if(T.checkedList.length+L.numberOfQuestion>500){F.warning(e("message.limit_question",{number:500}));return}Z.confirm({title:e("import_qs_modal.confirm_modal.title"),content:e("import_qs_modal.confirm_modal.content",{number:T.checkedList.length}),okText:e("create_QS.buttons.ok"),cancelText:e("create_QS.buttons.cancel"),onOk:()=>{var m;const c=(m=I.value)==null?void 0:m.filter(h=>T.checkedList.includes(h));V("import",c),S()}})},P=async()=>{window.open(k.value,"_blank")};Te(()=>{});const p={t:e,props:L,emit:V,modal_import_open:G,question_data:v,uploadedQuestions:I,uploadedInvalidQuestions:w,download_link:k,getLink:E,importModalState:T,openImportModal:M,closeImportModal:S,files:l,fileInput:Q,isDragging:U,openFileExplorer:A,onFileChange:u,handleFileChange:R,handleDragEnter:x,handleDrop:Y,onRemoveUploadedFile:J,optionKeys:ee,select_options:X,selected_option:K,onFilter:te,onCheckAll:ne,toggleDisplayAnswer:ae,handleModalImport:C,onDownloadTemplate:P,get InboxOutlined(){return ue},get QUESTION_TYPE(){return pe}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),Pe={class:"modal-container"},Ne={class:"modal-title-container"},ze={class:"modal-content-item"},Re={class:"content-item-section upload-section"},Be={class:"section-title"},Je={class:"section-content"},je={class:"customized-file-upload-icons"},He={class:"customized-file-upload-ins"},Ve={class:"customized-file-upload-hint"},Ye={class:"file-container"},$e={class:"file-item"},Xe=["onClick"],Ke={class:"content-item-section preview-section"},We={class:"section-title"},Ze={class:"section-content"},et={key:0,class:"section-content-header"},tt={class:"d-flex"},nt={class:"preview-question-container"},at={class:"question-item-content"},ot=["innerHTML"],lt={key:1,class:"question-text"},st=["id"],rt={key:0,class:"multiple-choice-answer"},it={key:0,class:"result-correct"},ct={class:"pair-answer"},dt={class:"pair-answer-item"},ut={class:"pair-answer-item"},_t={key:2,class:"ordering-answer"},mt={class:"ordering-answer-item"},ft={class:"ordering-answer-item"},gt={class:"ordering-answer-item"},pt={key:3,class:"short-text-answer"},vt={class:"question-item-toogle-btn"},ht=["onClick"],bt={class:"mt-4 d-flex align-items-center"},yt={class:"header-item"};function kt(a,t,g,e,L,V){const G=b("RouterLink"),v=b("a-col"),I=b("a-row"),w=b("a-button"),k=b("a-checkbox"),E=b("a-select-option"),T=b("a-select"),M=b("a-checkbox-group"),S=b("a-modal");return i(),oe(S,{centered:"",width:"100%","wrap-class-name":"full-modal",open:e.modal_import_open,onCancel:e.closeImportModal},{footer:r(()=>[n("div",bt,[n("div",yt,o(a.$t("import_qs_modal.other.total_question",{number:e.importModalState.checkedList.length})),1),s(w,{class:"main-color-btn",size:"large",key:"submit",type:"primary",onClick:e.handleModalImport},{default:r(()=>[f(o(a.$t("import_qs_modal.buttons.import")),1)]),_:1})])]),default:r(()=>[n("div",Pe,[n("div",Ne,[s(I,{class:"w-100 d-flex align-items-center"},{default:r(()=>[s(v,{span:1},{default:r(()=>[s(G,{onClick:e.closeImportModal,to:{name:""}},{default:r(()=>t[5]||(t[5]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[5]})]),_:1}),s(v,{class:"main-title",span:23},{default:r(()=>[n("span",null,o(a.$t("import_qs_modal.title")),1),t[6]||(t[6]=f()),t[7]||(t[7]=n("br",null,null,-1)),n("span",null,o(a.$t("import_qs_modal.sub_title")),1)]),_:1,__:[6,7]})]),_:1})]),n("div",ze,[n("div",Re,[n("div",Be,[n("span",null,o(a.$t("import_qs_modal.upload_section")),1),s(w,{class:"main-color-btn",type:"primary",onClick:e.onDownloadTemplate},{default:r(()=>[f(o(a.$t("import_qs_modal.buttons.download")),1)]),_:1})]),n("div",Je,[n("input",{onChange:e.handleFileChange,class:"d-none",type:"file",ref:"fileInput",accept:".xls,.xlsx"},null,544),n("div",{class:B(["customized-file-upload",e.isDragging?"is-dragging":""]),onClick:e.openFileExplorer,onDragenter:e.handleDragEnter,onDragover:t[0]||(t[0]=de(l=>e.isDragging=!0,["prevent"])),onDragleave:t[1]||(t[1]=l=>e.isDragging=!1),onDrop:de(e.handleDrop,["prevent"])},[n("div",je,[n("i",{class:B(["bx","bx-down-arrow-alt","bx-fade-up",e.isDragging?"":"d-none"])},null,2),s(e.InboxOutlined,{class:B([e.isDragging?"d-none":""])},null,8,["class"])]),n("div",He,o(a.$t("import_qs_modal.upload_area.title")),1),n("div",Ve,[f(o(a.$t("import_qs_modal.upload_area.content"))+" ",1),t[8]||(t[8]=n("br",null,null,-1)),f(" "+o(a.$t("import_qs_modal.upload_area.sub_content")),1)])],34)]),n("div",Ye,[(i(!0),_(O,null,z(e.files,(l,Q)=>(i(),_("div",$e,[n("span",null,o(l.name),1),n("i",{class:"bx bx-trash text-danger",onClick:U=>e.onRemoveUploadedFile(Q)},null,8,Xe)]))),256))])]),n("div",Ke,[n("div",We,o(a.$t("import_qs_modal.preview_section")),1),n("div",Ze,[e.question_data.length>0?(i(),_("div",et,[s(k,{class:B(["header-item",e.importModalState.checkAll?"check-all":""]),onClick:e.onCheckAll,checked:e.importModalState.checkAll,"onUpdate:checked":t[2]||(t[2]=l=>e.importModalState.checkAll=l),indeterminate:e.importModalState.indeterminate},{default:r(()=>[f(o(a.$t("share_modal.buttons.check_all",{number:e.importModalState.checkedList.length})),1)]),_:1},8,["class","checked","indeterminate"]),n("div",tt,[s(T,{size:"large",class:"me-3",value:e.selected_option,"onUpdate:value":t[3]||(t[3]=l=>e.selected_option=l),style:{width:"200px"},onChange:e.onFilter},{default:r(()=>[(i(!0),_(O,null,z(e.select_options,l=>(i(),oe(E,{value:l.value},{default:r(()=>[f(o(l.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])])):q("v-if",!0),s(M,{value:e.importModalState.checkedList,"onUpdate:value":t[4]||(t[4]=l=>e.importModalState.checkedList=l)},{default:r(()=>[n("div",nt,[(i(!0),_(O,null,z(e.uploadedQuestions,(l,Q)=>{var U;return i(),_("div",{class:B(["preview-question-item",(U=e.uploadedInvalidQuestions)!=null&&U.includes(l)?"invalid":""])},[s(k,{value:l},null,8,["value"]),n("div",at,[l.questionHTML?(i(),_("div",{key:0,class:"question-html",innerHTML:l.questionHTML},null,8,ot)):(i(),_("div",lt,o(l.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${Q}`},[l.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(i(),_("div",rt,[n("ul",null,[(i(!0),_(O,null,z(l.multipleChoices,A=>(i(),_("li",null,[f(o(A.text)+" ",1),A.isAnswer?(i(),_("span",it," ("+o(A.isAnswer)+") ",1)):q("v-if",!0)]))),256))])])):q("v-if",!0),l.type===e.QUESTION_TYPE.MATCHING?(i(!0),_(O,{key:1},z(l.matchingPairs,A=>(i(),_("div",ct,[n("span",dt,o(A.leftItem),1),t[9]||(t[9]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",ut,o(A.rightItem),1)]))),256)):q("v-if",!0),l.type===e.QUESTION_TYPE.ORDERING?(i(),_("div",_t,[n("div",mt,[(i(!0),_(O,null,z(l.orderingItems,A=>(i(),_("div",null,o(A.text),1))),256))]),t[10]||(t[10]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",ft,[(i(!0),_(O,null,z(l.orderingItems,(A,u)=>(i(),_("div",gt,[n("span",null,"#"+o(u+1),1),f(" - "+o(A.text),1)]))),256))])])):q("v-if",!0),l.type===e.QUESTION_TYPE.SHORT_TEXT?(i(),_("div",pt,o(l.shortAnswer),1)):q("v-if",!0)],8,st)]),n("div",vt,[n("i",{class:"bx bx-chevron-up",onClick:A=>e.toggleDisplayAnswer(Q,A.currentTarget)},null,8,ht)])],2)}),256))])]),_:1},8,["value"])])])])])]),_:1},8,["open"])}const jn=ye(Fe,[["render",kt],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/ImportQSModal.vue"]]),St={HARD:"Hard",MEDIUM:"Medium",EASY:"Easy"},me={GENERATE_QUESTION:"AiGenerate/GenerateQuestion",GENERATE_DOCUMENT_STRUCTURE:"AiGenerate/GenerateDocumentStructure",GET_COST_TO_GENERATE:"AiGenerate/DocumentStructure/GetCostToGenerate"};class wt{constructor(){se(this,"GenerateQuestion",async t=>await ce.post(me.GENERATE_QUESTION,t,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0}));se(this,"GenerateDocumentStructure",async t=>{const g=new FormData;return g.append("file",t),await ce.post(me.GENERATE_DOCUMENT_STRUCTURE,g,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})});se(this,"GetCostToGenerate",async t=>{const g=new FormData;return g.append("file",t),await ce.post(me.GET_COST_TO_GENERATE,g,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})})}}const re=new wt,Tt={GET_PDF_STRUCTURE:"PdfService/GetPdfStructure"};class It{constructor(){se(this,"GetPdfStructure",async t=>{const g=new FormData;return g.append("file",t),await ce.post(Tt.GET_PDF_STRUCTURE,g,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})})}}const Et=new It,Ct=ve({__name:"GenerateFileStructure",props:{file:{type:null,required:!0}},emits:["import"],setup(a,{expose:t,emit:g}){const{t:e}=he(),L=a,V=Ie(Ee,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),G=y(),v=y([]);function I(C){return C?Array.isArray(C)?C:[C]:[]}function w(C){return I(C).map(p=>{const c=I(p==null?void 0:p.children);return{...p,title:String((p==null?void 0:p.title)??""),key:crypto.randomUUID(),children:c.length?w(c):void 0}})}const k=y([]),E=y([]);function T(C,P){const p=[];for(const c of C){const m=P.includes(c.key),h=c.children?T(c.children,P):[];(m||h.length>0)&&p.push({title:c.title,key:c.key,children:h.length?h:void 0})}return p}const M=we(()=>T(k.value,E.value));be(k,async()=>{k.value.length>0&&(await ge(),G.value&&(G.value.scrollTop=0))});const S=y(null),l=y(!1),Q=y(!1),U=async()=>{try{Q.value=!0;const C=await re.GetCostToGenerate(L.file);if(!C.data.success)return Z.error({title:"Error",content:C.data.message||e("message.failed_to_get_cost")}),null;const P=C.data.data;if(!P){F.error(e("message.failed_to_get_cost"));return}S.value=P,J.value=!0}catch(C){return console.error(C),null}finally{Q.value=!1}},A=async(C,P)=>{try{Q.value=!0;const p=await C(L.file);if(!p.data.success){Z.error({title:"Error",content:p.data.message||e("message.failed_to_generate_file_structure")});return}const c=typeof p.data=="string"?JSON.parse(p.data):p.data,m=c==null?void 0:c.data,h=I(m==null?void 0:m.children);v.value=h,k.value=w(v.value),C===re.GenerateDocumentStructure&&F.success(e("message.generated_structure_successfully"))}catch(p){console.error(p)}finally{Q.value=!1,P&&(J.value=!1)}},u=()=>{A(re.GenerateDocumentStructure,!0)},R=()=>{A(Et.GetPdfStructure,!1)},x=async()=>{l.value=!0,!(v.value.length>0||S.value)&&R()},Y=()=>{l.value=!1,K()},J=y(!1),ee=async()=>{S.value&&u()},X=g,K=()=>{var m,h;if(k.value.length===0)return;const C=(m=k.value)==null?void 0:m[0],P=JSON.stringify({title:C.title,children:C.children}),p=(h=M.value)==null?void 0:h[0],c=JSON.stringify({title:p==null?void 0:p.title,children:p==null?void 0:p.children});X("import",P,c)},te=()=>{if(M.value.length===0){Z.error({title:e("generate_qs_modal.invalid_structure_modal.title"),content:e("generate_qs_modal.invalid_structure_modal.content"),centered:!0});return}K(),Y()},ne=()=>{v.value=[],k.value=[],S.value=null};t({openModal:x,closeModal:Y,clearData:ne});const ae={t:e,props:L,indicator:V,modalContentRef:G,serverData:v,toArray:I,addRandomKeys:w,treeData:k,checked:E,filterTree:T,selectedTree:M,cost:S,modal_open:l,loading:Q,getCostToGenerate:U,fetchTreeData:A,generateTreeData:u,getTreeData:R,openModal:x,closeModal:Y,modal_confirm_generate_structure_open:J,onConfirmGenerateFileStructure:ee,emit:X,onEmitImport:K,onConfirmImportStructure:te,clearData:ne,get ExclamationCircleFilled(){return Ce},get ATree(){return Me}};return Object.defineProperty(ae,"__isScriptSetup",{enumerable:!1,value:!0}),ae}}),At={class:"modal-container"},xt={class:"modal-title-container"},Dt={class:"modal-content-item",ref:"modalContentRef"},Mt={key:0,class:"loading-container"},Ot={key:0},qt={key:1,class:"content-wrapper"},Lt={key:0,class:"tree-container"},Gt={class:"mb-2 d-flex justify-content-end align-items-center"},Qt={class:"me-3"},Ut={class:"button-container"},Ft={class:"button-container"},Pt={class:"fs-6 mb-3"},Nt={class:"d-flex align-items-center justify-content-between"},zt={class:"confirm-modal-container"},Rt={class:"d-flex align-items-center"},Bt={class:"fs-6 fw-bold"},Jt={class:"fs-6 ms-5 mt-3"},jt={class:"fw-bold text-danger"};function Ht(a,t,g,e,L,V){const G=b("a-col"),v=b("a-row"),I=b("a-spin"),w=b("a-button"),k=b("a-modal");return i(),_(O,null,[s(k,{closable:!0,centered:"",width:"100%","wrap-class-name":"medium-modal large",open:e.modal_open,onCancel:e.closeModal},{footer:r(()=>[s(w,{class:"main-color-btn",type:"primary",onClick:e.onConfirmImportStructure},{default:r(()=>[f(o(a.$t("generate_file_structure.buttons.confirm")),1)]),_:1})]),default:r(()=>[n("div",At,[n("div",xt,[s(v,{class:"w-100 d-flex align-items-center"},{default:r(()=>[q(` <a-col :span="2">
                        <RouterLink @click="closeModal" :to="{ name: '' }">
                            <i class="bx bx-chevron-left navigator-back-button"></i>
                        </RouterLink>
                    </a-col> `),s(G,{class:"ms-3 main-title",span:22},{default:r(()=>[n("span",null,o(a.$t("generate_file_structure.title")),1),t[4]||(t[4]=f()),t[5]||(t[5]=n("br",null,null,-1)),n("span",null,o(a.$t("generate_file_structure.sub_title")),1)]),_:1,__:[4,5]})]),_:1})]),n("div",Dt,[e.loading?(i(),_("div",Mt,[s(I,{size:"large",indicator:e.indicator},null,8,["indicator"]),e.cost?q("v-if",!0):(i(),_("div",Ot,o(a.$t("generate_file_structure.other.analyzing")),1))])):(i(),_("div",qt,[e.treeData.length>0?(i(),_("div",Lt,[n("div",Gt,[n("div",Qt,o(a.$t("generate_file_structure.other.generate_structure_ins")),1),e.cost?(i(),oe(w,{key:0,type:"primary",class:"main-color-btn",onClick:t[0]||(t[0]=E=>e.modal_confirm_generate_structure_open=!0)},{default:r(()=>[f(o(a.$t("generate_file_structure.buttons.generate_structure")),1)]),_:1})):(i(),oe(w,{key:1,type:"primary",class:"main-color-btn",onClick:e.getCostToGenerate},{default:r(()=>[f(o(a.$t("generate_file_structure.buttons.generate_structure")),1)]),_:1}))]),s(e.ATree,{checkedKeys:e.checked,"onUpdate:checkedKeys":t[1]||(t[1]=E=>e.checked=E),"tree-data":e.treeData,checkable:"","show-icon":!1,"show-line":!0,"field-names":{title:"title",key:"key",children:"children"},defaultExpandAll:!0,style:{width:"100%"}},null,8,["checkedKeys","tree-data"])])):e.cost?(i(),_(O,{key:1},[q(" get cost success but cancel "),n("div",Ut,[s(w,{size:"large",type:"primary",class:"main-color-btn",onClick:t[2]||(t[2]=E=>e.modal_confirm_generate_structure_open=!0)},{default:r(()=>[f(o(a.$t("generate_file_structure.buttons.generate_structure")),1)]),_:1})])],2112)):(i(),_(O,{key:2},[q(" get structure but failed "),n("div",Ft,[n("div",Pt,o(a.$t("generate_file_structure.other.invalid_structure")),1),n("div",Nt,[s(w,{loading:e.loading,class:"me-3 main-color-btn-ghost",type:"primary",onClick:e.getTreeData},{default:r(()=>[f(o(a.$t("generate_file_structure.buttons.re_load")),1)]),_:1},8,["loading"]),s(w,{size:"large",type:"primary",class:"main-color-btn",onClick:e.getCostToGenerate},{default:r(()=>[f(o(a.$t("generate_file_structure.buttons.generate_structure")),1)]),_:1})])])],2112))]))],512)])]),_:1},8,["open"]),s(k,{"wrap-class-name":"medium-modal",centered:"",open:e.modal_confirm_generate_structure_open,closable:!1},{footer:r(()=>[s(w,{class:B(["main-color-btn-ghost",e.loading?"main-color-btn-disabled":""]),type:"ghost",onClick:t[3]||(t[3]=E=>e.modal_confirm_generate_structure_open=!1)},{default:r(()=>[f(o(a.$t("sidebar.buttons.cancel")),1)]),_:1},8,["class"]),s(w,{loading:e.loading,class:"main-color-btn",type:"primary",onClick:e.onConfirmGenerateFileStructure},{default:r(()=>[f(o(a.$t("generate_file_structure.buttons.confirm")),1)]),_:1},8,["loading"])]),default:r(()=>{var E;return[n("div",zt,[n("div",Rt,[s(e.ExclamationCircleFilled,{class:"fs-4 me-3 text-warning"}),n("div",Bt,o(a.$t("generate_file_structure.confirm_modal.title")),1)]),n("div",Jt,[f(o(a.$t("generate_file_structure.confirm_modal.content"))+" ",1),n("span",jt,o((E=e.cost)==null?void 0:E.miniumPointToGenerate),1),f(" "+o(a.$t("generate_file_structure.confirm_modal.content_tail")),1)])])]}),_:1},8,["open"])],64)}const Vt=ye(Ct,[["render",Ht],["__scopeId","data-v-8be2b719"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateFileStructure.vue"]]),Yt=ve({__name:"GenerateQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(a,{expose:t,emit:g}){const{t:e}=he(),L=a,V=g,G=y(!1),v=()=>{S.checkedList=[],G.value=!0},I=()=>{G.value=!1};t({openGenerateAIModal:v});const w=()=>{if(S.checkedList.length===0){F.warning(e("message.minimum_question",{number:1}));return}if(S.checkedList.length+L.numberOfQuestion>500){F.warning(e("message.limit_question",{number:500}));return}Z.confirm({title:e("import_qs_modal.confirm_modal.title"),content:e("import_qs_modal.confirm_modal.content",{number:S.checkedList.length}),okText:e("create_QS.buttons.ok"),cancelText:e("create_QS.buttons.cancel"),onOk:()=>{const d=M.value.filter(D=>S.checkedList.includes(D));V("import",d),I()}})},k=Object.values(pe).map(d=>({label:e(`create_QS.type.${d}`),value:d})),E=Object.values(St).map(d=>({label:d,value:d})),T=y([]);for(let d=10;d<=50;d+=10)T.value.push({label:d,value:d});const M=y([]),S=fe({checkAll:!1,indeterminate:!1,checkedList:[]}),l=fe({file:null,isGenerateExplain:!0,language:ie[0].code,questionCount:T.value[0].value,questionTypes:[k[0]],documentStructureJson:null,selectedPartJson:null,title:""}),Q=d=>{l.questionTypes.length===0&&(F.warning(e("message.minimun_question_type")),l.questionTypes.push(d))},U=y(!1),A=Ie(Ee,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),u=async()=>{var d;try{if(U.value=!0,!l.title&&l.isGenerateExplain){F.error(e("message.invalid_reference"));return}if(l.documentStructureJson===null){Z.error({title:e("generate_qs_modal.invalid_structure_modal.title"),content:e("generate_qs_modal.invalid_structure_modal.content"),centered:!0}),h();return}const D=JSON.parse(l.documentStructureJson),H=JSON.parse(l.selectedPartJson||"{}");l.isGenerateExplain&&l.title&&(l.documentStructureJson=JSON.stringify({...D,title:l.title}),l.selectedPartJson=JSON.stringify({...H,title:l.title}));const N=new FormData;N.append("file",J.value[0]),N.append("isGenerateExplain",l.isGenerateExplain?"true":"false"),N.append("language",((d=ie.find(le=>le.code===l.language))==null?void 0:d.label)||ie[0].label),N.append("questionCount",l.questionCount),N.append("questionTypes",JSON.stringify(l.questionTypes.map(le=>le.value))),N.append("documentStructureJson",l.documentStructureJson),N.append("selectedPartJson",l.selectedPartJson||"");const ke=await re.GenerateQuestion(N);if(!ke.data.success){F.error("Generate failed!");return}M.value=[...M.value||[],...ke.data.data.map(le=>({...le,questionId:Oe().valueOf()}))],await ge(),S.checkedList=[],S.indeterminate=!1,S.checkAll=!1}catch(D){console.log(D)}finally{U.value=!1,R.value=!1}},R=y(!1),x=y(null),Y=async()=>{if(x.value){R.value=!0;return}try{U.value=!0;const d=await re.GetCostToGenerate(J.value[0]);if(!d.data.success)return Z.error({title:"Error",content:d.data.message||e("message.failed_to_get_cost")}),null;const D=d.data.data;if(!D){F.error(e("message.failed_to_get_cost"));return}x.value=D,R.value=!0}catch(d){return console.error(d),null}finally{U.value=!1}},J=y([]),ee=y(null),X=y(!1),K=()=>{var d;(d=ee.value)==null||d.click()},te=async d=>{if(d){if(d.type!=="application/pdf"){F.error(e("message.file_support_only",{fileTypes:"PDF"}));return}J.value=[],F.success(e("message.uploaded_successfully",{name:d.name})),J.value.push(d);const D=d.name.replace(/\.[^/.]+$/,"");l.title=D,await ge(),h();return}F.error(e("message.uploaded_failed"))},ne=d=>{var N;const D=d.target,H=(N=D.files)==null?void 0:N[0];H&&(te(H),D.value="",x.value=null)},ae=d=>{var H;const D=((H=d.dataTransfer)==null?void 0:H.types)||[];Array.from(D).includes("files")&&(X.value=!0)},C=async d=>{var H;const D=(H=d.dataTransfer)==null?void 0:H.files[0];X.value=!1,D&&(te(D),x.value=null)},P=()=>{Z.confirm({title:e("generate_qs_modal.confirm_delete_file_modal.title"),content:e("generate_qs_modal.confirm_delete_file_modal.content"),onOk:()=>{var d;J.value=[],(d=m.value)==null||d.clearData(),l.documentStructureJson=null,l.selectedPartJson=null}})},p=d=>{Object.assign(S,{checkedList:d.target.checked?M.value:[],indeterminate:!1})};be(()=>S.checkedList,d=>{S.indeterminate=!!d.length&&d.length<M.value.length,S.checkAll=d.length===M.value.length});const c=(d,D)=>{$(D).toggleClass("bx-chevron-up bx-chevron-down");const N=$(`#question-item-answer-${d}`);N&&$(N).slideToggle()},m=y(null),h=()=>{m.value&&m.value.openModal()},j=(d,D)=>{l.documentStructureJson=d,l.selectedPartJson=D};Te(()=>{});const W={t:e,props:L,emit:V,modal_generate_ai_open:G,openGenerateAIModal:v,closeGenerateAIModal:I,handleModalImport:w,questionTypeOptions:k,questionDifficultyOptions:E,questionMaximumOptions:T,generatedQuestions:M,generateModalState:S,generateByAIModalState:l,onDeselectQuestionType:Q,loading:U,indicator:A,onGenerateQuestions:u,modal_confirm_generate_question_open:R,cost:x,getCostToGenerateQuestion:Y,files:J,fileInput:ee,isDragging:X,openFileExplorer:K,onFileChange:te,handleFileChange:ne,handleDragEnter:ae,handleDrop:C,onRemoveUploadedFile:P,onCheckAll:p,toggleDisplayAnswer:c,generateFileStructureRef:m,openFileStructureModal:h,handleImportStructure:j,get QUESTION_TYPE(){return pe},get SUPPORTED_LOCALES(){return ie},get InboxOutlined(){return ue},get ExclamationCircleFilled(){return Ce},TextArea:Ge,GenerateFileStructure:Vt};return Object.defineProperty(W,"__isScriptSetup",{enumerable:!1,value:!0}),W}}),$t={class:"modal-container"},Xt={class:"modal-title-container"},Kt={class:"modal-content-item"},Wt={class:"content-item-section upload-section"},Zt={class:"section-title"},en={key:0,class:"section-content mb-2"},tn={class:"customized-file-upload-icons"},nn={class:"customized-file-upload-ins"},an={class:"customized-file-upload-hint"},on={key:1,class:"file-container"},ln={class:"file-item"},sn={class:"content-item-section preview-section"},rn={class:"section-title"},cn={class:"section-content"},dn={key:0,class:"section-content-header"},un={class:"header-item"},_n={class:"preview-question-container"},mn={class:"preview-question-item"},fn={class:"question-item-content"},gn=["innerHTML"],pn={key:1,class:"question-text"},vn=["id"],hn={key:0,class:"multiple-choice-answer"},bn={key:0,class:"result-correct"},yn={class:"pair-answer"},kn={class:"pair-answer-item"},Sn={class:"pair-answer-item"},wn={key:2,class:"ordering-answer"},Tn={class:"ordering-answer-item"},In={class:"ordering-answer-item"},En={class:"ordering-answer-item"},Cn={class:"short-text-answer"},An={class:"question-item-toogle-btn"},xn=["onClick"],Dn={class:"modal-generate-by-ai-warning"},Mn={class:"w-100 d-flex justify-content-end"},On={class:"confirm-modal-container"},qn={class:"d-flex align-items-center"},Ln={class:"fs-6 fw-bold"},Gn={class:"fs-6 ms-5 mt-3"},Qn={class:"fw-bold text-danger"};function Un(a,t,g,e,L,V){const G=b("RouterLink"),v=b("a-col"),I=b("a-row"),w=b("a-select-option"),k=b("a-select"),E=b("a-form-item"),T=b("a-switch"),M=b("a-button"),S=b("a-form"),l=b("a-checkbox"),Q=b("a-checkbox-group"),U=b("a-spin"),A=b("a-modal");return i(),_(O,null,[s(A,{centered:"",width:"100%",closable:!1,"wrap-class-name":"full-modal",open:e.modal_generate_ai_open,onCancel:e.closeGenerateAIModal},{footer:r(()=>t[20]||(t[20]=[])),default:r(()=>[s(U,{spinning:e.loading,size:"large",indicator:e.indicator},{default:r(()=>[n("div",$t,[n("div",Xt,[s(I,{class:"w-100 d-flex align-items-center"},{default:r(()=>[s(v,{span:1},{default:r(()=>[s(G,{onClick:e.closeGenerateAIModal,to:{name:""}},{default:r(()=>t[11]||(t[11]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[11]})]),_:1}),s(v,{class:"main-title",span:23},{default:r(()=>[n("span",null,o(a.$t("generate_qs_modal.title")),1),t[12]||(t[12]=f()),t[13]||(t[13]=n("br",null,null,-1)),n("span",null,o(a.$t("generate_qs_modal.sub_title")),1)]),_:1,__:[12,13]})]),_:1})]),n("div",Kt,[n("div",Wt,[n("div",Zt,[n("span",null,o(a.$t("import_qs_modal.upload_section")),1)]),e.files.length?q("v-if",!0):(i(),_("div",en,[n("input",{onChange:e.handleFileChange,class:"d-none",type:"file",ref:"fileInput",accept:".pdf"},null,544),n("div",{class:B(["customized-file-upload",e.isDragging?"is-dragging":""]),onClick:e.openFileExplorer,onDragenter:e.handleDragEnter,onDragover:t[0]||(t[0]=de(u=>e.isDragging=!0,["prevent"])),onDragleave:t[1]||(t[1]=u=>e.isDragging=!1),onDrop:de(e.handleDrop,["prevent"])},[n("div",tn,[n("i",{class:B(["bx","bx-down-arrow-alt","bx-fade-up",e.isDragging?"":"d-none"])},null,2),s(e.InboxOutlined,{class:B([e.isDragging?"d-none":""])},null,8,["class"])]),n("div",nn,o(a.$t("import_qs_modal.upload_area.title")),1),n("div",an,[f(o(a.$t("import_qs_modal.upload_area.content"))+" ",1),t[14]||(t[14]=n("br",null,null,-1)),f(" "+o(a.$t("import_qs_modal.upload_area.sub_content")),1)])],34)])),e.files.length?(i(),_("div",on,[(i(!0),_(O,null,z(e.files,u=>(i(),_("div",ln,[n("div",null,o(u.name),1),n("i",{class:"bx bx-trash text-danger",onClick:t[2]||(t[2]=R=>e.onRemoveUploadedFile())})]))),256)),n("div",{class:B(["file-structure",e.generateByAIModalState.documentStructureJson?"answer-correct result-correct ":"answer-incorrect result-incorrect "]),onClick:e.openFileStructureModal},[t[15]||(t[15]=n("i",{class:"bx bx-file"},null,-1)),n("div",null,o(a.$t("generate_qs_modal.form.structure")),1)],2)])):q("v-if",!0),s(S,{layout:"vertical",class:"generate-ai-form"},{default:r(()=>[s(I,{class:"d-flex justify-content-between"},{default:r(()=>[s(v,{span:12},{default:r(()=>[s(E,{l:"",label:e.t("generate_qs_modal.form.language")},{default:r(()=>[s(k,{class:"language-select",value:e.generateByAIModalState.language,"onUpdate:value":t[3]||(t[3]=u=>e.generateByAIModalState.language=u)},{default:r(()=>[(i(!0),_(O,null,z(e.SUPPORTED_LOCALES,u=>(i(),oe(w,{key:`locale-${u.code}`,value:u.code},{default:r(()=>[f(o(u.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),s(v,{span:11},{default:r(()=>[s(E,{label:e.t("generate_qs_modal.form.maximum_question")},{default:r(()=>[s(k,{value:e.generateByAIModalState.questionCount,"onUpdate:value":t[4]||(t[4]=u=>e.generateByAIModalState.questionCount=u),style:{width:"100%"},placeholder:"Maximum number of question",options:e.questionMaximumOptions},null,8,["value","options"])]),_:1},8,["label"])]),_:1})]),_:1}),s(E,{label:e.t("generate_qs_modal.form.question_types")},{default:r(()=>[s(k,{onDeselect:e.onDeselectQuestionType,value:e.generateByAIModalState.questionTypes,"onUpdate:value":t[5]||(t[5]=u=>e.generateByAIModalState.questionTypes=u),mode:"multiple",style:{width:"100%"},placeholder:"Select multiple",options:e.questionTypeOptions},null,8,["value","options"])]),_:1},8,["label"]),s(I,{class:"d-flex justify-content-between"},{default:r(()=>[s(v,{span:7},{default:r(()=>[s(E,{label:e.t("generate_qs_modal.form.enable_explaination")},{default:r(()=>[s(T,{checked:e.generateByAIModalState.isGenerateExplain,"onUpdate:checked":t[6]||(t[6]=u=>e.generateByAIModalState.isGenerateExplain=u)},null,8,["checked"])]),_:1},8,["label"])]),_:1}),e.generateByAIModalState.isGenerateExplain?(i(),oe(v,{key:0,span:16},{default:r(()=>[s(E,{label:e.t("generate_qs_modal.form.reference_name")},{default:r(()=>[s(e.TextArea,{modelValue:e.generateByAIModalState.title,"onUpdate:modelValue":t[7]||(t[7]=u=>e.generateByAIModalState.title=u),"is-required":e.generateByAIModalState.isGenerateExplain,"max-length":200,placeholder:e.t("generate_qs_modal.form.reference_name_placeholder"),readonly:!e.generateByAIModalState.isGenerateExplain},null,8,["modelValue","is-required","placeholder","readonly"])]),_:1},8,["label"])]),_:1})):q("v-if",!0)]),_:1}),s(E,{style:{"margin-top":"7px"},class:"generate-ai-btn-container"},{default:r(()=>[s(M,{loading:e.loading,size:"large",class:B(["w-100 main-color-btn generate_ai",e.generateByAIModalState.documentStructureJson?"":"main-color-btn-disabled"]),type:"primary",onClick:e.getCostToGenerateQuestion},{default:r(()=>[f(o(a.$t("generate_qs_modal.buttons.generate")),1)]),_:1},8,["loading","class"])]),_:1})]),_:1})]),n("div",sn,[n("div",rn,o(a.$t("import_qs_modal.preview_section")),1),n("div",cn,[e.generatedQuestions.length>0?(i(),_("div",dn,[s(l,{class:B(["header-item",e.generateModalState.checkAll?"check-all":""]),onClick:e.onCheckAll,checked:e.generateModalState.checkAll,"onUpdate:checked":t[8]||(t[8]=u=>e.generateModalState.checkAll=u),indeterminate:e.generateModalState.indeterminate},{default:r(()=>[f(o(a.$t("share_modal.buttons.check_all",{number:e.generateModalState.checkedList.length})),1)]),_:1},8,["class","checked","indeterminate"]),n("div",un,o(a.$t("import_qs_modal.other.total_question",{number:e.generatedQuestions.length})),1)])):q("v-if",!0),s(Q,{value:e.generateModalState.checkedList,"onUpdate:value":t[9]||(t[9]=u=>e.generateModalState.checkedList=u)},{default:r(()=>[n("div",_n,[(i(!0),_(O,null,z(e.generatedQuestions,(u,R)=>(i(),_("div",mn,[s(l,{value:u},null,8,["value"]),n("div",fn,[u.questionHTML?(i(),_("div",{key:0,class:"question-html",innerHTML:u.questionHTML},null,8,gn)):(i(),_("div",pn,o(u.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${R}`},[u.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(i(),_("div",hn,[n("ul",null,[(i(!0),_(O,null,z(u.multipleChoices,x=>(i(),_("li",null,[f(o(x.text)+" ",1),x.isAnswer?(i(),_("span",bn," ("+o(x.isAnswer)+") ",1)):q("v-if",!0)]))),256))])])):q("v-if",!0),u.type===e.QUESTION_TYPE.MATCHING?(i(!0),_(O,{key:1},z(u.matchingPairs,x=>(i(),_("div",yn,[n("span",kn,o(x.leftItem),1),t[16]||(t[16]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",Sn,o(x.rightItem),1)]))),256)):q("v-if",!0),u.type===e.QUESTION_TYPE.ORDERING?(i(),_("div",wn,[n("div",Tn,[(i(!0),_(O,null,z(u.orderingItems,x=>(i(),_("div",null,o(x.text),1))),256))]),t[17]||(t[17]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",In,[(i(!0),_(O,null,z(u.orderingItems,(x,Y)=>(i(),_("div",En,[n("span",null,"#"+o(Y+1),1),f(" - "+o(x.text),1)]))),256))])])):q("v-if",!0),u.type===e.QUESTION_TYPE.SHORT_TEXT?(i(),_(O,{key:3},[t[18]||(t[18]=n("span",null,"Answer:",-1)),n("div",Cn,o(u.shortAnswer),1)],64)):q("v-if",!0)],8,vn)]),n("div",An,[n("i",{class:"bx bx-chevron-up",onClick:x=>e.toggleDisplayAnswer(R,x.currentTarget)},null,8,xn)])]))),256))])]),_:1},8,["value"])]),n("div",Dn,[n("span",null,[t[19]||(t[19]=n("i",{class:"bx bx-info-circle"},null,-1)),f(" "+o(a.$t("generate_qs_modal.other.ai_warning")),1)])]),n("div",Mn,[s(M,{class:"main-color-btn",key:"submit",type:"primary",size:"large",onClick:e.handleModalImport},{default:r(()=>[f(o(a.$t("import_qs_modal.buttons.import")),1)]),_:1})])])])])]),_:1},8,["spinning","indicator"])]),_:1},8,["open"]),s(A,{"wrap-class-name":"medium-modal",centered:"",open:e.modal_confirm_generate_question_open,closable:!1},{footer:r(()=>[s(M,{class:B(["main-color-btn-ghost",e.loading?"main-color-btn-disabled":""]),type:"ghost",onClick:t[10]||(t[10]=u=>e.modal_confirm_generate_question_open=!1)},{default:r(()=>[f(o(a.$t("sidebar.buttons.cancel")),1)]),_:1},8,["class"]),s(M,{loading:e.loading,class:"main-color-btn",type:"primary",onClick:e.onGenerateQuestions},{default:r(()=>[f(o(a.$t("generate_file_structure.buttons.confirm")),1)]),_:1},8,["loading"])]),default:r(()=>{var u;return[n("div",On,[n("div",qn,[s(e.ExclamationCircleFilled,{class:"fs-4 me-3 text-warning"}),n("div",Ln,o(a.$t("generate_qs_modal.confirm_modal.title")),1)]),n("div",Gn,[f(o(a.$t("generate_file_structure.confirm_modal.content"))+" ",1),n("span",Qn,o((u=e.cost)==null?void 0:u.miniumPointToGenerate),1),f(" "+o(a.$t("generate_file_structure.confirm_modal.content_tail")),1)])])]}),_:1},8,["open"]),s(e.GenerateFileStructure,{file:e.files[0],ref:"generateFileStructureRef",onImport:e.handleImportStructure},null,8,["file"])],64)}const Hn=ye(Yt,[["render",Un],["__scopeId","data-v-23b34ba3"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateQSModal.vue"]]);export{Hn as G,jn as I};
