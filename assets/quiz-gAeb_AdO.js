import{d as M,q as G,l as K,u as W,i as S,j as E,E as X,s as Y,R as L,M as H,k as U,_ as J,r as p,c as f,o as v,b as a,a as n,w as i,f as h,t as r,e as Q,F as D,B as Z,C as $}from"./index-DNe0PjcS.js";import{A as x}from"./ApiClass-DvyBSwYy.js";import{C as ee}from"./classStudentPosition-B7ChrNvq.js";import{I as ae}from"./Input-B39QhD1z.js";import{V as te}from"./Validator-CWeiTIFe.js";const se=M({__name:"quiz",emits:["updateSidebar"],setup(d,{expose:t,emit:R}){var A;t();const e=G(),b=K(),{t:u}=W(),g=R,m=S(e.params.id||""),_=S({classId:"",name:"",topic:""}),o=E({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,name:((A=e.query.name)==null?void 0:A.toString())||"",totalCount:0,statusFilter:!1}),I=S([]),k=S(""),C=S(!1),w=async()=>{try{const s=await x.GetUserPermission(_.value.classId);s.data.success&&(k.value=s.data.data)}catch(s){console.log(s)}},z=async()=>{try{if(!te.isValidGuid(m.value.toString())){b.push({name:"404"});return}m.value||b.push({name:"404"});let s=await x.GetById(m.value.toString());s.data.success||b.push({name:"404"}),_.value=s.data.data,N.name=_.value.name,N.topic=_.value.topic}catch(s){const c=Object.keys(s.response.data.errors);if(c.includes(L.NOT_FOUND_STUDENT_IN_CLASS)||c.includes(L.NOT_FOUND_USER_IN_CLASS)){b.push({name:"User_Class"});return}}},y=async()=>{try{C.value=!0;let s=await x.GetAllQSByLimit(m.value.toString(),o);if(s.data.success){let c=s.data.data;I.value=c.items,o.pageNumber=c.pageNumber,o.pageSize=c.pageSize,o.totalCount=c.totalCount,o.statusFilter&&(o.pageNumber>c.totalPages&&o.totalCount>0?(o.pageNumber=1,b.push({name:"User_Class_Quiz",params:{id:m.value},query:{pageNumber:1,pageSize:o.pageSize,name:o.name}})):b.push({name:"User_Class_Quiz",params:{id:m.value},query:{pageNumber:o.pageNumber,pageSize:o.pageSize,name:o.name}}),o.statusFilter=!o.statusFilter)}}catch(s){console.log("ERROR: GETALLEXAMBYLIMIT class qs: "+s)}finally{C.value=!1}};X(()=>Object.keys(e.query).length,()=>{var s;o.pageNumber=e.query.pageNumber||1,o.pageSize=e.query.pageSize||10,o.name=((s=e.query.name)==null?void 0:s.toString())||"",o.statusFilter=!0,y()});const T=(s,c)=>{o.pageNumber=s,o.pageSize=c,o.statusFilter=!0,y()},l=s=>{H.confirm({title:u("class_question_set.modal.delete_title"),content:u("class_question_set.modal.delete_content"),okText:u("sidebar.buttons.ok"),cancelText:u("sidebar.buttons.cancel"),onOk:async()=>{if(!(await x.DeleteQuestionSetFromClass(_.value.classId,s)).data.success){U.success(u("message.removed_failed"));return}U.success(u("message.removed_successfully")),y()}})},q=s=>{b.push({name:"User_QuestionSet_Detail",params:{id:s}})},B={name:[{required:!0,message:u("message.required"),trigger:"change"},{max:100,message:u("message.out_of_range",{max_length:100}),trigger:"change"}],topic:[{max:100,message:u("message.out_of_range",{max_length:100}),trigger:"change"}]},O=S(!1),P=S(),N=E({name:_.value.name,topic:_.value.topic}),F=S(!1),j=async()=>{var s;F.value=!0;try{if((s=P.value)==null||s.validate(),!(await x.Update({classId:m.value,name:N.name,topic:N.topic})).data.success){U.error(u("message.updated_failed"));return}U.success(u("message.updated_successfully")),O.value=!1,window.location.reload()}catch(c){console.log(c)}finally{F.value=!1}};Y(async()=>{g("updateSidebar","class"),await z(),await w(),await y()});const V={route:e,router:b,t:u,emit:g,classId:m,classData:_,pageParams:o,question_set_data:I,userRoleInClass:k,loading:C,getPermission:w,getClassData:z,getData:y,onPaginationChange:T,onDeleteQSFromClass:l,onRedirectToDetail:q,rules:B,modal_update_open:O,updateClassFormRef:P,updateClassFormState:N,isUpdateLoading:F,onUpdateClass:j,get CLASS_STUDENT_POSITION(){return ee},Input:ae};return Object.defineProperty(V,"__isScriptSetup",{enumerable:!1,value:!0}),V}}),oe={class:"page-container"},ne={class:"title-container"},le={class:"breadcrumb-container"},ie={class:"title-breadcrumb-item"},re={key:0,class:"title-breadcrumb-item"},ce={class:"breadcrumb-item-topic"},de={key:1,class:"title-breadcrumb-item"},ue={class:"breadcrumb-item-topic"},me={class:"content"},_e={class:"content-item"},pe={class:"content-item-title"},ge={class:"content-item-functions"},ve={class:"content-item-navigators"},be={class:"navigator-container"},fe={style:{width:"300px",padding:"0px"}},Se={key:0,class:"quiz-item-container"},he={class:"quiz-item"},ye={class:"quiz-item-title"},Ce={class:"quiz-item-description"},qe={class:"quiz-item-info quiz-info-detail"},ze={class:"quiz-item-questions"},Ne={class:"quiz-item-created-by"},xe={class:"exam-item-actions"},Ie=["onClick"],ke={key:1,class:"w-100 d-flex justify-content-center"},we={class:"pagination-container"},Ue={class:"modal-container"},De={class:"modal-title-container"};function Te(d,t,R,e,b,u){const g=p("RouterLink"),m=p("a-skeleton"),_=p("a-button"),o=p("a-tooltip"),I=p("a-empty"),k=p("a-pagination"),C=p("a-col"),w=p("a-row"),z=p("a-form-item"),y=p("a-form"),T=p("a-modal");return v(),f(D,null,[a("div",oe,[a("div",ne,[a("div",le,[a("ul",null,[a("li",ie,[n(g,{to:{name:"User_Class"}},{default:i(()=>[a("span",null,r(d.$t("class_index.title")),1),t[7]||(t[7]=h()),t[8]||(t[8]=a("br",null,null,-1))]),_:1,__:[7,8]}),t[9]||(t[9]=a("i",{class:"bx bx-chevron-right"},null,-1))]),e.userRoleInClass===e.CLASS_STUDENT_POSITION.OWNER?(v(),f("li",re,[n(g,{to:{name:""},class:"breadcrumb-item-class",onClick:t[0]||(t[0]=l=>e.modal_update_open=!0)},{default:i(()=>[a("span",null,r(e.classData.name),1),a("span",ce,r(e.classData.topic),1)]),_:1}),t[10]||(t[10]=a("i",{class:"bx bx-edit"},null,-1))])):(v(),f("li",de,[n(g,{to:{name:""},class:"breadcrumb-item-class"},{default:i(()=>[a("span",null,r(e.classData.name),1),a("span",ue,r(e.classData.topic),1)]),_:1})]))])])]),a("div",me,[a("div",_e,[a("div",pe,[a("div",null,[a("span",null,r(d.$t("class_question_set.title")),1),a("span",null,r(d.$t("class_question_set.sub_title")),1)])]),a("div",ge,[a("div",ve,[a("div",be,[n(g,{class:"navigator-item",to:{name:"User_Class_Exam"}},{default:i(()=>[h(r(d.$t("class_index.navigators.exam")),1)]),_:1}),n(g,{class:"navigator-item navigator-active",to:{name:""}},{default:i(()=>[h(r(d.$t("class_index.navigators.quiz")),1)]),_:1}),n(g,{class:"navigator-item",to:{name:"User_Class_Student"}},{default:i(()=>[h(r(d.$t("class_index.navigators.member")),1)]),_:1})])]),Q(` <a-select
                        v-model:value="pageParams.shareMode"
                        style="width: 200px"
                        @change="getData"
                    >
                        <a-select-option v-for="option in share_mode_options" :value="option.value">
                            {{ option.label }}
                        </a-select-option>
                    </a-select> `),a("div",fe,[n(e.Input,{onInput:e.getData,modelValue:e.pageParams.name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.pageParams.name=l),placeholder:e.t("question_sets_index.search_placeholder")},{icon:i(()=>t[11]||(t[11]=[a("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(v(),f(D,{key:0},[n(m,{active:"",loading:e.loading},null,8,["loading"]),n(m,{active:"",loading:e.loading},null,8,["loading"]),n(m,{active:"",loading:e.loading},null,8,["loading"])],64)):(v(),f(D,{key:1},[e.question_set_data.length>0?(v(),f("div",Se,[(v(!0),f(D,null,Z(e.question_set_data,l=>(v(),f("div",he,[t[13]||(t[13]=a("i",{class:"bx bx-book-open quiz-item-icon"},null,-1)),a("div",null,[a("div",ye,r(l.name),1),a("div",Ce,r(l.description),1),a("div",qe,[a("div",ze,[t[12]||(t[12]=a("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),h(" "+r(l.totalQuestionCount)+" "+r(d.$t("dashboards.list_items.quiz.questions")),1)]),a("div",Ne,r(d.$t("class_question_set.other.created_by"))+" "+r(l.createBy),1)])]),a("div",xe,[n(_,{type:"primary",class:"me-3 main-color-btn",onClick:q=>e.onRedirectToDetail(l.id)},{default:i(()=>[h(r(d.$t("class_question_set.buttons.view")),1)]),_:2},1032,["onClick"]),e.userRoleInClass!==e.CLASS_STUDENT_POSITION.STUDENT?(v(),$(o,{key:0},{title:i(()=>[h(r(d.$t("question_sets_index.buttons.delete")),1)]),default:i(()=>[a("i",{style:{cursor:"pointer"},class:"text-danger bx bx-trash-alt",onClick:q=>e.onDeleteQSFromClass(l.id)},null,8,Ie)]),_:2},1024)):Q("v-if",!0)])]))),256))])):(v(),f("div",ke,[n(I,null,{description:i(()=>[a("span",null,r(d.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),a("div",we,[n(k,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":t[2]||(t[2]=l=>e.pageParams.pageNumber=l),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(l,q)=>`${q[0]}-${q[1]} of ${l} ${e.t("class_question_set.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])]),n(T,{centered:"","wrap-class-name":"medium-modal",open:e.modal_update_open,onCancel:t[6]||(t[6]=l=>e.modal_update_open=!1)},{footer:i(()=>[n(_,{loading:e.isUpdateLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onUpdateClass},{default:i(()=>[h(r(d.$t("update_QS.buttons.update")),1)]),_:1},8,["loading"])]),default:i(()=>[a("div",Ue,[a("div",De,[n(w,{class:"w-100 d-flex align-items-center"},{default:i(()=>[n(C,{span:4},{default:i(()=>[n(g,{onClick:t[3]||(t[3]=l=>e.modal_update_open=!1),to:{name:""}},{default:i(()=>t[14]||(t[14]=[a("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[14]})]),_:1}),n(C,{class:"main-title",span:20},{default:i(()=>[a("span",null,r(e.t("class_index.modal.update_title")),1)]),_:1})]),_:1})]),n(y,{ref:"updateClassFormRef",layout:"vertical",rules:e.rules,model:e.updateClassFormState},{default:i(()=>[n(z,null,{default:i(()=>[n(e.Input,{label:e.t("class_index.modal.create_class_name_label"),name:"name",modelValue:e.updateClassFormState.name,"onUpdate:modelValue":t[4]||(t[4]=l=>e.updateClassFormState.name=l),placeholder:e.t("class_index.modal.create_class_name_placeholder"),"is-required":!0,"max-length":100},null,8,["label","modelValue","placeholder"])]),_:1}),n(z,null,{default:i(()=>[n(e.Input,{label:e.t("class_index.modal.create_class_topic_label"),name:"topic",modelValue:e.updateClassFormState.topic,"onUpdate:modelValue":t[5]||(t[5]=l=>e.updateClassFormState.topic=l),placeholder:e.t("class_index.modal.create_class_topic_placeholder"),"max-length":100},null,8,["label","modelValue","placeholder"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open"])],64)}const Ae=J(se,[["render",Te],["__scopeId","data-v-b4964186"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/quiz.vue"]]);export{Ae as default};
