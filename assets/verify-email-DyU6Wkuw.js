import{d as q,u as V,l as B,j as z,i as v,m as I,A as k,_ as L,r,a as A,b as i,c as t,f as g,t as s,w as l,F as M,o as N,p as E}from"./index-DjZzqq9v.js";import{M as U}from"./MailOutlined-BX5QExfa.js";import{L as j}from"./LockOutlined-eL4WdNgR.js";const Q=q({__name:"verify-email",setup(o,{expose:a}){a();const{t:c}=V(),e=B(),C=sessionStorage.getItem("email"),S=z({email:C,verificationCode:""}),u=z({email:sessionStorage.getItem("email")}),m={email:[{required:!0,message:c("auth.validation.required"),trigger:"change"},{pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:c("auth.validation.email"),trigger:"change"}],verificationCode:[{required:!0,message:c("auth.validation.required"),trigger:"change"}]},f=v(),h={span:24},b={span:24},R=v(!1),y=v(!1),_=v(!1),n=v(!1),p=(d,F,O)=>{I[d]({message:F,description:O})},w={t:c,router:e,sessionEmail:C,formState:S,resentFormState:u,rules:m,formRef:f,labelCol:h,wrapperCol:b,modal_open:R,modal_is_success:y,send_button_loading:_,verify_button_loading:n,showNotification:p,onRequestEmailVerification:()=>{f.value.validate().then(async()=>{try{if(_.value=!0,(await k.RequestEmailVerification({email:u.email})).data.success){p("success","Send email result","Success"),sessionStorage.setItem("email",u.email?u.email:""),y.value=!0;return}p("error","Send email result","ERROR")}catch(d){console.log(d)}finally{_.value=!1}})},onFinish:()=>{f.value.validate().then(async()=>{try{if(n.value=!0,!(await k.VerifyEmail(S)).data.success){p("error","Send email result","ERROR");return}p("success","Send email result","Success. Redirecting..."),setTimeout(()=>{e.push({name:"login"})},3e3)}catch(d){console.log(d)}finally{n.value=!1}})},get LockOutlined(){return j},get MailOutlined(){return U}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),T={class:"authentication-item"},D={class:"authentication-item-title"},P={class:"authentication-item-navigator"};function G(o,a,c,e,C,S){const u=r("a-input"),m=r("a-form-item"),f=r("a-input-password"),h=r("a-button"),b=r("a-form"),R=r("RouterLink"),y=r("a-result"),_=r("a-modal");return N(),A(M,null,[i("div",T,[i("div",D,[i("span",null,s(o.$t("auth.greetings.verify_email")),1),a[5]||(a[5]=g()),a[6]||(a[6]=i("br",null,null,-1)),i("span",null,s(o.$t("auth.instructions.verify_email",{email:e.sessionEmail})),1)]),t(b,{class:"authentication-item-form",ref:"formRef",model:e.formState,labelCol:e.labelCol,wrapperCol:e.wrapperCol,rules:e.rules},{default:l(()=>[t(m,{label:"",name:"email"},{default:l(()=>[i("label",null,s(o.$t("auth.inputs.email")),1),t(u,{size:"large",value:e.formState.email,"onUpdate:value":a[0]||(a[0]=n=>e.formState.email=n),placeholder:o.$t("auth.inputs.email")},{addonBefore:l(()=>[t(e.MailOutlined)]),_:1},8,["value","placeholder"])]),_:1}),t(m,{label:"",name:"verificationCode"},{default:l(()=>[i("label",null,s(o.$t("auth.inputs.code")),1),t(f,{size:"large",value:e.formState.verificationCode,"onUpdate:value":a[1]||(a[1]=n=>e.formState.verificationCode=n),placeholder:o.$t("auth.inputs.code")},{addonBefore:l(()=>[t(e.LockOutlined)]),_:1},8,["value","placeholder"])]),_:1}),t(m,null,{default:l(()=>[t(h,{loading:e.verify_button_loading,onClick:e.onFinish,size:"large",type:"primary",style:{"background-color":"#9823f5",width:"100%"}},{default:l(()=>[g(s(o.$t("auth.buttons.verify")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),i("div",P,[g(s(o.$t("auth.navigators.resend_email"))+" ",1),t(R,{to:{name:""},onClick:a[2]||(a[2]=n=>e.modal_open=!0)},{default:l(()=>[g(s(o.$t("auth.buttons.resend")),1)]),_:1})])]),t(_,{visible:e.modal_open,title:"",onCancel:a[4]||(a[4]=n=>e.modal_open=!1),centered:""},{footer:l(()=>a[7]||(a[7]=[])),default:l(()=>[t(b,{class:E(["authentication-item-form",e.modal_is_success?"d-none":""]),ref:"formRef",model:e.resentFormState,labelCol:e.labelCol,wrapperCol:e.wrapperCol,rules:e.rules},{default:l(()=>[t(m,{label:"",name:"email"},{default:l(()=>[i("label",null,s(o.$t("auth.inputs.email")),1),t(u,{size:"large",value:e.resentFormState.email,"onUpdate:value":a[3]||(a[3]=n=>e.resentFormState.email=n),placeholder:o.$t("auth.inputs.email")},{addonBefore:l(()=>[t(e.MailOutlined)]),_:1},8,["value","placeholder"])]),_:1}),t(m,null,{default:l(()=>[t(h,{loading:e.send_button_loading,onClick:e.onRequestEmailVerification,size:"large",type:"primary",style:{"background-color":"#9823f5",width:"100%"}},{default:l(()=>[g(s(o.$t("auth.buttons.send")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["class","model"]),t(y,{class:E([e.modal_is_success?"":"d-none"]),status:"success",title:"Email sent successfully!","sub-title":o.$t("auth.instructions.verify_email",{email:e.resentFormState.email})},null,8,["class","sub-title"])]),_:1},8,["visible"])],64)}const Y=L(Q,[["render",G],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/public/verify-email.vue"]]);export{Y as default};
