import{d as W,q as Z,l as $,u as ee,H,i as h,j as Q,K as te,s as ae,k as v,M as R,v as oe,_ as ne,r as c,a as x,o as f,b as t,f as M,c as s,w as o,g as m,t as r,F as V,B as K,C as F}from"./index-CaXCJ6tV.js";import{A as T}from"./ApiClass-BHnvAkQD.js";import{I as se}from"./Input-DtZ5xe-g.js";const le={FULL_NAME:"FullName",EMAIL:"Email"},ie={TEACHER:"Teacher",STUDENT:"Student"},re=W({__name:"student",emits:["updateSidebar"],setup(d,{expose:a,emit:B}){var G;a();const e=Z(),y=$(),{t:I}=ee(),b=B,k=Object.values(le),N=H(()=>k.map(n=>({label:I(`class_member.select_option.${n}`),value:n}))),_=h(e.params.id||""),C=h({classId:"",name:"",topic:""}),l=Q({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,keyword:((G=e.query.keyword)==null?void 0:G.toString())||"",fieldName:e.query.fieldName||N.value[0].value,totalCount:0,statusFilter:!1}),z=h([]),D=async()=>{try{_.value||y.push({name:"404"});let n=await T.GetById(_.value.toString());n.data.success||y.push({name:"404"}),C.value=n.data.data}catch(n){console.log("ERROR: GETBYID class: "+n)}},g=async()=>{try{let n=await T.GetAllStudentByLimit(_.value.toString(),l);if(n.data.success){let u=n.data.data;z.value=u.items,l.pageNumber=u.pageNumber,l.pageSize=u.pageSize,l.totalCount=u.totalCount,l.statusFilter&&(l.pageNumber>u.totalPages&&l.totalCount>0?(l.pageNumber=1,y.push({name:"User_Class_Student",params:{id:_.value},query:{pageNumber:1,pageSize:l.pageSize,keyword:l.keyword,fieldName:l.fieldName}})):y.push({name:"User_Class_Student",params:{id:_.value},query:{pageNumber:l.pageNumber,pageSize:l.pageSize,keyword:l.keyword,fieldName:l.fieldName}}),l.statusFilter=!l.statusFilter)}}catch(n){console.log("ERROR: GETALLEXAMBYLIMIT class exam: "+n)}};te(()=>{var n;Object.keys(e.query).length===0&&(l.pageNumber=e.query.pageNumber||1,l.pageSize=e.query.pageSize||10,l.keyword=((n=e.query.keyword)==null?void 0:n.toString())||"",l.fieldName=e.query.fieldName||N.value[0].value,l.statusFilter=!0,g())});const L=(n,u)=>{l.pageNumber=n,l.pageSize=u,l.statusFilter=!0,g()},U=[{title:"No",key:"no",customRender:n=>n.index+1},{title:"FullName",dataIndex:"fullName",key:"fullName",sorter:(n,u)=>n.fullName.localeCompare(u.fullName)},{title:"Email",dataIndex:"email",key:"email",sorter:(n,u)=>n.email.localeCompare(u.email)},{title:"Position",dataIndex:"position",key:"position"},{key:"action"}],E=[1,3,5,7,30],P=H(()=>E.map(n=>({label:n+I(n===1?"class_member.other.day_singular":"class_member.other.day_plural"),value:n}))),S=h(!1),w=Q({classId:_.value,code:"e3m3TR41fk+t",expiredTime:P.value[0].value}),O=h(!1),q=()=>{S.value=!0},i=()=>{},p=()=>{navigator.clipboard.writeText(w.code).then(()=>{v.success("Copied")}).catch(()=>{v.error("code empty")})},A=()=>{navigator.clipboard.writeText(w.code).then(()=>{v.success("Copied")}).catch(()=>{v.error("code empty")})},Y=n=>{R.confirm({title:"Are you sure to remove this user from class?",content:"This action is inreversible, every related data will be erased forever. Careful!",centered:!0,okText:"Confirm",onOk:async()=>{if(!(await T.DeleteClassMember(_.value.toString(),n.toString())).data.success){v.success("Remove failed.");return}v.success("Remove successfully."),await g()}})},X=(n,u)=>{R.confirm({title:"Are you sure to update this user position from class?",content:"Please make sure to double check the important information!.",centered:!0,okText:"Confirm",onOk:async()=>{if(!(await T.UpdateClassMemberPosition(_.value.toString(),n.toString(),u)).data.success){v.success("Update failed.");return}v.success("Update successfully."),await g()}})},J=()=>{R.confirm({title:"Are you sure to delete this class?",content:oe("div",{style:"color: red"},"This action is inreversible, every related data will be erased forever. Careful!"),centered:!0,okText:"Confirm",onOk:async()=>{if(!(await T.Delete(_.value.toString())).data.success){v.success("Delete class failed.");return}v.success("Delete class successfully."),y.push({name:"User_Class"})}})};ae(async()=>{b("updateSidebar","class"),await D(),await g()});const j={route:e,router:y,t:I,emit:b,optionKeys:k,class_position_options:N,classId:_,classData:C,pageParams:l,student_data:z,getClassData:D,getData:g,onPaginationChange:L,columns:U,optionDays:E,code_limit_time:P,modal_invitation_open:S,invitationFormState:w,isInvitaionLoading:O,onOpenInvitationModal:q,onResetInvitation:i,onCopyInvitationCode:p,onCopyInvitationLink:A,onConfirmDeleteMember:Y,onConfirmUpdateMemberPosition:X,onOpenConfirmDelete:J,Input:se,get CLASS_STUDENT_POSITION(){return ie}};return Object.defineProperty(j,"__isScriptSetup",{enumerable:!1,value:!0}),j}}),de={class:"page-container"},ce={class:"title-container"},me={class:"breadcrumb-container"},ue={class:"title-breadcrumb-item"},_e={class:"title-breadcrumb-item"},pe={class:"breadcrumb-item-topic"},ve={class:"content"},be={class:"content-item"},fe={class:"content-item-title"},ge={class:"content-item-functions"},ye={class:"content-item-navigators"},Ce={class:"navigator-container"},Se={style:{width:"300px",padding:"0px"}},ke={key:0,class:"student-name-container"},Ne=["src"],we={class:"student-name"},Ie={key:1,class:"student-action"},he={class:"d-flex align-items-center"},xe={class:"pagination-container"},Te={class:"mt-4 content-item"},ze={class:"content-item-title"},De={class:"text-danger"},Ue={class:"danger-zone mt-3 p-4"},Ee={class:"text-danger fs-6 fw-bold"},Pe={class:"text-secondary"},Ae={class:"modal-container"},Fe={class:"modal-title-container"},Le={class:"modal-invitation-body"},Oe={class:"invitation-code-container"},qe={class:"invitation-code-container"};function Re(d,a,B,e,y,I){const b=c("RouterLink"),k=c("a-button"),N=c("a-select-option"),_=c("a-select"),C=c("a-menu-item"),l=c("a-menu-divider"),z=c("a-menu"),D=c("a-dropdown"),g=c("a-table"),L=c("a-pagination"),U=c("a-col"),E=c("a-row"),P=c("a-qrcode"),S=c("a-form-item"),w=c("a-form"),O=c("a-divider"),q=c("a-modal");return f(),x(V,null,[t("div",de,[t("div",ce,[t("div",me,[t("ul",null,[t("li",ue,[s(b,{to:{name:"User_Class"}},{default:o(()=>[t("span",null,r(d.$t("class_index.title")),1),a[8]||(a[8]=m()),a[9]||(a[9]=t("br",null,null,-1))]),_:1,__:[8,9]}),a[10]||(a[10]=t("i",{class:"bx bx-chevron-right"},null,-1))]),t("li",_e,[s(b,{to:{name:""},class:"breadcrumb-item-class"},{default:o(()=>[t("span",null,r(e.classData.name),1),t("span",pe,r(e.classData.topic),1)]),_:1})])])])]),t("div",ve,[t("div",be,[t("div",fe,[t("div",null,[t("span",null,r(d.$t("class_member.title")),1),t("span",null,r(d.$t("class_member.sub_title")),1)]),s(k,{class:"main-color-btn",type:"primary",size:"large",onClick:e.onOpenInvitationModal},{default:o(()=>[a[11]||(a[11]=t("i",{class:"me-2 bx bx-user-plus"},null,-1)),m(" "+r(d.$t("class_member.buttons.invite_member")),1)]),_:1,__:[11]})]),t("div",ge,[t("div",ye,[t("div",Ce,[s(b,{class:"navigator-item",to:{name:"User_Class_Exam"}},{default:o(()=>[m(r(d.$t("class_index.navigators.exam")),1)]),_:1}),s(b,{class:"navigator-item",to:{name:"User_Class_Quiz"}},{default:o(()=>[m(r(d.$t("class_index.navigators.quiz")),1)]),_:1}),s(b,{class:"navigator-item navigator-active",to:{name:""}},{default:o(()=>[m(r(d.$t("class_index.navigators.member")),1)]),_:1})])]),s(_,{value:e.pageParams.fieldName,"onUpdate:value":a[0]||(a[0]=i=>e.pageParams.fieldName=i),style:{width:"200px"},onChange:e.getData},{default:o(()=>[(f(!0),x(V,null,K(e.class_position_options,i=>(f(),F(N,{value:i.value},{default:o(()=>[m(r(i.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",Se,[s(e.Input,{onInput:e.getData,modelValue:e.pageParams.keyword,"onUpdate:modelValue":a[1]||(a[1]=i=>e.pageParams.keyword=i),placeholder:e.t("class_member.other.search_placeholder")},{icon:o(()=>a[12]||(a[12]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),s(g,{columns:e.columns,"data-source":e.student_data,"row-key":"studentId",pagination:!1},{bodyCell:o(({column:i,record:p})=>[i.key==="fullName"?(f(),x("div",ke,[t("img",{class:"student-image",src:p.image,alt:""},null,8,Ne),t("div",we,r(p.fullName),1)])):M("v-if",!0),i.key==="action"?(f(),x("div",Ie,[s(D,{trigger:["click"],placement:"bottomRight"},{overlay:o(()=>[s(z,{class:"drop-down-container"},{default:o(()=>[p.position===e.CLASS_STUDENT_POSITION.STUDENT?(f(),F(C,{key:"1",onClick:A=>e.onConfirmUpdateMemberPosition(p.studentId,e.CLASS_STUDENT_POSITION.TEACHER)},{default:o(()=>[a[13]||(a[13]=t("i",{class:"bx bxs-id-card"},null,-1)),m(" "+r(d.$t("class_member.buttons.assign_lecturer")),1)]),_:2,__:[13]},1032,["onClick"])):(f(),F(C,{key:"2",onClick:A=>e.onConfirmUpdateMemberPosition(p.studentId,e.CLASS_STUDENT_POSITION.STUDENT)},{default:o(()=>[a[14]||(a[14]=t("i",{class:"bx bxs-id-card"},null,-1)),m(" "+r(d.$t("class_member.buttons.remove_lecturer")),1)]),_:2,__:[14]},1032,["onClick"])),s(C,{key:"3"},{default:o(()=>[a[15]||(a[15]=t("i",{class:"bx bx-history"},null,-1)),m(" "+r(d.$t("class_member.buttons.history_test")),1)]),_:1,__:[15]}),s(l,{style:{"background-color":"#ddd"}}),s(C,{key:"4",onClick:A=>e.onConfirmDeleteMember(p.studentId)},{default:o(()=>[t("span",he,[a[16]||(a[16]=t("i",{class:"bx bx-trash-alt"},null,-1)),m(" "+r(d.$t("question_sets_index.buttons.delete")),1)])]),_:2},1032,["onClick"])]),_:2},1024)]),default:o(()=>[a[17]||(a[17]=t("i",{class:"bx bx-dots-vertical-rounded student-action-dropdown"},null,-1))]),_:2,__:[17]},1024)])):M("v-if",!0)]),_:1},8,["data-source"]),t("div",xe,[s(L,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":a[2]||(a[2]=i=>e.pageParams.pageNumber=i),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(i,p)=>`${p[0]}-${p[1]} of ${i} ${e.t("class_member.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])]),t("div",Te,[t("div",ze,[t("div",null,[t("span",De,r(d.$t("class_member.danger_zone.title")),1),t("span",null,r(d.$t("class_member.danger_zone.sub_title")),1)])]),t("div",Ue,[t("div",Ee,r(d.$t("class_member.danger_zone.warning")),1),t("div",Pe,r(d.$t("class_member.danger_zone.warning_explain")),1),s(k,{class:"mt-3",type:"primary",danger:"",size:"large",onClick:e.onOpenConfirmDelete},{default:o(()=>[m(r(d.$t("class_member.buttons.delete_class")),1)]),_:1})])])])]),M(" invitation modal "),s(q,{width:"750px",centered:"","wrap-class-name":"medium-modal",open:e.modal_invitation_open,onCancel:a[7]||(a[7]=i=>e.modal_invitation_open=!1)},{footer:o(()=>[s(w,{layout:"vertical",class:"w-100 d-flex align-items-end justify-content-between"},{default:o(()=>[s(S,{label:e.t("class_member.modal.time_limit_label")},{default:o(()=>[s(_,{value:e.invitationFormState.expiredTime,"onUpdate:value":a[6]||(a[6]=i=>e.invitationFormState.expiredTime=i),style:{width:"200px"},onChange:e.getData},{default:o(()=>[(f(!0),x(V,null,K(e.code_limit_time,i=>(f(),F(N,{value:i.value},{default:o(()=>[m(r(i.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1},8,["label"]),s(S,null,{default:o(()=>[s(k,{loading:e.isInvitaionLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onResetInvitation},{default:o(()=>[m(r(d.$t("class_member.buttons.reset_code")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),default:o(()=>[t("div",Ae,[t("div",Fe,[s(E,{class:"w-100 d-flex align-items-center"},{default:o(()=>[s(U,{span:2},{default:o(()=>[s(b,{onClick:a[3]||(a[3]=i=>e.modal_invitation_open=!1),to:{name:""}},{default:o(()=>a[18]||(a[18]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[18]})]),_:1}),s(U,{class:"main-title",span:22},{default:o(()=>[t("span",null,r(d.$t("class_member.modal.title")),1),a[19]||(a[19]=m()),a[20]||(a[20]=t("br",null,null,-1)),t("span",null,r(d.$t("class_member.modal.sub_title")),1)]),_:1,__:[19,20]})]),_:1})]),t("div",Le,[s(P,{value:e.invitationFormState.code,class:"invitation-body-qrcode"},null,8,["value"]),s(w,{layout:"vertical",class:"invitation-body-link"},{default:o(()=>[s(S,{label:e.t("class_member.modal.class_code_label")},{default:o(()=>[t("div",Oe,[s(e.Input,{modelValue:e.invitationFormState.code,"onUpdate:modelValue":a[4]||(a[4]=i=>e.invitationFormState.code=i),"is-required":!0,"max-length":100,readonly:!0},null,8,["modelValue"]),t("i",{class:"bx bx-copy",onClick:e.onCopyInvitationCode})])]),_:1},8,["label"]),s(S,{label:e.t("class_member.modal.invitation_link")},{default:o(()=>[t("div",qe,[s(e.Input,{modelValue:e.invitationFormState.code,"onUpdate:modelValue":a[5]||(a[5]=i=>e.invitationFormState.code=i),"is-required":!0,"max-length":100,readonly:!0},null,8,["modelValue"]),t("i",{class:"bx bx-copy",onClick:e.onCopyInvitationLink})])]),_:1},8,["label"])]),_:1})]),s(O,null,{default:o(()=>[m(r(d.$t("class_member.modal.or")),1)]),_:1})])]),_:1},8,["open"])],64)}const Ge=ne(re,[["render",Re],["__scopeId","data-v-6a35c450"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/student.vue"]]);export{Ge as default};
