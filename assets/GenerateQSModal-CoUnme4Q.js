var xe=Object.defineProperty;var Te=(f,e,g)=>e in f?xe(f,e,{enumerable:!0,configurable:!0,writable:!0,value:g}):f[e]=g;var te=(f,e,g)=>Te(f,typeof e!="symbol"?e+"":e,g);import{c as l,I as Ie,d as ue,u as ve,i as S,j as re,B as he,C as me,s as ye,k as U,M as Z,_ as fe,r as v,E as oe,o as a,w as i,b as n,f as p,t as u,ah as le,p as V,a as s,F as L,D as R,e as G,G as se,v as be,L as ke,R as Se,ai as Ce,aj as Ee}from"./index-BTtyw8YW.js";import{A as Ae}from"./ApiTestTemplate-DKO1nVex.js";import{Q as ce}from"./questionTypes-CS3lcRlq.js";import{S as ne}from"./languages-DtYW231W.js";import{T as Me}from"./TextArea-BoIpbba0.js";var Oe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function ge(f){for(var e=1;e<arguments.length;e++){var g=arguments[e]!=null?Object(arguments[e]):{},t=Object.keys(g);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(g).filter(function(Q){return Object.getOwnPropertyDescriptor(g,Q).enumerable}))),t.forEach(function(Q){De(f,Q,g[Q])})}return f}function De(f,e,g){return e in f?Object.defineProperty(f,e,{value:g,enumerable:!0,configurable:!0,writable:!0}):f[e]=g,f}var ae=function(e,g){var t=ge({},e,g.attrs);return l(Ie,ge({},t,{icon:Oe}),null)};ae.displayName="InboxOutlined";ae.inheritAttrs=!1;const Le=ue({__name:"ImportQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(f,{expose:e,emit:g}){const{t}=ve(),Q=f,J=g,D=S(!1),h=S(),w=S(),I=S(),_=re({checkAll:!1,indeterminate:!1,checkedList:[]}),O=()=>{_.checkedList=[],D.value=!0},E=()=>{D.value=!1};e({openImportModal:O});const k=S([]),A=S(null),o=S(!1),F=()=>{var d;(d=A.value)==null||d.click()},P=async d=>{var B;const b=(B=d.target.files)==null?void 0:B[0];if(b){k.value=[],U.success(b.name+" uploaded successfully."),k.value.push(b);const z=await Ae.ImportFile(k.value[0]);z.data.success&&(h.value=[...z.data.data.validQuestions,...z.data.data.invalidQuestions],w.value=[...z.data.data.validQuestions,...z.data.data.invalidQuestions],I.value=z.data.data.invalidQuestions);return}U.error("Upload failed")},M=d=>{var b;const y=((b=d.dataTransfer)==null?void 0:b.types)||[];Array.from(y).includes("files")&&(o.value=!0)},H=d=>{var b;const y=(b=d.dataTransfer)==null?void 0:b.files[0];if(o.value=!1,y){k.value=[],U.success(y.name+" uploaded successfully."),k.value.push(y);return}U.error("Upload failed")},r=d=>{var y;(y=k.value)==null||y.splice(d,1),_.checkedList=[],h.value=[],I.value=[],w.value=[]},j=["all","valid","invalid"],x=he(()=>j.map(d=>({label:d,value:d}))),K=S(x.value[0].value),X=()=>{var y,b;_.checkedList=[];let d=h.value;switch(K.value){case"valid":{d=(y=h.value)==null?void 0:y.filter(B=>{var z;return!((z=I.value)!=null&&z.includes(B))});break}case"invalid":{d=(b=h.value)==null?void 0:b.filter(B=>{var z;return(z=I.value)==null?void 0:z.includes(B)});break}}w.value=d},W=d=>{Object.assign(_,{checkedList:d.target.checked?w.value:[],indeterminate:!1})};me(()=>_.checkedList,d=>{var y;_.indeterminate=!!d.length&&d.length<w.value.length,_.checkAll=d.length===((y=w.value)==null?void 0:y.length)});const m=(d,y)=>{$(y).toggleClass("bx-chevron-up bx-chevron-down");const B=$(`#question-item-answer-${d}`);B&&$(B).slideToggle()},q=()=>{if(_.checkedList.length===0){U.warning(t("message.minimum_question",{number:5}));return}if(_.checkedList.length+Q.numberOfQuestion>500){U.warning(t("message.limit_question",{number:500}));return}Z.confirm({title:"Are your sure? ",content:"Import: "+_.checkedList.length+" into "+Q.title+" ? ",okText:"Confirm",onOk:()=>{var y;const d=(y=w.value)==null?void 0:y.filter(b=>_.checkedList.includes(b));J("import",d),E()}})};ye(()=>{});const C={t,props:Q,emit:J,modal_import_open:D,question_data:h,uploadedQuestions:w,uploadedInvalidQuestions:I,importModalState:_,openImportModal:O,closeImportModal:E,files:k,fileInput:A,isDragging:o,openFileExplorer:F,handleFileChange:P,handleDragEnter:M,handleDrop:H,onRemoveUploadedFile:r,optionKeys:j,select_options:x,selected_option:K,onFilter:X,onCheckAll:W,toggleDisplayAnswer:m,handleModalImport:q,get InboxOutlined(){return ae},get QUESTION_TYPE(){return ce}};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}}),Ge={class:"modal-container"},Qe={class:"modal-title-container"},Ue={class:"modal-content-item"},Fe={class:"content-item-section upload-section"},Pe={class:"section-title"},ze={class:"section-content"},Ne={class:"customized-file-upload-icons"},Re={class:"file-container"},qe={class:"file-item"},Be=["onClick"],Je={class:"content-item-section preview-section"},He={class:"section-content"},je={key:0,class:"section-content-header"},Ye={class:"d-flex"},Ve={class:"preview-question-container"},Ke={class:"question-item-content"},Xe=["innerHTML"],We={key:1,class:"question-text"},Ze=["id"],$e={key:0,class:"multiple-choice-answer"},et={key:0,class:"text-success"},tt={class:"pair-answer"},nt={class:"pair-answer-item"},ot={class:"pair-answer-item"},lt={key:2,class:"ordering-answer"},at={class:"ordering-answer-item"},st={class:"ordering-answer-item"},it={class:"ordering-answer-item"},rt={class:"short-text-answer"},ct={class:"question-item-toogle-btn"},dt=["onClick"],ut={class:"header-item"};function mt(f,e,g,t,Q,J){const D=v("RouterLink"),h=v("a-col"),w=v("a-row"),I=v("a-button"),_=v("a-checkbox"),O=v("a-select-option"),E=v("a-select"),k=v("a-checkbox-group"),A=v("a-modal");return a(),oe(A,{centered:"",width:"100%","wrap-class-name":"full-modal",open:t.modal_import_open,onCancel:t.closeImportModal},{footer:i(()=>[n("div",ut," Total: "+u(t.importModalState.checkedList.length)+" questions ",1),l(I,{class:"main-color-btn",size:"large",key:"submit",type:"primary",onClick:t.handleModalImport},{default:i(()=>e[16]||(e[16]=[p(" Import ")])),_:1,__:[16]})]),default:i(()=>[n("div",Ge,[n("div",Qe,[l(w,{class:"w-100 d-flex align-items-center"},{default:i(()=>[l(h,{span:1},{default:i(()=>[l(D,{onClick:t.closeImportModal,to:{name:""}},{default:i(()=>e[5]||(e[5]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[5]})]),_:1}),l(h,{class:"main-title",span:23},{default:i(()=>[n("span",null,u(f.$t("create_QS.title")),1),e[6]||(e[6]=p()),e[7]||(e[7]=n("br",null,null,-1)),n("span",null,u(f.$t("create_QS.sub_title")),1)]),_:1,__:[6,7]})]),_:1})]),n("div",Ue,[n("div",Fe,[n("div",Pe,[e[9]||(e[9]=n("span",null,"Upload",-1)),l(I,{class:"main-color-btn",type:"primary"},{default:i(()=>e[8]||(e[8]=[p("Download template")])),_:1,__:[8]})]),n("div",ze,[n("input",{onChange:t.handleFileChange,class:"d-none",type:"file",ref:"fileInput"},null,544),n("div",{class:V(["customized-file-upload",t.isDragging?"is-dragging":""]),onClick:t.openFileExplorer,onDragenter:t.handleDragEnter,onDragover:e[0]||(e[0]=le(o=>t.isDragging=!0,["prevent"])),onDragleave:e[1]||(e[1]=o=>t.isDragging=!1),onDrop:le(t.handleDrop,["prevent"])},[n("div",Ne,[n("i",{class:V(["bx","bx-down-arrow-alt","bx-fade-up",t.isDragging?"":"d-none"])},null,2),l(t.InboxOutlined,{class:V([t.isDragging?"d-none":""])},null,8,["class"])]),e[10]||(e[10]=n("div",{class:"customized-file-upload-ins"},[n("strong",null,"Click"),p(" or "),n("strong",null,"drag"),p(" file to this area to upload ")],-1)),e[11]||(e[11]=n("div",{class:"customized-file-upload-hint"},[p(" Please use the template above to ensure the file is read correctly."),n("br"),p(" Support for a single upload. ")],-1))],34)]),n("div",Re,[(a(!0),s(L,null,R(t.files,(o,F)=>(a(),s("div",qe,[n("span",null,u(o.name),1),n("i",{class:"bx bx-trash text-danger",onClick:P=>t.onRemoveUploadedFile(F)},null,8,Be)]))),256))])]),n("div",Je,[e[15]||(e[15]=n("div",{class:"section-title"},"Preview",-1)),n("div",He,[t.files.length>0?(a(),s("div",je,[n("div",{class:V(["header-item",t.importModalState.checkAll?"check-all":""])},[l(_,{onClick:t.onCheckAll,checked:t.importModalState.checkAll,"onUpdate:checked":e[2]||(e[2]=o=>t.importModalState.checkAll=o),indeterminate:t.importModalState.indeterminate},null,8,["checked","indeterminate"]),p(" Check all ("+u(t.importModalState.checkedList.length)+") ",1)],2),n("div",Ye,[l(E,{size:"large",class:"me-3",value:t.selected_option,"onUpdate:value":e[3]||(e[3]=o=>t.selected_option=o),style:{width:"200px"},onChange:t.onFilter},{default:i(()=>[(a(!0),s(L,null,R(t.select_options,o=>(a(),oe(O,{value:o.value},{default:i(()=>[p(u(o.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])])):G("v-if",!0),l(k,{value:t.importModalState.checkedList,"onUpdate:value":e[4]||(e[4]=o=>t.importModalState.checkedList=o)},{default:i(()=>[n("div",Ve,[(a(!0),s(L,null,R(t.uploadedQuestions,(o,F)=>{var P;return a(),s("div",{class:V(["preview-question-item",(P=t.uploadedInvalidQuestions)!=null&&P.includes(o)?"invalid":""])},[l(_,{value:o},null,8,["value"]),n("div",Ke,[o.questionHTML?(a(),s("div",{key:0,class:"question-html",innerHTML:o.questionHTML},null,8,Xe)):(a(),s("div",We,u(o.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${F}`},[o.type===t.QUESTION_TYPE.MULTIPLE_CHOICE?(a(),s("div",$e,[n("ul",null,[(a(!0),s(L,null,R(o.multipleChoices,M=>(a(),s("li",null,[p(u(M.text)+" ",1),M.isAnswer?(a(),s("span",et," ("+u(M.isAnswer)+") ",1)):G("v-if",!0)]))),256))])])):G("v-if",!0),o.type===t.QUESTION_TYPE.MATCHING?(a(!0),s(L,{key:1},R(o.matchingPairs,M=>(a(),s("div",tt,[n("span",nt,u(M.leftItem),1),e[12]||(e[12]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",ot,u(M.rightItem),1)]))),256)):G("v-if",!0),o.type===t.QUESTION_TYPE.ORDERING?(a(),s("div",lt,[n("div",at,[(a(!0),s(L,null,R(o.orderingItems,M=>(a(),s("div",null,u(M.text),1))),256))]),e[13]||(e[13]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",st,[(a(!0),s(L,null,R(o.orderingItems,(M,H)=>(a(),s("div",it,[n("span",null,"#"+u(H+1),1),p(" - "+u(M.text),1)]))),256))])])):G("v-if",!0),o.type===t.QUESTION_TYPE.SHORT_TEXT?(a(),s(L,{key:3},[e[14]||(e[14]=n("span",null,"Answer:",-1)),n("div",rt,u(o.shortAnswer),1)],64)):G("v-if",!0)],8,Ze)]),n("div",ct,[n("i",{class:"bx bx-chevron-up",onClick:M=>t.toggleDisplayAnswer(F,M.currentTarget)},null,8,dt)])],2)}),256))])]),_:1},8,["value"])])])])])]),_:1},8,["open"])}const vn=fe(Le,[["render",mt],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/ImportQSModal.vue"]]),ft={HARD:"Hard",MEDIUM:"Medium",EASY:"Easy"},ie={GENERATE_QUESTION:"AiGenerate/GenerateQuestion",GENERATE_DOCUMENT_STRUCTURE:"AiGenerate/GenerateDocumentStructure",GET_COST_TO_GENERATE:"AiGenerate/DocumentStructure/GetCostToGenerate"};class _t{constructor(){te(this,"GenerateQuestion",async e=>await se.post(ie.GENERATE_QUESTION,e,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0}));te(this,"GenerateDocumentStructure",async e=>{const g=new FormData;return g.append("file",e),await se.post(ie.GENERATE_DOCUMENT_STRUCTURE,g,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})});te(this,"GetCostToGenerate",async e=>{const g=new FormData;return g.append("file",e),await se.post(ie.GET_COST_TO_GENERATE,g,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})})}}const de=new _t,pt=ue({__name:"GenerateFileStructure",props:{file:{type:null,required:!0}},emits:["import"],setup(f,{expose:e,emit:g}){const t=f,Q=be(ke,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),J=S(),D=S([]);function h(m){return m?Array.isArray(m)?m:[m]:[]}function w(m){return h(m).map(C=>{const d=h(C==null?void 0:C.children);return{...C,title:String((C==null?void 0:C.title)??""),key:crypto.randomUUID(),children:d.length?w(d):void 0}})}const I=S([]),_=S([]);function O(m,q){const C=[];for(const d of m){const y=q.includes(d.key),b=d.children?O(d.children,q):[];(y||b.length>0)&&C.push({title:d.title,key:d.key,children:b.length?b:void 0})}return C}const E=he(()=>O(I.value,_.value));me(I,async()=>{I.value.length>0&&(await Se(),J.value&&(J.value.scrollTop=0))});const k=S(null),A=S(!1),o=S(!1),F=async()=>{try{o.value=!0;const m=await de.GetCostToGenerate(t.file);return m.data.success?m.data.data:(Z.error({title:"Error",content:m.data.message||"Failed to get cost to generate."}),null)}catch(m){return console.error(m),null}finally{o.value=!1}},P=async()=>{try{o.value=!0;const m=await de.GenerateDocumentStructure(t.file);if(!m.data.success){Z.error({title:"Error",content:m.data.message||"Failed to generate file structure."});return}const q=typeof m.data=="string"?JSON.parse(m.data):m.data,C=q==null?void 0:q.data,d=h(C==null?void 0:C.children);D.value=d,I.value=w(D.value)}catch(m){console.error(m)}finally{o.value=!1,r.value=!1}},M=async()=>{if(A.value=!0,D.value.length>0||k.value)return;const m=await F();if(!m){U.error("Failed to get cost to generate file structure.");return}k.value=m,r.value=!0},H=()=>{A.value=!1},r=S(!1),j=async()=>{k.value&&await P()},x=g,K=()=>{var y,b;if(E.value.length===0){Z.error({title:"Error",content:"Please choose at least one section in your document to proceed.",centered:!0});return}const m=(y=I.value)==null?void 0:y[0],q=JSON.stringify({title:m.title,children:m.children}),C=(b=E.value)==null?void 0:b[0],d=JSON.stringify({title:C.title,children:C.children});x("import",q,d),H()},X=()=>{D.value=[],I.value=[],k.value=null};e({openModal:M,closeModal:H,clearData:X});const W={props:t,indicator:Q,modalContentRef:J,serverData:D,toArray:h,addRandomKeys:w,treeData:I,checked:_,filterTree:O,selectedTree:E,cost:k,modal_open:A,loading:o,getCostToGenerate:F,generateTreeData:P,openModal:M,closeModal:H,modal_confirm_generate_structure_open:r,onConfirmGenerateFileStructure:j,emit:x,onConfirmImportStructure:K,clearData:X,get ExclamationCircleFilled(){return Ee},get ATree(){return Ce}};return Object.defineProperty(W,"__isScriptSetup",{enumerable:!1,value:!0}),W}}),gt={class:"modal-container"},vt={class:"modal-title-container"},ht={class:"modal-content-item",ref:"modalContentRef"},yt={key:0,class:"loading-container"},bt={key:0},kt={key:1,class:"content-wrapper"},St={key:0,class:"tree-container"},wt={class:"button-container"},xt={class:"confirm-modal-container"},Tt={class:"d-flex align-items-center"},It={class:"fs-6 ms-5 mt-3"},Ct={class:"text-danger"};function Et(f,e,g,t,Q,J){const D=v("RouterLink"),h=v("a-col"),w=v("a-row"),I=v("a-spin"),_=v("a-button"),O=v("a-modal");return a(),s(L,null,[l(O,{centered:"",width:"100%","wrap-class-name":"medium-modal large",open:t.modal_open,onCancel:t.closeModal},{footer:i(()=>[l(_,{class:"main-color-btn",type:"primary",onClick:t.onConfirmImportStructure},{default:i(()=>e[7]||(e[7]=[p(" Confirm ")])),_:1,__:[7]})]),default:i(()=>[n("div",gt,[n("div",vt,[l(w,{class:"w-100 d-flex align-items-center"},{default:i(()=>[l(h,{span:1},{default:i(()=>[l(D,{onClick:t.closeModal,to:{name:""}},{default:i(()=>e[3]||(e[3]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[3]})]),_:1}),l(h,{class:"main-title",span:23},{default:i(()=>[n("span",null,u(f.$t("create_QS.title")),1),e[4]||(e[4]=p()),e[5]||(e[5]=n("br",null,null,-1)),n("span",null,u(f.$t("create_QS.sub_title")),1)]),_:1,__:[4,5]})]),_:1})]),n("div",ht,[t.loading?(a(),s("div",yt,[l(I,{size:"large",indicator:t.indicator},null,8,["indicator"]),t.cost?G("v-if",!0):(a(),s("div",bt,"Calculating cost to generate file"))])):(a(),s("div",kt,[t.treeData.length>0?(a(),s("div",St,[l(t.ATree,{checkedKeys:t.checked,"onUpdate:checkedKeys":e[0]||(e[0]=E=>t.checked=E),"tree-data":t.treeData,checkable:"","show-icon":!1,"show-line":!0,"field-names":{title:"title",key:"key",children:"children"},defaultExpandAll:!0,style:{width:"100%"}},null,8,["checkedKeys","tree-data"])])):t.cost?(a(),s(L,{key:1},[G(" get cost success but cancel "),n("div",wt,[l(_,{type:"primary",class:"main-color-btn",onClick:e[1]||(e[1]=E=>t.modal_confirm_generate_structure_open=!0)},{default:i(()=>e[6]||(e[6]=[p(" Generate File Structure ")])),_:1,__:[6]})])],2112)):G("v-if",!0)]))],512)])]),_:1},8,["open"]),l(O,{"wrap-class-name":"medium-modal",centered:"",open:t.modal_confirm_generate_structure_open,closable:!1},{footer:i(()=>[l(_,{class:V(["main-color-btn-ghost",t.loading?"main-color-btn-disabled":""]),type:"ghost",onClick:e[2]||(e[2]=E=>t.modal_confirm_generate_structure_open=!1)},{default:i(()=>e[11]||(e[11]=[p(" Cancel ")])),_:1,__:[11]},8,["class"]),l(_,{loading:t.loading,class:"main-color-btn",type:"primary",onClick:t.onConfirmGenerateFileStructure},{default:i(()=>e[12]||(e[12]=[p("Confirm")])),_:1,__:[12]},8,["loading"])]),default:i(()=>{var E;return[n("div",xt,[n("div",Tt,[l(t.ExclamationCircleFilled,{class:"fs-4 me-3 text-warning"}),e[8]||(e[8]=n("div",{class:"fs-6 fw-bold"}," Are you sure you want to generate the file structure? ",-1))]),n("div",It,[e[9]||(e[9]=p(" You will need at least ")),n("span",Ct,u((E=t.cost)==null?void 0:E.miniumPointToGenerate),1),e[10]||(e[10]=p(" point to process this file. "))])])]}),_:1},8,["open"])],64)}const At=fe(pt,[["render",Et],["__scopeId","data-v-8be2b719"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateFileStructure.vue"]]),Mt=ue({__name:"GenerateQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(f,{expose:e,emit:g}){const{t}=ve(),Q=f,J=g,D=S(!1),h=()=>{A.checkedList=[],D.value=!0},w=()=>{D.value=!1};e({openGenerateAIModal:h});const I=()=>{if(A.checkedList.length===0){U.warning(t("message.minimum_question",{number:5}));return}if(A.checkedList.length+Q.numberOfQuestion>500){U.warning(t("message.limit_question",{number:500}));return}Z.confirm({title:"Are your sure? ",content:"Import: "+A.checkedList.length+"into "+Q.title+" ? ",okText:"Confirm",onOk:()=>{const c=k.value.filter(T=>A.checkedList.includes(T.id));J("import",c),w()}})},_=Object.values(ce).map(c=>({label:t(`create_QS.type.${c}`),value:c})),O=Object.values(ft).map(c=>({label:c,value:c})),E=S([]);for(let c=10;c<=50;c+=10)E.value.push({label:c,value:c});const k=S([]),A=re({checkAll:!1,indeterminate:!1,checkedList:[]}),o=re({file:null,isGenerateExplain:!0,language:ne[0].code,questionCount:E.value[0].value,questionTypes:[_[0]],documentStructureJson:null,selectedPartJson:null,title:""}),F=c=>{o.questionTypes.length===0&&(U.warning("At least one question type must be selected."),o.questionTypes.push(c))},P=S(!1),M=be(ke,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),H=async()=>{var c;try{if(P.value=!0,!o.title&&o.isGenerateExplain){U.error("Please enter a reference for the document citation.");return}if(o.documentStructureJson===null||o.selectedPartJson===null){Z.error({title:"Error",content:"Please choose at least one section in your document to proceed.",centered:!0}),B();return}const T=JSON.parse(o.documentStructureJson),Y=JSON.parse(o.selectedPartJson);o.isGenerateExplain&&o.title&&(o.documentStructureJson=JSON.stringify({...T,title:o.title}),o.selectedPartJson=JSON.stringify({...Y,title:o.title}));const N=new FormData;N.append("file",r.value[0]),N.append("isGenerateExplain",o.isGenerateExplain?"true":"false"),N.append("language",((c=ne.find(ee=>ee.code===o.language))==null?void 0:c.label)||ne[0].label),N.append("questionCount",o.questionCount),N.append("questionTypes",JSON.stringify(o.questionTypes.map(ee=>ee))),N.append("documentStructureJson",o.documentStructureJson),N.append("selectedPartJson",o.selectedPartJson);const pe=await de.GenerateQuestion(N);if(!pe.data.success){U.error("Generate failed!");return}k.value=[...k.value||[],...pe.data.data.map((ee,we)=>({...ee,id:we}))]}catch(T){console.log(T)}finally{P.value=!1}},r=S([]),j=S(null),x=S(!1),K=()=>{var c;(c=j.value)==null||c.click()},X=async c=>{if(c){if(c.type!=="application/pdf"){U.error("Only PDF files are supported.");return}r.value=[],U.success(c.name+" uploaded successfully."),r.value.push(c);const T=c.name.replace(/\.[^/.]+$/,"");o.title=T,await Se(),B();return}U.error("Upload failed")},W=c=>{var N;const T=c.target,Y=(N=T.files)==null?void 0:N[0];Y&&(X(Y),T.value="")},m=c=>{var Y;const T=((Y=c.dataTransfer)==null?void 0:Y.types)||[];Array.from(T).includes("files")&&(x.value=!0)},q=async c=>{var Y;const T=(Y=c.dataTransfer)==null?void 0:Y.files[0];x.value=!1,T&&X(T)},C=()=>{var c;r.value=[],(c=b.value)==null||c.clearData()},d=c=>{Object.assign(A,{checkedList:c.target.checked?k.value.map(T=>T.id):[],indeterminate:!1})};me(()=>A.checkedList,c=>{A.indeterminate=!!c.length&&c.length<k.value.map(T=>T.id).length,A.checkAll=c.length===k.value.length});const y=(c,T)=>{$(T).toggleClass("bx-chevron-up bx-chevron-down");const N=$(`#question-item-answer-${c}`);N&&$(N).slideToggle()},b=S(null),B=()=>{b.value&&b.value.openModal()},z=(c,T)=>{o.documentStructureJson=c,o.selectedPartJson=T};ye(()=>{});const _e={t,props:Q,emit:J,modal_generate_ai_open:D,openGenerateAIModal:h,closeGenerateAIModal:w,handleModalImport:I,questionTypeOptions:_,questionDifficultyOptions:O,questionMaximumOptions:E,generatedQuestions:k,generateModalState:A,generateByAIModalState:o,onDeselectQuestionType:F,loading:P,indicator:M,onGenerateQuestions:H,files:r,fileInput:j,isDragging:x,openFileExplorer:K,onFileChange:X,handleFileChange:W,handleDragEnter:m,handleDrop:q,onRemoveUploadedFile:C,onCheckAll:d,toggleDisplayAnswer:y,generateFileStructureRef:b,openFileStructureModal:B,handleImportStructure:z,get QUESTION_TYPE(){return ce},get SUPPORTED_LOCALES(){return ne},get InboxOutlined(){return ae},TextArea:Me,GenerateFileStructure:At};return Object.defineProperty(_e,"__isScriptSetup",{enumerable:!1,value:!0}),_e}}),Ot={class:"modal-container"},Dt={class:"modal-title-container"},Lt={class:"modal-content-item"},Gt={class:"content-item-section upload-section"},Qt={key:0,class:"section-content mb-2"},Ut={class:"customized-file-upload-icons"},Ft={key:1,class:"file-container"},Pt={class:"file-item"},zt={class:"content-item-section preview-section"},Nt={key:0,class:"loading-container"},Rt={key:1,class:"section-content"},qt={class:"section-content-header"},Bt={class:"header-item"},Jt={class:"preview-question-container"},Ht={class:"preview-question-item"},jt={class:"question-item-content"},Yt=["innerHTML"],Vt={key:1,class:"question-text"},Kt=["id"],Xt={key:0,class:"multiple-choice-answer"},Wt={key:0,class:"text-success"},Zt={class:"pair-answer"},$t={class:"pair-answer-item"},en={class:"pair-answer-item"},tn={key:2,class:"ordering-answer"},nn={class:"ordering-answer-item"},on={class:"ordering-answer-item"},ln={class:"ordering-answer-item"},an={class:"short-text-answer"},sn={class:"question-item-toogle-btn"},rn=["onClick"],cn={class:"w-100 d-flex justify-content-end"};function dn(f,e,g,t,Q,J){const D=v("RouterLink"),h=v("a-col"),w=v("a-row"),I=v("a-select-option"),_=v("a-select"),O=v("a-form-item"),E=v("a-switch"),k=v("a-button"),A=v("a-form"),o=v("a-spin"),F=v("a-checkbox"),P=v("a-checkbox-group"),M=v("a-modal");return a(),s(L,null,[l(M,{centered:"",width:"100%","wrap-class-name":"full-modal",open:t.modal_generate_ai_open,onCancel:t.closeGenerateAIModal},{footer:i(()=>e[25]||(e[25]=[])),default:i(()=>{var H;return[n("div",Ot,[n("div",Dt,[l(w,{class:"w-100 d-flex align-items-center"},{default:i(()=>[l(h,{span:1},{default:i(()=>[l(D,{onClick:t.closeGenerateAIModal,to:{name:""}},{default:i(()=>e[11]||(e[11]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[11]})]),_:1}),l(h,{class:"main-title",span:23},{default:i(()=>[n("span",null,u(f.$t("create_QS.title")),1),e[12]||(e[12]=p()),e[13]||(e[13]=n("br",null,null,-1)),n("span",null,u(f.$t("create_QS.sub_title")),1)]),_:1,__:[12,13]})]),_:1})]),n("div",Lt,[n("div",Gt,[e[18]||(e[18]=n("div",{class:"section-title"},[n("span",null,"Upload")],-1)),t.files.length?G("v-if",!0):(a(),s("div",Qt,[n("input",{onChange:t.handleFileChange,class:"d-none",type:"file",ref:"fileInput",accept:".pdf"},null,544),n("div",{class:V(["customized-file-upload",t.isDragging?"is-dragging":""]),onClick:t.openFileExplorer,onDragenter:t.handleDragEnter,onDragover:e[0]||(e[0]=le(r=>t.isDragging=!0,["prevent"])),onDragleave:e[1]||(e[1]=r=>t.isDragging=!1),onDrop:le(t.handleDrop,["prevent"])},[n("div",Ut,[n("i",{class:V(["bx","bx-down-arrow-alt","bx-fade-up",t.isDragging?"":"d-none"])},null,2),l(t.InboxOutlined,{class:V([t.isDragging?"d-none":""])},null,8,["class"])]),e[14]||(e[14]=n("div",{class:"customized-file-upload-ins"},[n("strong",null,"Click"),p(" or "),n("strong",null,"drag"),p(" file to this area to upload ")],-1)),e[15]||(e[15]=n("div",{class:"customized-file-upload-hint"},[p(" Please use the template above to ensure the file is read correctly."),n("br"),p(" Support for a single upload. ")],-1))],34)])),t.files.length?(a(),s("div",Ft,[(a(!0),s(L,null,R(t.files,r=>(a(),s("div",Pt,[n("span",null,u(r.name),1),n("i",{class:"bx bx-trash text-danger",onClick:e[2]||(e[2]=j=>t.onRemoveUploadedFile())})]))),256)),n("div",{class:"file-structure",onClick:t.openFileStructureModal},e[16]||(e[16]=[n("i",{class:"bx bx-file"},null,-1),n("div",null,"Structure",-1)]))])):G("v-if",!0),l(A,{layout:"vertical",class:"generate-ai-form"},{default:i(()=>[l(w,{class:"d-flex justify-content-between"},{default:i(()=>[G(` <a-col :span="12">
                                <a-form-item label="Difficulty">
                                    <a-select
                                        v-model:value="generateByAIModalState.difficulty"
                                        style="width: 100%"
                                        :placeholder="'Difficulty of questions'"
                                        :options="questionDifficultyOptions"
                                    />
                                </a-form-item>
                            </a-col> `),l(h,{span:12},{default:i(()=>[l(O,{label:"Language"},{default:i(()=>[l(_,{class:"language-select",value:t.generateByAIModalState.language,"onUpdate:value":e[3]||(e[3]=r=>t.generateByAIModalState.language=r)},{default:i(()=>[(a(!0),s(L,null,R(t.SUPPORTED_LOCALES,r=>(a(),oe(I,{key:`locale-${r.code}`,value:r.code},{default:i(()=>[p(u(r.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),l(h,{span:11},{default:i(()=>[l(O,{label:"Maximum question"},{default:i(()=>[l(_,{value:t.generateByAIModalState.questionCount,"onUpdate:value":e[4]||(e[4]=r=>t.generateByAIModalState.questionCount=r),style:{width:"100%"},placeholder:"Maximum number of question",options:t.questionMaximumOptions},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),l(O,{label:"Question types"},{default:i(()=>[l(_,{onDeselect:t.onDeselectQuestionType,value:t.generateByAIModalState.questionTypes,"onUpdate:value":e[5]||(e[5]=r=>t.generateByAIModalState.questionTypes=r),mode:"multiple",style:{width:"100%"},placeholder:"Select multiple",options:t.questionTypeOptions},null,8,["value","options"])]),_:1}),l(w,{class:"d-flex justify-content-between"},{default:i(()=>[l(h,{span:7},{default:i(()=>[l(O,{label:"Enable explaination"},{default:i(()=>[l(E,{checked:t.generateByAIModalState.isGenerateExplain,"onUpdate:checked":e[6]||(e[6]=r=>t.generateByAIModalState.isGenerateExplain=r)},null,8,["checked"])]),_:1})]),_:1}),t.generateByAIModalState.isGenerateExplain?(a(),oe(h,{key:0,span:16},{default:i(()=>[l(O,{label:"Reference name"},{default:i(()=>[l(t.TextArea,{modelValue:t.generateByAIModalState.title,"onUpdate:modelValue":e[7]||(e[7]=r=>t.generateByAIModalState.title=r),"is-required":t.generateByAIModalState.isGenerateExplain,"max-length":200,placeholder:"Enter document title for citation",readonly:!t.generateByAIModalState.isGenerateExplain},null,8,["modelValue","is-required","readonly"])]),_:1})]),_:1})):G("v-if",!0)]),_:1}),l(O,{style:{"margin-top":"7px"},class:"generate-ai-btn-container"},{default:i(()=>[l(k,{loading:t.loading,size:"large",class:"w-100 main-color-btn generate_ai",type:"primary",onClick:t.onGenerateQuestions},{default:i(()=>e[17]||(e[17]=[p(" ✨ Generate ")])),_:1,__:[17]},8,["loading"])]),_:1})]),_:1})]),n("div",zt,[e[23]||(e[23]=n("div",{class:"section-title"},"Preview",-1)),t.loading?(a(),s("div",Nt,[l(o,{size:"large",indicator:t.indicator},null,8,["indicator"])])):(a(),s("div",Rt,[n("div",qt,[l(F,{class:V(["header-item",t.generateModalState.checkAll?"check-all":""]),onClick:t.onCheckAll,checked:t.generateModalState.checkAll,"onUpdate:checked":e[8]||(e[8]=r=>t.generateModalState.checkAll=r),indeterminate:t.generateModalState.indeterminate},{default:i(()=>[p(" Check all ("+u(t.generateModalState.checkedList.length)+") ",1)]),_:1},8,["class","checked","indeterminate"]),n("div",Bt," Total: "+u((H=t.generatedQuestions)==null?void 0:H.length)+" questions ",1)]),l(P,{value:t.generateModalState.checkedList,"onUpdate:value":e[10]||(e[10]=r=>t.generateModalState.checkedList=r)},{default:i(()=>[n("div",Jt,[(a(!0),s(L,null,R(t.generatedQuestions,(r,j)=>(a(),s("div",Ht,[l(F,{onClick:e[9]||(e[9]=x=>console.log(t.generateModalState.checkedList)),value:r.id},null,8,["value"]),n("div",jt,[r.questionHTML?(a(),s("div",{key:0,class:"question-html",innerHTML:r.questionHTML},null,8,Yt)):(a(),s("div",Vt,u(r.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${j}`},[r.type===t.QUESTION_TYPE.MULTIPLE_CHOICE?(a(),s("div",Xt,[n("ul",null,[(a(!0),s(L,null,R(r.multipleChoices,x=>(a(),s("li",null,[p(u(x.text)+" ",1),x.isAnswer?(a(),s("span",Wt," ("+u(x.isAnswer)+") ",1)):G("v-if",!0)]))),256))])])):G("v-if",!0),r.type===t.QUESTION_TYPE.MATCHING?(a(!0),s(L,{key:1},R(r.matchingPairs,x=>(a(),s("div",Zt,[n("span",$t,u(x.leftItem),1),e[19]||(e[19]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",en,u(x.rightItem),1)]))),256)):G("v-if",!0),r.type===t.QUESTION_TYPE.ORDERING?(a(),s("div",tn,[n("div",nn,[(a(!0),s(L,null,R(r.orderingItems,x=>(a(),s("div",null,u(x.text),1))),256))]),e[20]||(e[20]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",on,[(a(!0),s(L,null,R(r.orderingItems,(x,K)=>(a(),s("div",ln,[n("span",null,"#"+u(K+1),1),p(" - "+u(x.text),1)]))),256))])])):G("v-if",!0),r.type===t.QUESTION_TYPE.SHORT_TEXT?(a(),s(L,{key:3},[e[21]||(e[21]=n("span",null,"Answer:",-1)),n("div",an,u(r.shortAnswer),1)],64)):G("v-if",!0)],8,Kt)]),n("div",sn,[n("i",{class:"bx bx-chevron-up",onClick:x=>t.toggleDisplayAnswer(j,x.currentTarget)},null,8,rn)])]))),256))])]),_:1},8,["value"])])),e[24]||(e[24]=n("div",{class:"modal-generate-by-ai-warning"},[n("span",null,[n("i",{class:"bx bx-info-circle"}),p(" AI can make mistakes. Please check carefully the important info. ")])],-1)),n("div",cn,[l(k,{class:"main-color-btn",key:"submit",type:"primary",size:"large",onClick:t.handleModalImport},{default:i(()=>e[22]||(e[22]=[p(" Import ")])),_:1,__:[22]})])])])])]}),_:1},8,["open"]),l(t.GenerateFileStructure,{file:t.files[0],ref:"generateFileStructureRef",onImport:t.handleImportStructure},null,8,["file"])],64)}const hn=fe(Mt,[["render",dn],["__scopeId","data-v-23b34ba3"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateQSModal.vue"]]);export{hn as G,vn as I};
