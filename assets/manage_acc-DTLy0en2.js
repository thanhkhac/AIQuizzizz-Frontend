import{y as E,d as Ie,q as je,u as xe,z as oe,s as Oe,i as qe,j as Ce,M as D,_ as Ae,r as j,c as A,o as S,e as y,b as x,a as w,w as v,t as F,F as ie,B as se,C as L,f as P}from"./index-DlVciecZ.js";import{I as Ne}from"./Input-DHZLWcQT.js";import{A as z}from"./ApiAdmin-DDvlYIZr.js";var W,ce;function we(){if(ce)return W;ce=1;function o(t){var s=typeof t;return t!=null&&(s=="object"||s=="function")}return W=o,W}var V,le;function Ue(){if(le)return V;le=1;var o=typeof E=="object"&&E&&E.Object===Object&&E;return V=o,V}var K,ue;function Se(){if(ue)return K;ue=1;var o=Ue(),t=typeof self=="object"&&self&&self.Object===Object&&self,s=o||t||Function("return this")();return K=s,K}var Q,de;function Be(){if(de)return Q;de=1;var o=Se(),t=function(){return o.Date.now()};return Q=t,Q}var H,me;function Pe(){if(me)return H;me=1;var o=/\s/;function t(s){for(var e=s.length;e--&&o.test(s.charAt(e)););return e}return H=t,H}var X,fe;function ze(){if(fe)return X;fe=1;var o=Pe(),t=/^\s+/;function s(e){return e&&e.slice(0,o(e)+1).replace(t,"")}return X=s,X}var J,ge;function ke(){if(ge)return J;ge=1;var o=Se(),t=o.Symbol;return J=t,J}var Y,_e;function Me(){if(_e)return Y;_e=1;var o=ke(),t=Object.prototype,s=t.hasOwnProperty,e=t.toString,c=o?o.toStringTag:void 0;function p(f){var g=s.call(f,c),d=f[c];try{f[c]=void 0;var r=!0}catch{}var m=e.call(f);return r&&(g?f[c]=d:delete f[c]),m}return Y=p,Y}var Z,be;function Ee(){if(be)return Z;be=1;var o=Object.prototype,t=o.toString;function s(e){return t.call(e)}return Z=s,Z}var $,ve;function De(){if(ve)return $;ve=1;var o=ke(),t=Me(),s=Ee(),e="[object Null]",c="[object Undefined]",p=o?o.toStringTag:void 0;function f(g){return g==null?g===void 0?c:e:p&&p in Object(g)?t(g):s(g)}return $=f,$}var ee,pe;function Ge(){if(pe)return ee;pe=1;function o(t){return t!=null&&typeof t=="object"}return ee=o,ee}var te,ye;function Fe(){if(ye)return te;ye=1;var o=De(),t=Ge(),s="[object Symbol]";function e(c){return typeof c=="symbol"||t(c)&&o(c)==s}return te=e,te}var ae,he;function Le(){if(he)return ae;he=1;var o=ze(),t=we(),s=Fe(),e=NaN,c=/^[-+]0x[0-9a-f]+$/i,p=/^0b[01]+$/i,f=/^0o[0-7]+$/i,g=parseInt;function d(r){if(typeof r=="number")return r;if(s(r))return e;if(t(r)){var m=typeof r.valueOf=="function"?r.valueOf():r;r=t(m)?m+"":m}if(typeof r!="string")return r===0?r:+r;r=o(r);var b=p.test(r);return b||f.test(r)?g(r.slice(2),b?2:8):c.test(r)?e:+r}return ae=d,ae}var re,Te;function We(){if(Te)return re;Te=1;var o=we(),t=Be(),s=Le(),e="Expected a function",c=Math.max,p=Math.min;function f(g,d,r){var m,b,k,T,n,i,h=0,N=!1,R=!1,_=!0;if(typeof g!="function")throw new TypeError(e);d=s(d)||0,o(r)&&(N=!!r.leading,R="maxWait"in r,k=R?c(s(r.maxWait)||0,d):k,_="trailing"in r?!!r.trailing:_);function q(u){var I=m,B=b;return m=b=void 0,h=u,T=g.apply(B,I),T}function M(u){return h=u,n=setTimeout(O,d),N?q(u):T}function a(u){var I=u-i,B=u-h,ne=d-I;return R?p(ne,k-B):ne}function l(u){var I=u-i,B=u-h;return i===void 0||I>=d||I<0||R&&B>=k}function O(){var u=t();if(l(u))return U(u);n=setTimeout(O,a(u))}function U(u){return n=void 0,_&&m?q(u):(m=b=void 0,T)}function C(){n!==void 0&&clearTimeout(n),h=0,m=i=b=n=void 0}function Re(){return n===void 0?T:U(t())}function G(){var u=t(),I=l(u);if(m=arguments,b=this,i=u,I){if(n===void 0)return M(i);if(R)return clearTimeout(n),n=setTimeout(O,d),q(i)}return n===void 0&&(n=setTimeout(O,d)),T}return G.cancel=C,G.flush=Re,G}return re=f,re}We();const Ve=Ie({__name:"manage_acc",emits:["updateSidebar"],setup(o,{expose:t,emit:s}){var M;t();const e=s,c=je(),{t:p}=xe(),f=["all","active","ban"],g=oe(()=>f.map(a=>({label:p(`admin.manage_acc.acc_status.${a}`),value:a}))),d=["all","Administrator","Moderator","User"],r=oe(()=>d.map(a=>({label:p(`admin.manage_acc.acc_role.${a}`),value:a}))),m=[{title:"ID",dataIndex:"id",customRender:({index:a})=>(i.pageNumber-1)*i.pageSize+a+1,width:50,align:"center"},{title:"Fullname",dataIndex:"fullName",key:"fullName",sorter:(a,l)=>a.fullName.localeCompare(l.fullName),width:350,align:"center"},{title:"Email",dataIndex:"email",key:"email",sorter:(a,l)=>a.email.localeCompare(l.email),width:450,align:"center"},{title:"Token",dataIndex:"token",key:"token",sorter:(a,l)=>a.token-l.token,width:100,align:"center"},{title:"Role",dataIndex:"role",key:"role",sorter:(a,l)=>a.role.localeCompare(l.role),width:100,align:"center"},{title:"",key:"ban",width:120,align:"center"}];Oe(()=>{e("updateSidebar","account"),_()});const b=qe([]);async function k(a){try{a.isBanned?D.confirm({title:"Confirm Ban User",content:"Are you sure you want to ban this user?",centered:!0,onOk:async()=>{await z.BanUser(a.id,{isBanned:!0}),await _()},onCancel:async()=>{await _()}}):D.confirm({title:"Confirm Active User",content:"Are you sure you want to activate this user?",centered:!0,onOk:async()=>{await z.BanUser(a.id,{isBanned:!1}),await _()},onCancel:async()=>{await _()}})}catch(l){console.error("Toggle active ERROR:",l)}}async function T(a){try{D.confirm({title:"Promote User to Moderator",content:"Are you sure you want to promote this user to Moderator?",centered:!0,onOk:async()=>{await z.AssignRole(a.id,{role:"Moderator"}),await _()},onCancel:async()=>{await _()}})}catch(l){console.error("Promote to Moderator:",l)}}async function n(a){try{D.confirm({title:"Demote Moderator to User",content:"Are you sure you want to demote this moderator to User?",centered:!0,onOk:async()=>{await z.AssignRole(a.id,{role:"User"}),await _()},onCancel:async()=>{await _()}})}catch(l){console.error("Toggle active ERROR:",l)}}const i=Ce({pageNumber:c.query.pageNumber||1,pageSize:c.query.pageSize||10,keyword:((M=c.query.keyword)==null?void 0:M.toString())||"",isBanned:c.query.isBanned||g.value[0].value,role:c.query.role||r.value[0].value,fieldName:"Email",totalCount:0,statusFilter:!1}),h=(a,l)=>{i.pageNumber=a,i.pageSize=l,i.statusFilter=!0,_()},N=a=>{if(a==="active")return!1;if(a==="ban")return!0},R=a=>a==="Administrator"?"Administrator":a==="Moderator"?"Moderator":a==="User"?"User":"",_=async()=>{try{const a={...i},l=N(a.isBanned);l!==void 0?a.isBanned=l:delete a.isBanned;const O=R(a.role);O!==void 0?a.role=O:delete a.isBanned;let U=await z.GetAllUser(a);if(U.data.success){let C=U.data.data;b.value=C.items,i.pageNumber=C.pageNumber,i.pageSize=C.pageSize,i.totalCount=C.totalCount}}catch(a){console.log("ERROR: "+a)}},q={emit:e,route:c,t:p,optionKeysAccStatus:f,account_status_credit_options:g,optionKeysAccRole:d,account_role_credit_options:r,columns:m,dataSource:b,onToggle:k,onPromoteToModerator:T,onDemoteToUser:n,pageParams:i,onPaginationChange:h,mapStatusToApi:N,mapRoleToApi:R,getUsersData:_,Input:Ne};return Object.defineProperty(q,"__isScriptSetup",{enumerable:!1,value:!0}),q}}),Ke={class:"page-container"},Qe={class:"title-container"},He={class:"content"},Xe={class:"filter-input-item"},Je={class:"filter-input-full"},Ye={class:"account-table"},Ze={key:0,class:"action-cell"},$e=["onClick"],et=["onClick"],tt={class:"pagination-container"};function at(o,t,s,e,c,p){const f=j("a-col"),g=j("a-row"),d=j("a-select-option"),r=j("a-select"),m=j("a-tooltip"),b=j("a-switch"),k=j("a-table"),T=j("a-pagination");return S(),A("div",Ke,[y(" header title "),x("div",Qe,[w(g,{class:"w-100"},{default:v(()=>[w(f,{class:"main-title",span:20},{default:v(()=>[x("span",null,F(e.t("admin.manage_acc.title")),1)]),_:1})]),_:1})]),x("div",He,[y(" filter area "),x("div",Xe,[y(" filter text input  "),x("div",Je,[w(e.Input,{class:"custom-input",value:e.pageParams.keyword,"onUpdate:value":t[0]||(t[0]=n=>e.pageParams.keyword=n),placeholder:e.t("admin.manage_acc.search_placeholder"),onInput:e.getUsersData},{icon:v(()=>t[4]||(t[4]=[x("i",{class:"bx bx-search"},null,-1)])),_:1},8,["value","placeholder"])]),y(" filter account status "),w(r,{style:{width:"calc(19%)"},value:e.pageParams.isBanned,"onUpdate:value":t[1]||(t[1]=n=>e.pageParams.isBanned=n),onChange:e.getUsersData},{default:v(()=>[(S(!0),A(ie,null,se(e.account_status_credit_options,n=>(S(),L(d,{key:n.value,value:n.value},{default:v(()=>[P(F(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),y(" filter account role "),w(r,{style:{width:"calc(19%)"},value:e.pageParams.role,"onUpdate:value":t[2]||(t[2]=n=>e.pageParams.role=n),onChange:e.getUsersData},{default:v(()=>[(S(!0),A(ie,null,se(e.account_role_credit_options,n=>(S(),L(d,{key:n.value,value:n.value},{default:v(()=>[P(F(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),y(" table list account "),x("div",Ye,[w(k,{"data-source":e.dataSource,columns:e.columns,"row-key":"id",pagination:!1},{bodyCell:v(({column:n,record:i})=>[n.key==="ban"?(S(),A("div",Ze,[y(" icon assign moderator "),w(m,null,{title:v(()=>t[5]||(t[5]=[P(" Demote moderator to User ")])),default:v(()=>[i.role==="Moderator"?(S(),A("i",{key:0,class:"bx bx-id-card",style:{color:"#ff002e","font-size":"25px"},onClick:h=>e.onDemoteToUser(i)},null,8,$e)):y("v-if",!0)]),_:2},1024),y(" icon assign user "),w(m,null,{title:v(()=>t[6]||(t[6]=[P(" Promote user to Moderator ")])),default:v(()=>[i.role==="User"?(S(),A("i",{key:0,class:"bx bx-id-card",style:{color:"#5813c1","font-size":"25px"},onClick:h=>e.onPromoteToModerator(i)},null,8,et)):y("v-if",!0)]),_:2},1024),y(" button ban.active user "),w(m,null,{title:v(()=>t[7]||(t[7]=[P(" Ban/Active ")])),default:v(()=>[i.role!=="Administrator"?(S(),L(b,{key:0,checked:i.isBanned,"onUpdate:checked":h=>i.isBanned=h,"checked-children":"","un-checked-children":"",onChange:h=>e.onToggle(i)},null,8,["checked","onUpdate:checked","onChange"])):y("v-if",!0)]),_:2},1024)])):y("v-if",!0)]),_:1},8,["data-source"])]),x("div",tt,[w(T,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":t[3]||(t[3]=n=>e.pageParams.pageNumber=n),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(n,i)=>`${i[0]}-${i[1]} of ${n} ${e.t("class_member.other.items")}`,"show-size-changer":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])}const it=Ae(Ve,[["render",at],["__scopeId","data-v-a9d2c947"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/admin/account/manage_acc.vue"]]);export{it as default};
