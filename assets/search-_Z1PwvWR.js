var F=Object.defineProperty;var U=(l,a,i)=>a in l?F(l,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[a]=i;var A=(l,a,i)=>U(l,typeof a!="symbol"?a+"":a,i);import{G as V,d as G,q as M,l as Y,u as J,B as K,i as b,j as D,O as X,C as H,s as W,_ as Z,r as v,a as m,o as d,b as e,c as _,w as g,f as S,t as r,F as q,D as C,E as $,e as O,p as ee}from"./index-DhrrK0Mu.js";import{A as te}from"./ApiQuestionSet-CCKPOHyK.js";import{Q as ae}from"./questionSetSortCate-BudA85fH.js";/* empty css                                                                 */import{I as se}from"./Input-BvI-y3AG.js";const ne={GET_ALL_BY_LIMIT:"Tag"};class oe{constructor(){A(this,"GetAllByLimit",async a=>await V.get(`${ne.GET_ALL_BY_LIMIT}`,{params:{name:a.name,pageSize:a.pageSize}}))}}const le=new oe,ie=G({__name:"search",setup(l,{expose:a}){var R;a();const i=M(),t=Y(),{t:w}=J(),N=Object.values(ae),z=K(()=>N.map(o=>({label:w(`question_sets_search.sort_category.${o}`),value:o}))),y=b(!1),I=b([]),s=D({pageNumber:i.query.pageNumber||1,pageSize:i.query.pageSize||10,name:((R=i.query.name)==null?void 0:R.toString())||"",sortBy:i.query.sortBy||z.value[0].value,tagIds:i.query.tags?i.query.tags.toString().split(","):[],totalCount:0,statusFilter:!1}),h=async()=>{try{y.value=!0;let o=await te.GetPublicByLimit(s);if(o.data.success){let c=o.data.data;I.value=c.items,s.pageNumber=c.pageNumber,s.pageSize=c.pageSize,s.totalCount=c.totalCount,s.statusFilter&&(s.pageNumber>c.totalPages&&s.totalCount>0?(s.pageNumber=1,t.push({name:"User_QuestionSet_Search",query:{pageNumber:1,pageSize:s.pageSize,name:s.name,sortBy:s.sortBy,tagIds:s.tagIds.join(",")}})):t.push({name:"User_QuestionSet_Search",query:{pageNumber:s.pageNumber,pageSize:s.pageSize,name:s.name,sortBy:s.sortBy,tagIds:s.tagIds.join(",")}}),s.statusFilter=!s.statusFilter)}}catch(o){console.log("ERROR: GETALLEXAMBYLIMIT search qs: "+o)}finally{y.value=!1}};X(()=>{var o;Object.keys(i.query).length===0&&(s.pageNumber=i.query.pageNumber||1,s.pageSize=i.query.pageSize||10,s.name=((o=i.query.name)==null?void 0:o.toString())||"",s.sortBy=i.query.sortBy||z.value[0].value,s.tagIds=i.query.tags?i.query.tags.toString().split(","):u.value.map(c=>c.id),s.statusFilter=!0,h())});const T=(o,c)=>{s.pageNumber=o,s.pageSize=c,s.statusFilter=!0,h()},u=b([]),f=b([]),k=()=>{const o=sessionStorage.getItem("selected_tags");o&&u.value.push(...JSON.parse(o)),s.tagIds=u.value.map(c=>c.id)},n=D({name:"",pageSize:10}),p=async()=>{const o=await le.GetAllByLimit(n);o.data.success&&(f.value=o.data.data,B.value=o.data.data)},P=o=>{u.value.map(c=>c.id).includes(o.id)||u.value.push(o),sessionStorage.setItem("selected_tags",JSON.stringify(u.value))},E=o=>{u.value.splice(o,1),sessionStorage.setItem("selected_tags",JSON.stringify(u.value))};H(()=>u.value.length,()=>{s.tagIds=u.value.map(o=>o.id),h()});const Q=b(null),B=b([]);function L(o){var c;!n.name||!((c=Q.value)!=null&&c.contains(o.target))?f.value=[]:f.value=[...B.value]}const j=o=>{t.push({name:"User_QuestionSet_Detail",params:{id:o}})};W(async()=>{document.addEventListener("click",L),k(),await h()});const x={route:i,router:t,t:w,optionKeys:N,sort_options:z,loading:y,quiz_data:I,pageParams:s,getData:h,onPaginationChange:T,selectedTags:u,tag_search_data:f,getSessionSelectedTag:k,searchTagPageParams:n,getSearchTagData:p,addTag:P,removeTag:E,searchResultRef:Q,lastSearchResult:B,handleMouseClickOutside:L,onRedirectToDetail:j,Input:se};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),re={class:"page-container"},ce={class:"title-container"},ue={class:"content"},de={class:"content-item"},_e={class:"content-item-title"},me={class:"d-flex justify-content-between"},ge={class:"form-item"},pe={class:"form-item form-item-sort"},ve={class:"d-flex justify-content-between"},he={class:"form-item form-item-tag"},ye={class:"tag-container"},fe={class:"tag-item-qs-count"},be=["onClick"],Se={class:"search-bar",ref:"searchResultRef"},qe={key:0,class:ee(["search-result-container"])},ze={class:"search-result"},Ie={class:"search-result-tag"},Te={class:"result-tag"},ke={class:"result-tag-qs-count"},Ce={class:"result-item-action"},we={class:"content-item-title"},Ne={key:0,class:"quiz-item-container"},Be={class:"quiz-item"},Pe={class:"quiz-item-title"},Qe={class:"quiz-item-description"},Le={class:"quiz-item-info quiz-info-detail"},xe={class:"quiz-item-questions"},Re={class:"quiz-item-created-by"},Ae={class:"exam-item-actions"},De={key:1,class:"w-100 d-flex align-items-center justify-content-center quiz-item-container"},Oe={class:"pagination-container"};function Ee(l,a,i,t,w,N){const z=v("RouterLink"),y=v("a-col"),I=v("a-row"),s=v("a-select-option"),h=v("a-select"),T=v("a-button"),u=v("a-skeleton"),f=v("a-empty"),k=v("a-pagination");return d(),m("div",re,[e("div",ce,[_(I,{class:"w-100 d-flex align-items-center"},{default:g(()=>[_(y,{span:1},{default:g(()=>[_(z,{to:{name:"User_Library"}},{default:g(()=>a[4]||(a[4]=[e("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[4]})]),_:1}),_(y,{class:"main-title",span:23},{default:g(()=>[e("span",null,r(l.$t("detail_QS.other.library")),1),a[5]||(a[5]=S()),a[6]||(a[6]=e("br",null,null,-1))]),_:1,__:[5,6]})]),_:1})]),e("div",ue,[e("div",de,[e("div",_e,[e("div",null,[e("span",null,r(l.$t("search_QS.title")),1),e("span",null,r(l.$t("search_QS.sub_title")),1)])]),e("div",me,[e("div",ge,[e("label",null,r(l.$t("search_QS.form.key_word")),1),_(t.Input,{onInput:t.getData,modelValue:t.pageParams.name,"onUpdate:modelValue":a[0]||(a[0]=n=>t.pageParams.name=n),placeholder:t.t("search_QS.form.key_word_placeholder")},{icon:g(()=>a[7]||(a[7]=[e("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])]),e("div",pe,[e("label",null,r(l.$t("search_QS.form.sort_by")),1),_(h,{value:t.pageParams.sortBy,"onUpdate:value":a[1]||(a[1]=n=>t.pageParams.sortBy=n),style:{width:"200px"},onChange:t.getData},{default:g(()=>[(d(!0),m(q,null,C(t.sort_options,n=>(d(),$(s,{value:n.value},{default:g(()=>[S(r(n.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])]),e("div",ve,[O(` <div class="form-item form-item-sort">
                        <label>Sort by</label>
                        <a-select
                            v-model:value="pageParams.sortBy"
                            style="width: 200px"
                            @change="getData"
                        >
                            <a-select-option v-for="option in sort_options" :value="option.value">
                                {{ option.label }}
                            </a-select-option>
                        </a-select>
                    </div> `),e("div",he,[e("label",null,r(l.$t("create_QS.quiz.tag")),1),e("div",ye,[(d(!0),m(q,null,C(t.selectedTags,(n,p)=>(d(),m("div",{class:"result-tag",key:p},[S(r(n.name)+" ",1),e("span",fe,r(n.questionSetCount),1),e("i",{class:"bx bx-x",onClick:P=>t.removeTag(p)},null,8,be)]))),128))]),e("div",Se,[_(t.Input,{onInput:t.getSearchTagData,modelValue:t.searchTagPageParams.name,"onUpdate:modelValue":a[2]||(a[2]=n=>t.searchTagPageParams.name=n),placeholder:t.t("search_QS.form.tag_placeholder")},null,8,["modelValue","placeholder"]),t.tag_search_data.length>0?(d(),m("div",qe,[e("div",ze,[(d(!0),m(q,null,C(t.tag_search_data,n=>(d(),m("div",Ie,[e("div",Te,[S(r(n.name)+" ",1),e("div",ke,r(n.questionSetCount),1)]),e("div",Ce,[_(T,{type:"primary",class:"main-color-btn",size:"small",onClick:p=>t.addTag(n)},{default:g(()=>[...a[8]||(a[8]=[e("i",{class:"bx bx-plus"},null,-1)])]),_:2,__:[8]},1032,["onClick"])])]))),256))])])):O("v-if",!0)],512)])]),e("div",we,[e("div",null,[e("span",null,r(l.$t("search_QS.other.result_title",{number:t.quiz_data.length})),1)])]),t.loading?(d(),m(q,{key:0},[_(u,{loading:t.loading},null,8,["loading"]),_(u,{loading:t.loading},null,8,["loading"]),_(u,{loading:t.loading},null,8,["loading"])],64)):(d(),m(q,{key:1},[t.quiz_data.length>0?(d(),m("div",Ne,[(d(!0),m(q,null,C(t.quiz_data,n=>(d(),m("div",Be,[a[10]||(a[10]=e("i",{class:"bx bx-book-open quiz-item-icon"},null,-1)),e("div",null,[e("div",Pe,r(n.name),1),e("div",Qe,r(l.$t("search_QS.other.rating",{average:n.ratingAverage,count:n.ratingCount})),1),e("div",Le,[e("div",xe,[a[9]||(a[9]=e("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),S(" "+r(n.totalQuestionCount)+" "+r(l.$t("dashboards.list_items.quiz.questions")),1)]),e("div",Re,r(l.$t("class_question_set.other.created_by"))+" "+r(n.createBy),1)])]),e("div",Ae,[_(T,{type:"primary",class:"me-3 main-color-btn",onClick:p=>t.onRedirectToDetail(n.id)},{default:g(()=>[S(r(l.$t("class_question_set.buttons.view")),1)]),_:2},1032,["onClick"])])]))),256))])):(d(),m("div",De,[_(f,null,{description:g(()=>[e("span",null,r(l.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),e("div",Oe,[_(k,{onChange:t.onPaginationChange,current:t.pageParams.pageNumber,"onUpdate:current":a[3]||(a[3]=n=>t.pageParams.pageNumber=n),total:t.pageParams.totalCount,pageSize:t.pageParams.pageSize,"show-total":(n,p)=>`${p[0]}-${p[1]} of ${n} ${t.t("class_question_set.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:t.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])])}const Ye=Z(ie,[["render",Ee],["__scopeId","data-v-27ebb566"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/question_sets/search.vue"]]);export{Ye as default};
