var we=Object.defineProperty;var xe=(p,e,v)=>e in p?we(p,e,{enumerable:!0,configurable:!0,writable:!0,value:v}):p[e]=v;var te=(p,e,v)=>xe(p,typeof e!="symbol"?e+"":e,v);import{c as l,I as Ie,d as me,u as he,i as w,j as re,B as ye,C as fe,s as be,k as U,M as Z,_ as _e,r as h,E as ae,o,w as s,b as n,f as g,t as m,ai as le,p as V,a as i,F as G,D as R,e as L,J as se,v as ke,L as Se,G as ce,aj as Te,ak as Ee,R as Ce}from"./index-7pvKWGH0.js";import{A as Ae}from"./ApiTestTemplate-A2vpt1dk.js";import{Q as de}from"./questionTypes-CS3lcRlq.js";import{S as ne}from"./languages-DtYW231W.js";import{T as Me}from"./TextArea-BWkU02Ku.js";import"./lodash-DahQgOe8.js";var Oe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function ve(p){for(var e=1;e<arguments.length;e++){var v=arguments[e]!=null?Object(arguments[e]):{},t=Object.keys(v);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(v).filter(function(Q){return Object.getOwnPropertyDescriptor(v,Q).enumerable}))),t.forEach(function(Q){De(p,Q,v[Q])})}return p}function De(p,e,v){return e in p?Object.defineProperty(p,e,{value:v,enumerable:!0,configurable:!0,writable:!0}):p[e]=v,p}var oe=function(e,v){var t=ve({},e,v.attrs);return l(Ie,ve({},t,{icon:Oe}),null)};oe.displayName="InboxOutlined";oe.inheritAttrs=!1;const Le=me({__name:"ImportQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(p,{expose:e,emit:v}){const{t}=he(),Q=p,B=v,D=w(!1),y=w([]),x=w([]),I=w([]),_=re({checkAll:!1,indeterminate:!1,checkedList:[]}),M=()=>{_.checkedList=[],D.value=!0},C=()=>{D.value=!1};e({openImportModal:M});const b=w([]),S=w(null),a=w(!1),q=()=>{var c;(c=S.value)==null||c.click()},F=async c=>{var O;const k=(O=c.target.files)==null?void 0:O[0];if(k){b.value=[],U.success(k.name+" uploaded successfully."),b.value.push(k);const z=await Ae.ImportFile(b.value[0]);z.data.success&&(y.value=[...z.data.data.validQuestions,...z.data.data.invalidQuestions],x.value=[...z.data.data.validQuestions,...z.data.data.invalidQuestions],I.value=z.data.data.invalidQuestions,_.checkedList=[]);return}U.error("Upload failed")},A=c=>{var k;const u=((k=c.dataTransfer)==null?void 0:k.types)||[];Array.from(u).includes("files")&&(a.value=!0)},J=c=>{var k;const u=(k=c.dataTransfer)==null?void 0:k.files[0];if(a.value=!1,u){b.value=[],U.success(u.name+" uploaded successfully."),b.value.push(u);return}U.error("Upload failed")},r=c=>{var u;(u=b.value)==null||u.splice(c,1),_.checkedList=[],y.value=[],I.value=[],x.value=[]},H=["all","valid","invalid"],T=ye(()=>H.map(c=>({label:c,value:c}))),Y=w(T.value[0].value),K=()=>{var u,k;_.checkedList=[];let c=y.value;switch(Y.value){case"valid":{c=(u=y.value)==null?void 0:u.filter(O=>{var z;return!((z=I.value)!=null&&z.includes(O))});break}case"invalid":{c=(k=y.value)==null?void 0:k.filter(O=>{var z;return(z=I.value)==null?void 0:z.includes(O)});break}}x.value=c||[]},X=c=>{Object.assign(_,{checkedList:c.target.checked?x.value:[],indeterminate:!1})};fe(()=>_.checkedList,c=>{var u;_.indeterminate=!!c.length&&c.length<x.value.length,_.checkAll=c.length===((u=x.value)==null?void 0:u.length)});const W=(c,u)=>{$(u).toggleClass("bx-chevron-up bx-chevron-down");const O=$(`#question-item-answer-${c}`);O&&$(O).slideToggle()},f=()=>{if(_.checkedList.length===0){U.warning(t("message.minimum_question",{number:5}));return}if(_.checkedList.length+Q.numberOfQuestion>500){U.warning(t("message.limit_question",{number:500}));return}Z.confirm({title:"Are your sure? ",content:"Import: "+_.checkedList.length+" into "+Q.title+" ? ",okText:"Confirm",onOk:()=>{var u;const c=(u=x.value)==null?void 0:u.filter(k=>_.checkedList.includes(k));B("import",c),C()}})};be(()=>{});const P={t,props:Q,emit:B,modal_import_open:D,question_data:y,uploadedQuestions:x,uploadedInvalidQuestions:I,importModalState:_,openImportModal:M,closeImportModal:C,files:b,fileInput:S,isDragging:a,openFileExplorer:q,handleFileChange:F,handleDragEnter:A,handleDrop:J,onRemoveUploadedFile:r,optionKeys:H,select_options:T,selected_option:Y,onFilter:K,onCheckAll:X,toggleDisplayAnswer:W,handleModalImport:f,get InboxOutlined(){return oe},get QUESTION_TYPE(){return de}};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}}),Ge={class:"modal-container"},Qe={class:"modal-title-container"},Ue={class:"modal-content-item"},Fe={class:"content-item-section upload-section"},Pe={class:"section-title"},ze={class:"section-content"},Ne={class:"customized-file-upload-icons"},Re={class:"file-container"},qe={class:"file-item"},Be=["onClick"],Je={class:"content-item-section preview-section"},He={class:"section-content"},je={key:0,class:"section-content-header"},Ye={class:"d-flex"},Ve={class:"preview-question-container"},Ke={class:"question-item-content"},Xe=["innerHTML"],We={key:1,class:"question-text"},Ze=["id"],$e={key:0,class:"multiple-choice-answer"},et={key:0,class:"text-success"},tt={class:"pair-answer"},nt={class:"pair-answer-item"},at={class:"pair-answer-item"},lt={key:2,class:"ordering-answer"},ot={class:"ordering-answer-item"},st={class:"ordering-answer-item"},it={class:"ordering-answer-item"},rt={class:"short-text-answer"},ct={class:"question-item-toogle-btn"},dt=["onClick"],ut={class:"mt-4 d-flex align-items-center"},mt={class:"header-item"};function ft(p,e,v,t,Q,B){const D=h("RouterLink"),y=h("a-col"),x=h("a-row"),I=h("a-button"),_=h("a-checkbox"),M=h("a-select-option"),C=h("a-select"),b=h("a-checkbox-group"),S=h("a-modal");return o(),ae(S,{centered:"",width:"100%","wrap-class-name":"full-modal",open:t.modal_import_open,onCancel:t.closeImportModal},{footer:s(()=>[n("div",ut,[n("div",mt," Total: "+m(t.importModalState.checkedList.length)+" questions ",1),l(I,{class:"main-color-btn",size:"large",key:"submit",type:"primary",onClick:t.handleModalImport},{default:s(()=>e[16]||(e[16]=[g(" Import ")])),_:1,__:[16]})])]),default:s(()=>[n("div",Ge,[n("div",Qe,[l(x,{class:"w-100 d-flex align-items-center"},{default:s(()=>[l(y,{span:1},{default:s(()=>[l(D,{onClick:t.closeImportModal,to:{name:""}},{default:s(()=>e[5]||(e[5]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[5]})]),_:1}),l(y,{class:"main-title",span:23},{default:s(()=>[n("span",null,m(p.$t("create_QS.title")),1),e[6]||(e[6]=g()),e[7]||(e[7]=n("br",null,null,-1)),n("span",null,m(p.$t("create_QS.sub_title")),1)]),_:1,__:[6,7]})]),_:1})]),n("div",Ue,[n("div",Fe,[n("div",Pe,[e[9]||(e[9]=n("span",null,"Upload",-1)),l(I,{class:"main-color-btn",type:"primary"},{default:s(()=>e[8]||(e[8]=[g("Download template")])),_:1,__:[8]})]),n("div",ze,[n("input",{onChange:t.handleFileChange,class:"d-none",type:"file",ref:"fileInput"},null,544),n("div",{class:V(["customized-file-upload",t.isDragging?"is-dragging":""]),onClick:t.openFileExplorer,onDragenter:t.handleDragEnter,onDragover:e[0]||(e[0]=le(a=>t.isDragging=!0,["prevent"])),onDragleave:e[1]||(e[1]=a=>t.isDragging=!1),onDrop:le(t.handleDrop,["prevent"])},[n("div",Ne,[n("i",{class:V(["bx","bx-down-arrow-alt","bx-fade-up",t.isDragging?"":"d-none"])},null,2),l(t.InboxOutlined,{class:V([t.isDragging?"d-none":""])},null,8,["class"])]),e[10]||(e[10]=n("div",{class:"customized-file-upload-ins"},[n("strong",null,"Click"),g(" or "),n("strong",null,"drag"),g(" file to this area to upload ")],-1)),e[11]||(e[11]=n("div",{class:"customized-file-upload-hint"},[g(" Please use the template above to ensure the file is read correctly."),n("br"),g(" Support for a single upload. ")],-1))],34)]),n("div",Re,[(o(!0),i(G,null,R(t.files,(a,q)=>(o(),i("div",qe,[n("span",null,m(a.name),1),n("i",{class:"bx bx-trash text-danger",onClick:F=>t.onRemoveUploadedFile(q)},null,8,Be)]))),256))])]),n("div",Je,[e[15]||(e[15]=n("div",{class:"section-title"},"Preview",-1)),n("div",He,[t.question_data.length>0?(o(),i("div",je,[l(_,{class:V(["header-item",t.importModalState.checkAll?"check-all":""]),onClick:t.onCheckAll,checked:t.importModalState.checkAll,"onUpdate:checked":e[2]||(e[2]=a=>t.importModalState.checkAll=a),indeterminate:t.importModalState.indeterminate},{default:s(()=>[g(" Check all ("+m(t.importModalState.checkedList.length)+") ",1)]),_:1},8,["class","checked","indeterminate"]),n("div",Ye,[l(C,{size:"large",class:"me-3",value:t.selected_option,"onUpdate:value":e[3]||(e[3]=a=>t.selected_option=a),style:{width:"200px"},onChange:t.onFilter},{default:s(()=>[(o(!0),i(G,null,R(t.select_options,a=>(o(),ae(M,{value:a.value},{default:s(()=>[g(m(a.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])])):L("v-if",!0),l(b,{value:t.importModalState.checkedList,"onUpdate:value":e[4]||(e[4]=a=>t.importModalState.checkedList=a)},{default:s(()=>[n("div",Ve,[(o(!0),i(G,null,R(t.uploadedQuestions,(a,q)=>{var F;return o(),i("div",{class:V(["preview-question-item",(F=t.uploadedInvalidQuestions)!=null&&F.includes(a)?"invalid":""])},[l(_,{value:a},null,8,["value"]),n("div",Ke,[a.questionHTML?(o(),i("div",{key:0,class:"question-html",innerHTML:a.questionHTML},null,8,Xe)):(o(),i("div",We,m(a.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${q}`},[a.type===t.QUESTION_TYPE.MULTIPLE_CHOICE?(o(),i("div",$e,[n("ul",null,[(o(!0),i(G,null,R(a.multipleChoices,A=>(o(),i("li",null,[g(m(A.text)+" ",1),A.isAnswer?(o(),i("span",et," ("+m(A.isAnswer)+") ",1)):L("v-if",!0)]))),256))])])):L("v-if",!0),a.type===t.QUESTION_TYPE.MATCHING?(o(!0),i(G,{key:1},R(a.matchingPairs,A=>(o(),i("div",tt,[n("span",nt,m(A.leftItem),1),e[12]||(e[12]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",at,m(A.rightItem),1)]))),256)):L("v-if",!0),a.type===t.QUESTION_TYPE.ORDERING?(o(),i("div",lt,[n("div",ot,[(o(!0),i(G,null,R(a.orderingItems,A=>(o(),i("div",null,m(A.text),1))),256))]),e[13]||(e[13]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",st,[(o(!0),i(G,null,R(a.orderingItems,(A,J)=>(o(),i("div",it,[n("span",null,"#"+m(J+1),1),g(" - "+m(A.text),1)]))),256))])])):L("v-if",!0),a.type===t.QUESTION_TYPE.SHORT_TEXT?(o(),i(G,{key:3},[e[14]||(e[14]=n("span",null,"Answer:",-1)),n("div",rt,m(a.shortAnswer),1)],64)):L("v-if",!0)],8,Ze)]),n("div",ct,[n("i",{class:"bx bx-chevron-up",onClick:A=>t.toggleDisplayAnswer(q,A.currentTarget)},null,8,dt)])],2)}),256))])]),_:1},8,["value"])])])])])]),_:1},8,["open"])}const hn=_e(Le,[["render",ft],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/ImportQSModal.vue"]]),_t={HARD:"Hard",MEDIUM:"Medium",EASY:"Easy"},ie={GENERATE_QUESTION:"AiGenerate/GenerateQuestion",GENERATE_DOCUMENT_STRUCTURE:"AiGenerate/GenerateDocumentStructure",GET_COST_TO_GENERATE:"AiGenerate/DocumentStructure/GetCostToGenerate"};class pt{constructor(){te(this,"GenerateQuestion",async e=>await se.post(ie.GENERATE_QUESTION,e,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0}));te(this,"GenerateDocumentStructure",async e=>{const v=new FormData;return v.append("file",e),await se.post(ie.GENERATE_DOCUMENT_STRUCTURE,v,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})});te(this,"GetCostToGenerate",async e=>{const v=new FormData;return v.append("file",e),await se.post(ie.GET_COST_TO_GENERATE,v,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})})}}const ue=new pt,gt=me({__name:"GenerateFileStructure",props:{file:{type:null,required:!0}},emits:["import"],setup(p,{expose:e,emit:v}){const t=p,Q=ke(Se,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),B=w(),D=w([]);function y(f){return f?Array.isArray(f)?f:[f]:[]}function x(f){return y(f).map(c=>{const u=y(c==null?void 0:c.children);return{...c,title:String((c==null?void 0:c.title)??""),key:crypto.randomUUID(),children:u.length?x(u):void 0}})}const I=w([]),_=w([]);function M(f,P){const c=[];for(const u of f){const k=P.includes(u.key),O=u.children?M(u.children,P):[];(k||O.length>0)&&c.push({title:u.title,key:u.key,children:O.length?O:void 0})}return c}const C=ye(()=>M(I.value,_.value));fe(I,async()=>{I.value.length>0&&(await ce(),B.value&&(B.value.scrollTop=0))});const b=w(null),S=w(!1),a=w(!1),q=async()=>{try{a.value=!0;const f=await ue.GetCostToGenerate(t.file);return f.data.success?f.data.data:(Z.error({title:"Error",content:f.data.message||"Failed to get cost to generate."}),null)}catch(f){return console.error(f),null}finally{a.value=!1}},F=async()=>{try{a.value=!0;const f=await ue.GenerateDocumentStructure(t.file);if(!f.data.success){Z.error({title:"Error",content:f.data.message||"Failed to generate file structure."});return}const P=typeof f.data=="string"?JSON.parse(f.data):f.data,c=P==null?void 0:P.data,u=y(c==null?void 0:c.children);D.value=u,I.value=x(D.value)}catch(f){console.error(f)}finally{a.value=!1,r.value=!1}},A=async()=>{if(S.value=!0,D.value.length>0||b.value)return;const f=await q();if(!f){U.error("Failed to get cost to generate file structure.");return}b.value=f,r.value=!0},J=()=>{S.value=!1,Y()},r=w(!1),H=async()=>{b.value&&await F()},T=v,Y=()=>{var k,O;if(I.value.length===0||C.value.length===0)return;const f=(k=I.value)==null?void 0:k[0],P=JSON.stringify({title:f.title,children:f.children}),c=(O=C.value)==null?void 0:O[0],u=JSON.stringify({title:c.title,children:c.children});T("import",P,u)},K=()=>{if(C.value.length===0){Z.error({title:"Error",content:"Please choose at least one section in your document to proceed.",centered:!0});return}Y(),J()},X=()=>{D.value=[],I.value=[],b.value=null};e({openModal:A,closeModal:J,clearData:X});const W={props:t,indicator:Q,modalContentRef:B,serverData:D,toArray:y,addRandomKeys:x,treeData:I,checked:_,filterTree:M,selectedTree:C,cost:b,modal_open:S,loading:a,getCostToGenerate:q,generateTreeData:F,openModal:A,closeModal:J,modal_confirm_generate_structure_open:r,onConfirmGenerateFileStructure:H,emit:T,onEmitImport:Y,onConfirmImportStructure:K,clearData:X,get ExclamationCircleFilled(){return Ee},get ATree(){return Te}};return Object.defineProperty(W,"__isScriptSetup",{enumerable:!1,value:!0}),W}}),vt={class:"modal-container"},ht={class:"modal-title-container"},yt={class:"modal-content-item",ref:"modalContentRef"},bt={key:0,class:"loading-container"},kt={key:0},St={key:1,class:"content-wrapper"},wt={key:0,class:"tree-container"},xt={class:"button-container"},It={class:"confirm-modal-container"},Tt={class:"d-flex align-items-center"},Et={class:"fs-6 ms-5 mt-3"},Ct={class:"text-danger"};function At(p,e,v,t,Q,B){const D=h("RouterLink"),y=h("a-col"),x=h("a-row"),I=h("a-spin"),_=h("a-button"),M=h("a-modal");return o(),i(G,null,[l(M,{centered:"",width:"100%","wrap-class-name":"medium-modal large",open:t.modal_open,onCancel:t.closeModal},{footer:s(()=>[l(_,{class:"main-color-btn",type:"primary",onClick:t.onConfirmImportStructure},{default:s(()=>e[7]||(e[7]=[g(" Confirm ")])),_:1,__:[7]})]),default:s(()=>[n("div",vt,[n("div",ht,[l(x,{class:"w-100 d-flex align-items-center"},{default:s(()=>[l(y,{span:1},{default:s(()=>[l(D,{onClick:t.closeModal,to:{name:""}},{default:s(()=>e[3]||(e[3]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[3]})]),_:1}),l(y,{class:"main-title",span:23},{default:s(()=>[n("span",null,m(p.$t("create_QS.title")),1),e[4]||(e[4]=g()),e[5]||(e[5]=n("br",null,null,-1)),n("span",null,m(p.$t("create_QS.sub_title")),1)]),_:1,__:[4,5]})]),_:1})]),n("div",yt,[t.loading?(o(),i("div",bt,[l(I,{size:"large",indicator:t.indicator},null,8,["indicator"]),t.cost?L("v-if",!0):(o(),i("div",kt,"Calculating cost to generate file"))])):(o(),i("div",St,[t.treeData.length>0?(o(),i("div",wt,[l(t.ATree,{checkedKeys:t.checked,"onUpdate:checkedKeys":e[0]||(e[0]=C=>t.checked=C),"tree-data":t.treeData,checkable:"","show-icon":!1,"show-line":!0,"field-names":{title:"title",key:"key",children:"children"},defaultExpandAll:!0,style:{width:"100%"}},null,8,["checkedKeys","tree-data"])])):t.cost?(o(),i(G,{key:1},[L(" get cost success but cancel "),n("div",xt,[l(_,{type:"primary",class:"main-color-btn",onClick:e[1]||(e[1]=C=>t.modal_confirm_generate_structure_open=!0)},{default:s(()=>e[6]||(e[6]=[g(" Generate File Structure ")])),_:1,__:[6]})])],2112)):L("v-if",!0)]))],512)])]),_:1},8,["open"]),l(M,{"wrap-class-name":"medium-modal",centered:"",open:t.modal_confirm_generate_structure_open,closable:!1},{footer:s(()=>[l(_,{class:V(["main-color-btn-ghost",t.loading?"main-color-btn-disabled":""]),type:"ghost",onClick:e[2]||(e[2]=C=>t.modal_confirm_generate_structure_open=!1)},{default:s(()=>e[11]||(e[11]=[g(" Cancel ")])),_:1,__:[11]},8,["class"]),l(_,{loading:t.loading,class:"main-color-btn",type:"primary",onClick:t.onConfirmGenerateFileStructure},{default:s(()=>e[12]||(e[12]=[g("Confirm")])),_:1,__:[12]},8,["loading"])]),default:s(()=>{var C;return[n("div",It,[n("div",Tt,[l(t.ExclamationCircleFilled,{class:"fs-4 me-3 text-warning"}),e[8]||(e[8]=n("div",{class:"fs-6 fw-bold"}," Are you sure you want to generate the file structure? ",-1))]),n("div",Et,[e[9]||(e[9]=g(" You will need at least ")),n("span",Ct,m((C=t.cost)==null?void 0:C.miniumPointToGenerate),1),e[10]||(e[10]=g(" point to process this file. "))])])]}),_:1},8,["open"])],64)}const Mt=_e(gt,[["render",At],["__scopeId","data-v-8be2b719"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateFileStructure.vue"]]),Ot=me({__name:"GenerateQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(p,{expose:e,emit:v}){const{t}=he(),Q=p,B=v,D=w(!1),y=()=>{S.checkedList=[],D.value=!0},x=()=>{D.value=!1};e({openGenerateAIModal:y});const I=()=>{if(S.checkedList.length===0){U.warning(t("message.minimum_question",{number:5}));return}if(S.checkedList.length+Q.numberOfQuestion>500){U.warning(t("message.limit_question",{number:500}));return}Z.confirm({title:"Are your sure? ",content:"Import: "+S.checkedList.length+"into "+Q.title+" ? ",okText:"Confirm",onOk:()=>{const d=b.value.filter(E=>S.checkedList.includes(E.id));B("import",d),x()}})},_=Object.values(de).map(d=>({label:t(`create_QS.type.${d}`),value:d})),M=Object.values(_t).map(d=>({label:d,value:d})),C=w([]);for(let d=10;d<=50;d+=10)C.value.push({label:d,value:d});const b=w([]),S=re({checkAll:!1,indeterminate:!1,checkedList:[]}),a=re({file:null,isGenerateExplain:!0,language:ne[0].code,questionCount:C.value[0].value,questionTypes:[_[0]],documentStructureJson:null,selectedPartJson:null,title:""}),q=d=>{a.questionTypes.length===0&&(U.warning("At least one question type must be selected."),a.questionTypes.push(d))},F=w(!1),A=ke(Se,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),J=async()=>{var d;try{if(F.value=!0,!a.title&&a.isGenerateExplain){U.error("Please enter a reference for the document citation.");return}if(a.documentStructureJson===null||a.selectedPartJson===null){Z.error({title:"Error",content:"Please choose at least one section in your document to proceed.",centered:!0}),O();return}const E=JSON.parse(a.documentStructureJson),j=JSON.parse(a.selectedPartJson);a.isGenerateExplain&&a.title&&(a.documentStructureJson=JSON.stringify({...E,title:a.title}),a.selectedPartJson=JSON.stringify({...j,title:a.title}));const N=new FormData;N.append("file",r.value[0]),N.append("isGenerateExplain",a.isGenerateExplain?"true":"false"),N.append("language",((d=ne.find(ee=>ee.code===a.language))==null?void 0:d.label)||ne[0].label),N.append("questionCount",a.questionCount),N.append("questionTypes",JSON.stringify(a.questionTypes.map(ee=>ee))),N.append("documentStructureJson",a.documentStructureJson),N.append("selectedPartJson",a.selectedPartJson);const ge=await ue.GenerateQuestion(N);if(!ge.data.success){U.error("Generate failed!");return}b.value=[...b.value||[],...ge.data.data.map(ee=>({...ee,questionId:Ce().valueOf()}))],await ce(),S.checkedList=[],S.indeterminate=!1,S.checkAll=!1}catch(E){console.log(E)}finally{F.value=!1}},r=w([]),H=w(null),T=w(!1),Y=()=>{var d;(d=H.value)==null||d.click()},K=async d=>{if(d){if(d.type!=="application/pdf"){U.error("Only PDF files are supported.");return}r.value=[],U.success(d.name+" uploaded successfully."),r.value.push(d);const E=d.name.replace(/\.[^/.]+$/,"");a.title=E,await ce(),O();return}U.error("Upload failed")},X=d=>{var N;const E=d.target,j=(N=E.files)==null?void 0:N[0];j&&(K(j),E.value="")},W=d=>{var j;const E=((j=d.dataTransfer)==null?void 0:j.types)||[];Array.from(E).includes("files")&&(T.value=!0)},f=async d=>{var j;const E=(j=d.dataTransfer)==null?void 0:j.files[0];T.value=!1,E&&K(E)},P=()=>{var d;r.value=[],(d=k.value)==null||d.clearData()},c=d=>{Object.assign(S,{checkedList:d.target.checked?b.value.map(E=>E.id):[],indeterminate:!1})};fe(()=>S.checkedList,d=>{S.indeterminate=!!d.length&&d.length<b.value.map(E=>E.id).length,S.checkAll=d.length===b.value.length});const u=(d,E)=>{$(E).toggleClass("bx-chevron-up bx-chevron-down");const N=$(`#question-item-answer-${d}`);N&&$(N).slideToggle()},k=w(null),O=()=>{k.value&&k.value.openModal()},z=(d,E)=>{a.documentStructureJson=d,a.selectedPartJson=E};be(()=>{});const pe={t,props:Q,emit:B,modal_generate_ai_open:D,openGenerateAIModal:y,closeGenerateAIModal:x,handleModalImport:I,questionTypeOptions:_,questionDifficultyOptions:M,questionMaximumOptions:C,generatedQuestions:b,generateModalState:S,generateByAIModalState:a,onDeselectQuestionType:q,loading:F,indicator:A,onGenerateQuestions:J,files:r,fileInput:H,isDragging:T,openFileExplorer:Y,onFileChange:K,handleFileChange:X,handleDragEnter:W,handleDrop:f,onRemoveUploadedFile:P,onCheckAll:c,toggleDisplayAnswer:u,generateFileStructureRef:k,openFileStructureModal:O,handleImportStructure:z,get QUESTION_TYPE(){return de},get SUPPORTED_LOCALES(){return ne},get InboxOutlined(){return oe},TextArea:Me,GenerateFileStructure:Mt};return Object.defineProperty(pe,"__isScriptSetup",{enumerable:!1,value:!0}),pe}}),Dt={class:"modal-container"},Lt={class:"modal-title-container"},Gt={class:"modal-content-item"},Qt={class:"content-item-section upload-section"},Ut={key:0,class:"section-content mb-2"},Ft={class:"customized-file-upload-icons"},Pt={key:1,class:"file-container"},zt={class:"file-item"},Nt={class:"content-item-section preview-section"},Rt={class:"section-content"},qt={key:0,class:"section-content-header"},Bt={class:"header-item"},Jt={class:"preview-question-container"},Ht={class:"preview-question-item"},jt={class:"question-item-content"},Yt=["innerHTML"],Vt={key:1,class:"question-text"},Kt=["id"],Xt={key:0,class:"multiple-choice-answer"},Wt={key:0,class:"text-success"},Zt={class:"pair-answer"},$t={class:"pair-answer-item"},en={class:"pair-answer-item"},tn={key:2,class:"ordering-answer"},nn={class:"ordering-answer-item"},an={class:"ordering-answer-item"},ln={class:"ordering-answer-item"},on={class:"short-text-answer"},sn={class:"question-item-toogle-btn"},rn=["onClick"],cn={class:"w-100 d-flex justify-content-end"};function dn(p,e,v,t,Q,B){const D=h("RouterLink"),y=h("a-col"),x=h("a-row"),I=h("a-select-option"),_=h("a-select"),M=h("a-form-item"),C=h("a-switch"),b=h("a-button"),S=h("a-form"),a=h("a-checkbox"),q=h("a-checkbox-group"),F=h("a-spin"),A=h("a-modal");return o(),i(G,null,[l(A,{centered:"",width:"100%",closable:!1,"wrap-class-name":"full-modal",open:t.modal_generate_ai_open,onCancel:t.closeGenerateAIModal},{footer:s(()=>e[25]||(e[25]=[])),default:s(()=>[l(F,{spinning:t.loading,size:"large",indicator:t.indicator},{default:s(()=>{var J;return[n("div",Dt,[n("div",Lt,[l(x,{class:"w-100 d-flex align-items-center"},{default:s(()=>[l(y,{span:1},{default:s(()=>[l(D,{onClick:t.closeGenerateAIModal,to:{name:""}},{default:s(()=>e[11]||(e[11]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[11]})]),_:1}),l(y,{class:"main-title",span:23},{default:s(()=>[n("span",null,m(p.$t("create_QS.title")),1),e[12]||(e[12]=g()),e[13]||(e[13]=n("br",null,null,-1)),n("span",null,m(p.$t("create_QS.sub_title")),1)]),_:1,__:[12,13]})]),_:1})]),n("div",Gt,[n("div",Qt,[e[18]||(e[18]=n("div",{class:"section-title"},[n("span",null,"Upload")],-1)),t.files.length?L("v-if",!0):(o(),i("div",Ut,[n("input",{onChange:t.handleFileChange,class:"d-none",type:"file",ref:"fileInput",accept:".pdf"},null,544),n("div",{class:V(["customized-file-upload",t.isDragging?"is-dragging":""]),onClick:t.openFileExplorer,onDragenter:t.handleDragEnter,onDragover:e[0]||(e[0]=le(r=>t.isDragging=!0,["prevent"])),onDragleave:e[1]||(e[1]=r=>t.isDragging=!1),onDrop:le(t.handleDrop,["prevent"])},[n("div",Ft,[n("i",{class:V(["bx","bx-down-arrow-alt","bx-fade-up",t.isDragging?"":"d-none"])},null,2),l(t.InboxOutlined,{class:V([t.isDragging?"d-none":""])},null,8,["class"])]),e[14]||(e[14]=n("div",{class:"customized-file-upload-ins"},[n("strong",null,"Click"),g(" or "),n("strong",null,"drag"),g(" file to this area to upload ")],-1)),e[15]||(e[15]=n("div",{class:"customized-file-upload-hint"},[g(" Please use the template above to ensure the file is read correctly."),n("br"),g(" Support for a single upload. ")],-1))],34)])),t.files.length?(o(),i("div",Pt,[(o(!0),i(G,null,R(t.files,r=>(o(),i("div",zt,[n("span",null,m(r.name),1),n("i",{class:"bx bx-trash text-danger",onClick:e[2]||(e[2]=H=>t.onRemoveUploadedFile())})]))),256)),n("div",{class:"file-structure",onClick:t.openFileStructureModal},e[16]||(e[16]=[n("i",{class:"bx bx-file"},null,-1),n("div",null,"Structure",-1)]))])):L("v-if",!0),l(S,{layout:"vertical",class:"generate-ai-form"},{default:s(()=>[l(x,{class:"d-flex justify-content-between"},{default:s(()=>[L(` <a-col :span="12">
                                <a-form-item label="Difficulty">
                                    <a-select
                                        v-model:value="generateByAIModalState.difficulty"
                                        style="width: 100%"
                                        :placeholder="'Difficulty of questions'"
                                        :options="questionDifficultyOptions"
                                    />
                                </a-form-item>
                            </a-col> `),l(y,{span:12},{default:s(()=>[l(M,{label:"Language"},{default:s(()=>[l(_,{class:"language-select",value:t.generateByAIModalState.language,"onUpdate:value":e[3]||(e[3]=r=>t.generateByAIModalState.language=r)},{default:s(()=>[(o(!0),i(G,null,R(t.SUPPORTED_LOCALES,r=>(o(),ae(I,{key:`locale-${r.code}`,value:r.code},{default:s(()=>[g(m(r.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),l(y,{span:11},{default:s(()=>[l(M,{label:"Maximum question"},{default:s(()=>[l(_,{value:t.generateByAIModalState.questionCount,"onUpdate:value":e[4]||(e[4]=r=>t.generateByAIModalState.questionCount=r),style:{width:"100%"},placeholder:"Maximum number of question",options:t.questionMaximumOptions},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),l(M,{label:"Question types"},{default:s(()=>[l(_,{onDeselect:t.onDeselectQuestionType,value:t.generateByAIModalState.questionTypes,"onUpdate:value":e[5]||(e[5]=r=>t.generateByAIModalState.questionTypes=r),mode:"multiple",style:{width:"100%"},placeholder:"Select multiple",options:t.questionTypeOptions},null,8,["value","options"])]),_:1}),l(x,{class:"d-flex justify-content-between"},{default:s(()=>[l(y,{span:7},{default:s(()=>[l(M,{label:"Enable explaination"},{default:s(()=>[l(C,{checked:t.generateByAIModalState.isGenerateExplain,"onUpdate:checked":e[6]||(e[6]=r=>t.generateByAIModalState.isGenerateExplain=r)},null,8,["checked"])]),_:1})]),_:1}),t.generateByAIModalState.isGenerateExplain?(o(),ae(y,{key:0,span:16},{default:s(()=>[l(M,{label:"Reference name"},{default:s(()=>[l(t.TextArea,{modelValue:t.generateByAIModalState.title,"onUpdate:modelValue":e[7]||(e[7]=r=>t.generateByAIModalState.title=r),"is-required":t.generateByAIModalState.isGenerateExplain,"max-length":200,placeholder:"Enter document title for citation",readonly:!t.generateByAIModalState.isGenerateExplain},null,8,["modelValue","is-required","readonly"])]),_:1})]),_:1})):L("v-if",!0)]),_:1}),l(M,{style:{"margin-top":"7px"},class:"generate-ai-btn-container"},{default:s(()=>[l(b,{loading:t.loading,size:"large",class:"w-100 main-color-btn generate_ai",type:"primary",onClick:t.onGenerateQuestions},{default:s(()=>e[17]||(e[17]=[g(" ✨ Generate ")])),_:1,__:[17]},8,["loading"])]),_:1})]),_:1})]),n("div",Nt,[e[23]||(e[23]=n("div",{class:"section-title"},"Preview",-1)),n("div",Rt,[t.generatedQuestions.length>0?(o(),i("div",qt,[l(a,{class:V(["header-item",t.generateModalState.checkAll?"check-all":""]),onClick:t.onCheckAll,checked:t.generateModalState.checkAll,"onUpdate:checked":e[8]||(e[8]=r=>t.generateModalState.checkAll=r),indeterminate:t.generateModalState.indeterminate},{default:s(()=>[g(" Check all ("+m(t.generateModalState.checkedList.length)+") ",1)]),_:1},8,["class","checked","indeterminate"]),n("div",Bt," Total: "+m((J=t.generatedQuestions)==null?void 0:J.length)+" questions ",1)])):L("v-if",!0),l(q,{value:t.generateModalState.checkedList,"onUpdate:value":e[10]||(e[10]=r=>t.generateModalState.checkedList=r)},{default:s(()=>[n("div",Jt,[(o(!0),i(G,null,R(t.generatedQuestions,(r,H)=>(o(),i("div",Ht,[l(a,{onClick:e[9]||(e[9]=T=>console.log(t.generateModalState.checkedList)),value:r.id},null,8,["value"]),n("div",jt,[r.questionHTML?(o(),i("div",{key:0,class:"question-html",innerHTML:r.questionHTML},null,8,Yt)):(o(),i("div",Vt,m(r.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${H}`},[r.type===t.QUESTION_TYPE.MULTIPLE_CHOICE?(o(),i("div",Xt,[n("ul",null,[(o(!0),i(G,null,R(r.multipleChoices,T=>(o(),i("li",null,[g(m(T.text)+" ",1),T.isAnswer?(o(),i("span",Wt," ("+m(T.isAnswer)+") ",1)):L("v-if",!0)]))),256))])])):L("v-if",!0),r.type===t.QUESTION_TYPE.MATCHING?(o(!0),i(G,{key:1},R(r.matchingPairs,T=>(o(),i("div",Zt,[n("span",$t,m(T.leftItem),1),e[19]||(e[19]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",en,m(T.rightItem),1)]))),256)):L("v-if",!0),r.type===t.QUESTION_TYPE.ORDERING?(o(),i("div",tn,[n("div",nn,[(o(!0),i(G,null,R(r.orderingItems,T=>(o(),i("div",null,m(T.text),1))),256))]),e[20]||(e[20]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",an,[(o(!0),i(G,null,R(r.orderingItems,(T,Y)=>(o(),i("div",ln,[n("span",null,"#"+m(Y+1),1),g(" - "+m(T.text),1)]))),256))])])):L("v-if",!0),r.type===t.QUESTION_TYPE.SHORT_TEXT?(o(),i(G,{key:3},[e[21]||(e[21]=n("span",null,"Answer:",-1)),n("div",on,m(r.shortAnswer),1)],64)):L("v-if",!0)],8,Kt)]),n("div",sn,[n("i",{class:"bx bx-chevron-up",onClick:T=>t.toggleDisplayAnswer(H,T.currentTarget)},null,8,rn)])]))),256))])]),_:1},8,["value"])]),e[24]||(e[24]=n("div",{class:"modal-generate-by-ai-warning"},[n("span",null,[n("i",{class:"bx bx-info-circle"}),g(" AI can make mistakes. Please check carefully the important info. ")])],-1)),n("div",cn,[l(b,{class:"main-color-btn",key:"submit",type:"primary",size:"large",onClick:t.handleModalImport},{default:s(()=>e[22]||(e[22]=[g(" Import ")])),_:1,__:[22]})])])])])]}),_:1},8,["spinning","indicator"])]),_:1},8,["open"]),l(t.GenerateFileStructure,{file:t.files[0],ref:"generateFileStructureRef",onImport:t.handleImportStructure},null,8,["file"])],64)}const yn=_e(Ot,[["render",dn],["__scopeId","data-v-23b34ba3"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateQSModal.vue"]]);export{yn as G,hn as I};
