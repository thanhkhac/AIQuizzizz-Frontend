var Te=Object.defineProperty;var Ie=(o,t,g)=>t in o?Te(o,t,{enumerable:!0,configurable:!0,writable:!0,value:g}):o[t]=g;var ne=(o,t,g)=>Ie(o,typeof t!="symbol"?t+"":t,g);import{c as s,I as xe,d as fe,u as be,i as w,j as de,B as ye,C as pe,s as ke,k as U,M as ee,_ as ge,r as v,E as oe,o as i,w as r,b as n,f as b,t as l,al as le,p as V,a as c,F as L,D as z,e as q,J as ie,v as Se,L as we,G as ue,am as Ee,an as Ae,R as Ce}from"./index-DjZzqq9v.js";import{A as Me}from"./ApiTestTemplate-DUUU8Pdw.js";import{Q as me}from"./questionTypes-CS3lcRlq.js";import{S as ae}from"./languages-DtYW231W.js";import{T as Oe}from"./TextArea-Ch3F-Nss.js";var De={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function he(o){for(var t=1;t<arguments.length;t++){var g=arguments[t]!=null?Object(arguments[t]):{},e=Object.keys(g);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(g).filter(function(Q){return Object.getOwnPropertyDescriptor(g,Q).enumerable}))),e.forEach(function(Q){Le(o,Q,g[Q])})}return o}function Le(o,t,g){return t in o?Object.defineProperty(o,t,{value:g,enumerable:!0,configurable:!0,writable:!0}):o[t]=g,o}var se=function(t,g){var e=he({},t,g.attrs);return s(xe,he({},e,{icon:De}),null)};se.displayName="InboxOutlined";se.inheritAttrs=!1;const re={ALL:"all",VALID:"valid",IN_VALID:"invalid"},qe=fe({__name:"ImportQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(o,{expose:t,emit:g}){const{t:e}=be(),Q=o,B=g,D=w(!1),h=w([]),T=w([]),I=w([]),p=de({checkAll:!1,indeterminate:!1,checkedList:[]}),M=()=>{p.checkedList=[],D.value=!0},E=()=>{D.value=!1};t({openImportModal:M});const k=w([]),S=w(null),a=w(!1),P=()=>{var d;(d=S.value)==null||d.click()},G=async d=>{if(d){if(d.type!=="application/vnd.ms-excel"&&d.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"){U.error(e("message.file_support_only",{fileTypes:"XLS, XLSX"}));return}k.value=[],U.success(e("message.uploaded_successfully",{name:d.name})),k.value.push(d);const _=await Me.ImportFile(k.value[0]);_.data.success&&(h.value=[..._.data.data.validQuestions,..._.data.data.invalidQuestions],T.value=[..._.data.data.validQuestions,..._.data.data.invalidQuestions],I.value=_.data.data.invalidQuestions,p.checkedList=[]);return}U.error(e("message.uploaded_failed"))},C=async d=>{var H;const _=d.target,y=(H=_.files)==null?void 0:H[0];y&&(G(y),_.value="")},u=d=>{var y;const _=((y=d.dataTransfer)==null?void 0:y.types)||[];Array.from(_).includes("files")&&(a.value=!0)},F=d=>{var y;const _=(y=d.dataTransfer)==null?void 0:y.files[0];a.value=!1,_&&G(_)},O=d=>{var _;(_=k.value)==null||_.splice(d,1),p.checkedList=[],h.value=[],I.value=[],T.value=[]},J=Object.values(re),Y=ye(()=>J.map(d=>({label:e(`import_qs_modal.uploaded_question_status.${d}`),value:d}))),X=w(Y.value[0].value),W=()=>{var _,y;p.checkedList=[];let d=h.value;switch(X.value){case re.VALID:{d=(_=h.value)==null?void 0:_.filter(H=>{var K;return!((K=I.value)!=null&&K.includes(H))});break}case re.IN_VALID:{d=(y=h.value)==null?void 0:y.filter(H=>{var K;return(K=I.value)==null?void 0:K.includes(H)});break}}T.value=d||[]},Z=d=>{Object.assign(p,{checkedList:d.target.checked?T.value:[],indeterminate:!1})};pe(()=>p.checkedList,d=>{var _;p.indeterminate=!!d.length&&d.length<T.value.length,p.checkAll=d.length===((_=T.value)==null?void 0:_.length)});const f=(d,_)=>{$(_).toggleClass("bx-chevron-up bx-chevron-down");const H=$(`#question-item-answer-${d}`);H&&$(H).slideToggle()},R=()=>{if(p.checkedList.length===0){U.warning(e("message.minimum_question",{number:5}));return}if(p.checkedList.length+Q.numberOfQuestion>500){U.warning(e("message.limit_question",{number:500}));return}ee.confirm({title:e("import_qs_modal.confirm_modal.title"),content:e("import_qs_modal.confirm_modal.content",{number:p.checkedList.length}),okText:e("create_QS.buttons.ok"),cancelText:e("create_QS.buttons.cancel"),onOk:()=>{var _;const d=(_=T.value)==null?void 0:_.filter(y=>p.checkedList.includes(y));B("import",d),E()}})};ke(()=>{});const A={t:e,props:Q,emit:B,modal_import_open:D,question_data:h,uploadedQuestions:T,uploadedInvalidQuestions:I,importModalState:p,openImportModal:M,closeImportModal:E,files:k,fileInput:S,isDragging:a,openFileExplorer:P,onFileChange:G,handleFileChange:C,handleDragEnter:u,handleDrop:F,onRemoveUploadedFile:O,optionKeys:J,select_options:Y,selected_option:X,onFilter:W,onCheckAll:Z,toggleDisplayAnswer:f,handleModalImport:R,get InboxOutlined(){return se},get QUESTION_TYPE(){return me}};return Object.defineProperty(A,"__isScriptSetup",{enumerable:!1,value:!0}),A}}),Ge={class:"modal-container"},Qe={class:"modal-title-container"},Fe={class:"modal-content-item"},Ne={class:"content-item-section upload-section"},Ue={class:"section-title"},ze={class:"section-content"},Pe={class:"customized-file-upload-icons"},Re={class:"customized-file-upload-ins"},Be={class:"customized-file-upload-hint"},Je={class:"file-container"},He={class:"file-item"},je=["onClick"],Ve={class:"content-item-section preview-section"},Ye={class:"section-title"},Xe={class:"section-content"},Ke={key:0,class:"section-content-header"},$e={class:"d-flex"},We={class:"preview-question-container"},Ze={class:"question-item-content"},et=["innerHTML"],tt={key:1,class:"question-text"},nt=["id"],at={key:0,class:"multiple-choice-answer"},ot={key:0,class:"text-success"},lt={class:"pair-answer"},st={class:"pair-answer-item"},it={class:"pair-answer-item"},rt={key:2,class:"ordering-answer"},ct={class:"ordering-answer-item"},dt={class:"ordering-answer-item"},ut={class:"ordering-answer-item"},mt={key:3,class:"short-text-answer"},_t={class:"question-item-toogle-btn"},ft=["onClick"],pt={class:"mt-4 d-flex align-items-center"},gt={class:"header-item"};function vt(o,t,g,e,Q,B){const D=v("RouterLink"),h=v("a-col"),T=v("a-row"),I=v("a-button"),p=v("a-checkbox"),M=v("a-select-option"),E=v("a-select"),k=v("a-checkbox-group"),S=v("a-modal");return i(),oe(S,{centered:"",width:"100%","wrap-class-name":"full-modal",open:e.modal_import_open,onCancel:e.closeImportModal},{footer:r(()=>[n("div",pt,[n("div",gt,l(o.$t("import_qs_modal.other.total_question",{number:e.importModalState.checkedList.length})),1),s(I,{class:"main-color-btn",size:"large",key:"submit",type:"primary",onClick:e.handleModalImport},{default:r(()=>[b(l(o.$t("import_qs_modal.buttons.import")),1)]),_:1})])]),default:r(()=>[n("div",Ge,[n("div",Qe,[s(T,{class:"w-100 d-flex align-items-center"},{default:r(()=>[s(h,{span:1},{default:r(()=>[s(D,{onClick:e.closeImportModal,to:{name:""}},{default:r(()=>t[5]||(t[5]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[5]})]),_:1}),s(h,{class:"main-title",span:23},{default:r(()=>[n("span",null,l(o.$t("import_qs_modal.title")),1),t[6]||(t[6]=b()),t[7]||(t[7]=n("br",null,null,-1)),n("span",null,l(o.$t("import_qs_modal.sub_title")),1)]),_:1,__:[6,7]})]),_:1})]),n("div",Fe,[n("div",Ne,[n("div",Ue,[n("span",null,l(o.$t("import_qs_modal.upload_section")),1),s(I,{class:"main-color-btn",type:"primary"},{default:r(()=>[b(l(o.$t("import_qs_modal.buttons.download")),1)]),_:1})]),n("div",ze,[n("input",{onChange:e.handleFileChange,class:"d-none",type:"file",ref:"fileInput",accept:".xls,.xlsx"},null,544),n("div",{class:V(["customized-file-upload",e.isDragging?"is-dragging":""]),onClick:e.openFileExplorer,onDragenter:e.handleDragEnter,onDragover:t[0]||(t[0]=le(a=>e.isDragging=!0,["prevent"])),onDragleave:t[1]||(t[1]=a=>e.isDragging=!1),onDrop:le(e.handleDrop,["prevent"])},[n("div",Pe,[n("i",{class:V(["bx","bx-down-arrow-alt","bx-fade-up",e.isDragging?"":"d-none"])},null,2),s(e.InboxOutlined,{class:V([e.isDragging?"d-none":""])},null,8,["class"])]),n("div",Re,l(o.$t("import_qs_modal.upload_area.title")),1),n("div",Be,[b(l(o.$t("import_qs_modal.upload_area.content"))+" ",1),t[8]||(t[8]=n("br",null,null,-1)),b(" "+l(o.$t("import_qs_modal.upload_area.sub_content")),1)])],34)]),n("div",Je,[(i(!0),c(L,null,z(e.files,(a,P)=>(i(),c("div",He,[n("span",null,l(a.name),1),n("i",{class:"bx bx-trash text-danger",onClick:G=>e.onRemoveUploadedFile(P)},null,8,je)]))),256))])]),n("div",Ve,[n("div",Ye,l(o.$t("import_qs_modal.preview_section")),1),n("div",Xe,[e.question_data.length>0?(i(),c("div",Ke,[s(p,{class:V(["header-item",e.importModalState.checkAll?"check-all":""]),onClick:e.onCheckAll,checked:e.importModalState.checkAll,"onUpdate:checked":t[2]||(t[2]=a=>e.importModalState.checkAll=a),indeterminate:e.importModalState.indeterminate},{default:r(()=>[b(l(o.$t("share_modal.buttons.check_all",{number:e.importModalState.checkedList.length})),1)]),_:1},8,["class","checked","indeterminate"]),n("div",$e,[s(E,{size:"large",class:"me-3",value:e.selected_option,"onUpdate:value":t[3]||(t[3]=a=>e.selected_option=a),style:{width:"200px"},onChange:e.onFilter},{default:r(()=>[(i(!0),c(L,null,z(e.select_options,a=>(i(),oe(M,{value:a.value},{default:r(()=>[b(l(a.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])])):q("v-if",!0),s(k,{value:e.importModalState.checkedList,"onUpdate:value":t[4]||(t[4]=a=>e.importModalState.checkedList=a)},{default:r(()=>[n("div",We,[(i(!0),c(L,null,z(e.uploadedQuestions,(a,P)=>{var G;return i(),c("div",{class:V(["preview-question-item",(G=e.uploadedInvalidQuestions)!=null&&G.includes(a)?"invalid":""])},[s(p,{value:a},null,8,["value"]),n("div",Ze,[a.questionHTML?(i(),c("div",{key:0,class:"question-html",innerHTML:a.questionHTML},null,8,et)):(i(),c("div",tt,l(a.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${P}`},[a.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(i(),c("div",at,[n("ul",null,[(i(!0),c(L,null,z(a.multipleChoices,C=>(i(),c("li",null,[b(l(C.text)+" ",1),C.isAnswer?(i(),c("span",ot," ("+l(C.isAnswer)+") ",1)):q("v-if",!0)]))),256))])])):q("v-if",!0),a.type===e.QUESTION_TYPE.MATCHING?(i(!0),c(L,{key:1},z(a.matchingPairs,C=>(i(),c("div",lt,[n("span",st,l(C.leftItem),1),t[9]||(t[9]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",it,l(C.rightItem),1)]))),256)):q("v-if",!0),a.type===e.QUESTION_TYPE.ORDERING?(i(),c("div",rt,[n("div",ct,[(i(!0),c(L,null,z(a.orderingItems,C=>(i(),c("div",null,l(C.text),1))),256))]),t[10]||(t[10]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",dt,[(i(!0),c(L,null,z(a.orderingItems,(C,u)=>(i(),c("div",ut,[n("span",null,"#"+l(u+1),1),b(" - "+l(C.text),1)]))),256))])])):q("v-if",!0),a.type===e.QUESTION_TYPE.SHORT_TEXT?(i(),c("div",mt,l(a.shortAnswer),1)):q("v-if",!0)],8,nt)]),n("div",_t,[n("i",{class:"bx bx-chevron-up",onClick:C=>e.toggleDisplayAnswer(P,C.currentTarget)},null,8,ft)])],2)}),256))])]),_:1},8,["value"])])])])])]),_:1},8,["open"])}const En=ge(qe,[["render",vt],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/ImportQSModal.vue"]]),ht={HARD:"Hard",MEDIUM:"Medium",EASY:"Easy"},ce={GENERATE_QUESTION:"AiGenerate/GenerateQuestion",GENERATE_DOCUMENT_STRUCTURE:"AiGenerate/GenerateDocumentStructure",GET_COST_TO_GENERATE:"AiGenerate/DocumentStructure/GetCostToGenerate"};class bt{constructor(){ne(this,"GenerateQuestion",async t=>await ie.post(ce.GENERATE_QUESTION,t,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0}));ne(this,"GenerateDocumentStructure",async t=>{const g=new FormData;return g.append("file",t),await ie.post(ce.GENERATE_DOCUMENT_STRUCTURE,g,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})});ne(this,"GetCostToGenerate",async t=>{const g=new FormData;return g.append("file",t),await ie.post(ce.GET_COST_TO_GENERATE,g,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})})}}const _e=new bt,yt=fe({__name:"GenerateFileStructure",props:{file:{type:null,required:!0}},emits:["import"],setup(o,{expose:t,emit:g}){const e=o,Q=Se(we,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),B=w(),D=w([]);function h(f){return f?Array.isArray(f)?f:[f]:[]}function T(f){return h(f).map(A=>{const d=h(A==null?void 0:A.children);return{...A,title:String((A==null?void 0:A.title)??""),key:crypto.randomUUID(),children:d.length?T(d):void 0}})}const I=w([]),p=w([]);function M(f,R){const A=[];for(const d of f){const _=R.includes(d.key),y=d.children?M(d.children,R):[];(_||y.length>0)&&A.push({title:d.title,key:d.key,children:y.length?y:void 0})}return A}const E=ye(()=>M(I.value,p.value));pe(I,async()=>{I.value.length>0&&(await ue(),B.value&&(B.value.scrollTop=0))});const k=w(null),S=w(!1),a=w(!1),P=async()=>{try{a.value=!0;const f=await _e.GetCostToGenerate(e.file);return f.data.success?f.data.data:(ee.error({title:"Error",content:f.data.message||"Failed to get cost to generate."}),null)}catch(f){return console.error(f),null}finally{a.value=!1}},G=async()=>{try{a.value=!0;const f=await _e.GenerateDocumentStructure(e.file);if(!f.data.success){ee.error({title:"Error",content:f.data.message||"Failed to generate file structure."});return}const R=typeof f.data=="string"?JSON.parse(f.data):f.data,A=R==null?void 0:R.data,d=h(A==null?void 0:A.children);D.value=d,I.value=T(D.value)}catch(f){console.error(f)}finally{a.value=!1,F.value=!1}},C=async()=>{if(S.value=!0,D.value.length>0||k.value)return;const f=await P();if(!f){U.error("Failed to get cost to generate file structure.");return}k.value=f,F.value=!0},u=()=>{S.value=!1,Y()},F=w(!1),O=async()=>{k.value&&await G()},J=g,Y=()=>{var _,y;if(I.value.length===0||E.value.length===0)return;const f=(_=I.value)==null?void 0:_[0],R=JSON.stringify({title:f.title,children:f.children}),A=(y=E.value)==null?void 0:y[0],d=JSON.stringify({title:A.title,children:A.children});J("import",R,d)},X=()=>{if(E.value.length===0){ee.error({title:"Error",content:"Please choose at least one section in your document to proceed.",centered:!0});return}Y(),u()},W=()=>{D.value=[],I.value=[],k.value=null};t({openModal:C,closeModal:u,clearData:W});const Z={props:e,indicator:Q,modalContentRef:B,serverData:D,toArray:h,addRandomKeys:T,treeData:I,checked:p,filterTree:M,selectedTree:E,cost:k,modal_open:S,loading:a,getCostToGenerate:P,generateTreeData:G,openModal:C,closeModal:u,modal_confirm_generate_structure_open:F,onConfirmGenerateFileStructure:O,emit:J,onEmitImport:Y,onConfirmImportStructure:X,clearData:W,get ExclamationCircleFilled(){return Ae},get ATree(){return Ee}};return Object.defineProperty(Z,"__isScriptSetup",{enumerable:!1,value:!0}),Z}}),kt={class:"modal-container"},St={class:"modal-title-container"},wt={class:"modal-content-item",ref:"modalContentRef"},Tt={key:0,class:"loading-container"},It={key:0},xt={key:1,class:"content-wrapper"},Et={key:0,class:"tree-container"},At={class:"button-container"},Ct={class:"confirm-modal-container"},Mt={class:"d-flex align-items-center"},Ot={class:"fs-6 fw-bold"},Dt={class:"fs-6 ms-5 mt-3"},Lt={class:"fw-bold text-danger"};function qt(o,t,g,e,Q,B){const D=v("RouterLink"),h=v("a-col"),T=v("a-row"),I=v("a-spin"),p=v("a-button"),M=v("a-modal");return i(),c(L,null,[s(M,{centered:"",width:"100%","wrap-class-name":"medium-modal large",open:e.modal_open,onCancel:e.closeModal},{footer:r(()=>[s(p,{class:"main-color-btn",type:"primary",onClick:e.onConfirmImportStructure},{default:r(()=>[b(l(o.$t("generate_file_structure.buttons.confirm")),1)]),_:1})]),default:r(()=>[n("div",kt,[n("div",St,[s(T,{class:"w-100 d-flex align-items-center"},{default:r(()=>[s(h,{span:1},{default:r(()=>[s(D,{onClick:e.closeModal,to:{name:""}},{default:r(()=>t[3]||(t[3]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[3]})]),_:1}),s(h,{class:"main-title",span:23},{default:r(()=>[n("span",null,l(o.$t("generate_file_structure.title")),1),t[4]||(t[4]=b()),t[5]||(t[5]=n("br",null,null,-1)),n("span",null,l(o.$t("generate_file_structure.sub_title")),1)]),_:1,__:[4,5]})]),_:1})]),n("div",wt,[e.loading?(i(),c("div",Tt,[s(I,{size:"large",indicator:e.indicator},null,8,["indicator"]),e.cost?q("v-if",!0):(i(),c("div",It,l(o.$t("generate_file_structure.other.calculating")),1))])):(i(),c("div",xt,[e.treeData.length>0?(i(),c("div",Et,[s(e.ATree,{checkedKeys:e.checked,"onUpdate:checkedKeys":t[0]||(t[0]=E=>e.checked=E),"tree-data":e.treeData,checkable:"","show-icon":!1,"show-line":!0,"field-names":{title:"title",key:"key",children:"children"},defaultExpandAll:!0,style:{width:"100%"}},null,8,["checkedKeys","tree-data"])])):e.cost?(i(),c(L,{key:1},[q(" get cost success but cancel "),n("div",At,[s(p,{type:"primary",class:"main-color-btn",onClick:t[1]||(t[1]=E=>e.modal_confirm_generate_structure_open=!0)},{default:r(()=>[b(l(o.$t("generate_file_structure.buttons.generate_structure")),1)]),_:1})])],2112)):q("v-if",!0)]))],512)])]),_:1},8,["open"]),s(M,{"wrap-class-name":"medium-modal",centered:"",open:e.modal_confirm_generate_structure_open,closable:!1},{footer:r(()=>[s(p,{class:V(["main-color-btn-ghost",e.loading?"main-color-btn-disabled":""]),type:"ghost",onClick:t[2]||(t[2]=E=>e.modal_confirm_generate_structure_open=!1)},{default:r(()=>[b(l(o.$t("sidebar.buttons.cancel")),1)]),_:1},8,["class"]),s(p,{loading:e.loading,class:"main-color-btn",type:"primary",onClick:e.onConfirmGenerateFileStructure},{default:r(()=>[b(l(o.$t("generate_file_structure.buttons.confirm")),1)]),_:1},8,["loading"])]),default:r(()=>{var E;return[n("div",Ct,[n("div",Mt,[s(e.ExclamationCircleFilled,{class:"fs-4 me-3 text-warning"}),n("div",Ot,l(o.$t("generate_file_structure.confirm_modal.title")),1)]),n("div",Dt,[b(l(o.$t("generate_file_structure.confirm_modal.content"))+" ",1),n("span",Lt,l((E=e.cost)==null?void 0:E.miniumPointToGenerate),1),b(" "+l(o.$t("generate_file_structure.confirm_modal.content_tail")),1)])])]}),_:1},8,["open"])],64)}const Gt=ge(yt,[["render",qt],["__scopeId","data-v-8be2b719"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateFileStructure.vue"]]),Qt=fe({__name:"GenerateQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(o,{expose:t,emit:g}){const{t:e}=be(),Q=o,B=g,D=w(!1),h=()=>{S.checkedList=[],D.value=!0},T=()=>{D.value=!1};t({openGenerateAIModal:h});const I=()=>{if(S.checkedList.length===0){U.warning(e("message.minimum_question",{number:5}));return}if(S.checkedList.length+Q.numberOfQuestion>500){U.warning(e("message.limit_question",{number:500}));return}ee.confirm({title:e("import_qs_modal.confirm_modal.title"),content:e("import_qs_modal.confirm_modal.content",{number:S.checkedList.length}),okText:e("create_QS.buttons.ok"),cancelText:e("create_QS.buttons.cancel"),onOk:()=>{const m=k.value.filter(x=>S.checkedList.includes(x.id));B("import",m),T()}})},p=Object.values(me).map(m=>({label:e(`create_QS.type.${m}`),value:m})),M=Object.values(ht).map(m=>({label:m,value:m})),E=w([]);for(let m=10;m<=50;m+=10)E.value.push({label:m,value:m});const k=w([]),S=de({checkAll:!1,indeterminate:!1,checkedList:[]}),a=de({file:null,isGenerateExplain:!0,language:ae[0].code,questionCount:E.value[0].value,questionTypes:[p[0]],documentStructureJson:null,selectedPartJson:null,title:""}),P=m=>{a.questionTypes.length===0&&(U.warning(e("message.minimun_question_type")),a.questionTypes.push(m))},G=w(!1),C=Se(we,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),u=async()=>{var m;try{if(G.value=!0,!a.title&&a.isGenerateExplain){U.error(e("message.invalid_reference"));return}if(a.documentStructureJson===null||a.selectedPartJson===null){ee.error({title:e("generate_qs_modal.invalid_structure_modal.title"),content:e("generate_qs_modal.invalid_structure_modal.content"),centered:!0}),y();return}const x=JSON.parse(a.documentStructureJson),j=JSON.parse(a.selectedPartJson);a.isGenerateExplain&&a.title&&(a.documentStructureJson=JSON.stringify({...x,title:a.title}),a.selectedPartJson=JSON.stringify({...j,title:a.title}));const N=new FormData;N.append("file",F.value[0]),N.append("isGenerateExplain",a.isGenerateExplain?"true":"false"),N.append("language",((m=ae.find(te=>te.code===a.language))==null?void 0:m.label)||ae[0].label),N.append("questionCount",a.questionCount),N.append("questionTypes",JSON.stringify(a.questionTypes.map(te=>te))),N.append("documentStructureJson",a.documentStructureJson),N.append("selectedPartJson",a.selectedPartJson);const ve=await _e.GenerateQuestion(N);if(!ve.data.success){U.error("Generate failed!");return}k.value=[...k.value||[],...ve.data.data.map(te=>({...te,questionId:Ce().valueOf()}))],await ue(),S.checkedList=[],S.indeterminate=!1,S.checkAll=!1}catch(x){console.log(x)}finally{G.value=!1}},F=w([]),O=w(null),J=w(!1),Y=()=>{var m;(m=O.value)==null||m.click()},X=async m=>{if(m){if(m.type!=="application/pdf"){U.error(e("message.file_support_only",{fileTypes:"PDF"}));return}F.value=[],U.success(e("message.uploaded_successfully",{name:m.name})),F.value.push(m);const x=m.name.replace(/\.[^/.]+$/,"");a.title=x,await ue(),y();return}U.error(e("message.uploaded_failed"))},W=m=>{var N;const x=m.target,j=(N=x.files)==null?void 0:N[0];j&&(X(j),x.value="")},Z=m=>{var j;const x=((j=m.dataTransfer)==null?void 0:j.types)||[];Array.from(x).includes("files")&&(J.value=!0)},f=async m=>{var j;const x=(j=m.dataTransfer)==null?void 0:j.files[0];J.value=!1,x&&X(x)},R=()=>{var m;F.value=[],(m=_.value)==null||m.clearData()},A=m=>{Object.assign(S,{checkedList:m.target.checked?k.value.map(x=>x.id):[],indeterminate:!1})};pe(()=>S.checkedList,m=>{S.indeterminate=!!m.length&&m.length<k.value.map(x=>x.id).length,S.checkAll=m.length===k.value.length});const d=(m,x)=>{$(x).toggleClass("bx-chevron-up bx-chevron-down");const N=$(`#question-item-answer-${m}`);N&&$(N).slideToggle()},_=w(null),y=()=>{_.value&&_.value.openModal()},H=(m,x)=>{a.documentStructureJson=m,a.selectedPartJson=x};ke(()=>{});const K={t:e,props:Q,emit:B,modal_generate_ai_open:D,openGenerateAIModal:h,closeGenerateAIModal:T,handleModalImport:I,questionTypeOptions:p,questionDifficultyOptions:M,questionMaximumOptions:E,generatedQuestions:k,generateModalState:S,generateByAIModalState:a,onDeselectQuestionType:P,loading:G,indicator:C,onGenerateQuestions:u,files:F,fileInput:O,isDragging:J,openFileExplorer:Y,onFileChange:X,handleFileChange:W,handleDragEnter:Z,handleDrop:f,onRemoveUploadedFile:R,onCheckAll:A,toggleDisplayAnswer:d,generateFileStructureRef:_,openFileStructureModal:y,handleImportStructure:H,get QUESTION_TYPE(){return me},get SUPPORTED_LOCALES(){return ae},get InboxOutlined(){return se},TextArea:Oe,GenerateFileStructure:Gt};return Object.defineProperty(K,"__isScriptSetup",{enumerable:!1,value:!0}),K}}),Ft={class:"modal-container"},Nt={class:"modal-title-container"},Ut={class:"modal-content-item"},zt={class:"content-item-section upload-section"},Pt={class:"section-title"},Rt={key:0,class:"section-content mb-2"},Bt={class:"customized-file-upload-icons"},Jt={class:"customized-file-upload-ins"},Ht={class:"customized-file-upload-hint"},jt={key:1,class:"file-container"},Vt={class:"file-item"},Yt={class:"content-item-section preview-section"},Xt={class:"section-title"},Kt={class:"section-content"},$t={key:0,class:"section-content-header"},Wt={class:"header-item"},Zt={class:"preview-question-container"},en={class:"preview-question-item"},tn={class:"question-item-content"},nn=["innerHTML"],an={key:1,class:"question-text"},on=["id"],ln={key:0,class:"multiple-choice-answer"},sn={key:0,class:"text-success"},rn={class:"pair-answer"},cn={class:"pair-answer-item"},dn={class:"pair-answer-item"},un={key:2,class:"ordering-answer"},mn={class:"ordering-answer-item"},_n={class:"ordering-answer-item"},fn={class:"ordering-answer-item"},pn={class:"short-text-answer"},gn={class:"question-item-toogle-btn"},vn=["onClick"],hn={class:"modal-generate-by-ai-warning"},bn={class:"w-100 d-flex justify-content-end"};function yn(o,t,g,e,Q,B){const D=v("RouterLink"),h=v("a-col"),T=v("a-row"),I=v("a-select-option"),p=v("a-select"),M=v("a-form-item"),E=v("a-switch"),k=v("a-button"),S=v("a-form"),a=v("a-checkbox"),P=v("a-checkbox-group"),G=v("a-spin"),C=v("a-modal");return i(),c(L,null,[s(C,{centered:"",width:"100%",closable:!1,"wrap-class-name":"full-modal",open:e.modal_generate_ai_open,onCancel:e.closeGenerateAIModal},{footer:r(()=>t[20]||(t[20]=[])),default:r(()=>[s(G,{spinning:e.loading,size:"large",indicator:e.indicator},{default:r(()=>[n("div",Ft,[n("div",Nt,[s(T,{class:"w-100 d-flex align-items-center"},{default:r(()=>[s(h,{span:1},{default:r(()=>[s(D,{onClick:e.closeGenerateAIModal,to:{name:""}},{default:r(()=>t[11]||(t[11]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[11]})]),_:1}),s(h,{class:"main-title",span:23},{default:r(()=>[n("span",null,l(o.$t("generate_qs_modal.title")),1),t[12]||(t[12]=b()),t[13]||(t[13]=n("br",null,null,-1)),n("span",null,l(o.$t("generate_qs_modal.sub_title")),1)]),_:1,__:[12,13]})]),_:1})]),n("div",Ut,[n("div",zt,[n("div",Pt,[n("span",null,l(o.$t("import_qs_modal.upload_section")),1)]),e.files.length?q("v-if",!0):(i(),c("div",Rt,[n("input",{onChange:e.handleFileChange,class:"d-none",type:"file",ref:"fileInput",accept:".pdf"},null,544),n("div",{class:V(["customized-file-upload",e.isDragging?"is-dragging":""]),onClick:e.openFileExplorer,onDragenter:e.handleDragEnter,onDragover:t[0]||(t[0]=le(u=>e.isDragging=!0,["prevent"])),onDragleave:t[1]||(t[1]=u=>e.isDragging=!1),onDrop:le(e.handleDrop,["prevent"])},[n("div",Bt,[n("i",{class:V(["bx","bx-down-arrow-alt","bx-fade-up",e.isDragging?"":"d-none"])},null,2),s(e.InboxOutlined,{class:V([e.isDragging?"d-none":""])},null,8,["class"])]),n("div",Jt,l(o.$t("import_qs_modal.upload_area.title")),1),n("div",Ht,[b(l(o.$t("import_qs_modal.upload_area.content"))+" ",1),t[14]||(t[14]=n("br",null,null,-1)),b(" "+l(o.$t("import_qs_modal.upload_area.sub_content")),1)])],34)])),e.files.length?(i(),c("div",jt,[(i(!0),c(L,null,z(e.files,u=>(i(),c("div",Vt,[n("span",null,l(u.name),1),n("i",{class:"bx bx-trash text-danger",onClick:t[2]||(t[2]=F=>e.onRemoveUploadedFile())})]))),256)),n("div",{class:"file-structure",onClick:e.openFileStructureModal},[t[15]||(t[15]=n("i",{class:"bx bx-file"},null,-1)),n("div",null,l(o.$t("generate_qs_modal.form.structure")),1)])])):q("v-if",!0),s(S,{layout:"vertical",class:"generate-ai-form"},{default:r(()=>[s(T,{class:"d-flex justify-content-between"},{default:r(()=>[s(h,{span:12},{default:r(()=>[s(M,{l:"",label:e.t("generate_qs_modal.form.language")},{default:r(()=>[s(p,{class:"language-select",value:e.generateByAIModalState.language,"onUpdate:value":t[3]||(t[3]=u=>e.generateByAIModalState.language=u)},{default:r(()=>[(i(!0),c(L,null,z(e.SUPPORTED_LOCALES,u=>(i(),oe(I,{key:`locale-${u.code}`,value:u.code},{default:r(()=>[b(l(u.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),s(h,{span:11},{default:r(()=>[s(M,{label:e.t("generate_qs_modal.form.maximum_question")},{default:r(()=>[s(p,{value:e.generateByAIModalState.questionCount,"onUpdate:value":t[4]||(t[4]=u=>e.generateByAIModalState.questionCount=u),style:{width:"100%"},placeholder:"Maximum number of question",options:e.questionMaximumOptions},null,8,["value","options"])]),_:1},8,["label"])]),_:1})]),_:1}),s(M,{label:e.t("generate_qs_modal.form.question_types")},{default:r(()=>[s(p,{onDeselect:e.onDeselectQuestionType,value:e.generateByAIModalState.questionTypes,"onUpdate:value":t[5]||(t[5]=u=>e.generateByAIModalState.questionTypes=u),mode:"multiple",style:{width:"100%"},placeholder:"Select multiple",options:e.questionTypeOptions},null,8,["value","options"])]),_:1},8,["label"]),s(T,{class:"d-flex justify-content-between"},{default:r(()=>[s(h,{span:7},{default:r(()=>[s(M,{label:e.t("generate_qs_modal.form.enable_explaination")},{default:r(()=>[s(E,{checked:e.generateByAIModalState.isGenerateExplain,"onUpdate:checked":t[6]||(t[6]=u=>e.generateByAIModalState.isGenerateExplain=u)},null,8,["checked"])]),_:1},8,["label"])]),_:1}),e.generateByAIModalState.isGenerateExplain?(i(),oe(h,{key:0,span:16},{default:r(()=>[s(M,{label:e.t("generate_qs_modal.form.reference_name")},{default:r(()=>[s(e.TextArea,{modelValue:e.generateByAIModalState.title,"onUpdate:modelValue":t[7]||(t[7]=u=>e.generateByAIModalState.title=u),"is-required":e.generateByAIModalState.isGenerateExplain,"max-length":200,placeholder:e.t("generate_qs_modal.form.reference_name_placeholder"),readonly:!e.generateByAIModalState.isGenerateExplain},null,8,["modelValue","is-required","placeholder","readonly"])]),_:1},8,["label"])]),_:1})):q("v-if",!0)]),_:1}),s(M,{style:{"margin-top":"7px"},class:"generate-ai-btn-container"},{default:r(()=>[s(k,{loading:e.loading,size:"large",class:"w-100 main-color-btn generate_ai",type:"primary",onClick:e.onGenerateQuestions},{default:r(()=>[b(l(o.$t("generate_qs_modal.buttons.generate")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),n("div",Yt,[n("div",Xt,l(o.$t("import_qs_modal.preview_section")),1),n("div",Kt,[e.generatedQuestions.length>0?(i(),c("div",$t,[s(a,{class:V(["header-item",e.generateModalState.checkAll?"check-all":""]),onClick:e.onCheckAll,checked:e.generateModalState.checkAll,"onUpdate:checked":t[8]||(t[8]=u=>e.generateModalState.checkAll=u),indeterminate:e.generateModalState.indeterminate},{default:r(()=>[b(l(o.$t("share_modal.buttons.check_all",{number:e.generateModalState.checkedList.length})),1)]),_:1},8,["class","checked","indeterminate"]),n("div",Wt,l(o.$t("import_qs_modal.other.total_question",{number:e.generateModalState.checkedList.length})),1)])):q("v-if",!0),s(P,{value:e.generateModalState.checkedList,"onUpdate:value":t[10]||(t[10]=u=>e.generateModalState.checkedList=u)},{default:r(()=>[n("div",Zt,[(i(!0),c(L,null,z(e.generatedQuestions,(u,F)=>(i(),c("div",en,[s(a,{onClick:t[9]||(t[9]=O=>console.log(e.generateModalState.checkedList)),value:u.id},null,8,["value"]),n("div",tn,[u.questionHTML?(i(),c("div",{key:0,class:"question-html",innerHTML:u.questionHTML},null,8,nn)):(i(),c("div",an,l(u.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${F}`},[u.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(i(),c("div",ln,[n("ul",null,[(i(!0),c(L,null,z(u.multipleChoices,O=>(i(),c("li",null,[b(l(O.text)+" ",1),O.isAnswer?(i(),c("span",sn," ("+l(O.isAnswer)+") ",1)):q("v-if",!0)]))),256))])])):q("v-if",!0),u.type===e.QUESTION_TYPE.MATCHING?(i(!0),c(L,{key:1},z(u.matchingPairs,O=>(i(),c("div",rn,[n("span",cn,l(O.leftItem),1),t[16]||(t[16]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",dn,l(O.rightItem),1)]))),256)):q("v-if",!0),u.type===e.QUESTION_TYPE.ORDERING?(i(),c("div",un,[n("div",mn,[(i(!0),c(L,null,z(u.orderingItems,O=>(i(),c("div",null,l(O.text),1))),256))]),t[17]||(t[17]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",_n,[(i(!0),c(L,null,z(u.orderingItems,(O,J)=>(i(),c("div",fn,[n("span",null,"#"+l(J+1),1),b(" - "+l(O.text),1)]))),256))])])):q("v-if",!0),u.type===e.QUESTION_TYPE.SHORT_TEXT?(i(),c(L,{key:3},[t[18]||(t[18]=n("span",null,"Answer:",-1)),n("div",pn,l(u.shortAnswer),1)],64)):q("v-if",!0)],8,on)]),n("div",gn,[n("i",{class:"bx bx-chevron-up",onClick:O=>e.toggleDisplayAnswer(F,O.currentTarget)},null,8,vn)])]))),256))])]),_:1},8,["value"])]),n("div",hn,[n("span",null,[t[19]||(t[19]=n("i",{class:"bx bx-info-circle"},null,-1)),b(" "+l(o.$t("generate_qs_modal.other.ai_warning")),1)])]),n("div",bn,[s(k,{class:"main-color-btn",key:"submit",type:"primary",size:"large",onClick:e.handleModalImport},{default:r(()=>[b(l(o.$t("import_qs_modal.buttons.import")),1)]),_:1})])])])])]),_:1},8,["spinning","indicator"])]),_:1},8,["open"]),s(e.GenerateFileStructure,{file:e.files[0],ref:"generateFileStructureRef",onImport:e.handleImportStructure},null,8,["file"])],64)}const An=ge(Qt,[["render",yn],["__scopeId","data-v-23b34ba3"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateQSModal.vue"]]);export{An as G,En as I};
