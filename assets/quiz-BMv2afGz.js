import{d as M,q as G,l as K,u as X,i as f,j as L,E as Y,s as H,R as E,M as J,k as U,_ as W,r as p,c as y,o as b,b as a,a as n,w as i,f as S,t as r,e as Q,F,B as Z,C as $}from"./index-CHQ5wIb3.js";import{A as N}from"./ApiClass-B3uIo_GQ.js";import{C as ee}from"./classStudentPosition-B7ChrNvq.js";import{I as ae}from"./Input-DIUsBtCl.js";import{V as te}from"./Validator-CWeiTIFe.js";const se=M({__name:"quiz",emits:["updateSidebar"],setup(c,{expose:t,emit:R}){var A;t();const e=G(),g=K(),{t:u}=X(),v=R,m=f(e.params.id||""),_=f({classId:"",name:"",topic:""}),o=L({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,name:((A=e.query.name)==null?void 0:A.toString())||"",totalCount:0,statusFilter:!1}),k=f([]),I=f(""),C=f(!1),w=async()=>{try{const s=await N.GetUserPermission(_.value.classId);s.data.success&&(I.value=s.data.data)}catch(s){console.log(s)}},z=async()=>{try{if(!te.isValidGuid(m.value.toString())){g.push({name:"404"});return}m.value||g.push({name:"404"});let s=await N.GetById(m.value.toString());s.data.success||g.push({name:"404"}),_.value=s.data.data,x.name=_.value.name,x.topic=_.value.topic}catch(s){const d=Object.keys(s.response.data.errors);if(d.includes(E.NOT_FOUND_STUDENT_IN_CLASS)||d.includes(E.NOT_FOUND_USER_IN_CLASS)){g.push({name:"User_Class"});return}}},h=async()=>{try{C.value=!0;let s=await N.GetAllQSByLimit(m.value.toString(),o);if(s.data.success){let d=s.data.data;k.value=d.items,o.pageNumber=d.pageNumber,o.pageSize=d.pageSize,o.totalCount=d.totalCount,o.statusFilter&&(o.pageNumber>d.totalPages&&o.totalCount>0?(o.pageNumber=1,g.push({name:"User_Class_Quiz",params:{id:m.value},query:{pageNumber:1,pageSize:o.pageSize,name:o.name}})):g.push({name:"User_Class_Quiz",params:{id:m.value},query:{pageNumber:o.pageNumber,pageSize:o.pageSize,name:o.name}}),o.statusFilter=!o.statusFilter)}}catch(s){console.log("ERROR: GETALLEXAMBYLIMIT class qs: "+s)}finally{C.value=!1}};Y(()=>Object.keys(e.query).length,()=>{var s;o.pageNumber=e.query.pageNumber||1,o.pageSize=e.query.pageSize||10,o.name=((s=e.query.name)==null?void 0:s.toString())||"",o.statusFilter=!0,h()});const D=(s,d)=>{o.pageNumber=s,o.pageSize=d,o.statusFilter=!0,h()},l=s=>{J.confirm({title:u("class_question_set.modal.delete_title"),content:u("class_question_set.modal.delete_content"),okText:u("sidebar.buttons.ok"),cancelText:u("sidebar.buttons.cancel"),onOk:async()=>{if(!(await N.DeleteQuestionSetFromClass(_.value.classId,s)).data.success){U.success(u("message.removed_failed"));return}U.success(u("message.removed_successfully")),h()}})},q=s=>{g.push({name:"User_QuestionSet_Detail",params:{id:s}})},B={name:[{required:!0,message:u("message.required"),trigger:"change"},{max:100,message:u("message.out_of_range",{max_length:100}),trigger:"change"}],topic:[{max:100,message:u("message.out_of_range",{max_length:100}),trigger:"change"}]},P=f(!1),O=f(),x=L({name:_.value.name,topic:_.value.topic}),T=f(!1),j=async()=>{var s;T.value=!0;try{if((s=O.value)==null||s.validate(),!(await N.Update({classId:m.value,name:x.name,topic:x.topic})).data.success){U.error(u("message.updated_failed"));return}U.success(u("message.updated_successfully")),P.value=!1,window.location.reload()}catch(d){console.log(d)}finally{T.value=!1}};H(async()=>{v("updateSidebar","class"),await z(),await w(),await h()});const V={route:e,router:g,t:u,emit:v,classId:m,classData:_,pageParams:o,question_set_data:k,userRoleInClass:I,loading:C,getPermission:w,getClassData:z,getData:h,onPaginationChange:D,onDeleteQSFromClass:l,onRedirectToDetail:q,rules:B,modal_update_open:P,updateClassFormRef:O,updateClassFormState:x,isUpdateLoading:T,onUpdateClass:j,get CLASS_STUDENT_POSITION(){return ee},Input:ae};return Object.defineProperty(V,"__isScriptSetup",{enumerable:!1,value:!0}),V}}),oe={class:"page-container"},ne={class:"title-container"},le={class:"breadcrumb-container"},ie={class:"title-breadcrumb-item"},re={class:"title-breadcrumb-item"},de={class:"breadcrumb-item-topic"},ce={class:"content"},ue={class:"content-item"},me={class:"content-item-title"},_e={class:"content-item-functions"},pe={class:"content-item-navigators"},ge={class:"navigator-container"},ve={style:{width:"300px",padding:"0px"}},fe={key:0,class:"quiz-item-container"},be={class:"quiz-item"},Se={class:"quiz-item-title"},he={class:"quiz-item-description"},ye={class:"quiz-item-info quiz-info-detail"},Ce={class:"quiz-item-questions"},qe={class:"quiz-item-created-by"},ze={class:"exam-item-actions"},xe=["onClick"],Ne={key:1,class:"w-100 d-flex justify-content-center"},ke={class:"pagination-container"},Ie={class:"modal-container"},we={class:"modal-title-container"};function Ue(c,t,R,e,g,u){const v=p("RouterLink"),m=p("a-skeleton"),_=p("a-button"),o=p("a-tooltip"),k=p("a-empty"),I=p("a-pagination"),C=p("a-col"),w=p("a-row"),z=p("a-form-item"),h=p("a-form"),D=p("a-modal");return b(),y(F,null,[a("div",oe,[a("div",ne,[a("div",le,[a("ul",null,[a("li",ie,[n(v,{to:{name:"User_Class"}},{default:i(()=>[a("span",null,r(c.$t("class_index.title")),1),t[7]||(t[7]=S()),t[8]||(t[8]=a("br",null,null,-1))]),_:1,__:[7,8]}),t[9]||(t[9]=a("i",{class:"bx bx-chevron-right"},null,-1))]),a("li",re,[n(v,{to:{name:""},class:"breadcrumb-item-class",onClick:t[0]||(t[0]=l=>e.modal_update_open=!0)},{default:i(()=>[a("span",null,r(e.classData.name),1),a("span",de,r(e.classData.topic),1)]),_:1}),t[10]||(t[10]=a("i",{class:"bx bx-edit"},null,-1))])])])]),a("div",ce,[a("div",ue,[a("div",me,[a("div",null,[a("span",null,r(c.$t("class_question_set.title")),1),a("span",null,r(c.$t("class_question_set.sub_title")),1)])]),a("div",_e,[a("div",pe,[a("div",ge,[n(v,{class:"navigator-item",to:{name:"User_Class_Exam"}},{default:i(()=>[S(r(c.$t("class_index.navigators.exam")),1)]),_:1}),n(v,{class:"navigator-item navigator-active",to:{name:""}},{default:i(()=>[S(r(c.$t("class_index.navigators.quiz")),1)]),_:1}),n(v,{class:"navigator-item",to:{name:"User_Class_Student"}},{default:i(()=>[S(r(c.$t("class_index.navigators.member")),1)]),_:1})])]),Q(` <a-select
                        v-model:value="pageParams.shareMode"
                        style="width: 200px"
                        @change="getData"
                    >
                        <a-select-option v-for="option in share_mode_options" :value="option.value">
                            {{ option.label }}
                        </a-select-option>
                    </a-select> `),a("div",ve,[n(e.Input,{onInput:e.getData,modelValue:e.pageParams.name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.pageParams.name=l),placeholder:e.t("question_sets_index.search_placeholder")},{icon:i(()=>t[11]||(t[11]=[a("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(b(),y(F,{key:0},[n(m,{active:"",loading:e.loading},null,8,["loading"]),n(m,{active:"",loading:e.loading},null,8,["loading"]),n(m,{active:"",loading:e.loading},null,8,["loading"])],64)):(b(),y(F,{key:1},[e.question_set_data.length>0?(b(),y("div",fe,[(b(!0),y(F,null,Z(e.question_set_data,l=>(b(),y("div",be,[t[13]||(t[13]=a("i",{class:"bx bx-book-open quiz-item-icon"},null,-1)),a("div",null,[a("div",Se,r(l.name),1),a("div",he,r(l.description),1),a("div",ye,[a("div",Ce,[t[12]||(t[12]=a("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),S(" "+r(l.totalQuestionCount)+" "+r(c.$t("dashboards.list_items.quiz.questions")),1)]),a("div",qe,r(c.$t("class_question_set.other.created_by"))+" "+r(l.createBy),1)])]),a("div",ze,[n(_,{type:"primary",class:"me-3 main-color-btn",onClick:q=>e.onRedirectToDetail(l.id)},{default:i(()=>[S(r(c.$t("class_question_set.buttons.view")),1)]),_:2},1032,["onClick"]),e.userRoleInClass!==e.CLASS_STUDENT_POSITION.STUDENT?(b(),$(o,{key:0},{title:i(()=>[S(r(c.$t("question_sets_index.buttons.delete")),1)]),default:i(()=>[a("i",{style:{cursor:"pointer"},class:"text-danger bx bx-trash-alt",onClick:q=>e.onDeleteQSFromClass(l.id)},null,8,xe)]),_:2},1024)):Q("v-if",!0)])]))),256))])):(b(),y("div",Ne,[n(k,null,{description:i(()=>[a("span",null,r(c.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),a("div",ke,[n(I,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":t[2]||(t[2]=l=>e.pageParams.pageNumber=l),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(l,q)=>`${q[0]}-${q[1]} of ${l} ${e.t("class_question_set.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])]),n(D,{centered:"","wrap-class-name":"medium-modal",open:e.modal_update_open,onCancel:t[6]||(t[6]=l=>e.modal_update_open=!1)},{footer:i(()=>[n(_,{loading:e.isUpdateLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onUpdateClass},{default:i(()=>[S(r(c.$t("update_QS.buttons.update")),1)]),_:1},8,["loading"])]),default:i(()=>[a("div",Ie,[a("div",we,[n(w,{class:"w-100 d-flex align-items-center"},{default:i(()=>[n(C,{span:4},{default:i(()=>[n(v,{onClick:t[3]||(t[3]=l=>e.modal_update_open=!1),to:{name:""}},{default:i(()=>t[14]||(t[14]=[a("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[14]})]),_:1}),n(C,{class:"main-title",span:20},{default:i(()=>[a("span",null,r(e.t("class_index.modal.update_title")),1)]),_:1})]),_:1})]),n(h,{ref:"updateClassFormRef",layout:"vertical",rules:e.rules,model:e.updateClassFormState},{default:i(()=>[n(z,null,{default:i(()=>[n(e.Input,{label:e.t("class_index.modal.create_class_name_label"),name:"name",modelValue:e.updateClassFormState.name,"onUpdate:modelValue":t[4]||(t[4]=l=>e.updateClassFormState.name=l),placeholder:e.t("class_index.modal.create_class_name_placeholder"),"is-required":!0,"max-length":100},null,8,["label","modelValue","placeholder"])]),_:1}),n(z,null,{default:i(()=>[n(e.Input,{label:e.t("class_index.modal.create_class_topic_label"),name:"topic",modelValue:e.updateClassFormState.topic,"onUpdate:modelValue":t[5]||(t[5]=l=>e.updateClassFormState.topic=l),placeholder:e.t("class_index.modal.create_class_topic_placeholder"),"max-length":100},null,8,["label","modelValue","placeholder"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["open"])],64)}const Oe=W(se,[["render",Ue],["__scopeId","data-v-b4964186"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/quiz.vue"]]);export{Oe as default};
