import{d as Y,q as G,l as H,u as J,i as v,j as P,C as K,s as W,M as B,k as I,v as X,_ as Z,r as p,a as h,o as y,b as t,c as n,f as b,t as s,w as u,F as x,D as $}from"./index-Cmj4Sauw.js";import{A as w}from"./ApiFolder-CeYzSMFo.js";import{V as ee}from"./Validator-CWeiTIFe.js";import{I as te}from"./Input-7s2qH2uT.js";import{S as ae}from"./ShareModal-5ZXwrv5i.js";import{V as oe}from"./visibility-PZlBDoOn.js";import"./ApiQuestionSet-Bv36wec6.js";import"./ApiTestTemplate-7SUP0tzq.js";const le=Y({__name:"detail",emits:["updateSidebar"],setup(m,{expose:a,emit:D}){var M;a();const e=G(),_=H(),{t:r}=J(),g=D,c=v(e.params.id.toString()||""),T=v({folderTestId:"",name:"",createBy:""}),o=P({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,testTemplateName:((M=e.query.testTemplateName)==null?void 0:M.toString())||"",totalCount:0,statusFilter:!1}),k=v([]),z=v(!1),f=async()=>{try{if(z.value=!0,!ee.isValidGuid(c.value.toString())){_.push({name:"404"});return}c.value||_.push({name:"404"});let l=await w.GetAllTestTemplateByLimit(c.value.toString(),o);if(l.data.success){let d=l.data.data;k.value=d.testTemplates.items,T.value.name=d.folderName,o.pageNumber=d.testTemplates.pageNumber,o.pageSize=d.testTemplates.pageSize,o.totalCount=d.testTemplates.totalCount,o.statusFilter&&(o.pageNumber>d.totalPages&&o.totalCount>0?(o.pageNumber=1,_.push({name:"User_Folder_Detail",params:{id:c.value},query:{pageNumber:1,pageSize:o.pageSize,testTemplateName:o.testTemplateName}})):_.push({name:"User_Folder_Detail",params:{id:c.value},query:{pageNumber:o.pageNumber,pageSize:o.pageSize,testTemplateName:o.testTemplateName}}),o.statusFilter=!o.statusFilter)}}catch(l){console.log("ERROR: GETALLBYLIMIT testtemplate: "+l)}finally{z.value=!1}};K(()=>Object.keys(e.query).length,()=>{var l;o.pageNumber=e.query.pageNumber||1,o.pageSize=e.query.pageSize||10,o.testTemplateName=((l=e.query.testTemplateName)==null?void 0:l.toString())||"",o.statusFilter=!0,f()});const F=(l,d)=>{o.pageNumber=l,o.pageSize=d,o.statusFilter=!0,f()},q=l=>{B.confirm({title:r("folder_detail.modal.delete_template_warning"),content:r("folder_detail.modal.delete_template_ins"),okText:r("sidebar.buttons.ok"),cancelText:r("sidebar.buttons.cancel"),onOk:async()=>{if(!(await w.DeleteTestTemplate(c.value.toString(),l)).data.success){I.error(r("message.removed_failed"));return}I.success(r("message.removed_successylly")),await f()}})},i=()=>{B.confirm({title:r("folder_detail.modal.delete_folder_warning"),content:X("div",{style:"color: red"},r("folder_detail.danger_zone.warning_explain")),centered:!0,okText:r("sidebar.buttons.ok"),cancelText:r("sidebar.buttons.cancel"),onOk:async()=>{if(!(await w.DeleteFolder(c.value.toString())).data.success){I.error(r("message.deleted_failed"));return}I.success(r("message.deleted_successfully")),_.push({name:"User_Folder"})}})},S={name:[{required:!0,message:"This field is required.",trigger:"change"},{max:100,message:"Limit 100.",trigger:"change"}]},C=v(!1),N=v(),R=P({name:T.value.name}),A=()=>{var l;C.value=!0,R.name=T.value.name,(l=N.value)==null||l.validate()},V=v(!1),O=async()=>{var l;V.value=!0;try{if((l=N.value)==null||l.validate(),!(await w.Update(c.value.toString(),{folderId:c.value,name:R.name})).data.success){I.error(r("message.updated_failed"));return}I.success(r("message.updated_successfully")),C.value=!1,await f()}catch(d){console.log(d)}finally{V.value=!1}},U=v(null),j=l=>{var d;(d=U.value)==null||d.openModal()},E=()=>{_.push({name:"User_TestTemplate_Create"})},Q=l=>{_.push({name:"User_TestTemplate_Detail",params:{id:l}})};W(async()=>{g("updateSidebar","folder"),await f()});const L={route:e,router:_,t:r,emit:g,folderId:c,folderData:T,pageParams:o,test_template_data:k,loading:z,getData:f,onPaginationChange:F,onRemoveTestTemplate:q,onOpenConfirmDelete:i,rules:S,modal_update_open:C,updateFolderFormRef:N,updateFolderFormState:R,openUpdateModal:A,isUpdateLoading:V,onUpdateFolder:O,shareModalRef:U,onOpenShareModal:j,onRedirectToCreate:E,onRedirectToDetail:Q,Input:te,ShareModal:ae,get VISIBILITY(){return oe}};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}}),ne={class:"page-container"},se={class:"title-container"},ie={class:"main-title"},re={class:"title-button-container"},de={class:"content"},me={class:"content-item"},ce={class:"content-item-title"},ue={class:"content-item-functions"},_e={class:"filter-container"},pe={style:{width:"300px",padding:"0px"}},ge={key:0,class:"quiz-item-container"},fe={class:"quiz-item"},ve={class:"quiz-item-title"},be={class:"quiz-item-info quiz-info-detail"},he={class:"quiz-item-questions"},ye={class:"quiz-item-created-by"},Te={class:"exam-item-actions"},ze=["onClick"],Se={key:1,class:"w-100 d-flex justify-content-center"},Ie={class:"pagination-container"},ke={class:"mt-4 content-item"},xe={class:"content-item-title"},we={class:"text-danger"},Fe={class:"danger-zone mt-3 p-4"},qe={class:"text-danger fs-6 fw-bold"},Ce={class:"text-secondary"},Ne={class:"modal-container"},Re={class:"modal-title-container"};function Ve(m,a,D,e,_,r){const g=p("a-button"),c=p("a-skeleton"),T=p("a-empty"),o=p("a-pagination"),k=p("RouterLink"),z=p("a-col"),f=p("a-row"),F=p("a-form"),q=p("a-modal");return y(),h(x,null,[t("div",ne,[t("div",se,[t("div",ie,[t("span",null,s(m.$t("folder_detail.title")),1),a[5]||(a[5]=b()),a[6]||(a[6]=t("br",null,null,-1))]),t("div",re,[n(g,{type:"primary",class:"ms-3 main-color-btn",size:"large",onClick:e.onOpenShareModal},{default:u(()=>[a[7]||(a[7]=t("i",{class:"me-2 bx bx-share-alt"},null,-1)),b(" "+s(m.$t("detail_QS.buttons.share_quiz")),1)]),_:1,__:[7]}),n(g,{type:"primary",class:"ms-3 main-color-btn",size:"large",onClick:e.onRedirectToCreate},{default:u(()=>[a[8]||(a[8]=t("i",{class:"me-2 bx bx-plus"},null,-1)),b(" "+s(m.$t("folder_detail.buttons.create_new_template")),1)]),_:1,__:[8]})])]),t("div",de,[t("div",me,[t("div",ce,[t("span",null,[b(s(e.folderData.name)+" ",1),t("i",{class:"bx bx-edit",onClick:e.openUpdateModal})])]),t("div",ue,[t("div",_e,[t("div",pe,[n(e.Input,{onInput:e.getData,modelValue:e.pageParams.testTemplateName,"onUpdate:modelValue":a[0]||(a[0]=i=>e.pageParams.testTemplateName=i),placeholder:e.t("class_index.other.search_class_placeholder")},{icon:u(()=>a[9]||(a[9]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])])]),e.loading?(y(),h(x,{key:0},[n(c,{loading:e.loading},null,8,["loading"]),n(c,{loading:e.loading},null,8,["loading"]),n(c,{loading:e.loading},null,8,["loading"])],64)):(y(),h(x,{key:1},[e.test_template_data.length>0?(y(),h("div",ge,[(y(!0),h(x,null,$(e.test_template_data,i=>(y(),h("div",fe,[a[11]||(a[11]=t("i",{class:"bx bx-book-open quiz-item-icon"},null,-1)),t("div",null,[t("div",ve,s(i.name),1),t("div",be,[t("div",he,[a[10]||(a[10]=t("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),b(" "+s(i.numberOfQuestion)+" "+s(m.$t("dashboards.list_items.quiz.questions")),1)]),t("div",ye,s(m.$t("class_question_set.other.created_by"))+" "+s(i.createBy),1)])]),t("div",Te,[n(g,{type:"primary",class:"me-3 main-color-btn",onClick:S=>e.onRedirectToDetail(i.testTemplateId)},{default:u(()=>[b(s(m.$t("class_question_set.buttons.view")),1)]),_:2},1032,["onClick"]),t("i",{class:"text-danger bx bx-trash-alt",onClick:S=>e.onRemoveTestTemplate(i.testTemplateId)},null,8,ze)])]))),256))])):(y(),h("div",Se,[n(T,null,{description:u(()=>[t("span",null,s(m.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),t("div",Ie,[n(o,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":a[1]||(a[1]=i=>e.pageParams.pageNumber=i),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(i,S)=>`${S[0]}-${S[1]} of ${i} ${e.t("folder_index.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("folder_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])]),t("div",ke,[t("div",xe,[t("div",null,[t("span",we,s(m.$t("folder_detail.danger_zone.title")),1),t("span",null,s(m.$t("folder_detail.danger_zone.sub_title")),1)])]),t("div",Fe,[t("div",qe,s(m.$t("folder_detail.danger_zone.warning")),1),t("div",Ce,s(m.$t("folder_detail.danger_zone.warning_explain")),1),n(g,{class:"mt-3",type:"primary",danger:"",size:"large",onClick:e.onOpenConfirmDelete},{default:u(()=>[b(s(m.$t("folder_detail.danger_zone.warning")),1)]),_:1})])])])]),n(q,{centered:"","wrap-class-name":"medium-modal",open:e.modal_update_open,onCancel:a[4]||(a[4]=i=>e.modal_update_open=!1)},{footer:u(()=>[n(g,{loading:e.isUpdateLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onUpdateFolder},{default:u(()=>[b(s(m.$t("update_QS.buttons.update")),1)]),_:1},8,["loading"])]),default:u(()=>[t("div",Ne,[t("div",Re,[n(f,{class:"w-100 d-flex align-items-center"},{default:u(()=>[n(z,{span:4},{default:u(()=>[n(k,{onClick:a[2]||(a[2]=i=>e.modal_update_open=!1),to:{name:""}},{default:u(()=>a[12]||(a[12]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[12]})]),_:1}),n(z,{class:"main-title",span:20},{default:u(()=>[t("span",null,s(e.t("folder_detail.modal.create_title")),1)]),_:1})]),_:1})]),n(F,{ref:"updateFolderFormRef",layout:"vertical",rules:e.rules,model:e.updateFolderFormState},{default:u(()=>[n(e.Input,{label:"Folder name",name:"name",modelValue:e.updateFolderFormState.name,"onUpdate:modelValue":a[3]||(a[3]=i=>e.updateFolderFormState.name=i),placeholder:e.t("folder_index.modal.create_folder_name_placeholder"),"is-required":!0,"max-length":100},null,8,["modelValue","placeholder"])]),_:1},8,["model"])])]),_:1},8,["open"]),n(e.ShareModal,{ref:"shareModalRef",id:e.folderId,name:e.folderData.name,mode:"folder",options:[e.VISIBILITY.PRIVATE],visibility:e.VISIBILITY.PRIVATE},null,8,["id","name","options","visibility"])],64)}const je=Z(le,[["render",Ve],["__scopeId","data-v-2d07fd31"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/folder/detail.vue"]]);export{je as default};
