import{c as u,I as Y,d as X,q as $,l as Q,u as J,i as O,B as W,j as Z,C as K,s as ee,M as te,k as ae,P as se,_ as ne,r as v,a as b,o as p,b as a,w as c,f as m,t as i,F as z,D as L,E as P,e as k}from"./index-Cmj4Sauw.js";import{A as E}from"./ApiClass-D7Qkk9XC.js";import{A as oe}from"./ApiTest-BhZnBpID.js";import{C as le}from"./classStudentPosition-B7ChrNvq.js";import{I as ie}from"./Input-7s2qH2uT.js";var re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm376 116c-119.3 0-216 96.7-216 216s96.7 216 216 216 216-96.7 216-216-96.7-216-216-216zm107.5 323.5C750.8 868.2 712.6 884 672 884s-78.8-15.8-107.5-44.5C535.8 810.8 520 772.6 520 732s15.8-78.8 44.5-107.5C593.2 595.8 631.4 580 672 580s78.8 15.8 107.5 44.5C808.2 653.2 824 691.4 824 732s-15.8 78.8-44.5 107.5zM761 656h-44.3c-2.6 0-5 1.2-6.5 3.3l-63.5 87.8-23.1-31.9a7.92 7.92 0 00-6.5-3.3H573c-6.5 0-10.3 7.4-6.5 12.7l73.8 102.1c3.2 4.4 9.7 4.4 12.9 0l114.2-158c3.9-5.3.1-12.7-6.4-12.7zM440 852H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"file-done",theme:"outlined"};function q(o){for(var s=1;s<arguments.length;s++){var _=arguments[s]!=null?Object(arguments[s]):{},e=Object.keys(_);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(_).filter(function(d){return Object.getOwnPropertyDescriptor(_,d).enumerable}))),e.forEach(function(d){ce(o,d,_[d])})}return o}function ce(o,s,_){return s in o?Object.defineProperty(o,s,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[s]=_,o}var U=function(s,_){var e=q({},s,_.attrs);return u(Y,q({},e,{icon:re}),null)};U.displayName="FileDoneOutlined";U.inheritAttrs=!1;const x={ALL:"All",UPCOMING:"Upcoming",ACTIVE:"Active",COMPLETED:"Completed"},ue=X({__name:"exam",emits:["updateSidebar"],setup(o,{expose:s,emit:_}){var M;s();const e=$(),d=Q(),{t:f}=J(),h=_,g=O(e.params.id||""),T=O({classId:"",name:"",topic:""}),A=Object.values(x),S=W(()=>A.map(t=>({label:f(`class_exam.select_option.${t}`),value:t!==x.ALL?t:""}))),n=Z({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,testName:((M=e.query.testName)==null?void 0:M.toString())||"",status:e.query.status||S.value[0].value,totalCount:0,statusFilter:!1}),y=O([]),D=O(""),N=O(!1),l=async()=>{try{const t=await E.GetUserPermission(T.value.classId);t.data.success&&(D.value=t.data.data)}catch(t){console.log(t)}},C=async()=>{try{g.value||d.push({name:"404"});let t=await E.GetById(g.value.toString());t.data.success||d.push({name:"404"}),T.value=t.data.data}catch(t){console.log("ERROR: GETBYID class: "+t)}},I=async()=>{try{N.value=!0;let t=await E.GetAllExamByLimit(g.value.toString(),n);if(t.data.success){let r=t.data.data;y.value=r.items,n.pageNumber=r.pageNumber,n.pageSize=r.pageSize,n.totalCount=r.totalCount,n.statusFilter&&(n.pageNumber>r.totalPages&&n.totalCount>0?(n.pageNumber=1,d.push({name:"User_Class_Exam",params:{id:g.value},query:{pageNumber:1,pageSize:n.pageSize,testName:n.testName,status:n.status}})):d.push({name:"User_Class_Exam",params:{id:g.value},query:{pageNumber:n.pageNumber,pageSize:n.pageSize,testName:n.testName,status:n.status}}),n.statusFilter=!n.statusFilter)}}catch(t){console.log("ERROR: GETALLEXAMBYLIMIT class exam: "+t)}finally{N.value=!1}};K(()=>Object.keys(e.query).length,()=>{var t;n.pageNumber=e.query.pageNumber||1,n.pageSize=e.query.pageSize||10,n.testName=((t=e.query.testName)==null?void 0:t.toString())||"",n.status=e.query.status||S.value[0].value,n.statusFilter=!0,I()});const R=(t,r)=>{n.pageNumber=t,n.pageSize=r,n.statusFilter=!0,I()},F=t=>{if(t<24)return`${t} hour${t!==1?"s":""} ago`;if(t<24*7){const r=Math.floor(t/24);return`${r} day${r!==1?"s":""} ago`}else if(t<24*30){const r=Math.floor(t/168);return`${r} week${r!==1?"s":""} ago`}else if(t<24*365){const r=Math.floor(t/720);return`${r} month${r!==1?"s":""} ago`}else{const r=Math.floor(t/8760);return`${r} year${r!==1?"s":""} ago`}},j=t=>{switch(t){case x.COMPLETED:return"#3b82f6";case x.ACTIVE:return"#22C55E";case x.UPCOMING:return"#f59e0b"}},V=()=>{d.push({name:"User_Test_Create",params:{id:g.value}})},B=t=>{d.push({name:"User_Test_Update",params:{id:t}})},G=t=>{te.confirm({title:f("class_exam.modal.delete_title"),content:f("class_exam.modal.delete_content"),okText:f("sidebar.buttons.ok"),cancelText:f("sidebar.buttons.cancel"),onOk:async()=>{(await oe.Delete(t)).data.success&&(ae.success(f("message.deleted_successfully")),I())}})},H=t=>{d.push({name:"User_Test_Attempt",params:{id:t}})};ee(async()=>{h("updateSidebar","class"),await C(),await l(),await I()});const w={route:e,router:d,t:f,emit:h,classId:g,classData:T,optionKeys:A,exam_status_options:S,pageParams:n,exam_data:y,userRoleInClass:D,loading:N,getPermission:l,getClassData:C,getData:I,onPaginationChange:R,getFormattedRelativeTime:F,getTagColor:j,onRedirectToCreate:V,onRedirectToUpdate:B,onDeleteTest:G,onRedirectToAttempt:H,get CLASS_STUDENT_POSITION(){return le},get CLASS_EXAM_STATUS(){return x},get dayjs(){return se},Input:ie,get FileDoneOutlined(){return U}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),me={class:"page-container"},de={class:"title-container"},_e={class:"breadcrumb-container"},pe={class:"title-breadcrumb-item"},ge={class:"title-breadcrumb-item"},ve={class:"breadcrumb-item-topic"},be={class:"content"},fe={class:"content-item"},he={class:"content-item-title"},Ce={class:"content-item-functions"},Se={class:"content-item-navigators"},ye={class:"navigator-container"},xe={style:{width:"300px",padding:"0px"}},Te={key:0,class:"exam-item-container"},Ne={class:"exam-item"},Ie={class:"exam-item-title"},Oe={class:"exam-item-info exam-item-date"},ze={class:"exam-item-info exam-info-detail"},Ae={class:"exam-item-questions"},De={class:"exam-item-time"},Pe={class:"exam-item-assigned completion"},ke={class:"exam-item-assigned"},Ee={class:"exam-item-actions"},Ue=["onClick"],we=["onClick"],Me={key:1,class:"w-100 d-flex justify-content-center"},Le={class:"pagination-container"};function qe(o,s,_,e,d,f){const h=v("RouterLink"),g=v("a-button"),T=v("a-select-option"),A=v("a-select"),S=v("a-skeleton"),n=v("a-tag"),y=v("a-tooltip"),D=v("a-empty"),N=v("a-pagination");return p(),b("div",me,[a("div",de,[a("div",_e,[a("ul",null,[a("li",pe,[u(h,{to:{name:"User_Class"}},{default:c(()=>[a("span",null,i(o.$t("class_index.title")),1),s[3]||(s[3]=m()),s[4]||(s[4]=a("br",null,null,-1))]),_:1,__:[3,4]}),s[5]||(s[5]=a("i",{class:"bx bx-chevron-right"},null,-1))]),a("li",ge,[u(h,{to:{name:""},class:"breadcrumb-item-class"},{default:c(()=>[a("span",null,i(e.classData.name),1),a("span",ve,i(e.classData.topic),1)]),_:1})])])])]),a("div",be,[a("div",fe,[a("div",he,[a("div",null,[a("span",null,i(o.$t("class_index.title")),1),a("span",null,i(o.$t("class_exam.sub_title")),1)]),u(g,{type:"primary",class:"main-color-btn",onClick:e.onRedirectToCreate},{default:c(()=>[s[6]||(s[6]=a("i",{class:"me-2 bx bx-list-plus"},null,-1)),m(" "+i(o.$t("class_exam.buttons.assign_test")),1)]),_:1,__:[6]})]),a("div",Ce,[a("div",Se,[a("div",ye,[u(h,{class:"navigator-item navigator-active",to:{name:""}},{default:c(()=>[m(i(o.$t("class_index.navigators.exam")),1)]),_:1}),u(h,{class:"navigator-item",to:{name:"User_Class_Quiz"}},{default:c(()=>[m(i(o.$t("class_index.navigators.quiz")),1)]),_:1}),u(h,{class:"navigator-item",to:{name:"User_Class_Student"}},{default:c(()=>[m(i(o.$t("class_index.navigators.member")),1)]),_:1})])]),u(A,{value:e.pageParams.status,"onUpdate:value":s[0]||(s[0]=l=>e.pageParams.status=l),style:{width:"200px"},onChange:e.getData},{default:c(()=>[(p(!0),b(z,null,L(e.exam_status_options,l=>(p(),P(T,{value:l.value},{default:c(()=>[m(i(l.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),a("div",xe,[u(e.Input,{onInput:e.getData,modelValue:e.pageParams.testName,"onUpdate:modelValue":s[1]||(s[1]=l=>e.pageParams.testName=l),placeholder:e.t("class_exam.other.search_placeholder")},{icon:c(()=>s[7]||(s[7]=[a("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(p(),b(z,{key:0},[u(S,{loading:e.loading},null,8,["loading"]),u(S,{loading:e.loading},null,8,["loading"]),u(S,{loading:e.loading},null,8,["loading"])],64)):(p(),b(z,{key:1},[e.exam_data.length>0?(p(),b("div",Te,[(p(!0),b(z,null,L(e.exam_data,l=>(p(),b("div",Ne,[s[11]||(s[11]=a("i",{class:"bx bx-book-open exam-item-icon"},null,-1)),a("div",null,[a("div",Ie,[m(i(l.name)+" ",1),u(n,{color:e.getTagColor(l.status)},{default:c(()=>[m(i(o.$t(`class_exam.select_option.${l.status}`)),1)]),_:2},1032,["color"])]),a("div",Oe,[a("div",null,[s[8]||(s[8]=a("i",{class:"bx bx-calendar"},null,-1)),m(" "+i(e.dayjs(l.timeStart).format("DD/MM/YYYY HH:mm A")),1)])]),a("div",ze,[a("div",Ae,[s[9]||(s[9]=a("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),m(" "+i(l.numberOfQuestions)+" "+i(o.$t("dashboards.list_items.quiz.questions")),1)]),a("div",De,[s[10]||(s[10]=a("i",{class:"bx bx-time-five"},null,-1)),m(" "+i(l.timeLimit)+" "+i(o.$t("class_exam.other.min")),1)]),a("span",Pe,i(l.numberOfCompletion)+" "+i(o.$t("class_exam.other.completions")),1),a("span",ke,i(o.$t("class_exam.other.assigned"))+" "+i(e.getFormattedRelativeTime(l.relativeTime)),1)])]),a("div",Ee,[l.status===e.CLASS_EXAM_STATUS.ACTIVE?(p(),P(g,{key:0,type:"primary",class:"main-color-btn",onClick:C=>e.onRedirectToAttempt(l.testId)},{default:c(()=>[m(i(o.$t("class_exam.buttons.attempt")),1)]),_:2},1032,["onClick"])):k("v-if",!0),e.userRoleInClass!==e.CLASS_STUDENT_POSITION.STUDENT?(p(),b(z,{key:1},[l.status===e.CLASS_EXAM_STATUS.UPCOMING?(p(),P(y,{key:0},{title:c(()=>[m(i(o.$t("question_sets_index.buttons.edit")),1)]),default:c(()=>[a("i",{class:"bx bx-edit",onClick:C=>e.onRedirectToUpdate(l.testId)},null,8,Ue)]),_:2},1024)):k("v-if",!0),u(y,null,{title:c(()=>[m(i(o.$t("class_member.buttons.history_test")),1)]),default:c(()=>[a("i",null,[u(e.FileDoneOutlined)])]),_:1}),u(y,null,{title:c(()=>[m(i(o.$t("question_sets_index.buttons.delete")),1)]),default:c(()=>[a("i",{class:"text-danger bx bx-trash-alt",onClick:C=>e.onDeleteTest(l.testId)},null,8,we)]),_:2},1024)],64)):k("v-if",!0)])]))),256))])):(p(),b("div",Me,[u(D,null,{description:c(()=>[a("span",null,i(o.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),a("div",Le,[u(N,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":s[2]||(s[2]=l=>e.pageParams.pageNumber=l),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(l,C)=>`${C[0]}-${C[1]} of ${l} ${e.t("class_exam.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])])}const Ge=ne(ue,[["render",qe],["__scopeId","data-v-1afc52c6"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/exam.vue"]]);export{Ge as default};
