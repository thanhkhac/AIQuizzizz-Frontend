import{d as Z,q as $,l as ee,u as te,C as V,i as C,j as B,P as ae,s as oe,k as g,M as A,v as ne,_ as se,r as _,a as S,o as b,b as t,e as O,c as l,w as i,f as v,t as r,F,E as j,G}from"./index-CNC2148x.js";import{A as w}from"./ApiClass-BckaWWMn.js";import{I as le}from"./Input-B6AzPJuz.js";const ie={FULL_NAME:"FullName",EMAIL:"Email"},re={TEACHER:"Teacher",STUDENT:"Student"},de=Z({__name:"student",emits:["updateSidebar"],setup(d,{expose:a,emit:q}){var M;a();const e=$(),y=ee(),{t:I}=te(),p=q,k=Object.values(ie),N=V(()=>k.map(o=>({label:I(`class_member.select_option.${o}`),value:o}))),u=C(e.params.id||""),z=C({classId:"",name:"",topic:""}),E=[{title:"No",key:"no",customRender:o=>o.index+1},{title:"FullName",dataIndex:"fullName",key:"fullName",sorter:(o,c)=>o.fullName.localeCompare(c.fullName)},{title:"Email",dataIndex:"email",key:"email",sorter:(o,c)=>o.email.localeCompare(c.email)},{title:"Position",dataIndex:"position",key:"position"},{key:"action"}],x=[1,3,5,7,30],D=V(()=>x.map(o=>({label:o+I(o===1?"class_member.other.day_singular":"class_member.other.day_plural"),value:o}))),U=async()=>{try{u.value||y.push({name:"404"});let o=await w.GetById(u.value.toString());o.data.success||y.push({name:"404"}),z.value=o.data.data}catch(o){console.log("ERROR: GETBYID class: "+o)}},n=B({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,keyword:((M=e.query.keyword)==null?void 0:M.toString())||"",fieldName:e.query.fieldName||N.value[0].value,totalCount:0,statusFilter:!1}),T=C([]),f=async()=>{try{let o=await w.GetAllStudentByLimit(u.value.toString(),n);if(o.data.success){let c=o.data.data;T.value=c.items,n.pageNumber=c.pageNumber,n.pageSize=c.pageSize,n.totalCount=c.totalCount,n.statusFilter&&(n.pageNumber>c.totalPages&&n.totalCount>0?(n.pageNumber=1,y.push({name:"User_Class_Student",params:{id:u.value},query:{pageNumber:1,pageSize:n.pageSize,keyword:n.keyword,fieldName:n.fieldName}})):y.push({name:"User_Class_Student",params:{id:u.value},query:{pageNumber:n.pageNumber,pageSize:n.pageSize,keyword:n.keyword,fieldName:n.fieldName}}),n.statusFilter=!n.statusFilter)}}catch(o){console.log("ERROR: GETALLEXAMBYLIMIT class exam: "+o)}};ae(()=>{var o;Object.keys(e.query).length===0&&(n.pageNumber=e.query.pageNumber||1,n.pageSize=e.query.pageSize||10,n.keyword=((o=e.query.keyword)==null?void 0:o.toString())||"",n.fieldName=e.query.fieldName||N.value[0].value,n.statusFilter=!0,f())});const P=(o,c)=>{n.pageNumber=o,n.pageSize=c,n.statusFilter=!0,f()},s=C(!1),m=B({classId:u.value,code:"",expiredTime:D.value[0].value}),h=C(window.location.origin+`/user/class/invitation/${m.code}`),L=C(!0),Q=C(!1),H=async()=>{if(m.code)return;const o=await w.GetInivationCode(u.value.toString());o.data.success?m.code=o.data.data:(m.code="Code empty or expired!",h.value="Code empty or expired!",L.value=!1),s.value=!0},Y=()=>{},K=o=>{if(!L.value)return;let c=m.code;o==="link"&&(c=h.value),navigator.clipboard.writeText(c).then(()=>{g.success("Copied!")}).catch(()=>{g.error("Copied failed!")})},X=o=>{A.confirm({title:"Are you sure to remove this user from class?",content:"This action is inreversible, every related data will be erased forever. Careful!",centered:!0,okText:"Confirm",onOk:async()=>{if(!(await w.DeleteClassMember(u.value.toString(),o.toString())).data.success){g.success("Remove failed.");return}g.success("Remove successfully."),await f()}})},J=(o,c)=>{A.confirm({title:"Are you sure to update this user position from class?",content:"Please make sure to double check the important information!.",centered:!0,okText:"Confirm",onOk:async()=>{if(!(await w.UpdateClassMemberPosition(u.value.toString(),o.toString(),c)).data.success){g.success("Update failed.");return}g.success("Update successfully."),await f()}})},W=()=>{A.confirm({title:"Are you sure to delete this class?",content:ne("div",{style:"color: red"},"This action is inreversible, every related data will be erased forever. Careful!"),centered:!0,okText:"Confirm",onOk:async()=>{if(!(await w.Delete(u.value.toString())).data.success){g.success("Delete class failed.");return}g.success("Delete class successfully."),y.push({name:"User_Class"})}})};oe(async()=>{p("updateSidebar","class"),await U(),await f()});const R={route:e,router:y,t:I,emit:p,optionKeys:k,class_position_options:N,classId:u,classData:z,columns:E,optionDays:x,code_limit_time:D,getClassData:U,pageParams:n,student_data:T,getData:f,onPaginationChange:P,modal_invitation_open:s,invitationFormState:m,inivitationLink:h,allowCopy:L,isInvitaionLoading:Q,onOpenInvitationModal:H,onResetInvitation:Y,onCopyInvitationCode:K,onConfirmDeleteMember:X,onConfirmUpdateMemberPosition:J,onOpenConfirmDeleteClass:W,Input:le,get CLASS_STUDENT_POSITION(){return re}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),ce={class:"page-container"},me={class:"title-container"},ue={class:"breadcrumb-container"},_e={class:"title-breadcrumb-item"},ve={class:"title-breadcrumb-item"},pe={class:"breadcrumb-item-topic"},be={class:"content"},fe={class:"content-item"},ge={class:"content-item-title"},ye={class:"content-item-functions"},Ce={class:"content-item-navigators"},Se={class:"navigator-container"},ke={style:{width:"300px",padding:"0px"}},Ne={key:0,class:"student-name-container"},he=["src"],we={class:"student-name"},Ie={key:1,class:"student-action"},xe=["onClick"],Te=["onClick"],ze=["onClick"],De={class:"pagination-container"},Ue={class:"mt-4 content-item"},Ee={class:"content-item-title"},Pe={class:"text-danger"},Le={class:"danger-zone mt-3 p-4"},Ae={class:"text-danger fs-6 fw-bold"},Oe={class:"text-secondary"},Fe={class:"modal-container"},qe={class:"modal-title-container"},Re={class:"modal-invitation-body"},Me={class:"invitation-code-container"},Ve={class:"invitation-code-container"};function Be(d,a,q,e,y,I){const p=_("RouterLink"),k=_("a-button"),N=_("a-select-option"),u=_("a-select"),z=_("a-table"),E=_("a-pagination"),x=_("a-col"),D=_("a-row"),U=_("a-qrcode"),n=_("a-form-item"),T=_("a-form"),f=_("a-divider"),P=_("a-modal");return b(),S(F,null,[t("div",ce,[t("div",me,[t("div",ue,[t("ul",null,[t("li",_e,[l(p,{to:{name:"User_Class"}},{default:i(()=>[t("span",null,r(d.$t("class_index.title")),1),a[10]||(a[10]=v()),a[11]||(a[11]=t("br",null,null,-1))]),_:1,__:[10,11]}),a[12]||(a[12]=t("i",{class:"bx bx-chevron-right"},null,-1))]),t("li",ve,[l(p,{to:{name:""},class:"breadcrumb-item-class"},{default:i(()=>[t("span",null,r(e.classData.name),1),t("span",pe,r(e.classData.topic),1)]),_:1})])])])]),t("div",be,[t("div",fe,[t("div",ge,[t("div",null,[t("span",null,r(d.$t("class_member.title")),1),t("span",null,r(d.$t("class_member.sub_title")),1)]),l(k,{class:"main-color-btn",type:"primary",size:"large",onClick:e.onOpenInvitationModal},{default:i(()=>[a[13]||(a[13]=t("i",{class:"me-2 bx bx-user-plus"},null,-1)),v(" "+r(d.$t("class_member.buttons.invite_member")),1)]),_:1,__:[13]})]),t("div",ye,[t("div",Ce,[t("div",Se,[l(p,{class:"navigator-item",to:{name:"User_Class_Exam"}},{default:i(()=>[v(r(d.$t("class_index.navigators.exam")),1)]),_:1}),l(p,{class:"navigator-item",to:{name:"User_Class_Quiz"}},{default:i(()=>[v(r(d.$t("class_index.navigators.quiz")),1)]),_:1}),l(p,{class:"navigator-item navigator-active",to:{name:""}},{default:i(()=>[v(r(d.$t("class_index.navigators.member")),1)]),_:1})])]),l(u,{value:e.pageParams.fieldName,"onUpdate:value":a[0]||(a[0]=s=>e.pageParams.fieldName=s),style:{width:"200px"},onChange:e.getData},{default:i(()=>[(b(!0),S(F,null,j(e.class_position_options,s=>(b(),G(N,{value:s.value},{default:i(()=>[v(r(s.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",ke,[l(e.Input,{onInput:e.getData,modelValue:e.pageParams.keyword,"onUpdate:modelValue":a[1]||(a[1]=s=>e.pageParams.keyword=s),placeholder:e.t("class_member.other.search_placeholder")},{icon:i(()=>a[14]||(a[14]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),l(z,{columns:e.columns,"data-source":e.student_data,"row-key":"studentId",pagination:!1},{bodyCell:i(({column:s,record:m})=>[s.key==="fullName"?(b(),S("div",Ne,[t("img",{class:"student-image",src:m.image,alt:""},null,8,he),t("div",we,r(m.fullName),1)])):O("v-if",!0),s.key==="action"?(b(),S("div",Ie,[m.position===e.CLASS_STUDENT_POSITION.STUDENT?(b(),S("i",{key:0,style:{cursor:"pointer"},class:"bx bxs-id-card",onClick:h=>e.onConfirmUpdateMemberPosition(m.studentId,e.CLASS_STUDENT_POSITION.TEACHER)},null,8,xe)):(b(),S("i",{key:1,class:"text-danger bx bxs-id-card",onClick:h=>e.onConfirmUpdateMemberPosition(m.studentId,e.CLASS_STUDENT_POSITION.STUDENT)},null,8,Te)),t("i",{class:"text-danger bx bx-trash-alt",onClick:h=>e.onConfirmDeleteMember(m.studentId)},null,8,ze)])):O("v-if",!0)]),_:1},8,["data-source"]),t("div",De,[l(E,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":a[2]||(a[2]=s=>e.pageParams.pageNumber=s),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(s,m)=>`${m[0]}-${m[1]} of ${s} ${e.t("class_member.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])]),t("div",Ue,[t("div",Ee,[t("div",null,[t("span",Pe,r(d.$t("class_member.danger_zone.title")),1),t("span",null,r(d.$t("class_member.danger_zone.sub_title")),1)])]),t("div",Le,[t("div",Ae,r(d.$t("class_member.danger_zone.warning")),1),t("div",Oe,r(d.$t("class_member.danger_zone.warning_explain")),1),l(k,{class:"mt-3",type:"primary",danger:"",size:"large",onClick:e.onOpenConfirmDeleteClass},{default:i(()=>[v(r(d.$t("class_member.buttons.delete_class")),1)]),_:1})])])])]),O(" invitation modal "),l(P,{width:"750px",centered:"","wrap-class-name":"medium-modal",open:e.modal_invitation_open,onCancel:a[9]||(a[9]=s=>e.modal_invitation_open=!1)},{footer:i(()=>[l(T,{layout:"vertical",class:"w-100 d-flex align-items-end justify-content-between"},{default:i(()=>[l(n,{label:e.t("class_member.modal.time_limit_label")},{default:i(()=>[l(u,{value:e.invitationFormState.expiredTime,"onUpdate:value":a[8]||(a[8]=s=>e.invitationFormState.expiredTime=s),style:{width:"200px"},onChange:e.getData},{default:i(()=>[(b(!0),S(F,null,j(e.code_limit_time,s=>(b(),G(N,{value:s.value},{default:i(()=>[v(r(s.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1},8,["label"]),l(n,null,{default:i(()=>[l(k,{loading:e.isInvitaionLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onResetInvitation},{default:i(()=>[v(r(d.$t("class_member.buttons.reset_code")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),default:i(()=>[t("div",Fe,[t("div",qe,[l(D,{class:"w-100 d-flex align-items-center"},{default:i(()=>[l(x,{span:2},{default:i(()=>[l(p,{onClick:a[3]||(a[3]=s=>e.modal_invitation_open=!1),to:{name:""}},{default:i(()=>a[15]||(a[15]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[15]})]),_:1}),l(x,{class:"main-title",span:22},{default:i(()=>[t("span",null,r(d.$t("class_member.modal.title")),1),a[16]||(a[16]=v()),a[17]||(a[17]=t("br",null,null,-1)),t("span",null,r(d.$t("class_member.modal.sub_title")),1)]),_:1,__:[16,17]})]),_:1})]),t("div",Re,[l(U,{value:e.invitationFormState.code,class:"invitation-body-qrcode"},null,8,["value"]),l(T,{layout:"vertical",class:"invitation-body-link"},{default:i(()=>[l(n,{label:e.t("class_member.modal.class_code_label")},{default:i(()=>[t("div",Me,[l(e.Input,{modelValue:e.invitationFormState.code,"onUpdate:modelValue":a[4]||(a[4]=s=>e.invitationFormState.code=s),"is-required":!0,"max-length":100,readonly:!0},null,8,["modelValue"]),t("i",{class:"bx bx-copy",onClick:a[5]||(a[5]=s=>e.onCopyInvitationCode("code"))})])]),_:1},8,["label"]),l(n,{label:e.t("class_member.modal.invitation_link")},{default:i(()=>[t("div",Ve,[l(e.Input,{modelValue:e.inivitationLink,"onUpdate:modelValue":a[6]||(a[6]=s=>e.inivitationLink=s),"is-required":!0,"max-length":100,readonly:!0},null,8,["modelValue"]),t("i",{class:"bx bx-copy",onClick:a[7]||(a[7]=s=>e.onCopyInvitationCode("link"))})])]),_:1},8,["label"])]),_:1})]),l(f,null,{default:i(()=>[v(r(d.$t("class_member.modal.or")),1)]),_:1})])]),_:1},8,["open"])],64)}const Ye=se(de,[["render",Be],["__scopeId","data-v-6a35c450"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/student.vue"]]);export{Ye as default};
