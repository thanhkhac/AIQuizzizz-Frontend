import{d as W,q as Z,l as $,u as ee,H as M,i as w,j as V,J as te,s as ae,k as v,M as A,v as oe,_ as se,r as _,a as C,o as g,b as t,e as F,c as n,w as i,f as p,t as r,F as L,B,C as j}from"./index-Dd8-myui.js";import{A as x}from"./ApiClass-Dplhuan4.js";import{I as ne}from"./Input-BtmZP41X.js";const le={FULL_NAME:"FullName",EMAIL:"Email"},ie={TEACHER:"Teacher",STUDENT:"Student"},re=W({__name:"student",emits:["updateSidebar"],setup(d,{expose:a,emit:O}){var R;a();const e=Z(),y=$(),{t:N}=ee(),b=O,S=Object.values(le),k=M(()=>S.map(o=>({label:N(`class_member.select_option.${o}`),value:o}))),m=w(e.params.id||""),T=w({classId:"",name:"",topic:""}),s=V({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,keyword:((R=e.query.keyword)==null?void 0:R.toString())||"",fieldName:e.query.fieldName||k.value[0].value,totalCount:0,statusFilter:!1}),I=w([]),z=async()=>{try{m.value||y.push({name:"404"});let o=await x.GetById(m.value.toString());o.data.success||y.push({name:"404"}),T.value=o.data.data}catch(o){console.log("ERROR: GETBYID class: "+o)}},f=async()=>{try{let o=await x.GetAllStudentByLimit(m.value.toString(),s);if(o.data.success){let c=o.data.data;I.value=c.items,s.pageNumber=c.pageNumber,s.pageSize=c.pageSize,s.totalCount=c.totalCount,s.statusFilter&&(s.pageNumber>c.totalPages&&s.totalCount>0?(s.pageNumber=1,y.push({name:"User_Class_Student",params:{id:m.value},query:{pageNumber:1,pageSize:s.pageSize,keyword:s.keyword,fieldName:s.fieldName}})):y.push({name:"User_Class_Student",params:{id:m.value},query:{pageNumber:s.pageNumber,pageSize:s.pageSize,keyword:s.keyword,fieldName:s.fieldName}}),s.statusFilter=!s.statusFilter)}}catch(o){console.log("ERROR: GETALLEXAMBYLIMIT class exam: "+o)}};te(()=>{var o;Object.keys(e.query).length===0&&(s.pageNumber=e.query.pageNumber||1,s.pageSize=e.query.pageSize||10,s.keyword=((o=e.query.keyword)==null?void 0:o.toString())||"",s.fieldName=e.query.fieldName||k.value[0].value,s.statusFilter=!0,f())});const h=(o,c)=>{s.pageNumber=o,s.pageSize=c,s.statusFilter=!0,f()},D=[{title:"No",key:"no",customRender:o=>o.index+1},{title:"FullName",dataIndex:"fullName",key:"fullName",sorter:(o,c)=>o.fullName.localeCompare(c.fullName)},{title:"Email",dataIndex:"email",key:"email",sorter:(o,c)=>o.email.localeCompare(c.email)},{title:"Position",dataIndex:"position",key:"position"},{key:"action"}],U=[1,3,5,7,30],E=M(()=>U.map(o=>({label:o+N(o===1?"class_member.other.day_singular":"class_member.other.day_plural"),value:o}))),l=w(!1),u=V({classId:m.value,code:"e3m3TR41fk+t",expiredTime:E.value[0].value}),P=w(!1),G=()=>{l.value=!0},H=()=>{},Q=()=>{navigator.clipboard.writeText(u.code).then(()=>{v.success("Copied")}).catch(()=>{v.error("code empty")})},Y=()=>{navigator.clipboard.writeText(u.code).then(()=>{v.success("Copied")}).catch(()=>{v.error("code empty")})},J=o=>{A.confirm({title:"Are you sure to remove this user from class?",content:"This action is inreversible, every related data will be erased forever. Careful!",centered:!0,okText:"Confirm",onOk:async()=>{if(!(await x.DeleteClassMember(m.value.toString(),o.toString())).data.success){v.success("Remove failed.");return}v.success("Remove successfully."),await f()}})},K=(o,c)=>{A.confirm({title:"Are you sure to update this user position from class?",content:"Please make sure to double check the important information!.",centered:!0,okText:"Confirm",onOk:async()=>{if(!(await x.UpdateClassMemberPosition(m.value.toString(),o.toString(),c)).data.success){v.success("Update failed.");return}v.success("Update successfully."),await f()}})},X=()=>{A.confirm({title:"Are you sure to delete this class?",content:oe("div",{style:"color: red"},"This action is inreversible, every related data will be erased forever. Careful!"),centered:!0,okText:"Confirm",onOk:async()=>{if(!(await x.Delete(m.value.toString())).data.success){v.success("Delete class failed.");return}v.success("Delete class successfully."),y.push({name:"User_Class"})}})};ae(async()=>{b("updateSidebar","class"),await z(),await f()});const q={route:e,router:y,t:N,emit:b,optionKeys:S,class_position_options:k,classId:m,classData:T,pageParams:s,student_data:I,getClassData:z,getData:f,onPaginationChange:h,columns:D,optionDays:U,code_limit_time:E,modal_invitation_open:l,invitationFormState:u,isInvitaionLoading:P,onOpenInvitationModal:G,onResetInvitation:H,onCopyInvitationCode:Q,onCopyInvitationLink:Y,onConfirmDeleteMember:J,onConfirmUpdateMemberPosition:K,onOpenConfirmDelete:X,Input:ne,get CLASS_STUDENT_POSITION(){return ie}};return Object.defineProperty(q,"__isScriptSetup",{enumerable:!1,value:!0}),q}}),de={class:"page-container"},ce={class:"title-container"},me={class:"breadcrumb-container"},ue={class:"title-breadcrumb-item"},_e={class:"title-breadcrumb-item"},pe={class:"breadcrumb-item-topic"},ve={class:"content"},be={class:"content-item"},ge={class:"content-item-title"},fe={class:"content-item-functions"},ye={class:"content-item-navigators"},Ce={class:"navigator-container"},Se={style:{width:"300px",padding:"0px"}},ke={key:0,class:"student-name-container"},he=["src"],Ne={class:"student-name"},Ie={key:1,class:"student-action"},we=["onClick"],xe=["onClick"],Te=["onClick"],ze={class:"pagination-container"},De={class:"mt-4 content-item"},Ue={class:"content-item-title"},Ee={class:"text-danger"},Pe={class:"danger-zone mt-3 p-4"},Ae={class:"text-danger fs-6 fw-bold"},Fe={class:"text-secondary"},Le={class:"modal-container"},Oe={class:"modal-title-container"},qe={class:"modal-invitation-body"},Re={class:"invitation-code-container"},Me={class:"invitation-code-container"};function Ve(d,a,O,e,y,N){const b=_("RouterLink"),S=_("a-button"),k=_("a-select-option"),m=_("a-select"),T=_("a-table"),s=_("a-pagination"),I=_("a-col"),z=_("a-row"),f=_("a-qrcode"),h=_("a-form-item"),D=_("a-form"),U=_("a-divider"),E=_("a-modal");return g(),C(L,null,[t("div",de,[t("div",ce,[t("div",me,[t("ul",null,[t("li",ue,[n(b,{to:{name:"User_Class"}},{default:i(()=>[t("span",null,r(d.$t("class_index.title")),1),a[8]||(a[8]=p()),a[9]||(a[9]=t("br",null,null,-1))]),_:1,__:[8,9]}),a[10]||(a[10]=t("i",{class:"bx bx-chevron-right"},null,-1))]),t("li",_e,[n(b,{to:{name:""},class:"breadcrumb-item-class"},{default:i(()=>[t("span",null,r(e.classData.name),1),t("span",pe,r(e.classData.topic),1)]),_:1})])])])]),t("div",ve,[t("div",be,[t("div",ge,[t("div",null,[t("span",null,r(d.$t("class_member.title")),1),t("span",null,r(d.$t("class_member.sub_title")),1)]),n(S,{class:"main-color-btn",type:"primary",size:"large",onClick:e.onOpenInvitationModal},{default:i(()=>[a[11]||(a[11]=t("i",{class:"me-2 bx bx-user-plus"},null,-1)),p(" "+r(d.$t("class_member.buttons.invite_member")),1)]),_:1,__:[11]})]),t("div",fe,[t("div",ye,[t("div",Ce,[n(b,{class:"navigator-item",to:{name:"User_Class_Exam"}},{default:i(()=>[p(r(d.$t("class_index.navigators.exam")),1)]),_:1}),n(b,{class:"navigator-item",to:{name:"User_Class_Quiz"}},{default:i(()=>[p(r(d.$t("class_index.navigators.quiz")),1)]),_:1}),n(b,{class:"navigator-item navigator-active",to:{name:""}},{default:i(()=>[p(r(d.$t("class_index.navigators.member")),1)]),_:1})])]),n(m,{value:e.pageParams.fieldName,"onUpdate:value":a[0]||(a[0]=l=>e.pageParams.fieldName=l),style:{width:"200px"},onChange:e.getData},{default:i(()=>[(g(!0),C(L,null,B(e.class_position_options,l=>(g(),j(k,{value:l.value},{default:i(()=>[p(r(l.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",Se,[n(e.Input,{onInput:e.getData,modelValue:e.pageParams.keyword,"onUpdate:modelValue":a[1]||(a[1]=l=>e.pageParams.keyword=l),placeholder:e.t("class_member.other.search_placeholder")},{icon:i(()=>a[12]||(a[12]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),n(T,{columns:e.columns,"data-source":e.student_data,"row-key":"studentId",pagination:!1},{bodyCell:i(({column:l,record:u})=>[l.key==="fullName"?(g(),C("div",ke,[t("img",{class:"student-image",src:u.image,alt:""},null,8,he),t("div",Ne,r(u.fullName),1)])):F("v-if",!0),l.key==="action"?(g(),C("div",Ie,[u.position===e.CLASS_STUDENT_POSITION.STUDENT?(g(),C("i",{key:0,style:{cursor:"pointer"},class:"bx bxs-id-card",onClick:P=>e.onConfirmUpdateMemberPosition(u.studentId,e.CLASS_STUDENT_POSITION.TEACHER)},null,8,we)):(g(),C("i",{key:1,class:"text-danger bx bxs-id-card",onClick:P=>e.onConfirmUpdateMemberPosition(u.studentId,e.CLASS_STUDENT_POSITION.STUDENT)},null,8,xe)),t("i",{class:"text-danger bx bx-trash-alt",onClick:P=>e.onConfirmDeleteMember(u.studentId)},null,8,Te)])):F("v-if",!0)]),_:1},8,["data-source"]),t("div",ze,[n(s,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":a[2]||(a[2]=l=>e.pageParams.pageNumber=l),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(l,u)=>`${u[0]}-${u[1]} of ${l} ${e.t("class_member.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])]),t("div",De,[t("div",Ue,[t("div",null,[t("span",Ee,r(d.$t("class_member.danger_zone.title")),1),t("span",null,r(d.$t("class_member.danger_zone.sub_title")),1)])]),t("div",Pe,[t("div",Ae,r(d.$t("class_member.danger_zone.warning")),1),t("div",Fe,r(d.$t("class_member.danger_zone.warning_explain")),1),n(S,{class:"mt-3",type:"primary",danger:"",size:"large",onClick:e.onOpenConfirmDelete},{default:i(()=>[p(r(d.$t("class_member.buttons.delete_class")),1)]),_:1})])])])]),F(" invitation modal "),n(E,{width:"750px",centered:"","wrap-class-name":"medium-modal",open:e.modal_invitation_open,onCancel:a[7]||(a[7]=l=>e.modal_invitation_open=!1)},{footer:i(()=>[n(D,{layout:"vertical",class:"w-100 d-flex align-items-end justify-content-between"},{default:i(()=>[n(h,{label:e.t("class_member.modal.time_limit_label")},{default:i(()=>[n(m,{value:e.invitationFormState.expiredTime,"onUpdate:value":a[6]||(a[6]=l=>e.invitationFormState.expiredTime=l),style:{width:"200px"},onChange:e.getData},{default:i(()=>[(g(!0),C(L,null,B(e.code_limit_time,l=>(g(),j(k,{value:l.value},{default:i(()=>[p(r(l.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1},8,["label"]),n(h,null,{default:i(()=>[n(S,{loading:e.isInvitaionLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onResetInvitation},{default:i(()=>[p(r(d.$t("class_member.buttons.reset_code")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),default:i(()=>[t("div",Le,[t("div",Oe,[n(z,{class:"w-100 d-flex align-items-center"},{default:i(()=>[n(I,{span:2},{default:i(()=>[n(b,{onClick:a[3]||(a[3]=l=>e.modal_invitation_open=!1),to:{name:""}},{default:i(()=>a[13]||(a[13]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[13]})]),_:1}),n(I,{class:"main-title",span:22},{default:i(()=>[t("span",null,r(d.$t("class_member.modal.title")),1),a[14]||(a[14]=p()),a[15]||(a[15]=t("br",null,null,-1)),t("span",null,r(d.$t("class_member.modal.sub_title")),1)]),_:1,__:[14,15]})]),_:1})]),t("div",qe,[n(f,{value:e.invitationFormState.code,class:"invitation-body-qrcode"},null,8,["value"]),n(D,{layout:"vertical",class:"invitation-body-link"},{default:i(()=>[n(h,{label:e.t("class_member.modal.class_code_label")},{default:i(()=>[t("div",Re,[n(e.Input,{modelValue:e.invitationFormState.code,"onUpdate:modelValue":a[4]||(a[4]=l=>e.invitationFormState.code=l),"is-required":!0,"max-length":100,readonly:!0},null,8,["modelValue"]),t("i",{class:"bx bx-copy",onClick:e.onCopyInvitationCode})])]),_:1},8,["label"]),n(h,{label:e.t("class_member.modal.invitation_link")},{default:i(()=>[t("div",Me,[n(e.Input,{modelValue:e.invitationFormState.code,"onUpdate:modelValue":a[5]||(a[5]=l=>e.invitationFormState.code=l),"is-required":!0,"max-length":100,readonly:!0},null,8,["modelValue"]),t("i",{class:"bx bx-copy",onClick:e.onCopyInvitationLink})])]),_:1},8,["label"])]),_:1})]),n(U,null,{default:i(()=>[p(r(d.$t("class_member.modal.or")),1)]),_:1})])]),_:1},8,["open"])],64)}const Qe=se(re,[["render",Ve],["__scopeId","data-v-6a35c450"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/student.vue"]]);export{Qe as default};
