var Te=Object.defineProperty;var Ie=(l,t,v)=>t in l?Te(l,t,{enumerable:!0,configurable:!0,writable:!0,value:v}):l[t]=v;var ne=(l,t,v)=>Ie(l,typeof t!="symbol"?t+"":t,v);import{c as i,I as xe,d as fe,u as be,i as k,j as de,B as ye,C as pe,s as ke,k as P,M as ee,_ as ge,r as h,E as oe,o as r,w as c,b as n,f as y,t as s,ao as le,p as Y,a as d,F as D,D as R,e as L,J as ie,v as we,L as Se,G as ue,ap as Ee,aq as Ae,T as Ce}from"./index-CZZuPq2J.js";import{A as Me}from"./ApiTestTemplate-C-go-SZO.js";import{A as Oe}from"./ApiQuestionSet-69wH4BjR.js";import{Q as me}from"./questionTypes-CS3lcRlq.js";import{S as ae}from"./languages-DtYW231W.js";import{T as De}from"./vue-draggable-plus-BarUSV2N.js";var Le={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function he(l){for(var t=1;t<arguments.length;t++){var v=arguments[t]!=null?Object(arguments[t]):{},e=Object.keys(v);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(v).filter(function(F){return Object.getOwnPropertyDescriptor(v,F).enumerable}))),e.forEach(function(F){qe(l,F,v[F])})}return l}function qe(l,t,v){return t in l?Object.defineProperty(l,t,{value:v,enumerable:!0,configurable:!0,writable:!0}):l[t]=v,l}var se=function(t,v){var e=he({},t,v.attrs);return i(xe,he({},e,{icon:Le}),null)};se.displayName="InboxOutlined";se.inheritAttrs=!1;const re={ALL:"all",VALID:"valid",IN_VALID:"invalid"},Ge=fe({__name:"ImportQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(l,{expose:t,emit:v}){const{t:e}=be(),F=l,H=v,O=k(!1),b=k([]),S=k([]),T=k([]),I=k(""),C=async()=>{if(!I.value)try{const m=await Oe.DownloadFileImport();m.data.success&&(I.value=m.data.data)}catch(m){console.log(m)}},_=de({checkAll:!1,indeterminate:!1,checkedList:[]}),x=async()=>{await C(),_.checkedList=[],O.value=!0},w=()=>{O.value=!1};t({openImportModal:x});const a=k([]),U=k(null),G=k(!1),E=()=>{var m;(m=U.value)==null||m.click()},u=async m=>{if(m){if(m.type!=="application/vnd.ms-excel"&&m.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"){P.error(e("message.file_support_only",{fileTypes:"XLS, XLSX"}));return}a.value=[],P.success(e("message.uploaded_successfully",{name:m.name})),a.value.push(m);const g=await Me.ImportFile(a.value[0]);g.data.success&&(b.value=[...g.data.data.validQuestions,...g.data.data.invalidQuestions],S.value=[...g.data.data.validQuestions,...g.data.data.invalidQuestions],T.value=g.data.data.invalidQuestions,_.checkedList=[]);return}P.error(e("message.uploaded_failed"))},N=async m=>{var f;const g=m.target,o=(f=g.files)==null?void 0:f[0];o&&(u(o),g.value="")},M=m=>{var o;const g=((o=m.dataTransfer)==null?void 0:o.types)||[];Array.from(g).includes("files")&&(G.value=!0)},V=m=>{var o;const g=(o=m.dataTransfer)==null?void 0:o.files[0];G.value=!1,g&&u(g)},K=m=>{var g;(g=a.value)==null||g.splice(m,1),_.checkedList=[],b.value=[],T.value=[],S.value=[]},X=Object.values(re),W=ye(()=>X.map(m=>({label:e(`import_qs_modal.uploaded_question_status.${m}`),value:m}))),Z=k(W.value[0].value),p=()=>{var g,o;_.checkedList=[];let m=b.value;switch(Z.value){case re.VALID:{m=(g=b.value)==null?void 0:g.filter(f=>{var q;return!((q=T.value)!=null&&q.includes(f))});break}case re.IN_VALID:{m=(o=b.value)==null?void 0:o.filter(f=>{var q;return(q=T.value)==null?void 0:q.includes(f)});break}}S.value=m||[]},B=m=>{Object.assign(_,{checkedList:m.target.checked?S.value:[],indeterminate:!1})};pe(()=>_.checkedList,m=>{var g;_.indeterminate=!!m.length&&m.length<S.value.length,_.checkAll=m.length===((g=S.value)==null?void 0:g.length)});const A=(m,g)=>{$(g).toggleClass("bx-chevron-up bx-chevron-down");const f=$(`#question-item-answer-${m}`);f&&$(f).slideToggle()},Q=()=>{if(_.checkedList.length===0){P.warning(e("message.minimum_question",{number:5}));return}if(_.checkedList.length+F.numberOfQuestion>500){P.warning(e("message.limit_question",{number:500}));return}ee.confirm({title:e("import_qs_modal.confirm_modal.title"),content:e("import_qs_modal.confirm_modal.content",{number:_.checkedList.length}),okText:e("create_QS.buttons.ok"),cancelText:e("create_QS.buttons.cancel"),onOk:()=>{var g;const m=(g=S.value)==null?void 0:g.filter(o=>_.checkedList.includes(o));H("import",m),w()}})},j=async()=>{window.open(I.value,"_blank")};ke(()=>{});const J={t:e,props:F,emit:H,modal_import_open:O,question_data:b,uploadedQuestions:S,uploadedInvalidQuestions:T,download_link:I,getLink:C,importModalState:_,openImportModal:x,closeImportModal:w,files:a,fileInput:U,isDragging:G,openFileExplorer:E,onFileChange:u,handleFileChange:N,handleDragEnter:M,handleDrop:V,onRemoveUploadedFile:K,optionKeys:X,select_options:W,selected_option:Z,onFilter:p,onCheckAll:B,toggleDisplayAnswer:A,handleModalImport:Q,onDownloadTemplate:j,get InboxOutlined(){return se},get QUESTION_TYPE(){return me}};return Object.defineProperty(J,"__isScriptSetup",{enumerable:!1,value:!0}),J}}),Qe={class:"modal-container"},Fe={class:"modal-title-container"},Ne={class:"modal-content-item"},Ue={class:"content-item-section upload-section"},ze={class:"section-title"},Pe={class:"section-content"},Re={class:"customized-file-upload-icons"},Be={class:"customized-file-upload-ins"},Je={class:"customized-file-upload-hint"},He={class:"file-container"},je={class:"file-item"},Ve=["onClick"],Ye={class:"content-item-section preview-section"},Xe={class:"section-title"},Ke={class:"section-content"},$e={key:0,class:"section-content-header"},We={class:"d-flex"},Ze={class:"preview-question-container"},et={class:"question-item-content"},tt=["innerHTML"],nt={key:1,class:"question-text"},at=["id"],ot={key:0,class:"multiple-choice-answer"},lt={key:0,class:"text-success"},st={class:"pair-answer"},it={class:"pair-answer-item"},rt={class:"pair-answer-item"},ct={key:2,class:"ordering-answer"},dt={class:"ordering-answer-item"},ut={class:"ordering-answer-item"},mt={class:"ordering-answer-item"},_t={key:3,class:"short-text-answer"},ft={class:"question-item-toogle-btn"},pt=["onClick"],gt={class:"mt-4 d-flex align-items-center"},vt={class:"header-item"};function ht(l,t,v,e,F,H){const O=h("RouterLink"),b=h("a-col"),S=h("a-row"),T=h("a-button"),I=h("a-checkbox"),C=h("a-select-option"),_=h("a-select"),x=h("a-checkbox-group"),w=h("a-modal");return r(),oe(w,{centered:"",width:"100%","wrap-class-name":"full-modal",open:e.modal_import_open,onCancel:e.closeImportModal},{footer:c(()=>[n("div",gt,[n("div",vt,s(l.$t("import_qs_modal.other.total_question",{number:e.importModalState.checkedList.length})),1),i(T,{class:"main-color-btn",size:"large",key:"submit",type:"primary",onClick:e.handleModalImport},{default:c(()=>[y(s(l.$t("import_qs_modal.buttons.import")),1)]),_:1})])]),default:c(()=>[n("div",Qe,[n("div",Fe,[i(S,{class:"w-100 d-flex align-items-center"},{default:c(()=>[i(b,{span:1},{default:c(()=>[i(O,{onClick:e.closeImportModal,to:{name:""}},{default:c(()=>t[5]||(t[5]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[5]})]),_:1}),i(b,{class:"main-title",span:23},{default:c(()=>[n("span",null,s(l.$t("import_qs_modal.title")),1),t[6]||(t[6]=y()),t[7]||(t[7]=n("br",null,null,-1)),n("span",null,s(l.$t("import_qs_modal.sub_title")),1)]),_:1,__:[6,7]})]),_:1})]),n("div",Ne,[n("div",Ue,[n("div",ze,[n("span",null,s(l.$t("import_qs_modal.upload_section")),1),i(T,{class:"main-color-btn",type:"primary",onClick:e.onDownloadTemplate},{default:c(()=>[y(s(l.$t("import_qs_modal.buttons.download")),1)]),_:1})]),n("div",Pe,[n("input",{onChange:e.handleFileChange,class:"d-none",type:"file",ref:"fileInput",accept:".xls,.xlsx"},null,544),n("div",{class:Y(["customized-file-upload",e.isDragging?"is-dragging":""]),onClick:e.openFileExplorer,onDragenter:e.handleDragEnter,onDragover:t[0]||(t[0]=le(a=>e.isDragging=!0,["prevent"])),onDragleave:t[1]||(t[1]=a=>e.isDragging=!1),onDrop:le(e.handleDrop,["prevent"])},[n("div",Re,[n("i",{class:Y(["bx","bx-down-arrow-alt","bx-fade-up",e.isDragging?"":"d-none"])},null,2),i(e.InboxOutlined,{class:Y([e.isDragging?"d-none":""])},null,8,["class"])]),n("div",Be,s(l.$t("import_qs_modal.upload_area.title")),1),n("div",Je,[y(s(l.$t("import_qs_modal.upload_area.content"))+" ",1),t[8]||(t[8]=n("br",null,null,-1)),y(" "+s(l.$t("import_qs_modal.upload_area.sub_content")),1)])],34)]),n("div",He,[(r(!0),d(D,null,R(e.files,(a,U)=>(r(),d("div",je,[n("span",null,s(a.name),1),n("i",{class:"bx bx-trash text-danger",onClick:G=>e.onRemoveUploadedFile(U)},null,8,Ve)]))),256))])]),n("div",Ye,[n("div",Xe,s(l.$t("import_qs_modal.preview_section")),1),n("div",Ke,[e.question_data.length>0?(r(),d("div",$e,[i(I,{class:Y(["header-item",e.importModalState.checkAll?"check-all":""]),onClick:e.onCheckAll,checked:e.importModalState.checkAll,"onUpdate:checked":t[2]||(t[2]=a=>e.importModalState.checkAll=a),indeterminate:e.importModalState.indeterminate},{default:c(()=>[y(s(l.$t("share_modal.buttons.check_all",{number:e.importModalState.checkedList.length})),1)]),_:1},8,["class","checked","indeterminate"]),n("div",We,[i(_,{size:"large",class:"me-3",value:e.selected_option,"onUpdate:value":t[3]||(t[3]=a=>e.selected_option=a),style:{width:"200px"},onChange:e.onFilter},{default:c(()=>[(r(!0),d(D,null,R(e.select_options,a=>(r(),oe(C,{value:a.value},{default:c(()=>[y(s(a.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])])):L("v-if",!0),i(x,{value:e.importModalState.checkedList,"onUpdate:value":t[4]||(t[4]=a=>e.importModalState.checkedList=a)},{default:c(()=>[n("div",Ze,[(r(!0),d(D,null,R(e.uploadedQuestions,(a,U)=>{var G;return r(),d("div",{class:Y(["preview-question-item",(G=e.uploadedInvalidQuestions)!=null&&G.includes(a)?"invalid":""])},[i(I,{value:a},null,8,["value"]),n("div",et,[a.questionHTML?(r(),d("div",{key:0,class:"question-html",innerHTML:a.questionHTML},null,8,tt)):(r(),d("div",nt,s(a.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${U}`},[a.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(r(),d("div",ot,[n("ul",null,[(r(!0),d(D,null,R(a.multipleChoices,E=>(r(),d("li",null,[y(s(E.text)+" ",1),E.isAnswer?(r(),d("span",lt," ("+s(E.isAnswer)+") ",1)):L("v-if",!0)]))),256))])])):L("v-if",!0),a.type===e.QUESTION_TYPE.MATCHING?(r(!0),d(D,{key:1},R(a.matchingPairs,E=>(r(),d("div",st,[n("span",it,s(E.leftItem),1),t[9]||(t[9]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",rt,s(E.rightItem),1)]))),256)):L("v-if",!0),a.type===e.QUESTION_TYPE.ORDERING?(r(),d("div",ct,[n("div",dt,[(r(!0),d(D,null,R(a.orderingItems,E=>(r(),d("div",null,s(E.text),1))),256))]),t[10]||(t[10]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",ut,[(r(!0),d(D,null,R(a.orderingItems,(E,u)=>(r(),d("div",mt,[n("span",null,"#"+s(u+1),1),y(" - "+s(E.text),1)]))),256))])])):L("v-if",!0),a.type===e.QUESTION_TYPE.SHORT_TEXT?(r(),d("div",_t,s(a.shortAnswer),1)):L("v-if",!0)],8,at)]),n("div",ft,[n("i",{class:"bx bx-chevron-up",onClick:E=>e.toggleDisplayAnswer(U,E.currentTarget)},null,8,pt)])],2)}),256))])]),_:1},8,["value"])])])])])]),_:1},8,["open"])}const Cn=ge(Ge,[["render",ht],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/ImportQSModal.vue"]]),bt={HARD:"Hard",MEDIUM:"Medium",EASY:"Easy"},ce={GENERATE_QUESTION:"AiGenerate/GenerateQuestion",GENERATE_DOCUMENT_STRUCTURE:"AiGenerate/GenerateDocumentStructure",GET_COST_TO_GENERATE:"AiGenerate/DocumentStructure/GetCostToGenerate"};class yt{constructor(){ne(this,"GenerateQuestion",async t=>await ie.post(ce.GENERATE_QUESTION,t,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0}));ne(this,"GenerateDocumentStructure",async t=>{const v=new FormData;return v.append("file",t),await ie.post(ce.GENERATE_DOCUMENT_STRUCTURE,v,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})});ne(this,"GetCostToGenerate",async t=>{const v=new FormData;return v.append("file",t),await ie.post(ce.GET_COST_TO_GENERATE,v,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})})}}const _e=new yt,kt=fe({__name:"GenerateFileStructure",props:{file:{type:null,required:!0}},emits:["import"],setup(l,{expose:t,emit:v}){const e=l,F=we(Se,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),H=k(),O=k([]);function b(p){return p?Array.isArray(p)?p:[p]:[]}function S(p){return b(p).map(A=>{const Q=b(A==null?void 0:A.children);return{...A,title:String((A==null?void 0:A.title)??""),key:crypto.randomUUID(),children:Q.length?S(Q):void 0}})}const T=k([]),I=k([]);function C(p,B){const A=[];for(const Q of p){const j=B.includes(Q.key),J=Q.children?C(Q.children,B):[];(j||J.length>0)&&A.push({title:Q.title,key:Q.key,children:J.length?J:void 0})}return A}const _=ye(()=>C(T.value,I.value));pe(T,async()=>{T.value.length>0&&(await ue(),H.value&&(H.value.scrollTop=0))});const x=k(null),w=k(!1),a=k(!1),U=async()=>{try{a.value=!0;const p=await _e.GetCostToGenerate(e.file);return p.data.success?p.data.data:(ee.error({title:"Error",content:p.data.message||"Failed to get cost to generate."}),null)}catch(p){return console.error(p),null}finally{a.value=!1}},G=async()=>{try{a.value=!0;const p=await _e.GenerateDocumentStructure(e.file);if(!p.data.success){ee.error({title:"Error",content:p.data.message||"Failed to generate file structure."});return}const B=typeof p.data=="string"?JSON.parse(p.data):p.data,A=B==null?void 0:B.data,Q=b(A==null?void 0:A.children);O.value=Q,T.value=S(O.value)}catch(p){console.error(p)}finally{a.value=!1,N.value=!1}},E=async()=>{if(w.value=!0,O.value.length>0||x.value)return;const p=await U();if(!p){P.error("Failed to get cost to generate file structure.");return}x.value=p,N.value=!0},u=()=>{w.value=!1,K()},N=k(!1),M=async()=>{x.value&&await G()},V=v,K=()=>{var j,J;if(T.value.length===0||_.value.length===0)return;const p=(j=T.value)==null?void 0:j[0],B=JSON.stringify({title:p.title,children:p.children}),A=(J=_.value)==null?void 0:J[0],Q=JSON.stringify({title:A.title,children:A.children});V("import",B,Q)},X=()=>{if(_.value.length===0){ee.error({title:"Error",content:"Please choose at least one section in your document to proceed.",centered:!0});return}K(),u()},W=()=>{O.value=[],T.value=[],x.value=null};t({openModal:E,closeModal:u,clearData:W});const Z={props:e,indicator:F,modalContentRef:H,serverData:O,toArray:b,addRandomKeys:S,treeData:T,checked:I,filterTree:C,selectedTree:_,cost:x,modal_open:w,loading:a,getCostToGenerate:U,generateTreeData:G,openModal:E,closeModal:u,modal_confirm_generate_structure_open:N,onConfirmGenerateFileStructure:M,emit:V,onEmitImport:K,onConfirmImportStructure:X,clearData:W,get ExclamationCircleFilled(){return Ae},get ATree(){return Ee}};return Object.defineProperty(Z,"__isScriptSetup",{enumerable:!1,value:!0}),Z}}),wt={class:"modal-container"},St={class:"modal-title-container"},Tt={class:"modal-content-item",ref:"modalContentRef"},It={key:0,class:"loading-container"},xt={key:0},Et={key:1,class:"content-wrapper"},At={key:0,class:"tree-container"},Ct={class:"button-container"},Mt={class:"confirm-modal-container"},Ot={class:"d-flex align-items-center"},Dt={class:"fs-6 fw-bold"},Lt={class:"fs-6 ms-5 mt-3"},qt={class:"fw-bold text-danger"};function Gt(l,t,v,e,F,H){const O=h("RouterLink"),b=h("a-col"),S=h("a-row"),T=h("a-spin"),I=h("a-button"),C=h("a-modal");return r(),d(D,null,[i(C,{centered:"",width:"100%","wrap-class-name":"medium-modal large",open:e.modal_open,onCancel:e.closeModal},{footer:c(()=>[i(I,{class:"main-color-btn",type:"primary",onClick:e.onConfirmImportStructure},{default:c(()=>[y(s(l.$t("generate_file_structure.buttons.confirm")),1)]),_:1})]),default:c(()=>[n("div",wt,[n("div",St,[i(S,{class:"w-100 d-flex align-items-center"},{default:c(()=>[i(b,{span:1},{default:c(()=>[i(O,{onClick:e.closeModal,to:{name:""}},{default:c(()=>t[3]||(t[3]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[3]})]),_:1}),i(b,{class:"main-title",span:23},{default:c(()=>[n("span",null,s(l.$t("generate_file_structure.title")),1),t[4]||(t[4]=y()),t[5]||(t[5]=n("br",null,null,-1)),n("span",null,s(l.$t("generate_file_structure.sub_title")),1)]),_:1,__:[4,5]})]),_:1})]),n("div",Tt,[e.loading?(r(),d("div",It,[i(T,{size:"large",indicator:e.indicator},null,8,["indicator"]),e.cost?L("v-if",!0):(r(),d("div",xt,s(l.$t("generate_file_structure.other.calculating")),1))])):(r(),d("div",Et,[e.treeData.length>0?(r(),d("div",At,[i(e.ATree,{checkedKeys:e.checked,"onUpdate:checkedKeys":t[0]||(t[0]=_=>e.checked=_),"tree-data":e.treeData,checkable:"","show-icon":!1,"show-line":!0,"field-names":{title:"title",key:"key",children:"children"},defaultExpandAll:!0,style:{width:"100%"}},null,8,["checkedKeys","tree-data"])])):e.cost?(r(),d(D,{key:1},[L(" get cost success but cancel "),n("div",Ct,[i(I,{type:"primary",class:"main-color-btn",onClick:t[1]||(t[1]=_=>e.modal_confirm_generate_structure_open=!0)},{default:c(()=>[y(s(l.$t("generate_file_structure.buttons.generate_structure")),1)]),_:1})])],2112)):L("v-if",!0)]))],512)])]),_:1},8,["open"]),i(C,{"wrap-class-name":"medium-modal",centered:"",open:e.modal_confirm_generate_structure_open,closable:!1},{footer:c(()=>[i(I,{class:Y(["main-color-btn-ghost",e.loading?"main-color-btn-disabled":""]),type:"ghost",onClick:t[2]||(t[2]=_=>e.modal_confirm_generate_structure_open=!1)},{default:c(()=>[y(s(l.$t("sidebar.buttons.cancel")),1)]),_:1},8,["class"]),i(I,{loading:e.loading,class:"main-color-btn",type:"primary",onClick:e.onConfirmGenerateFileStructure},{default:c(()=>[y(s(l.$t("generate_file_structure.buttons.confirm")),1)]),_:1},8,["loading"])]),default:c(()=>{var _;return[n("div",Mt,[n("div",Ot,[i(e.ExclamationCircleFilled,{class:"fs-4 me-3 text-warning"}),n("div",Dt,s(l.$t("generate_file_structure.confirm_modal.title")),1)]),n("div",Lt,[y(s(l.$t("generate_file_structure.confirm_modal.content"))+" ",1),n("span",qt,s((_=e.cost)==null?void 0:_.miniumPointToGenerate),1),y(" "+s(l.$t("generate_file_structure.confirm_modal.content_tail")),1)])])]}),_:1},8,["open"])],64)}const Qt=ge(kt,[["render",Gt],["__scopeId","data-v-8be2b719"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateFileStructure.vue"]]),Ft=fe({__name:"GenerateQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(l,{expose:t,emit:v}){const{t:e}=be(),F=l,H=v,O=k(!1),b=()=>{w.checkedList=[],O.value=!0},S=()=>{O.value=!1};t({openGenerateAIModal:b});const T=()=>{if(w.checkedList.length===0){P.warning(e("message.minimum_question",{number:5}));return}if(w.checkedList.length+F.numberOfQuestion>500){P.warning(e("message.limit_question",{number:500}));return}ee.confirm({title:e("import_qs_modal.confirm_modal.title"),content:e("import_qs_modal.confirm_modal.content",{number:w.checkedList.length}),okText:e("create_QS.buttons.ok"),cancelText:e("create_QS.buttons.cancel"),onOk:()=>{const o=x.value.filter(f=>w.checkedList.includes(f.id));H("import",o),S()}})},I=Object.values(me).map(o=>({label:e(`create_QS.type.${o}`),value:o})),C=Object.values(bt).map(o=>({label:o,value:o})),_=k([]);for(let o=10;o<=50;o+=10)_.value.push({label:o,value:o});const x=k([]),w=de({checkAll:!1,indeterminate:!1,checkedList:[]}),a=de({file:null,isGenerateExplain:!0,language:ae[0].code,questionCount:_.value[0].value,questionTypes:[I[0]],documentStructureJson:null,selectedPartJson:null,title:""}),U=o=>{a.questionTypes.length===0&&(P.warning(e("message.minimun_question_type")),a.questionTypes.push(o))},G=k(!1),E=we(Se,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),u=async()=>{var o;try{if(G.value=!0,!a.title&&a.isGenerateExplain){P.error(e("message.invalid_reference"));return}if(a.documentStructureJson===null||a.selectedPartJson===null){ee.error({title:e("generate_qs_modal.invalid_structure_modal.title"),content:e("generate_qs_modal.invalid_structure_modal.content"),centered:!0}),J();return}const f=JSON.parse(a.documentStructureJson),q=JSON.parse(a.selectedPartJson);a.isGenerateExplain&&a.title&&(a.documentStructureJson=JSON.stringify({...f,title:a.title}),a.selectedPartJson=JSON.stringify({...q,title:a.title}));const z=new FormData;z.append("file",N.value[0]),z.append("isGenerateExplain",a.isGenerateExplain?"true":"false"),z.append("language",((o=ae.find(te=>te.code===a.language))==null?void 0:o.label)||ae[0].label),z.append("questionCount",a.questionCount),z.append("questionTypes",JSON.stringify(a.questionTypes.map(te=>te))),z.append("documentStructureJson",a.documentStructureJson),z.append("selectedPartJson",a.selectedPartJson);const ve=await _e.GenerateQuestion(z);if(!ve.data.success){P.error("Generate failed!");return}x.value=[...x.value||[],...ve.data.data.map(te=>({...te,questionId:Ce().valueOf()}))],await ue(),w.checkedList=[],w.indeterminate=!1,w.checkAll=!1}catch(f){console.log(f)}finally{G.value=!1}},N=k([]),M=k(null),V=k(!1),K=()=>{var o;(o=M.value)==null||o.click()},X=async o=>{if(o){if(o.type!=="application/pdf"){P.error(e("message.file_support_only",{fileTypes:"PDF"}));return}N.value=[],P.success(e("message.uploaded_successfully",{name:o.name})),N.value.push(o);const f=o.name.replace(/\.[^/.]+$/,"");a.title=f,await ue(),J();return}P.error(e("message.uploaded_failed"))},W=o=>{var z;const f=o.target,q=(z=f.files)==null?void 0:z[0];q&&(X(q),f.value="")},Z=o=>{var q;const f=((q=o.dataTransfer)==null?void 0:q.types)||[];Array.from(f).includes("files")&&(V.value=!0)},p=async o=>{var q;const f=(q=o.dataTransfer)==null?void 0:q.files[0];V.value=!1,f&&X(f)},B=()=>{var o;N.value=[],(o=j.value)==null||o.clearData()},A=o=>{Object.assign(w,{checkedList:o.target.checked?x.value.map(f=>f.id):[],indeterminate:!1})};pe(()=>w.checkedList,o=>{w.indeterminate=!!o.length&&o.length<x.value.map(f=>f.id).length,w.checkAll=o.length===x.value.length});const Q=(o,f)=>{$(f).toggleClass("bx-chevron-up bx-chevron-down");const z=$(`#question-item-answer-${o}`);z&&$(z).slideToggle()},j=k(null),J=()=>{j.value&&j.value.openModal()},m=(o,f)=>{a.documentStructureJson=o,a.selectedPartJson=f};ke(()=>{});const g={t:e,props:F,emit:H,modal_generate_ai_open:O,openGenerateAIModal:b,closeGenerateAIModal:S,handleModalImport:T,questionTypeOptions:I,questionDifficultyOptions:C,questionMaximumOptions:_,generatedQuestions:x,generateModalState:w,generateByAIModalState:a,onDeselectQuestionType:U,loading:G,indicator:E,onGenerateQuestions:u,files:N,fileInput:M,isDragging:V,openFileExplorer:K,onFileChange:X,handleFileChange:W,handleDragEnter:Z,handleDrop:p,onRemoveUploadedFile:B,onCheckAll:A,toggleDisplayAnswer:Q,generateFileStructureRef:j,openFileStructureModal:J,handleImportStructure:m,get QUESTION_TYPE(){return me},get SUPPORTED_LOCALES(){return ae},get InboxOutlined(){return se},TextArea:De,GenerateFileStructure:Qt};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),Nt={class:"modal-container"},Ut={class:"modal-title-container"},zt={class:"modal-content-item"},Pt={class:"content-item-section upload-section"},Rt={class:"section-title"},Bt={key:0,class:"section-content mb-2"},Jt={class:"customized-file-upload-icons"},Ht={class:"customized-file-upload-ins"},jt={class:"customized-file-upload-hint"},Vt={key:1,class:"file-container"},Yt={class:"file-item"},Xt={class:"content-item-section preview-section"},Kt={class:"section-title"},$t={class:"section-content"},Wt={key:0,class:"section-content-header"},Zt={class:"header-item"},en={class:"preview-question-container"},tn={class:"preview-question-item"},nn={class:"question-item-content"},an=["innerHTML"],on={key:1,class:"question-text"},ln=["id"],sn={key:0,class:"multiple-choice-answer"},rn={key:0,class:"text-success"},cn={class:"pair-answer"},dn={class:"pair-answer-item"},un={class:"pair-answer-item"},mn={key:2,class:"ordering-answer"},_n={class:"ordering-answer-item"},fn={class:"ordering-answer-item"},pn={class:"ordering-answer-item"},gn={class:"short-text-answer"},vn={class:"question-item-toogle-btn"},hn=["onClick"],bn={class:"modal-generate-by-ai-warning"},yn={class:"w-100 d-flex justify-content-end"};function kn(l,t,v,e,F,H){const O=h("RouterLink"),b=h("a-col"),S=h("a-row"),T=h("a-select-option"),I=h("a-select"),C=h("a-form-item"),_=h("a-switch"),x=h("a-button"),w=h("a-form"),a=h("a-checkbox"),U=h("a-checkbox-group"),G=h("a-spin"),E=h("a-modal");return r(),d(D,null,[i(E,{centered:"",width:"100%",closable:!1,"wrap-class-name":"full-modal",open:e.modal_generate_ai_open,onCancel:e.closeGenerateAIModal},{footer:c(()=>t[20]||(t[20]=[])),default:c(()=>[i(G,{spinning:e.loading,size:"large",indicator:e.indicator},{default:c(()=>[n("div",Nt,[n("div",Ut,[i(S,{class:"w-100 d-flex align-items-center"},{default:c(()=>[i(b,{span:1},{default:c(()=>[i(O,{onClick:e.closeGenerateAIModal,to:{name:""}},{default:c(()=>t[11]||(t[11]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[11]})]),_:1}),i(b,{class:"main-title",span:23},{default:c(()=>[n("span",null,s(l.$t("generate_qs_modal.title")),1),t[12]||(t[12]=y()),t[13]||(t[13]=n("br",null,null,-1)),n("span",null,s(l.$t("generate_qs_modal.sub_title")),1)]),_:1,__:[12,13]})]),_:1})]),n("div",zt,[n("div",Pt,[n("div",Rt,[n("span",null,s(l.$t("import_qs_modal.upload_section")),1)]),e.files.length?L("v-if",!0):(r(),d("div",Bt,[n("input",{onChange:e.handleFileChange,class:"d-none",type:"file",ref:"fileInput",accept:".pdf"},null,544),n("div",{class:Y(["customized-file-upload",e.isDragging?"is-dragging":""]),onClick:e.openFileExplorer,onDragenter:e.handleDragEnter,onDragover:t[0]||(t[0]=le(u=>e.isDragging=!0,["prevent"])),onDragleave:t[1]||(t[1]=u=>e.isDragging=!1),onDrop:le(e.handleDrop,["prevent"])},[n("div",Jt,[n("i",{class:Y(["bx","bx-down-arrow-alt","bx-fade-up",e.isDragging?"":"d-none"])},null,2),i(e.InboxOutlined,{class:Y([e.isDragging?"d-none":""])},null,8,["class"])]),n("div",Ht,s(l.$t("import_qs_modal.upload_area.title")),1),n("div",jt,[y(s(l.$t("import_qs_modal.upload_area.content"))+" ",1),t[14]||(t[14]=n("br",null,null,-1)),y(" "+s(l.$t("import_qs_modal.upload_area.sub_content")),1)])],34)])),e.files.length?(r(),d("div",Vt,[(r(!0),d(D,null,R(e.files,u=>(r(),d("div",Yt,[n("span",null,s(u.name),1),n("i",{class:"bx bx-trash text-danger",onClick:t[2]||(t[2]=N=>e.onRemoveUploadedFile())})]))),256)),n("div",{class:"file-structure",onClick:e.openFileStructureModal},[t[15]||(t[15]=n("i",{class:"bx bx-file"},null,-1)),n("div",null,s(l.$t("generate_qs_modal.form.structure")),1)])])):L("v-if",!0),i(w,{layout:"vertical",class:"generate-ai-form"},{default:c(()=>[i(S,{class:"d-flex justify-content-between"},{default:c(()=>[i(b,{span:12},{default:c(()=>[i(C,{l:"",label:e.t("generate_qs_modal.form.language")},{default:c(()=>[i(I,{class:"language-select",value:e.generateByAIModalState.language,"onUpdate:value":t[3]||(t[3]=u=>e.generateByAIModalState.language=u)},{default:c(()=>[(r(!0),d(D,null,R(e.SUPPORTED_LOCALES,u=>(r(),oe(T,{key:`locale-${u.code}`,value:u.code},{default:c(()=>[y(s(u.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),i(b,{span:11},{default:c(()=>[i(C,{label:e.t("generate_qs_modal.form.maximum_question")},{default:c(()=>[i(I,{value:e.generateByAIModalState.questionCount,"onUpdate:value":t[4]||(t[4]=u=>e.generateByAIModalState.questionCount=u),style:{width:"100%"},placeholder:"Maximum number of question",options:e.questionMaximumOptions},null,8,["value","options"])]),_:1},8,["label"])]),_:1})]),_:1}),i(C,{label:e.t("generate_qs_modal.form.question_types")},{default:c(()=>[i(I,{onDeselect:e.onDeselectQuestionType,value:e.generateByAIModalState.questionTypes,"onUpdate:value":t[5]||(t[5]=u=>e.generateByAIModalState.questionTypes=u),mode:"multiple",style:{width:"100%"},placeholder:"Select multiple",options:e.questionTypeOptions},null,8,["value","options"])]),_:1},8,["label"]),i(S,{class:"d-flex justify-content-between"},{default:c(()=>[i(b,{span:7},{default:c(()=>[i(C,{label:e.t("generate_qs_modal.form.enable_explaination")},{default:c(()=>[i(_,{checked:e.generateByAIModalState.isGenerateExplain,"onUpdate:checked":t[6]||(t[6]=u=>e.generateByAIModalState.isGenerateExplain=u)},null,8,["checked"])]),_:1},8,["label"])]),_:1}),e.generateByAIModalState.isGenerateExplain?(r(),oe(b,{key:0,span:16},{default:c(()=>[i(C,{label:e.t("generate_qs_modal.form.reference_name")},{default:c(()=>[i(e.TextArea,{modelValue:e.generateByAIModalState.title,"onUpdate:modelValue":t[7]||(t[7]=u=>e.generateByAIModalState.title=u),"is-required":e.generateByAIModalState.isGenerateExplain,"max-length":200,placeholder:e.t("generate_qs_modal.form.reference_name_placeholder"),readonly:!e.generateByAIModalState.isGenerateExplain},null,8,["modelValue","is-required","placeholder","readonly"])]),_:1},8,["label"])]),_:1})):L("v-if",!0)]),_:1}),i(C,{style:{"margin-top":"7px"},class:"generate-ai-btn-container"},{default:c(()=>[i(x,{loading:e.loading,size:"large",class:"w-100 main-color-btn generate_ai",type:"primary",onClick:e.onGenerateQuestions},{default:c(()=>[y(s(l.$t("generate_qs_modal.buttons.generate")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),n("div",Xt,[n("div",Kt,s(l.$t("import_qs_modal.preview_section")),1),n("div",$t,[e.generatedQuestions.length>0?(r(),d("div",Wt,[i(a,{class:Y(["header-item",e.generateModalState.checkAll?"check-all":""]),onClick:e.onCheckAll,checked:e.generateModalState.checkAll,"onUpdate:checked":t[8]||(t[8]=u=>e.generateModalState.checkAll=u),indeterminate:e.generateModalState.indeterminate},{default:c(()=>[y(s(l.$t("share_modal.buttons.check_all",{number:e.generateModalState.checkedList.length})),1)]),_:1},8,["class","checked","indeterminate"]),n("div",Zt,s(l.$t("import_qs_modal.other.total_question",{number:e.generateModalState.checkedList.length})),1)])):L("v-if",!0),i(U,{value:e.generateModalState.checkedList,"onUpdate:value":t[10]||(t[10]=u=>e.generateModalState.checkedList=u)},{default:c(()=>[n("div",en,[(r(!0),d(D,null,R(e.generatedQuestions,(u,N)=>(r(),d("div",tn,[i(a,{onClick:t[9]||(t[9]=M=>console.log(e.generateModalState.checkedList)),value:u.id},null,8,["value"]),n("div",nn,[u.questionHTML?(r(),d("div",{key:0,class:"question-html",innerHTML:u.questionHTML},null,8,an)):(r(),d("div",on,s(u.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${N}`},[u.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(r(),d("div",sn,[n("ul",null,[(r(!0),d(D,null,R(u.multipleChoices,M=>(r(),d("li",null,[y(s(M.text)+" ",1),M.isAnswer?(r(),d("span",rn," ("+s(M.isAnswer)+") ",1)):L("v-if",!0)]))),256))])])):L("v-if",!0),u.type===e.QUESTION_TYPE.MATCHING?(r(!0),d(D,{key:1},R(u.matchingPairs,M=>(r(),d("div",cn,[n("span",dn,s(M.leftItem),1),t[16]||(t[16]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",un,s(M.rightItem),1)]))),256)):L("v-if",!0),u.type===e.QUESTION_TYPE.ORDERING?(r(),d("div",mn,[n("div",_n,[(r(!0),d(D,null,R(u.orderingItems,M=>(r(),d("div",null,s(M.text),1))),256))]),t[17]||(t[17]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",fn,[(r(!0),d(D,null,R(u.orderingItems,(M,V)=>(r(),d("div",pn,[n("span",null,"#"+s(V+1),1),y(" - "+s(M.text),1)]))),256))])])):L("v-if",!0),u.type===e.QUESTION_TYPE.SHORT_TEXT?(r(),d(D,{key:3},[t[18]||(t[18]=n("span",null,"Answer:",-1)),n("div",gn,s(u.shortAnswer),1)],64)):L("v-if",!0)],8,ln)]),n("div",vn,[n("i",{class:"bx bx-chevron-up",onClick:M=>e.toggleDisplayAnswer(N,M.currentTarget)},null,8,hn)])]))),256))])]),_:1},8,["value"])]),n("div",bn,[n("span",null,[t[19]||(t[19]=n("i",{class:"bx bx-info-circle"},null,-1)),y(" "+s(l.$t("generate_qs_modal.other.ai_warning")),1)])]),n("div",yn,[i(x,{class:"main-color-btn",key:"submit",type:"primary",size:"large",onClick:e.handleModalImport},{default:c(()=>[y(s(l.$t("import_qs_modal.buttons.import")),1)]),_:1})])])])])]),_:1},8,["spinning","indicator"])]),_:1},8,["open"]),i(e.GenerateFileStructure,{file:e.files[0],ref:"generateFileStructureRef",onImport:e.handleImportStructure},null,8,["file"])],64)}const Mn=ge(Ft,[["render",kn],["__scopeId","data-v-23b34ba3"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateQSModal.vue"]]);export{Mn as G,Cn as I};
