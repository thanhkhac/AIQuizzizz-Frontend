import{d as G,q as X,l as K,u as W,B as J,i as b,j as ie,U as re,_ as Z,r as v,E as L,o as n,w as _,b as t,c,f as x,t as r,a as s,F as k,D as A,s as de,S as H,M as j,k as D,T as ce,e as E}from"./index-CZZuPq2J.js";import{u as _e}from"./user-zaK1_Zi8.js";import{A as U}from"./ApiTestTemplate-C-go-SZO.js";import{A as ee}from"./ApiFolder-CAtwHbTG.js";import{Q as F}from"./questionTypes-CS3lcRlq.js";import{I as te}from"./Input-CmmM3bqD.js";import{T as ue}from"./TransferQuestionData-BxcXdBjq.js";import{V as me}from"./Validator-CWeiTIFe.js";import{S as pe}from"./ShareModal-D-oJZ3Ir.js";import{V as ve}from"./visibility-PZlBDoOn.js";import{F as V}from"./folderShareMode-BudLQ2R2.js";/* empty css                                                              */import"./ApiQuestionSet-69wH4BjR.js";import"./ApiClass-CYakcOs3.js";const fe=G({__name:"ShareToFolder",emits:["addToFolder"],setup(f,{expose:a,emit:C}){var N;const e=X(),q=K(),{t:z}=W(),p=[V.OWNER,V.EDITABLE],u=J(()=>p.map(m=>({label:z(`folder_index.select_option.${m}`),value:m!==V.ALL?m:""}))),y=b([]),i=ie({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,folderName:((N=e.query.folderName)==null?void 0:N.toString())||"",shareMode:e.query.shareMode||u.value[0].value,totalCount:0,statusFilter:!1}),g=async()=>{try{let m=await ee.GetAllByLimit(i);if(m.data.success){let S=m.data.data;y.value=S.items,i.pageNumber=S.pageNumber,i.pageSize=S.pageSize,i.totalCount=S.totalCount}}catch(m){console.log("ERROR: GETALLBYLIMIT folder: "+m)}};re(()=>{var m;Object.keys(e.query).length===0&&(i.pageNumber=e.query.pageNumber||1,i.pageSize=e.query.pageSize||10,i.folderName=((m=e.query.folderName)==null?void 0:m.toString())||"",i.shareMode=e.query.shareMode||u.value[0].value,i.statusFilter=!0,g())});const M=(m,S)=>{i.pageNumber=m,i.pageSize=S,i.statusFilter=!0,g()},l=b(!1),I=()=>{l.value=!0},o=()=>{l.value=!1};a({openModal:I,closeModal:o});const h=C,O={route:e,router:q,t:z,optionKeys:p,folder_share_mode_options:u,folder_data:y,pageParams:i,getData:g,onPaginationChange:M,modal_open:l,openModal:I,closeModal:o,emit:h,handleAddToFolder:m=>{h("addToFolder",m)},Input:te};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}}),ge={class:"modal-container"},he={class:"modal-title-container"},Te={class:"content"},be={class:"content-item"},ye={class:"title-container"},Ie={class:"main-title"},Se={class:"content-item-functions"},we={class:"filter-container"},Ee={style:{width:"300px",padding:"0px"}},xe={class:"folder-container"},ke=["onClick"],Me={class:"folder-name"},Ae={key:1,class:"w-100 m-2 d-flex justify-content-center"},ze={class:"pagination-container"};function qe(f,a,C,e,q,z){const p=v("RouterLink"),u=v("a-col"),y=v("a-row"),i=v("a-select-option"),g=v("a-select"),M=v("a-empty"),l=v("a-pagination"),I=v("a-modal");return n(),L(I,{centered:"",width:"100%","wrap-class-name":"medium-modal large",open:e.modal_open,onCancel:e.closeModal},{footer:_(()=>a[9]||(a[9]=[])),default:_(()=>[t("div",ge,[t("div",he,[c(y,{class:"w-100 d-flex align-items-center"},{default:_(()=>[c(u,{span:1},{default:_(()=>[c(p,{onClick:e.closeModal,to:{name:""}},{default:_(()=>a[3]||(a[3]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[3]})]),_:1}),c(u,{class:"main-title",span:23},{default:_(()=>a[4]||(a[4]=[t("span",null,"Choose from folder test",-1)])),_:1,__:[4]})]),_:1})]),t("div",Te,[t("div",be,[t("div",ye,[t("div",Ie,[t("span",null,r(f.$t("folder_index.title")),1),a[5]||(a[5]=x()),a[6]||(a[6]=t("br",null,null,-1)),t("span",null,r(f.$t("folder_index.sub_title")),1)])]),t("div",Se,[t("div",we,[c(g,{class:"me-3",value:e.pageParams.shareMode,"onUpdate:value":a[0]||(a[0]=o=>e.pageParams.shareMode=o),style:{width:"200px"},onChange:e.getData},{default:_(()=>[(n(!0),s(k,null,A(e.folder_share_mode_options,o=>(n(),L(i,{value:o.value},{default:_(()=>[x(r(o.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",Ee,[c(e.Input,{onInput:e.getData,modelValue:e.pageParams.folderName,"onUpdate:modelValue":a[1]||(a[1]=o=>e.pageParams.folderName=o),placeholder:e.t("class_index.other.search_class_placeholder")},{icon:_(()=>a[7]||(a[7]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])])]),t("div",xe,[e.folder_data.length>0?(n(!0),s(k,{key:0},A(e.folder_data,o=>(n(),s("div",{class:"folder",onClick:h=>e.handleAddToFolder(o)},[a[8]||(a[8]=t("div",{class:"folder-icon"},[t("div",{class:"folder-top"}),t("div",{class:"folder-body"})],-1)),t("div",Me,r(o.name),1)],8,ke))),256)):(n(),s("div",Ae,[c(M,null,{description:_(()=>[t("span",null,r(f.$t("folder_index.other.no_data_matches")),1)]),_:1})]))]),t("div",ze,[c(l,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":a[2]||(a[2]=o=>e.pageParams.pageNumber=o),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(o,h)=>`${h[0]}-${h[1]} of ${o} ${e.t("folder_index.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("folder_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])])]),_:1},8,["open"])}const Re=Z(fe,[["render",qe],["__scopeId","data-v-2d13cee5"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/ShareToFolder.vue"]]),Ce=G({__name:"detail",emits:["updateSidebar"],setup(f,{expose:a,emit:C}){a();const{t:e}=W(),q=C,z=X(),p=K(),u=b(!1),y=b(z.params.id),i=b({testTemplateId:"",name:"",createBy:"",numberOfQuestion:0,dateCreated:"",description:""}),g=b([]),M=b([]),l=["All",F.MULTIPLE_CHOICE,F.MATCHING,F.ORDERING,F.SHORT_TEXT],I=J(()=>l.map(d=>({label:e(`create_QS.type.${d}`),value:d}))),o=b(I.value[0].value),h=b(""),P=async()=>{var d,w;try{u.value=!0,me.isValidGuid(y.value.toString())||p.push({name:"404"});const T=await U.GetById(y.value.toString());T.data.success||p.push({name:"User_Library"}),i.value=T.data.data,i.value.dateCreated=T.data.data.createAt,g.value=T.data.data.questions.map(R=>ue.transformResponseToRequest(R)),M.value=g.value,await Y()}catch(T){H.USER_NOT_HAVE_PERMISSION_IN_TEST_TEMPLATE in(((w=(d=T.response)==null?void 0:d.data)==null?void 0:w.errors)||{})?p.push({name:"not-allowed"}):p.push({name:"404"})}finally{u.value=!1}},O=(d,w)=>{$(w).toggleClass("bx-chevron-up bx-chevron-down");const R=$(`#question-item-answer-${d}`);R&&$(R).slideToggle()},N=b(null),m=()=>{var d;(d=N.value)==null||d.openModal()},S=b(null),ae=()=>{var d;(d=S.value)==null||d.openModal()},oe=d=>{j.confirm({title:e("detail_test_template.modal.add_to_folder_title"),content:e("detail_test_template.modal.add_to_folder_content",{name:i.value.name,folder_name:d.name}),okText:e("sidebar.buttons.ok"),cancelText:e("sidebar.buttons.cancel"),centered:!0,onOk:async()=>{var T;const w=await ee.AddTestTemplate(d.folderTestId,i.value.testTemplateId);if(!w.data.success&&Object.keys(w.data.errors).includes(H.TEST_TEMPLATE_ALREADY_EXISTS_IN_FOLDER)){D.error(e("mesage.TEST_TEMPLATE_ALREADY_EXISTS_IN_FOLDER"));return}D.success(e("message.added_successfully")),(T=S.value)==null||T.closeModal()}})},ne=()=>{p.push({name:"User_TestTemplate_Update",params:{id:i.value.testTemplateId}})},Q=b({canEdit:!1,canDelete:!1}),Y=async()=>{const d=await U.GetPermissions(i.value.testTemplateId);d.data.success&&(Q.value=d.data.data)},se=()=>{j.confirm({title:e("detail_test_template.modal.delete_title"),content:e("detail_test_template.modal.delete_content"),okText:e("sidebar.buttons.ok"),cancelText:e("sidebar.buttons.cancel"),onOk:async()=>{if(!(await U.Delete(i.value.testTemplateId)).data.success){D.error(e("message.deleted_failed"));return}D.success(e("message.deleted_successfully")),p.push({name:"User_TestTemplate"})}})},le=()=>{let d=g.value;d=g.value.filter(w=>{const T=w.questionText.includes(h.value),R=o.value==="All"||o.value===w.type;return T&&R}),M.value=d};de(async()=>{q("updateSidebar","folder"),await P()});const B={t:e,emit:q,route:z,router:p,loading:u,question_set_id:y,quiz:i,quiz_questions:g,questions:M,optionKeys:l,question_type_options:I,selected_type_option:o,searchValue:h,getData:P,toggleDisplayAnswer:O,shareModalRef:N,onOpenShareModal:m,shareToFolderModalRef:S,openFolderModal:ae,onAddToFolder:oe,onRedirectToEdit:ne,permission:Q,getPermission:Y,onDelete:se,onFilter:le,get user_image(){return _e},get QUESTION_TYPE(){return F},Input:te,get dayjs(){return ce},ShareModal:pe,get VISIBILITY(){return ve},ShareToFolder:Re};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),Ne={class:"content"},Fe={class:"content-item"},Le={key:0},Oe={key:1},De={class:"content-item-title"},Pe={key:0,class:"d-flex flex-row align-items-center justify-content-between quiz-header-functions"},Ue={class:"action-container"},Ve={class:"credit-user"},Qe=["src"],Ye={class:"credit-user-info"},Be={class:"action-container"},He={class:"content-item"},je={class:"content-item-title"},Ge={class:"content-item-functions"},Xe={style:{width:"300px",padding:"0"}},Ke={key:0},We={key:1,class:"preview-question-container"},Je={class:"preview-question-item"},Ze={class:"question-item-content"},$e={class:"d-flex pb-2"},et={class:"question-index"},tt=["innerHTML"],at={key:1,class:"question-text"},ot=["id"],nt={key:0,class:"multiple-choice-answer"},st={key:0,class:"text-success"},lt={class:"pair-answer"},it={class:"pair-answer-item"},rt={class:"pair-answer-item"},dt={key:2,class:"ordering-answer"},ct={class:"ordering-answer-item"},_t={class:"ordering-answer-item"},ut={class:"ordering-answer-item"},mt={class:"short-text-answer"},pt={class:"question-item-toogle-btn"},vt=["onClick"];function ft(f,a,C,e,q,z){const p=v("RouterLink"),u=v("a-skeleton"),y=v("a-tooltip"),i=v("a-button"),g=v("a-select-option"),M=v("a-select");return n(),s(k,null,[t("div",Ne,[c(p,{class:"navigator-back-link d-flex align-items-center p-2",to:{name:"User_TestTemplate"}},{default:_(()=>[a[2]||(a[2]=t("i",{class:"me-1 bx bx-chevron-left"},null,-1)),x(" "+r(f.$t("detail_QS.other.library")),1)]),_:1,__:[2]}),t("div",Fe,[e.loading?(n(),s("div",Le,[c(u,{loading:e.loading,active:""},null,8,["loading"]),c(u,{loading:e.loading,active:""},null,8,["loading"])])):(n(),s("div",Oe,[t("div",De,[t("div",null,[t("span",null," Mẫu đề thi: "+r(e.quiz.name),1),t("span",null,r(e.quiz.description),1)]),e.permission.canEdit||e.permission.canDelete?(n(),s("div",Pe,[c(y,null,{title:_(()=>[x(r(f.$t("question_sets_index.buttons.edit")),1)]),default:_(()=>[e.permission.canEdit?(n(),s("i",{key:0,class:"bx bx-edit",onClick:e.onRedirectToEdit})):E("v-if",!0)]),_:1}),c(y,null,{title:_(()=>[x(r(f.$t("question_sets_index.buttons.delete")),1)]),default:_(()=>[e.permission.canDelete?(n(),s("i",{key:0,class:"text-danger bx bx-trash-alt",onClick:e.onDelete})):E("v-if",!0)]),_:1})])):E("v-if",!0)]),t("div",Ue,[t("div",Ve,[t("img",{class:"user-image",src:e.user_image,alt:""},null,8,Qe),t("div",Ye,[t("span",null,r(f.$t("detail_QS.other.created_by",{username:e.quiz.createBy||"Unknown"})),1),t("span",null,r(e.dayjs(e.quiz.dateCreated).format("DD/MM/YYYY")),1)])]),t("div",Be,[e.permission.canDelete?(n(),L(i,{key:0,type:"primary",class:"me-3 main-color-btn share-btn",size:"large",onClick:e.openFolderModal},{default:_(()=>[a[3]||(a[3]=t("i",{class:"bx bx-plus"},null,-1)),x(" "+r(f.$t("detail_test_template.buttons.add_to_folder")),1)]),_:1,__:[3]})):E("v-if",!0),e.permission.canDelete?(n(),L(i,{key:1,type:"primary",class:"main-color-btn share-btn",size:"large",onClick:e.onOpenShareModal},{default:_(()=>[a[4]||(a[4]=t("i",{class:"bx bx-share-alt"},null,-1)),x(" "+r(f.$t("detail_QS.buttons.share_quiz")),1)]),_:1,__:[4]})):E("v-if",!0)])])]))]),t("div",He,[t("div",je,[t("div",null,[t("span",null,r(f.$t("detail_QS.other.questions",{number:e.quiz_questions.length})),1)])]),t("div",Ge,[c(M,{class:"me-3",value:e.selected_type_option,"onUpdate:value":a[0]||(a[0]=l=>e.selected_type_option=l),style:{width:"200px"},onChange:e.onFilter},{default:_(()=>[(n(!0),s(k,null,A(e.question_type_options,l=>(n(),L(g,{value:l.value},{default:_(()=>[x(r(l.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",Xe,[c(e.Input,{onInput:e.onFilter,modelValue:e.searchValue,"onUpdate:modelValue":a[1]||(a[1]=l=>e.searchValue=l),placeholder:e.t("question_sets_index.search_placeholder")},{icon:_(()=>a[5]||(a[5]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(n(),s("div",Ke,[c(u,{loading:e.loading,active:""},null,8,["loading"]),c(u,{loading:e.loading,active:""},null,8,["loading"]),c(u,{loading:e.loading,active:""},null,8,["loading"]),c(u,{loading:e.loading,active:""},null,8,["loading"]),c(u,{loading:e.loading,active:""},null,8,["loading"])])):(n(),s("div",We,[(n(!0),s(k,null,A(e.questions,(l,I)=>(n(),s("div",Je,[t("div",Ze,[t("div",$e,[t("div",et,r(I+1),1),l.questionHTML?(n(),s("div",{key:0,class:"question-html",innerHTML:l.questionHTML},null,8,tt)):(n(),s("div",at,r(l.questionText),1))]),t("div",{class:"question-item-answer",id:`question-item-answer-${I}`,style:{display:"none"}},[l.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(n(),s("div",nt,[t("ul",null,[(n(!0),s(k,null,A(l.multipleChoices,o=>(n(),s("li",null,[x(r(o.text)+" ",1),o.isAnswer?(n(),s("span",st," ("+r(o.isAnswer)+") ",1)):E("v-if",!0)]))),256))])])):E("v-if",!0),l.type===e.QUESTION_TYPE.MATCHING?(n(!0),s(k,{key:1},A(l.matchingPairs,o=>(n(),s("div",lt,[t("span",it,r(o.leftItem),1),a[6]||(a[6]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("span",rt,r(o.rightItem),1)]))),256)):E("v-if",!0),l.type===e.QUESTION_TYPE.ORDERING?(n(),s("div",dt,[t("div",ct,[(n(!0),s(k,null,A(l.orderingItems,o=>(n(),s("div",null,r(o.text),1))),256))]),a[7]||(a[7]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("div",_t,[(n(!0),s(k,null,A(l.orderingItems.sort((o,h)=>o.correctOrder-h.correctOrder),(o,h)=>(n(),s("div",ut,[t("span",null,"#"+r(h+1),1),x(" - "+r(o.text),1)]))),256))])])):E("v-if",!0),l.type===e.QUESTION_TYPE.SHORT_TEXT?(n(),s(k,{key:3},[a[8]||(a[8]=t("span",null,"Answer:",-1)),t("div",mt,r(l.shortAnswer),1)],64)):E("v-if",!0)],8,ot)]),t("div",pt,[t("i",{class:"bx bx-chevron-down",onClick:o=>e.toggleDisplayAnswer(I,o.currentTarget)},null,8,vt)])]))),256))]))])]),c(e.ShareModal,{ref:"shareModalRef",id:e.quiz.testTemplateId,name:e.quiz.name,mode:"template",options:[e.VISIBILITY.PRIVATE],visibility:""},null,8,["id","name","options"]),c(e.ShareToFolder,{ref:"shareToFolderModalRef",onAddToFolder:e.onAddToFolder},null,512)],64)}const qt=Z(Ce,[["render",ft],["__scopeId","data-v-a98a6135"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/test_template/detail.vue"]]);export{qt as default};
