import{c as u,I as X,d as $,q as Q,l as J,u as W,i as O,B as Z,j as K,C as ee,s as te,M as ae,k as se,R as ne,_ as oe,r as b,a as f,o as g,b as a,w as c,f as m,t as i,F as z,D as M,E as D,e as E}from"./index-DjZzqq9v.js";import{A as P}from"./ApiClass-_GHyt6RM.js";import{A as le}from"./ApiTest-34xsPgDX.js";import{C as ie}from"./classStudentPosition-B7ChrNvq.js";import{I as re}from"./Input-Ct_lfuqj.js";import{V as ce}from"./Validator-CWeiTIFe.js";var ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm376 116c-119.3 0-216 96.7-216 216s96.7 216 216 216 216-96.7 216-216-96.7-216-216-216zm107.5 323.5C750.8 868.2 712.6 884 672 884s-78.8-15.8-107.5-44.5C535.8 810.8 520 772.6 520 732s15.8-78.8 44.5-107.5C593.2 595.8 631.4 580 672 580s78.8 15.8 107.5 44.5C808.2 653.2 824 691.4 824 732s-15.8 78.8-44.5 107.5zM761 656h-44.3c-2.6 0-5 1.2-6.5 3.3l-63.5 87.8-23.1-31.9a7.92 7.92 0 00-6.5-3.3H573c-6.5 0-10.3 7.4-6.5 12.7l73.8 102.1c3.2 4.4 9.7 4.4 12.9 0l114.2-158c3.9-5.3.1-12.7-6.4-12.7zM440 852H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"file-done",theme:"outlined"};function L(l){for(var s=1;s<arguments.length;s++){var _=arguments[s]!=null?Object(arguments[s]):{},e=Object.keys(_);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(_).filter(function(d){return Object.getOwnPropertyDescriptor(_,d).enumerable}))),e.forEach(function(d){de(l,d,_[d])})}return l}function de(l,s,_){return s in l?Object.defineProperty(l,s,{value:_,enumerable:!0,configurable:!0,writable:!0}):l[s]=_,l}var U=function(s,_){var e=L({},s,_.attrs);return u(X,L({},e,{icon:ue}),null)};U.displayName="FileDoneOutlined";U.inheritAttrs=!1;const x={ALL:"All",UPCOMING:"Upcoming",ACTIVE:"Active",COMPLETED:"Completed"},me=$({__name:"exam",emits:["updateSidebar"],setup(l,{expose:s,emit:_}){var w;s();const e=Q(),d=J(),{t:h}=W(),C=_,p=O(e.params.id||""),T=O({classId:"",name:"",topic:""}),k=Object.values(x),S=Z(()=>k.map(t=>({label:h(`class_exam.select_option.${t}`),value:t!==x.ALL?t:""}))),n=K({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,testName:((w=e.query.testName)==null?void 0:w.toString())||"",status:e.query.status||S.value[0].value,totalCount:0,statusFilter:!1}),y=O([]),A=O(""),N=O(!1),o=async()=>{try{const t=await P.GetUserPermission(T.value.classId);t.data.success&&(A.value=t.data.data)}catch(t){console.log(t)}},v=async()=>{try{if(!ce.isValidGuid(p.value.toString())){d.push({name:"404"});return}p.value||d.push({name:"404"});let t=await P.GetById(p.value.toString());t.data.success||d.push({name:"404"}),T.value=t.data.data}catch(t){console.log("ERROR: GETBYID class: "+t)}},I=async()=>{try{N.value=!0;let t=await P.GetAllExamByLimit(p.value.toString(),n);if(t.data.success){let r=t.data.data;y.value=r.items,n.pageNumber=r.pageNumber,n.pageSize=r.pageSize,n.totalCount=r.totalCount,n.statusFilter&&(n.pageNumber>r.totalPages&&n.totalCount>0?(n.pageNumber=1,d.push({name:"User_Class_Exam",params:{id:p.value},query:{pageNumber:1,pageSize:n.pageSize,testName:n.testName,status:n.status}})):d.push({name:"User_Class_Exam",params:{id:p.value},query:{pageNumber:n.pageNumber,pageSize:n.pageSize,testName:n.testName,status:n.status}}),n.statusFilter=!n.statusFilter)}}catch(t){console.log("ERROR: GETALLEXAMBYLIMIT class exam: "+t)}finally{N.value=!1}};ee(()=>Object.keys(e.query).length,()=>{var t;n.pageNumber=e.query.pageNumber||1,n.pageSize=e.query.pageSize||10,n.testName=((t=e.query.testName)==null?void 0:t.toString())||"",n.status=e.query.status||S.value[0].value,n.statusFilter=!0,I()});const q=(t,r)=>{n.pageNumber=t,n.pageSize=r,n.statusFilter=!0,I()},F=t=>{if(t<24)return`${t} hour${t!==1?"s":""} ago`;if(t<24*7){const r=Math.floor(t/24);return`${r} day${r!==1?"s":""} ago`}else if(t<24*30){const r=Math.floor(t/168);return`${r} week${r!==1?"s":""} ago`}else if(t<24*365){const r=Math.floor(t/720);return`${r} month${r!==1?"s":""} ago`}else{const r=Math.floor(t/8760);return`${r} year${r!==1?"s":""} ago`}},V=t=>{switch(t){case x.COMPLETED:return"#3b82f6";case x.ACTIVE:return"#22C55E";case x.UPCOMING:return"#f59e0b"}},j=()=>{d.push({name:"User_Test_Create",params:{id:p.value}})},B=t=>{d.push({name:"User_Test_Update",params:{id:t}})},G=t=>{ae.confirm({title:h("class_exam.modal.delete_title"),content:h("class_exam.modal.delete_content"),okText:h("sidebar.buttons.ok"),cancelText:h("sidebar.buttons.cancel"),onOk:async()=>{(await le.Delete(t)).data.success&&(se.success(h("message.deleted_successfully")),I())}})},H=t=>{d.push({name:"User_Test_Attempt",params:{id:t}})},Y=t=>{d.push({name:"User_Class_Exam_Result",params:{classId:p.value,testId:t}})};te(async()=>{C("updateSidebar","class"),await v(),await o(),await I()});const R={route:e,router:d,t:h,emit:C,classId:p,classData:T,optionKeys:k,exam_status_options:S,pageParams:n,exam_data:y,userRoleInClass:A,loading:N,getPermission:o,getClassData:v,getData:I,onPaginationChange:q,getFormattedRelativeTime:F,getTagColor:V,onRedirectToCreate:j,onRedirectToUpdate:B,onDeleteTest:G,onRedirectToAttempt:H,onRedirectToResult:Y,get CLASS_STUDENT_POSITION(){return ie},get CLASS_EXAM_STATUS(){return x},get dayjs(){return ne},Input:re,get FileDoneOutlined(){return U}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),_e={class:"page-container"},pe={class:"title-container"},ge={class:"breadcrumb-container"},ve={class:"title-breadcrumb-item"},be={class:"title-breadcrumb-item"},fe={class:"breadcrumb-item-topic"},he={class:"content"},Ce={class:"content-item"},Se={class:"content-item-title"},ye={class:"content-item-functions"},xe={class:"content-item-navigators"},Te={class:"navigator-container"},Ne={style:{width:"300px",padding:"0px"}},Ie={key:0,class:"exam-item-container"},Oe={class:"exam-item"},ze={class:"exam-item-title"},ke={class:"exam-item-info exam-item-date"},Ae={class:"exam-item-info exam-info-detail"},De={class:"exam-item-questions"},Ee={class:"exam-item-time"},Pe={class:"exam-item-assigned completion"},Ue={class:"exam-item-assigned"},Re={class:"exam-item-actions"},we=["onClick"],Me=["onClick"],Le=["onClick"],qe={key:1,class:"w-100 d-flex justify-content-center"},Fe={class:"pagination-container"};function Ve(l,s,_,e,d,h){const C=b("RouterLink"),p=b("a-button"),T=b("a-select-option"),k=b("a-select"),S=b("a-skeleton"),n=b("a-tag"),y=b("a-tooltip"),A=b("a-empty"),N=b("a-pagination");return g(),f("div",_e,[a("div",pe,[a("div",ge,[a("ul",null,[a("li",ve,[u(C,{to:{name:"User_Class"}},{default:c(()=>[a("span",null,i(l.$t("class_index.title")),1),s[3]||(s[3]=m()),s[4]||(s[4]=a("br",null,null,-1))]),_:1,__:[3,4]}),s[5]||(s[5]=a("i",{class:"bx bx-chevron-right"},null,-1))]),a("li",be,[u(C,{to:{name:""},class:"breadcrumb-item-class"},{default:c(()=>[a("span",null,i(e.classData.name),1),a("span",fe,i(e.classData.topic),1)]),_:1})])])])]),a("div",he,[a("div",Ce,[a("div",Se,[a("div",null,[a("span",null,i(l.$t("class_index.title")),1),a("span",null,i(l.$t("class_exam.sub_title")),1)]),u(p,{type:"primary",class:"main-color-btn",onClick:e.onRedirectToCreate},{default:c(()=>[s[6]||(s[6]=a("i",{class:"me-2 bx bx-list-plus"},null,-1)),m(" "+i(l.$t("class_exam.buttons.assign_test")),1)]),_:1,__:[6]})]),a("div",ye,[a("div",xe,[a("div",Te,[u(C,{class:"navigator-item navigator-active",to:{name:""}},{default:c(()=>[m(i(l.$t("class_index.navigators.exam")),1)]),_:1}),u(C,{class:"navigator-item",to:{name:"User_Class_Quiz"}},{default:c(()=>[m(i(l.$t("class_index.navigators.quiz")),1)]),_:1}),u(C,{class:"navigator-item",to:{name:"User_Class_Student"}},{default:c(()=>[m(i(l.$t("class_index.navigators.member")),1)]),_:1})])]),u(k,{value:e.pageParams.status,"onUpdate:value":s[0]||(s[0]=o=>e.pageParams.status=o),style:{width:"200px"},onChange:e.getData},{default:c(()=>[(g(!0),f(z,null,M(e.exam_status_options,o=>(g(),D(T,{value:o.value},{default:c(()=>[m(i(o.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),a("div",Ne,[u(e.Input,{onInput:e.getData,modelValue:e.pageParams.testName,"onUpdate:modelValue":s[1]||(s[1]=o=>e.pageParams.testName=o),placeholder:e.t("class_exam.other.search_placeholder")},{icon:c(()=>s[7]||(s[7]=[a("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(g(),f(z,{key:0},[u(S,{active:"",loading:e.loading},null,8,["loading"]),u(S,{active:"",loading:e.loading},null,8,["loading"]),u(S,{active:"",loading:e.loading},null,8,["loading"])],64)):(g(),f(z,{key:1},[e.exam_data.length>0?(g(),f("div",Ie,[(g(!0),f(z,null,M(e.exam_data,o=>(g(),f("div",Oe,[s[11]||(s[11]=a("i",{class:"bx bx-book-open exam-item-icon"},null,-1)),a("div",null,[a("div",ze,[m(i(o.name)+" ",1),u(n,{color:e.getTagColor(o.status)},{default:c(()=>[m(i(l.$t(`class_exam.select_option.${o.status}`)),1)]),_:2},1032,["color"])]),a("div",ke,[a("div",null,[s[8]||(s[8]=a("i",{class:"bx bx-calendar"},null,-1)),m(" "+i(e.dayjs(o.timeStart).format("DD/MM/YYYY HH:mm A")),1)])]),a("div",Ae,[a("div",De,[s[9]||(s[9]=a("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),m(" "+i(o.numberOfQuestions)+" "+i(l.$t("dashboards.list_items.quiz.questions")),1)]),a("div",Ee,[s[10]||(s[10]=a("i",{class:"bx bx-time-five"},null,-1)),m(" "+i(o.timeLimit)+" "+i(l.$t("class_exam.other.min")),1)]),a("span",Pe,i(o.numberOfCompletion)+" "+i(l.$t("class_exam.other.completions")),1),a("span",Ue,i(l.$t("class_exam.other.assigned"))+" "+i(e.getFormattedRelativeTime(o.relativeTime)),1)])]),a("div",Re,[o.status===e.CLASS_EXAM_STATUS.ACTIVE?(g(),D(p,{key:0,type:"primary",class:"main-color-btn",onClick:v=>e.onRedirectToAttempt(o.testId)},{default:c(()=>[m(i(l.$t("class_exam.buttons.attempt")),1)]),_:2},1032,["onClick"])):E("v-if",!0),e.userRoleInClass!==e.CLASS_STUDENT_POSITION.STUDENT?(g(),f(z,{key:1},[o.status===e.CLASS_EXAM_STATUS.UPCOMING?(g(),D(y,{key:0},{title:c(()=>[m(i(l.$t("question_sets_index.buttons.edit")),1)]),default:c(()=>[a("i",{class:"bx bx-edit",onClick:v=>e.onRedirectToUpdate(o.testId)},null,8,we)]),_:2},1024)):E("v-if",!0),u(y,null,{title:c(()=>[m(i(l.$t("class_member.buttons.history_test")),1)]),default:c(()=>[a("i",{onClick:v=>e.onRedirectToResult(o.testId)},[u(e.FileDoneOutlined)],8,Me)]),_:2},1024),u(y,null,{title:c(()=>[m(i(l.$t("question_sets_index.buttons.delete")),1)]),default:c(()=>[a("i",{class:"text-danger bx bx-trash-alt",onClick:v=>e.onDeleteTest(o.testId)},null,8,Le)]),_:2},1024)],64)):E("v-if",!0)])]))),256))])):(g(),f("div",qe,[u(A,null,{description:c(()=>[a("span",null,i(l.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),a("div",Fe,[u(N,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":s[2]||(s[2]=o=>e.pageParams.pageNumber=o),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(o,v)=>`${v[0]}-${v[1]} of ${o} ${e.t("class_exam.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])])}const $e=oe(me,[["render",Ve],["__scopeId","data-v-1afc52c6"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/exam.vue"]]);export{$e as default};
