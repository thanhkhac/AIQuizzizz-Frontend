var F=Object.defineProperty;var Q=(g,e,l)=>e in g?F(g,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):g[e]=l;var E=(g,e,l)=>Q(g,typeof e!="symbol"?e+"":e,l);import{y as V,d as j,q as U,l as G,u as M,C as Y,i as f,j as O,P as J,D as K,s as X,_ as H,r as p,a as _,o as c,b as t,c as d,w as m,f as S,F as q,E as N,G as W,t as u,e as Z,p as $}from"./index-C2jtDg6B.js";import{A as ee}from"./ApiQuestionSet-C75xoSuo.js";import{Q as te}from"./questionSetSortCate-BudA85fH.js";/* empty css                                                                 */import{I as ae}from"./Input-0Otcuoto.js";const se={GET_ALL_BY_LIMIT:"Tag"};class ne{constructor(){E(this,"GetAllByLimit",async e=>await V.get(`${se.GET_ALL_BY_LIMIT}`,{params:{name:e.name,pageSize:e.pageSize}}))}}const oe=new ne,le=j({__name:"search",setup(g,{expose:e}){var A;e();const l=U(),a=G(),{t:k}=M(),w=Object.values(te),z=Y(()=>w.map(o=>({label:k(`question_sets_search.sort_category.${o}`),value:o}))),y=f(!1),I=f([]),s=O({pageNumber:l.query.pageNumber||1,pageSize:l.query.pageSize||10,name:((A=l.query.name)==null?void 0:A.toString())||"",sortBy:l.query.sortBy||z.value[0].value,tagIds:l.query.tags?l.query.tags.toString().split(","):[],totalCount:0,statusFilter:!1}),h=async()=>{try{y.value=!0;let o=await ee.GetPublicByLimit(s);if(o.data.success){let i=o.data.data;I.value=i.items,s.pageNumber=i.pageNumber,s.pageSize=i.pageSize,s.totalCount=i.totalCount,s.statusFilter&&(s.pageNumber>i.totalPages&&s.totalCount>0?(s.pageNumber=1,a.push({name:"User_QuestionSet_Search",query:{pageNumber:1,pageSize:s.pageSize,name:s.name,sortBy:s.sortBy,tagIds:s.tagIds.join(",")}})):a.push({name:"User_QuestionSet_Search",query:{pageNumber:s.pageNumber,pageSize:s.pageSize,name:s.name,sortBy:s.sortBy,tagIds:s.tagIds.join(",")}}),s.statusFilter=!s.statusFilter)}}catch(o){console.log("ERROR: GETALLEXAMBYLIMIT search qs: "+o)}finally{y.value=!1}};J(()=>{var o;Object.keys(l.query).length===0&&(s.pageNumber=l.query.pageNumber||1,s.pageSize=l.query.pageSize||10,s.name=((o=l.query.name)==null?void 0:o.toString())||"",s.sortBy=l.query.sortBy||z.value[0].value,s.tagIds=l.query.tags?l.query.tags.toString().split(","):r.value.map(i=>i.id),s.statusFilter=!0,h())});const T=(o,i)=>{s.pageNumber=o,s.pageSize=i,s.statusFilter=!0,h()},r=f([]),b=f([]),C=()=>{const o=sessionStorage.getItem("selected_tags");o&&r.value.push(...JSON.parse(o)),s.tagIds=r.value.map(i=>i.id)},n=O({name:"",pageSize:10}),v=async()=>{const o=await oe.GetAllByLimit(n);o.data.success&&(b.value=o.data.data,x.value=o.data.data)},B=o=>{r.value.map(i=>i.id).includes(o.id)||r.value.push(o),sessionStorage.setItem("selected_tags",JSON.stringify(r.value))},D=o=>{r.value.splice(o,1),sessionStorage.setItem("selected_tags",JSON.stringify(r.value))};K(()=>r.value.length,()=>{s.tagIds=r.value.map(o=>o.id),h()});const P=f(null),x=f([]);function L(o){var i;!n.name||!((i=P.value)!=null&&i.contains(o.target))?b.value=[]:b.value=[...x.value]}X(async()=>{document.addEventListener("click",L),C(),await h()});const R={route:l,router:a,t:k,optionKeys:w,sort_options:z,loading:y,quiz_data:I,pageParams:s,getData:h,onPaginationChange:T,selectedTags:r,tag_search_data:b,getSessionSelectedTag:C,searchTagPageParams:n,getSearchTagData:v,addTag:B,removeTag:D,searchResultRef:P,lastSearchResult:x,handleMouseClickOutside:L,Input:ae};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),ie={class:"page-container"},re={class:"title-container"},ue={class:"content"},ce={class:"content-item"},de={class:"form-item"},_e={class:"d-flex justify-content-between"},ge={class:"form-item form-item-sort"},me={class:"form-item form-item-tag"},pe={class:"tag-container"},ve={class:"tag-item-qs-count"},he=["onClick"],ye={class:"search-bar",ref:"searchResultRef"},be={key:0,class:$(["search-result-container"])},fe={class:"search-result"},Se={class:"search-result-tag"},qe={class:"result-tag"},ze={class:"result-tag-qs-count"},Ie={class:"result-item-action"},Te={class:"content-item-title"},Ce={key:0,class:"quiz-item-container"},Ne={class:"quiz-item"},ke={class:"quiz-item-title"},we={class:"quiz-item-description"},xe={class:"quiz-item-info quiz-info-detail"},Be={class:"quiz-item-questions"},Pe={class:"quiz-item-created-by"},Le={class:"exam-item-actions"},Re={key:1,class:"w-100 d-flex align-items-center justify-content-center quiz-item-container"},Ae={class:"pagination-container"};function Ee(g,e,l,a,k,w){const z=p("RouterLink"),y=p("a-col"),I=p("a-row"),s=p("a-select-option"),h=p("a-select"),T=p("a-button"),r=p("a-skeleton"),b=p("a-empty"),C=p("a-pagination");return c(),_("div",ie,[t("div",re,[d(I,{class:"w-100 d-flex align-items-center"},{default:m(()=>[d(y,{span:1},{default:m(()=>[d(z,{to:{name:"User_Library"}},{default:m(()=>e[4]||(e[4]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[4]})]),_:1}),d(y,{class:"main-title",span:23},{default:m(()=>e[5]||(e[5]=[t("span",null," Library",-1),S(),t("br",null,null,-1)])),_:1,__:[5]})]),_:1})]),t("div",ue,[t("div",ce,[e[13]||(e[13]=t("div",{class:"content-item-title"},[t("div",null,[t("span",null,"Search Question Sets"),t("span",null," Discover question sets using keywords, tags, or titles from the great archive. ")])],-1)),t("div",de,[e[7]||(e[7]=t("label",null,"Key words",-1)),d(a.Input,{onInput:a.getData,modelValue:a.pageParams.name,"onUpdate:modelValue":e[0]||(e[0]=n=>a.pageParams.name=n),placeholder:a.t("class_index.other.search_class_placeholder")},{icon:m(()=>e[6]||(e[6]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])]),t("div",_e,[t("div",ge,[e[8]||(e[8]=t("label",null,"Sort by",-1)),d(h,{value:a.pageParams.sortBy,"onUpdate:value":e[1]||(e[1]=n=>a.pageParams.sortBy=n),style:{width:"200px"},onChange:a.getData},{default:m(()=>[(c(!0),_(q,null,N(a.sort_options,n=>(c(),W(s,{value:n.value},{default:m(()=>[S(u(n.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),t("div",me,[t("label",null,u(g.$t("create_QS.quiz.tag")),1),t("div",pe,[(c(!0),_(q,null,N(a.selectedTags,(n,v)=>(c(),_("div",{class:"result-tag",key:v},[S(u(n.name)+" ",1),t("span",ve,u(n.questionSetCount),1),t("i",{class:"bx bx-x",onClick:B=>a.removeTag(v)},null,8,he)]))),128))]),t("div",ye,[d(a.Input,{onInput:a.getSearchTagData,modelValue:a.searchTagPageParams.name,"onUpdate:modelValue":e[2]||(e[2]=n=>a.searchTagPageParams.name=n),placeholder:a.t("class_index.other.search_class_placeholder")},null,8,["modelValue","placeholder"]),a.tag_search_data.length>0?(c(),_("div",be,[t("div",fe,[(c(!0),_(q,null,N(a.tag_search_data,n=>(c(),_("div",Se,[t("div",qe,[S(u(n.name)+" ",1),t("div",ze,u(n.questionSetCount),1)]),t("div",Ie,[d(T,{type:"primary",class:"main-color-btn",size:"small",onClick:v=>a.addTag(n)},{default:m(()=>[...e[9]||(e[9]=[t("i",{class:"bx bx-plus"},null,-1)])]),_:2,__:[9]},1032,["onClick"])])]))),256))])])):Z("v-if",!0)],512)])]),t("div",Te,[t("div",null,[t("span",null,"Result("+u(a.quiz_data.length)+")",1)])]),a.loading?(c(),_(q,{key:0},[d(r,{loading:a.loading},null,8,["loading"]),d(r,{loading:a.loading},null,8,["loading"]),d(r,{loading:a.loading},null,8,["loading"])],64)):(c(),_(q,{key:1},[a.quiz_data.length>0?(c(),_("div",Ce,[(c(!0),_(q,null,N(a.quiz_data,n=>(c(),_("div",Ne,[e[11]||(e[11]=t("i",{class:"bx bx-book-open quiz-item-icon"},null,-1)),t("div",null,[t("div",ke,u(n.name),1),t("div",we," Rating: "+u(n.ratingAverage)+"⭐️ ("+u(n.ratingCount)+") ",1),t("div",xe,[t("div",Be,[e[10]||(e[10]=t("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),S(" "+u(n.totalQuestionCount)+" "+u(g.$t("dashboards.list_items.quiz.questions")),1)]),t("div",Pe,u(g.$t("class_question_set.other.created_by"))+" "+u(n.createBy),1)])]),t("div",Le,[d(T,{type:"primary",class:"me-3 main-color-btn"},{default:m(()=>[S(u(g.$t("class_question_set.buttons.view")),1)]),_:1})])]))),256))])):(c(),_("div",Re,[d(b,null,{description:m(()=>e[12]||(e[12]=[t("span",null," No data matches. ",-1)])),_:1})]))],64)),t("div",Ae,[d(C,{onChange:a.onPaginationChange,current:a.pageParams.pageNumber,"onUpdate:current":e[3]||(e[3]=n=>a.pageParams.pageNumber=n),total:a.pageParams.totalCount,pageSize:a.pageParams.pageSize,"show-total":(n,v)=>`${v[0]}-${v[1]} of ${n} ${a.t("class_question_set.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:a.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])])}const Ue=H(le,[["render",Ee],["__scopeId","data-v-27ebb566"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/question_sets/search.vue"]]);export{Ue as default};
