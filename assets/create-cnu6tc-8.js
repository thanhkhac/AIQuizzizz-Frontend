import{d as z,u as W,i as S,j as V,N as F,s as G,O as B,k as h,M as y,_ as N,r as w,a as A,o as x,b as t,c,w as m,f as I,t as d,F as L,B as U,C as j,D as J}from"./index-Dd8-myui.js";import{A as Y}from"./ApiTestTemplate-x2TAPrW4.js";import{I as K}from"./Input-BtmZP41X.js";import{T as X}from"./TextArea-DyOic0o8.js";import{S as Z,O as $,M as ee,a as te}from"./ShortText-B2lmwy7J.js";import{G as oe,I as re}from"./GenerateQSModal-BLpofKFx.js";import{Q as T}from"./questionTypes-CS3lcRlq.js";import"./vue-draggable-plus-CKvOH8GT.js";const ne=z({__name:"create",setup(a,{expose:s}){s();const{t:C}=W(),e=S(),n=V({name:"",description:"",questions:[]}),O={title:[{required:"true",message:"This field is required",trigger:"change"},{length:100,message:"Limit 100",trigger:"change"}],description:[{length:200,message:"Limit 200",trigger:"change"}],tags:[{validator:(o,l)=>l&&l.length>5?Promise.reject("You can only add up to 5 tags."):Promise.resolve(),trigger:"change"}],questions:[{validator:(o,l)=>l&&l.length>500?Promise.reject("You can only add up to 5 questions."):Promise.resolve(),trigger:"change"}]},p={MultipleChoice:te,Matching:ee,Ordering:$,ShortText:Z},g=[{id:"q1",type:"MultipleChoice",questionText:"What is the capital of France ?",questionHTML:"<p><strong>What</strong> is <br/> the <em>capital</em> of <u>France</u>? <code>// geography</code></p>",explainText:"Paris is the capital city of France.",score:20,multipleChoices:[{id:"1",text:"Paris",isAnswer:!0},{id:"2",text:"London",isAnswer:!1},{id:"3",text:"Berlin",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q2",type:"Matching",questionText:"Match the countries to their capitals.",questionHTML:"<p><u>Match</u> the <strong>countries</strong> to their <em>capitals</em>. <code>// matching task</code></p>",explainText:"Each country must be paired with its capital.",score:10,multipleChoices:[],matchingPairs:[{id:"1",leftItem:"Japan",rightItem:"Tokyo"},{id:"2",leftItem:"Italy",rightItem:"Rome"},{id:"3",leftItem:"Vietnam",rightItem:"Hanoi"}],orderingItems:[],shortAnswer:""},{id:"q3",type:"Ordering",questionText:"Arrange the steps of the water cycle in the correct order.",questionHTML:"<p><strong>Arrange</strong> the steps of the <u>water cycle</u> in the <em>correct order</em>. <code>// science</code></p>",explainText:"The correct order is: Evaporation → Condensation → Precipitation → Collection.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[{id:"1",text:"Evaporation",correctOrder:0},{id:"2",text:"Condensation",correctOrder:1},{id:"3",text:"Precipitation",correctOrder:2},{id:"4",text:"Collection",correctOrder:3}],shortAnswer:""},{id:"q4",type:"ShortText",questionText:"What is the chemical symbol for water?",questionHTML:"<p><em>What</em> is the chemical <strong>symbol</strong> for <u>water</u>? <code>H2O</code></p>",explainText:"H2O is the formula for water.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[],shortAnswer:"H2O"},{id:"q5",type:"MultipleChoice",questionText:"Which planet is known as the Red Planet?",questionHTML:"<p>Which <strong>planet</strong> is known as the <em>Red Planet</em>? <u>Mars</u> <pre><code>// astronomy</code></pre></p>",explainText:"Mars is often called the Red Planet due to its reddish appearance.",score:30,multipleChoices:[{id:"1",text:"Mars",isAnswer:!0},{id:"2",text:"Venus",isAnswer:!1},{id:"3",text:"Jupiter",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q6",type:"MultipleChoice",questionText:"Which language is primarily used for web development?",questionHTML:"<p>Which <strong>language</strong> is primarily used for <em>web development</em>? <code>// programming</code></p>",explainText:"JavaScript is the most commonly used language for web development.",score:20,multipleChoices:[{id:"1",text:"JavaScript",isAnswer:!0},{id:"2",text:"Python",isAnswer:!1},{id:"3",text:"C++",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q7",type:"Matching",questionText:"Match the authors to their famous works.",questionHTML:"<p>Match the <strong>authors</strong> to their <em>famous works</em>. <code>// literature</code></p>",explainText:"Each author is known for a specific famous book.",score:15,multipleChoices:[],matchingPairs:[{id:"1",leftItem:"George Orwell",rightItem:"1984"},{id:"2",leftItem:"J.K. Rowling",rightItem:"Harry Potter"},{id:"3",leftItem:"Leo Tolstoy",rightItem:"War and Peace"}],orderingItems:[],shortAnswer:""},{id:"q8",type:"Ordering",questionText:"Arrange the historical periods in chronological order.",questionHTML:"<p><strong>Arrange</strong> the <em>historical periods</em> in <u>chronological</u> order. <code>// history</code></p>",explainText:"The order is: Ancient → Medieval → Renaissance → Modern.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[{id:"1",text:"Ancient",correctOrder:0},{id:"2",text:"Medieval",correctOrder:1},{id:"3",text:"Renaissance",correctOrder:2},{id:"4",text:"Modern",correctOrder:3}],shortAnswer:""},{id:"q9",type:"ShortText",questionText:"What is the square root of 144?",questionHTML:"<p>What is the <strong>square root</strong> of <em>144</em>? <code>// math</code></p>",explainText:"The square root of 144 is 12.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[],shortAnswer:"12"},{id:"q10",type:"MultipleChoice",questionText:"Which gas do plants absorb from the atmosphere?",questionHTML:"<p>Which <strong>gas</strong> do <u>plants</u> absorb from the <em>atmosphere</em>? <code>// biology</code></p>",explainText:"Plants absorb carbon dioxide (CO₂) during photosynthesis.",score:20,multipleChoices:[{id:"1",text:"Oxygen",isAnswer:!1},{id:"2",text:"Carbon Dioxide",isAnswer:!0},{id:"3",text:"Nitrogen",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""}],q=()=>({id:Date.now().toString(),type:"MultipleChoice",questionText:"",questionHTML:"",explainText:"",score:10,multipleChoices:[{id:(Date.now()+1).toString(),text:"",isAnswer:!0},{id:(Date.now()+2).toString(),text:"",isAnswer:!1},{id:(Date.now()+3).toString(),text:"",isAnswer:!1},{id:(Date.now()+4).toString(),text:"",isAnswer:!1}],matchingPairs:[{id:(Date.now()+1).toString(),leftItem:"",rightItem:""},{id:(Date.now()+2).toString(),leftItem:"",rightItem:""}],orderingItems:[{id:(Date.now()+1).toString(),text:"",correctOrder:0},{id:(Date.now()+2).toString(),text:"",correctOrder:1},{id:(Date.now()+3).toString(),text:"",correctOrder:2},{id:(Date.now()+4).toString(),text:"",correctOrder:3}],shortAnswer:""}),v=()=>{if(n.questions.length>=10){h.warning("Each question set could have at most 100 questions");return}n.questions.push(q())},u=o=>{if(n.questions.length<=1){h.warning("Each question set must have at least 1 questions");return}n.questions.splice(o,1)},_=()=>{let o=!1,l="Invalid question.",f=new Set;if(n.name.trim().length>100||n.name.trim().length===0){o=!0,l="Invalid title.",h.error(l);return}if(n.description.trim().length>250){o=!0,l="Invalid description.",h.error(l);return}[n.questions.filter(r=>{const i=r.questionText.replace(/^<p>/,"").replace(/<\/p>$/,"").trim();return i.length===0||i.length>=500}),n.questions.filter(r=>r.explainText.replace(/^<p>/,"").replace(/<\/p>$/,"").trim().length>=500),n.questions.filter(r=>r.type===T.MULTIPLE_CHOICE&&(r.multipleChoices.some(i=>i.text.trim().length===0||i.text.trim().length>500)||r.multipleChoices.filter(i=>i.isAnswer).length===0)),n.questions.filter(r=>r.type===T.MATCHING&&(r.matchingPairs.some(i=>i.leftItem.trim().length===0||i.leftItem.trim().length>500)||r.matchingPairs.some(i=>i.rightItem.trim().length===0||i.rightItem.trim().length>500))),n.questions.filter(r=>r.type===T.ORDERING&&r.orderingItems.some(i=>i.text.trim().length===0||i.text.trim().length>500)),n.questions.filter(r=>r.type===T.SHORT_TEXT&&(r.shortAnswer.trim().length===0||r.shortAnswer.trim().length>500))].forEach(r=>{r.length>0&&(o=!0,r.forEach(i=>f.add(i)))});let E=Array.from(f).map(r=>n.questions.indexOf(r)+1);o?y.error({title:"Cannot create new question set!",content:"There are errors at questions: "+E.sort().join(", ")}):M()},M=()=>{y.confirm({title:"Create new quiz!",content:"Make sure to review your contents before proceeding.",centered:!0,onOk:async()=>{let o=await Y.Create(n);o.data.success&&h.success(o.data.data)}})},P=S(null),R=()=>{var o;(o=P.value)==null||o.openImportModal()},Q=S(null),D=()=>{var o;(o=Q.value)==null||o.openGenerateAIModal()},H=o=>{h.success(`Imported ${o.length} questions`),n.questions.push(...o)};F((o,l,f)=>{y.confirm({title:"Leave already?",content:"You have unsaved changes.",onOk:()=>{f()},onCancel:()=>f(!1)})});function b(o){o.preventDefault(),o.returnValue=""}G(()=>{n.questions.push(...g),window.addEventListener("beforeunload",b)}),B(()=>{window.removeEventListener("beforeunload",b)});const k={t:C,formRef:e,formState:n,rules:O,componentMap:p,question_data_raw:g,createQuestionTemplate:q,onAddQuestion:v,onRemoveQuestion:u,onFinish:_,showModalConfirmation:M,importModalRef:P,onOpenImportModal:R,generateModalRef:Q,openGenerateAIModal:D,onModalImport:H,handleBeforeUnload:b,Input:K,TextArea:X,ImportQSModal:re,GenerateQSModal:oe};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),ie={class:"page-container"},se={class:"title-container"},ae={class:"content"},le={class:"content-item"},ce={class:"content-item-title"},de={class:"d-flex"},ue={class:"content-item"},me={class:"content-item-title"},he={class:"content-item-buttons"},pe={class:"import-button"},ge={class:"list-question-container"};function fe(a,s,C,e,n,O){const p=w("RouterLink"),g=w("a-col"),q=w("a-row"),v=w("a-form");return x(),A(L,null,[t("div",ie,[t("div",se,[c(q,{class:"w-100 d-flex align-items-center"},{default:m(()=>[c(g,{span:1},{default:m(()=>[c(p,{to:{name:"User_TestTemplate"}},{default:m(()=>s[2]||(s[2]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[2]})]),_:1}),c(g,{class:"main-title",span:23},{default:m(()=>[t("span",null,d(a.$t("create_QS.title")),1),s[3]||(s[3]=I()),s[4]||(s[4]=t("br",null,null,-1)),t("span",null,d(a.$t("create_QS.sub_title")),1)]),_:1,__:[3,4]})]),_:1})]),t("div",ae,[c(v,{layout:"vertical",model:e.formState,rules:e.rules,ref:"formRef"},{default:m(()=>[t("div",le,[t("div",ce,[t("div",null,[t("span",null,d(a.$t("create_QS.quiz.question_detail_title")),1),t("span",null,d(a.$t("create_QS.quiz.question_detail_sub_title")),1)])]),c(e.Input,{class:"question-input-item",modelValue:e.formState.name,"onUpdate:modelValue":s[0]||(s[0]=u=>e.formState.name=u),isRequired:!0,placeholder:e.t("question_sets_index.search_placeholder"),label:e.t("create_QS.quiz.title"),"max-length":100},null,8,["modelValue","placeholder","label"]),t("div",de,[c(e.TextArea,{class:"question-input-item",modelValue:e.formState.description,"onUpdate:modelValue":s[1]||(s[1]=u=>e.formState.description=u),placeholder:"textarea with clear icon","max-length":250,label:e.t("create_QS.quiz.description")},null,8,["modelValue","label"])])]),t("div",ue,[t("div",me,[t("div",null,[t("span",null,d(a.$t("create_QS.quiz.question_question_title")),1),t("span",null,d(a.$t("create_QS.quiz.question_question_sub_title")),1)]),t("div",he,[c(p,{onClick:e.onOpenImportModal,class:"import-button",to:{name:""}},{default:m(()=>[I(d(a.$t("create_QS.buttons.import"))+" ",1),s[5]||(s[5]=t("i",{class:"bx bx-download"},null,-1))]),_:1,__:[5]}),c(p,{onClick:e.openGenerateAIModal,class:"import-button",to:{name:""}},{default:m(()=>[I(d(a.$t("create_QS.buttons.generated_by_ai"))+" ",1),s[6]||(s[6]=t("i",{class:"bx bx-upload"},null,-1))]),_:1,__:[6]}),t("div",{class:"import-button",onClick:e.onFinish},d(a.$t("create_QS.buttons.create")),1),t("div",pe,d(a.$t("create_QS.quiz.total",{number:e.formState.questions.length.toString().padStart(3,"0")})),1)])]),t("div",ge,[(x(!0),A(L,null,U(e.formState.questions,(u,_)=>(x(),A("div",{key:u.id},[(x(),j(J(e.componentMap[u.type]),{question:u,index:_+1,displayScore:!0,onDeleteQuestion:M=>e.onRemoveQuestion(_)},null,40,["question","index","onDeleteQuestion"]))]))),128)),t("div",{class:"add-question-btn",onClick:e.onAddQuestion},[s[7]||(s[7]=t("i",{class:"bx bx-plus"},null,-1)),I(" "+d(a.$t("create_QS.buttons.add_question")),1)])])])]),_:1},8,["model"])])]),c(e.ImportQSModal,{ref:"importModalRef",title:e.formState.name,onImport:e.onModalImport},null,8,["title"]),c(e.GenerateQSModal,{ref:"generateModalRef",title:e.formState.name,onImport:e.onModalImport},null,8,["title"])],64)}const Se=N(ne,[["render",fe],["__scopeId","data-v-6115bf3d"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/test_template/create.vue"]]);export{Se as default};
