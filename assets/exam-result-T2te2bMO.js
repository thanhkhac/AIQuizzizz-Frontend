import{d as O,q as V,l as Q,u as K,i as y,B as X,j as J,C as W,s as Z,G as $,T as ee,_ as te,r as _,a as v,o as b,b as t,c as l,w as i,f as k,t as s,F as A,D as ae,E as j,e as Y}from"./index-LsQ9jhpY.js";import{A as se}from"./ApiClass-BWhA5EE9.js";import{T as C,A as F}from"./ApiTest-CPAJutsx.js";import{T as ne,a as le}from"./testGradeQuestionMethod-B_BacNS6.js";import{I as oe}from"./Input-Dsf9BKpt.js";import{V as G}from"./Validator-CWeiTIFe.js";import{U as ie}from"./UserTestAttempts-JD3WZdBq.js";import"./lodash-CId-rXFu.js";const re=O({__name:"exam-result",emits:["updateSidebar"],setup(o,{expose:d,emit:z}){var U,L;d();const e=V(),p=Q(),{t:S}=K(),w=z,m=y(!1),c=y(e.params.classId||""),I=y({classId:"",name:"",topic:""}),g=y(e.params.testId||""),h=y({name:"",classId:e.params.classId.toString()||"",timeLimit:0,startTime:"",endTime:"",questionCount:0,gradeAttemptMethod:le.HIGHEST_SCORE,gradeQuestionMethod:ne.PARTIAL,isShowCorrectAnswerInReview:!0,isAllowReviewAfterSubmit:!0,numberOfShuffles:0,maxAttempt:0,passingScore:0,totalScore:0}),N=y([]),E=[{title:"No",key:"no",customRender:a=>a.index+1},{title:S("class_member.column.fullName"),dataIndex:"studentName",key:"studentName",sorter:(a,u)=>a.studentName.localeCompare(u.studentName)},{title:S("class_member.column.email"),dataIndex:"studentEmail",key:"email",sorter:(a,u)=>a.studentEmail.localeCompare(u.studentEmail)},{title:"Final score",dataIndex:"score",key:"score",sorter:(a,u)=>a.score-u.score},{title:"Result",dataIndex:"status",key:"status"}],T=Object.values(C),R=X(()=>T.map(a=>({label:S(`exam_result.test_status.${a}`),value:a!==C.ALL?a:""}))),n=J({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,studentName:((U=e.query.studentName)==null?void 0:U.toString())||"",isPassed:((L=e.query.isPassed)==null?void 0:L.toString())||null,totalCount:0,statusFilter:!1}),D=async()=>{try{if(!G.isValidGuid(c.value.toString())){p.push({name:"404"});return}c.value||p.push({name:"404"});let a=await se.GetById(c.value.toString());a.data.success||p.push({name:"404"}),I.value=a.data.data}catch(a){console.log("ERROR: GETBYID class: "+a)}},x=async()=>{try{if(!G.isValidGuid(g.value.toString())){p.push({name:"404"});return}g.value||p.push({name:"404"});let a=await F.GetById(g.value.toString(),!1);a.data.success||p.push({name:"404"}),h.value=a.data.data}catch(a){console.log("ERROR: GETBYID test: "+a)}},r=async()=>{try{m.value=!0;let a=await F.GetAllExamResultByLimit(g.value.toString(),n);if(a.data.success){let u=a.data.data;N.value=a.data.data.items,n.pageNumber=u.pageNumber,n.pageSize=u.pageSize,n.totalCount=u.totalCount,n.statusFilter&&(n.pageNumber>u.totalPages&&n.totalCount>0?(n.pageNumber=1,p.push({name:"User_Class_Exam_Result",params:{classId:c.value,testId:g.value},query:{pageNumber:1,pageSize:n.pageSize,studentName:n.studentName,isPassed:n.isPassed}})):p.push({name:"User_Class_Exam_Result",params:{classId:c.value,testId:g.value},query:{pageNumber:n.pageNumber,pageSize:n.pageSize,studentName:n.studentName,isPassed:n.isPassed}}),n.statusFilter=!n.statusFilter)}}catch(a){console.log("ERROR: GETALLEXAMBYLIMIT class exam result: "+a)}finally{m.value=!1}};W(()=>Object.keys(e.query).length,()=>{var a,u;n.pageNumber=e.query.pageNumber||1,n.pageSize=e.query.pageSize||11,n.studentName=((a=e.query.studentName)==null?void 0:a.toString())||"",n.isPassed=((u=e.query.isPassed)==null?void 0:u.toString())||null,n.statusFilter=!0,r()});const f=(a,u)=>{n.pageNumber=a,n.pageSize=u,n.statusFilter=!0,r()},P=y({studentId:"",studentName:"",studentEmail:"",score:0,status:""}),q=y(null),H=async a=>{var u;P.value=a,await $(),(u=q.value)==null||u.openModal()},B=a=>{switch(a){case C.PASSED:return"#22C55E";case C.FAILED:return"#cd201f"}};Z(async()=>{w("updateSidebar","class"),await D(),await x(),await r()});const M={route:e,router:p,t:S,emit:w,loading:m,classId:c,classData:I,testId:g,testData:h,testResultData:N,columns:E,optionKeys:T,test_status_options:R,pageParams:n,getClassData:D,getTestDetail:x,getData:r,onPaginationChange:f,chosenUser:P,userHistoryModalRef:q,openUserHistoryModal:H,getTagColor:B,Input:oe,get dayjs(){return ee},UserTestAttempts:ie};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),ue={class:"page-container"},de={class:"title-container"},me={class:"breadcrumb-container"},ce={class:"title-breadcrumb-item"},_e={class:"title-breadcrumb-item"},pe={class:"breadcrumb-item-topic"},ge={class:"content"},fe={class:"content-item"},be={class:"content-item-title"},ye={class:"test-info-container"},he={class:"d-flex justify-content-between"},ve={class:"d-flex justify-content-between"},Se={class:"d-flex justify-content-between"},we={class:"d-flex justify-content-between"},De={class:"content-item-functions"},xe={style:{width:"300px",padding:"0px"}},Ie=["onClick"],Ne={key:1,class:"w-110 d-flex justify-content-center"},Te={class:"pagination-container"};function Ae(o,d,z,e,p,S){var D,x;const w=_("RouterLink"),m=_("a-col"),c=_("a-row"),I=_("a-select-option"),g=_("a-select"),h=_("a-skeleton"),N=_("a-tag"),E=_("a-table"),T=_("a-config-provider"),R=_("a-empty"),n=_("a-pagination");return b(),v(A,null,[t("div",ue,[t("div",de,[t("div",me,[t("ul",null,[t("li",ce,[l(w,{to:{name:"User_Class"}},{default:i(()=>[t("span",null,s(o.$t("class_index.title")),1),d[3]||(d[3]=k()),d[4]||(d[4]=t("br",null,null,-1))]),_:1,__:[3,4]}),d[5]||(d[5]=t("i",{class:"bx bx-chevron-right"},null,-1))]),t("li",_e,[l(w,{to:{name:"User_Class_Exam",params:{id:e.classId}},class:"breadcrumb-item-class"},{default:i(()=>[t("span",null,s(e.classData.name),1),t("span",pe,s(e.classData.topic),1)]),_:1},8,["to"])])])])]),t("div",ge,[t("div",fe,[t("div",be,[t("div",null,[t("span",null,s(o.$t("exam_result.test_name",{name:e.testData.name})),1),t("span",null,s(o.$t("class_index.title"))+": "+s(e.classData.name),1)])]),t("div",ye,[l(c,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:i(()=>[l(m,{span:11,class:"test-info-item"},{default:i(()=>[t("div",he,[t("span",null,s(o.$t("exam_result.start_time")),1),t("span",null,s(e.dayjs(e.testData.startTime).format("DD/MM/YYYY HH:mm A")),1)]),t("div",ve,[t("span",null,s(o.$t("exam_result.end_time")),1),t("span",null,s(e.dayjs(e.testData.endTime).format("DD/MM/YYYY HH:mm A")),1)])]),_:1}),l(m,{span:11,class:"test-info-item"},{default:i(()=>[t("div",Se,[t("span",null,s(o.$t("exam_result.time_limit")),1),t("span",null,s(e.testData.timeLimit)+" "+s(e.testData.timeLimit>1?o.$t("practice_test.other.minute_plural"):o.$t("practice_test.other.minute")),1)]),t("div",we,[t("span",null,s(o.$t("exam_result.question_count")),1),t("span",null,s(e.testData.questionCount)+" "+s(e.testData.questionCount>1?o.$t("exam_result.other.question_plural"):o.$t("exam_result.other.question")),1)])]),_:1})]),_:1}),l(c,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:i(()=>[l(m,{span:11,class:"d-flex justify-content-between test-info-item"},{default:i(()=>[t("span",null,s(o.$t("exam_result.grade_attempt_method")),1),t("span",null,s(o.$t("testData.gradeAttemptMethod")),1)]),_:1}),l(m,{span:11,class:"d-flex justify-content-between test-info-item"},{default:i(()=>[t("span",null,s(o.$t("exam_result.max_attempt")),1),t("span",null,s(e.testData.maxAttempt)+" "+s(e.testData.questionCount>1?o.$t("exam_result.other.time_plural"):o.$t("exam_result.other.time")),1)]),_:1})]),_:1}),l(c,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:i(()=>[l(m,{span:11,class:"d-flex justify-content-between test-info-item"},{default:i(()=>[t("span",null,s(o.$t("exam_result.grade_question_method")),1),t("span",null,s(e.testData.gradeQuestionMethod),1)]),_:1}),l(m,{span:11,class:"d-flex justify-content-between test-info-item"},{default:i(()=>[t("span",null,s(o.$t("exam_result.passing_score")),1),t("span",null,s(e.testData.totalScore*(e.testData.passingScore/100))+" ("+s(e.testData.passingScore)+"%) ",1)]),_:1})]),_:1}),l(c,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:i(()=>[l(m,{span:11,class:"d-flex justify-content-between test-info-item"},{default:i(()=>[t("span",null,s(o.$t("exam_result.show_correct_answer")),1),t("span",null,s(e.testData.isShowCorrectAnswerInReview?"Yes":"No"),1)]),_:1}),l(m,{span:11,class:"d-flex justify-content-between test-info-item"},{default:i(()=>[t("span",null,s(o.$t("exam_result.allow_review")),1),t("span",null,s(e.testData.isAllowReviewAfterSubmit?"Yes":"No"),1)]),_:1})]),_:1})]),t("div",De,[l(g,{value:e.pageParams.isPassed,"onUpdate:value":d[0]||(d[0]=r=>e.pageParams.isPassed=r),style:{width:"230px","margin-right":"10px"},onChange:e.getData},{default:i(()=>[(b(!0),v(A,null,ae(e.test_status_options,r=>(b(),j(I,{value:r.value},{default:i(()=>[k(s(r.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",xe,[l(e.Input,{onInput:e.getData,modelValue:e.pageParams.studentName,"onUpdate:modelValue":d[1]||(d[1]=r=>e.pageParams.studentName=r),placeholder:e.t("class_member.other.search_placeholder")},{icon:i(()=>d[6]||(d[6]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(b(),v(A,{key:0},[l(h,{loading:e.loading},null,8,["loading"]),l(h,{loading:e.loading},null,8,["loading"]),l(h,{loading:e.loading},null,8,["loading"])],64)):(b(),v(A,{key:1},[e.testResultData.length>0?(b(),j(T,{key:0,locale:{Table:{cancelSort:"",triggerAsc:"",triggerDesc:""}}},{default:i(()=>[l(E,{columns:e.columns,"data-source":e.testResultData,"row-key":"studentId",pagination:!1},{bodyCell:i(({column:r,record:f})=>[r.key==="studentName"?(b(),v("div",{key:0,class:"student-name",onClick:P=>e.openUserHistoryModal(f)},s(f.studentName),9,Ie)):Y("v-if",!0),r.key==="status"?(b(),j(N,{key:1,color:e.getTagColor(f.status)},{default:i(()=>[k(s(f.status),1)]),_:2},1032,["color"])):Y("v-if",!0)]),_:1},8,["data-source"])]),_:1})):(b(),v("div",Ne,[l(R,null,{description:i(()=>[t("span",null,s(o.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),t("div",Te,[l(n,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":d[2]||(d[2]=r=>e.pageParams.pageNumber=r),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(r,f)=>`${f[0]}-${f[1]} of ${r} ${e.t("class_member.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])]),l(e.UserTestAttempts,{ref:"userHistoryModalRef","test-id":e.testId.toString(),"user-id":(D=e.chosenUser)==null?void 0:D.studentId,"test-name":e.testData.name,"passing-score":e.testData.passingScore,"student-name":(x=e.chosenUser)==null?void 0:x.studentEmail},null,8,["test-id","user-id","test-name","passing-score","student-name"])],64)}const Me=te(re,[["render",Ae],["__scopeId","data-v-09bf35d5"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/exam-result.vue"]]);export{Me as default};
