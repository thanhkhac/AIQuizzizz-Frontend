import{d as J,u as W,i as w,s as X,j as M,C as Z,B as $,k as h,M as N,_ as ee,r as m,a as C,o as b,b as a,e as F,c as s,t as o,w as i,f as U,F as x,D,E as V,p as G}from"./index-BTtyw8YW.js";import{A as I}from"./ApiAdmin-hwQLwxkU.js";import{I as ae}from"./Input-OaAZgVyh.js";const ne=J({__name:"manage_subscription",emits:["updateSidebar"],setup(z,{expose:t,emit:q}){t();const e=q,{t:O}=W(),T=w(!1),v=w(!1);X(()=>{e("updateSidebar","subscription"),k()});const c=w([]),g=w(),p=w(),d=M({name:"",price:0,duration:0,unit:"",canLearn:!1,canOpenTest:!1,canCopyOrImportQuestionSet:!1,isActive:!1}),r=M({planId:"",name:"",price:0,duration:0,unit:"",canLearn:!1,canOpenTest:!1,canCopyOrImportQuestionSet:!1,isActive:!0}),y=w(!1),P=w(!1),A=async()=>{y.value=!0;try{await g.value.validate();const l={...d};(await I.CreatePlan(l)).data.success&&(h.success("Create successfully."),T.value=!1),k()}catch(l){h.error("Create fail."),console.log("error",l.response.data)}finally{y.value=!1}},L=async()=>{P.value=!0;try{await p.value.validate();const l={...r};(await I.UpdatePlan(l)).data.success&&(v.value=!1,h.success("Update successfully.")),k()}catch(l){h.error("Update fail."),console.log("error",l.response.data)}finally{P.value=!1}},S={name:[{required:!0,message:"This field is required.",trigger:"change"}],price:[{required:!0,message:"This field is required.",trigger:"change"},{type:"number",min:1,message:"Price must be greater than 0",trigger:"change"}],duration:[{required:!0,message:"This field is required.",trigger:"change"},{type:"number",min:1,message:"Duration must be greater than 0",trigger:"change"}]},Q=()=>{d.name="",d.price=0,d.duration=0,d.unit=_.value[0].value,d.canLearn=!1,d.canOpenTest=!1,d.canCopyOrImportQuestionSet=!1};Z(T,l=>{l&&Q()});const n=["Day","Month","Year"],_=$(()=>n.map(l=>({label:O(`admin.manage_subscription.plan_unit.${l}`),value:l})));function K(l){return[l.canLearn&&O("admin.manage_subscription.plan_feature.canLearn"),l.canOpenTest&&O("admin.manage_subscription.plan_feature.canOpenTest"),l.canCopyOrImportQuestionSet&&O("admin.manage_subscription.plan_feature.canCopyOrImportQuestionSet")].filter(Boolean)}const B=async l=>{try{let u=await I.GetPlan(l);const f=u.data.data;console.log(f),u.data.success&&Object.assign(r,{planId:f.id,name:f.name,price:f.price,duration:f.duration,unit:f.unit,canLearn:f.canLearn,canOpenTest:f.canOpenTest,canCopyOrImportQuestionSet:f.canCopyOrImportQuestionSet,isActive:f.isActive})}catch(u){console.log(u)}},k=async()=>{try{let l=await I.GetAllPlan();c.value=l.data.data}catch(l){console.log(l)}},R=async l=>{try{Object.assign(r,{planId:l.id,name:l.name,price:l.price,duration:l.duration,unit:l.unit,canLearn:l.canLearn,canOpenTest:l.canOpenTest,canCopyOrImportQuestionSet:l.canCopyOrImportQuestionSet,isActive:l.isActive}),(await I.UpdatePlan({...r})).data.success&&(v.value=!1,h.success("Update plan activity status successfully")),k()}catch(u){h.error("Active fail."),console.log("error",u.response.data)}finally{P.value=!1}};async function Y(l){N.confirm({title:"Confirm Active Subscription",content:"Are you sure you want to update this subscription activation status?",centered:!0,onOk:async()=>{await R(l)},onCancel:()=>{k()}})}function H(l){v.value=!0,B(l.id)}const j=async l=>{try{let u=await I.DeletePlan(l);h.success("Delete successfully."),k()}catch(u){h.error("Delete fail."),console.log(u)}},E={emit:e,t:O,modal_create_subscription_open:T,modal_update_subscription_open:v,plans:c,createPlanFormRef:g,updatePlanFormRef:p,createPlanForm:d,updatePlanForm:r,isCreateLoading:y,isUpdateLoading:P,onCreatePlan:A,onUpdatePlan:L,rules:S,resetCreatePlanForm:Q,optionKeysUnitPlan:n,unit_plan_credit_options:_,mapPlanToFeatures:K,getPlanData:B,getAllPlanData:k,updateActivePlan:R,onTogglePlan:Y,onEditPlan:H,deletePlan:j,onDeletePlan:l=>{N.confirm({title:"Confirm Delete Subscription",content:"Are you sure you want to delete this subscription?",centered:!0,onOk:()=>{j(l.id)},onCancel:()=>{}})},Input:ae};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}}),te={class:"page-container"},se={class:"title-container"},le={class:"main-title"},ie={class:"title-button-container"},oe={class:"content"},re={class:"stat-content"},ce={class:"stat-card"},de={class:"stat-title"},ue={class:"stat-card"},me={class:"stat-title"},pe={class:"stat-card"},_e={class:"stat-title"},fe={class:"stat-card"},be={class:"stat-title"},ve={class:"plan-comparison"},ge={class:"content-item"},ye={class:"title-container"},he={class:"plan-comparison-row"},Pe=["onClick"],ke=["onClick"],we={class:"mb-2"},Ce={class:"display-6 fw-bold mb-3"},Fe={class:"fs-6 fw-normal"},Oe={class:"mb-0"},Ue={class:"modal-container"},Ie={class:"modal-title-container"},xe={class:"content"},Te={class:"modal-content-subs-item"},Ae={class:"feature-switch-row"},Le={class:"feature-switch-item"},Se={class:"feature-switch-item"},Qe={class:"feature-switch-item"},De={class:"modal-container"},ze={class:"modal-title-container"},qe={class:"content"},Be={class:"modal-content-subs-item"},Re={class:"feature-switch-row"},je={class:"feature-switch-item"},Ee={class:"feature-switch-item"},Me={class:"feature-switch-item"};function Ne(z,t,q,e,O,T){const v=m("a-button"),c=m("a-col"),g=m("a-row"),p=m("a-switch"),d=m("RouterLink"),r=m("a-form-item"),y=m("a-input-number"),P=m("a-select-option"),A=m("a-select"),L=m("a-form"),S=m("a-modal"),Q=m("a-input");return b(),C(x,null,[a("div",te,[F(" header title "),a("div",se,[a("div",le,[a("span",null,o(e.t("admin.manage_subscription.title")),1)]),a("div",ie,[s(v,{type:"primary",class:"main-color-btn",style:{gap:"5px"},size:"large",onClick:t[0]||(t[0]=n=>e.modal_create_subscription_open=!0)},{default:i(()=>[t[19]||(t[19]=a("i",{class:"bx bx-plus"},null,-1)),U(" "+o(z.$t("admin.manage_subscription.create_new_sub")),1)]),_:1,__:[19]})])]),a("div",oe,[F(" statistic "),a("div",re,[a("div",ce,[a("div",de,[a("span",null,o(e.t("admin.manage_subscription.stat_card.total_subs")),1),t[20]||(t[20]=a("span",null," 123",-1))])]),a("div",ue,[a("div",me,[a("span",null,o(e.t("admin.manage_subscription.stat_card.monthly_rev")),1),t[21]||(t[21]=a("span",null," 123$",-1))])]),a("div",pe,[a("div",_e,[a("span",null,o(e.t("admin.manage_subscription.stat_card.new_subs")),1),t[22]||(t[22]=a("span",null," 123",-1))])]),a("div",fe,[a("div",be,[a("span",null,o(e.t("admin.manage_subscription.stat_card.unsubs")),1),t[23]||(t[23]=a("span",null," 123",-1))])])]),F(" plan comparison "),a("div",ve,[a("div",ge,[F(" title plan comparison "),a("div",ye,[s(g,{class:"w-100 d-block"},{default:i(()=>[s(c,{class:"main-title",span:20},{default:i(()=>[a("span",null,o(e.t("admin.manage_subscription.plan_comparison")),1)]),_:1}),a("span",null,o(e.t("admin.manage_subscription.plan_comparison_content")),1)]),_:1})]),F(" list plan "),a("div",he,[(b(!0),C(x,null,D(e.plans,n=>(b(),C("div",{key:n.id,class:"plan-compa-content-item"},[a("div",{class:G([{invisible:n.price===0},"plan-comparison-card-action"])},[a("i",{class:"bx bx-edit",style:{"font-size":"20px"},onClick:_=>e.onEditPlan(n)},null,8,Pe),a("i",{class:"bx bx-trash",style:{color:"#ff002e","font-size":"20px"},onClick:_=>e.onDeletePlan(n)},null,8,ke)],2),a("h5",we,o(n.name),1),a("div",Ce,[U(o(n.price),1),t[24]||(t[24]=a("span",{class:"vnd-icon"},"â‚«",-1)),a("span",Fe," / "+o(n.duration)+" "+o(n.unit),1)]),a("ul",Oe,[(b(!0),C(x,null,D(e.mapPlanToFeatures(n),_=>(b(),C("li",{key:_},o(_),1))),128))]),a("div",{class:G([{invisible:n.price===0},"d-flex justify-content-end mt-auto pt-1"])},[s(p,{checked:n.isActive,"onUpdate:checked":_=>n.isActive=_,"checked-children":"","un-checked-children":"",onChange:_=>e.onTogglePlan(n)},null,8,["checked","onUpdate:checked","onChange"])],2)]))),128))])])])])]),F(" popup create subscription "),s(S,{centered:"",width:"50%","wrap-class-name":"large-modal",closable:!1,open:e.modal_create_subscription_open,onCancel:t[9]||(t[9]=n=>e.modal_create_subscription_open=!1)},{footer:i(()=>[s(v,{loading:e.isCreateLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onCreatePlan},{default:i(()=>[U(o(e.t("admin.manage_subscription.btn.create")),1)]),_:1},8,["loading"])]),default:i(()=>[a("div",Ue,[a("div",Ie,[s(g,{class:"w-100 d-flex align-items-center"},{default:i(()=>[s(c,{span:4},{default:i(()=>[s(d,{onClick:t[1]||(t[1]=n=>e.modal_create_subscription_open=!1),to:{name:""}},{default:i(()=>t[25]||(t[25]=[a("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[25]})]),_:1}),s(c,{class:"main-title",span:20},{default:i(()=>[a("span",null,o(e.t("admin.manage_subscription.modal.title_create")),1)]),_:1})]),_:1})]),a("div",xe,[a("div",Te,[s(L,{layout:"vertical",ref:"createPlanFormRef",model:e.createPlanForm,rules:e.rules},{default:i(()=>[s(r,{label:e.t("admin.manage_subscription.create_plan.name"),name:"name"},{default:i(()=>[s(e.Input,{value:e.createPlanForm.name,"onUpdate:value":t[2]||(t[2]=n=>e.createPlanForm.name=n),placeholder:e.t("admin.manage_subscription.create_plan.name"),style:{width:"100%"},"is-required":!0},null,8,["value","placeholder"])]),_:1},8,["label"]),s(g,{class:"row-3-input"},{default:i(()=>[s(c,{span:8},{default:i(()=>[s(r,{label:e.t("admin.manage_subscription.create_plan.price"),name:"price",class:"form-item-third"},{default:i(()=>[s(y,{value:e.createPlanForm.price,"onUpdate:value":t[3]||(t[3]=n=>e.createPlanForm.price=n),min:0,placeholder:e.t("admin.manage_subscription.create_plan.price"),style:{width:"100%"},"is-required":!0,class:"my-price-input"},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:8},{default:i(()=>[s(r,{label:e.t("admin.manage_subscription.create_plan.duration"),class:"form-item-third",name:"duration"},{default:i(()=>[s(y,{value:e.createPlanForm.duration,"onUpdate:value":t[4]||(t[4]=n=>e.createPlanForm.duration=n),min:0,placeholder:e.t("admin.manage_subscription.create_plan.duration"),style:{width:"100%"},"is-required":!0,class:"my-price-input"},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:6},{default:i(()=>[s(r,{label:e.t("admin.manage_subscription.create_plan.unit"),class:"form-item-third"},{default:i(()=>[s(A,{value:e.createPlanForm.unit,"onUpdate:value":t[5]||(t[5]=n=>e.createPlanForm.unit=n)},{default:i(()=>[(b(!0),C(x,null,D(e.unit_plan_credit_options,n=>(b(),V(P,{key:n.value,value:n.value},{default:i(()=>[U(o(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1})]),_:1}),s(r,{label:e.t("admin.manage_subscription.create_plan.feature"),style:{"margin-top":"28px"}},{default:i(()=>[a("div",Ae,[a("div",Le,[a("span",null,o(e.t("admin.manage_subscription.plan_feature.canLearn")),1),s(p,{checked:e.createPlanForm.canLearn,"onUpdate:checked":t[6]||(t[6]=n=>e.createPlanForm.canLearn=n)},null,8,["checked"])]),a("div",Se,[a("span",null,o(e.t("admin.manage_subscription.plan_feature.canOpenTest")),1),s(p,{checked:e.createPlanForm.canOpenTest,"onUpdate:checked":t[7]||(t[7]=n=>e.createPlanForm.canOpenTest=n)},null,8,["checked"])]),a("div",Qe,[a("span",null,o(e.t("admin.manage_subscription.plan_feature.canCopyOrImportQuestionSet")),1),s(p,{checked:e.createPlanForm.canCopyOrImportQuestionSet,"onUpdate:checked":t[8]||(t[8]=n=>e.createPlanForm.canCopyOrImportQuestionSet=n)},null,8,["checked"])])])]),_:1},8,["label"])]),_:1},8,["model"])])])])]),_:1},8,["open"]),F(" popup update subscription "),s(S,{centered:"",width:"50%","wrap-class-name":"large-modal",closable:!1,open:e.modal_update_subscription_open,onCancel:t[18]||(t[18]=n=>e.modal_update_subscription_open=!1)},{footer:i(()=>[s(v,{loading:e.isUpdateLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onUpdatePlan},{default:i(()=>[U(o(e.t("admin.manage_subscription.btn.save")),1)]),_:1},8,["loading"])]),default:i(()=>[a("div",De,[a("div",ze,[s(g,{class:"w-100 d-flex align-items-center"},{default:i(()=>[s(c,{span:4},{default:i(()=>[s(d,{onClick:t[10]||(t[10]=n=>e.modal_create_subscription_open=!1),to:{name:""}},{default:i(()=>t[26]||(t[26]=[a("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[26]})]),_:1}),s(c,{class:"main-title",span:20},{default:i(()=>[a("span",null,o(e.t("admin.manage_subscription.modal.title_update")),1)]),_:1})]),_:1})]),a("div",qe,[a("div",Be,[s(L,{layout:"vertical",ref:"updatePlanFormRef",model:e.updatePlanForm,rules:e.rules},{default:i(()=>[s(r,{label:e.t("admin.manage_subscription.create_plan.name"),name:"name"},{default:i(()=>[s(Q,{value:e.updatePlanForm.name,"onUpdate:value":t[11]||(t[11]=n=>e.updatePlanForm.name=n),class:"update_input_name"},null,8,["value"])]),_:1},8,["label"]),s(g,{class:"row-3-input"},{default:i(()=>[s(c,{span:7},{default:i(()=>[s(r,{label:e.t("admin.manage_subscription.create_plan.price"),name:"price",class:"form-item-third"},{default:i(()=>[s(y,{value:e.updatePlanForm.price,"onUpdate:value":t[12]||(t[12]=n=>e.updatePlanForm.price=n),min:0,placeholder:e.t("admin.manage_subscription.create_plan.price"),style:{width:"100%"},"is-required":!0,class:"my-price-input"},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:7},{default:i(()=>[s(r,{label:e.t("admin.manage_subscription.create_plan.duration"),class:"form-item-third",name:"duration"},{default:i(()=>[s(y,{value:e.updatePlanForm.duration,"onUpdate:value":t[13]||(t[13]=n=>e.updatePlanForm.duration=n),min:0,placeholder:e.t("admin.manage_subscription.create_plan.duration"),style:{width:"100%"},"is-required":!0,class:"my-price-input"},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:7},{default:i(()=>[s(r,{label:e.t("admin.manage_subscription.create_plan.unit"),class:"form-item-third"},{default:i(()=>[s(A,{value:e.updatePlanForm.unit,"onUpdate:value":t[14]||(t[14]=n=>e.updatePlanForm.unit=n)},{default:i(()=>[(b(!0),C(x,null,D(e.unit_plan_credit_options,n=>(b(),V(P,{key:n.value,value:n.value},{default:i(()=>[U(o(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1})]),_:1}),s(r,{label:e.t("admin.manage_subscription.create_plan.feature"),style:{"margin-top":"28px"}},{default:i(()=>[a("div",Re,[a("div",je,[a("span",null,o(e.t("admin.manage_subscription.plan_feature.canLearn")),1),s(p,{checked:e.updatePlanForm.canLearn,"onUpdate:checked":t[15]||(t[15]=n=>e.updatePlanForm.canLearn=n)},null,8,["checked"])]),a("div",Ee,[a("span",null,o(e.t("admin.manage_subscription.plan_feature.canOpenTest")),1),s(p,{checked:e.updatePlanForm.canOpenTest,"onUpdate:checked":t[16]||(t[16]=n=>e.updatePlanForm.canOpenTest=n)},null,8,["checked"])]),a("div",Me,[a("span",null,o(e.t("admin.manage_subscription.plan_feature.canCopyOrImportQuestionSet")),1),s(p,{checked:e.updatePlanForm.canCopyOrImportQuestionSet,"onUpdate:checked":t[17]||(t[17]=n=>e.updatePlanForm.canCopyOrImportQuestionSet=n)},null,8,["checked"])])])]),_:1},8,["label"])]),_:1},8,["model"])])])])]),_:1},8,["open"])],64)}const He=ee(ne,[["render",Ne],["__scopeId","data-v-77f2d5e4"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/admin/account/manage_subscription.vue"]]);export{He as default};
