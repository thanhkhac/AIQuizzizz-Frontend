import{c as m,I as G,d as H,q as Y,l as Q,u as X,i as z,B as J,j as W,O as Z,s as K,M as ee,k as te,Q as ae,_ as se,r as h,a as C,o as g,b as a,w as c,f as u,t as l,F as A,D as M,E as D,e as P}from"./index-DhrrK0Mu.js";import{A as U}from"./ApiClass-pTCUFE45.js";import{A as ne}from"./ApiTest-DdRL4lfq.js";import{C as oe}from"./classStudentPosition-B7ChrNvq.js";import{I as ie}from"./Input-BvI-y3AG.js";var le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm376 116c-119.3 0-216 96.7-216 216s96.7 216 216 216 216-96.7 216-216-96.7-216-216-216zm107.5 323.5C750.8 868.2 712.6 884 672 884s-78.8-15.8-107.5-44.5C535.8 810.8 520 772.6 520 732s15.8-78.8 44.5-107.5C593.2 595.8 631.4 580 672 580s78.8 15.8 107.5 44.5C808.2 653.2 824 691.4 824 732s-15.8 78.8-44.5 107.5zM761 656h-44.3c-2.6 0-5 1.2-6.5 3.3l-63.5 87.8-23.1-31.9a7.92 7.92 0 00-6.5-3.3H573c-6.5 0-10.3 7.4-6.5 12.7l73.8 102.1c3.2 4.4 9.7 4.4 12.9 0l114.2-158c3.9-5.3.1-12.7-6.4-12.7zM440 852H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"file-done",theme:"outlined"};function L(o){for(var s=1;s<arguments.length;s++){var _=arguments[s]!=null?Object(arguments[s]):{},e=Object.keys(_);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(_).filter(function(d){return Object.getOwnPropertyDescriptor(_,d).enumerable}))),e.forEach(function(d){re(o,d,_[d])})}return o}function re(o,s,_){return s in o?Object.defineProperty(o,s,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[s]=_,o}var E=function(s,_){var e=L({},s,_.attrs);return m(G,L({},e,{icon:le}),null)};E.displayName="FileDoneOutlined";E.inheritAttrs=!1;const S={ALL:"All",UPCOMING:"Upcoming",ACTIVE:"Active",COMPLETED:"Completed"},ce=H({__name:"exam",emits:["updateSidebar"],setup(o,{expose:s,emit:_}){var k;s();const e=Y(),d=Q(),{t:v}=X(),b=_,p=z(e.params.id||""),y=z({classId:"",name:"",topic:""}),N=Object.values(S),x=J(()=>N.map(t=>({label:v(`class_exam.select_option.${t}`),value:t!==S.ALL?t:""}))),n=W({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,testName:((k=e.query.testName)==null?void 0:k.toString())||"",status:e.query.status||x.value[0].value,totalCount:0,statusFilter:!1}),I=z([]),O=z(""),i=async()=>{try{const t=await U.GetUserPermission(y.value.classId);t.data.success&&(O.value=t.data.data)}catch(t){console.log(t)}},f=async()=>{try{p.value||d.push({name:"404"});let t=await U.GetById(p.value.toString());t.data.success||d.push({name:"404"}),y.value=t.data.data}catch(t){console.log("ERROR: GETBYID class: "+t)}},T=async()=>{try{let t=await U.GetAllExamByLimit(p.value.toString(),n);if(t.data.success){let r=t.data.data;I.value=r.items,n.pageNumber=r.pageNumber,n.pageSize=r.pageSize,n.totalCount=r.totalCount,n.statusFilter&&(n.pageNumber>r.totalPages&&n.totalCount>0?(n.pageNumber=1,d.push({name:"User_Class_Exam",params:{id:p.value},query:{pageNumber:1,pageSize:n.pageSize,testName:n.testName,status:n.status}})):d.push({name:"User_Class_Exam",params:{id:p.value},query:{pageNumber:n.pageNumber,pageSize:n.pageSize,testName:n.testName,status:n.status}}),n.statusFilter=!n.statusFilter)}}catch(t){console.log("ERROR: GETALLEXAMBYLIMIT class exam: "+t)}};Z(()=>{var t;Object.keys(e.query).length===0&&(n.pageNumber=e.query.pageNumber||1,n.pageSize=e.query.pageSize||10,n.testName=((t=e.query.testName)==null?void 0:t.toString())||"",n.status=e.query.status||x.value[0].value,n.statusFilter=!0,T())});const q=(t,r)=>{n.pageNumber=t,n.pageSize=r,n.statusFilter=!0,T()},R=t=>{if(t<24)return`${t} hour${t!==1?"s":""} ago`;if(t<24*7){const r=Math.floor(t/24);return`${r} day${r!==1?"s":""} ago`}else if(t<24*30){const r=Math.floor(t/168);return`${r} week${r!==1?"s":""} ago`}else if(t<24*365){const r=Math.floor(t/720);return`${r} month${r!==1?"s":""} ago`}else{const r=Math.floor(t/8760);return`${r} year${r!==1?"s":""} ago`}},F=t=>{switch(t){case S.COMPLETED:return"#3b82f6";case S.ACTIVE:return"#22C55E";case S.UPCOMING:return"#f59e0b"}},j=()=>{d.push({name:"User_Test_Create",params:{id:p.value}})},V=t=>{d.push({name:"User_Test_Update",params:{id:t}})},B=t=>{ee.confirm({title:v("class_exam.modal.delete_title"),content:v("class_exam.modal.delete_content"),okText:v("sidebar.buttons.ok"),cancelText:v("sidebar.buttons.cancel"),onOk:async()=>{(await ne.Delete(t)).data.success&&(te.success(v("message.deleted_successfully")),T())}})},$=t=>{d.push({name:"User_Test_Attempt",params:{id:t}})};K(async()=>{b("updateSidebar","class"),await f(),await i(),await T()});const w={route:e,router:d,t:v,emit:b,classId:p,classData:y,optionKeys:N,exam_status_options:x,pageParams:n,exam_data:I,userRoleInClass:O,getPermission:i,getClassData:f,getData:T,onPaginationChange:q,getFormattedRelativeTime:R,getTagColor:F,onRedirectToCreate:j,onRedirectToUpdate:V,onDeleteTest:B,onRedirectToAttempt:$,get CLASS_STUDENT_POSITION(){return oe},get CLASS_EXAM_STATUS(){return S},get dayjs(){return ae},Input:ie,get FileDoneOutlined(){return E}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),ue={class:"page-container"},me={class:"title-container"},de={class:"breadcrumb-container"},_e={class:"title-breadcrumb-item"},pe={class:"title-breadcrumb-item"},ge={class:"breadcrumb-item-topic"},ve={class:"content"},be={class:"content-item"},fe={class:"content-item-title"},he={class:"content-item-functions"},Ce={class:"content-item-navigators"},Se={class:"navigator-container"},ye={style:{width:"300px",padding:"0px"}},xe={key:0,class:"exam-item-container"},Te={class:"exam-item"},Ne={class:"exam-item-title"},Ie={class:"exam-item-info exam-item-date"},Oe={class:"exam-item-info exam-info-detail"},ze={class:"exam-item-questions"},Ae={class:"exam-item-time"},De={class:"exam-item-assigned completion"},Pe={class:"exam-item-assigned"},Ue={class:"exam-item-actions"},Ee=["onClick"],we=["onClick"],ke={key:1,class:"w-100 d-flex justify-content-center"},Me={class:"pagination-container"};function Le(o,s,_,e,d,v){const b=h("RouterLink"),p=h("a-button"),y=h("a-select-option"),N=h("a-select"),x=h("a-tag"),n=h("a-tooltip"),I=h("a-empty"),O=h("a-pagination");return g(),C("div",ue,[a("div",me,[a("div",de,[a("ul",null,[a("li",_e,[m(b,{to:{name:"User_Class"}},{default:c(()=>[a("span",null,l(o.$t("class_index.title")),1),s[3]||(s[3]=u()),s[4]||(s[4]=a("br",null,null,-1))]),_:1,__:[3,4]}),s[5]||(s[5]=a("i",{class:"bx bx-chevron-right"},null,-1))]),a("li",pe,[m(b,{to:{name:""},class:"breadcrumb-item-class"},{default:c(()=>[a("span",null,l(e.classData.name),1),a("span",ge,l(e.classData.topic),1)]),_:1})])])])]),a("div",ve,[a("div",be,[a("div",fe,[a("div",null,[a("span",null,l(o.$t("class_index.title")),1),a("span",null,l(o.$t("class_exam.sub_title")),1)]),m(p,{type:"primary",class:"main-color-btn",onClick:e.onRedirectToCreate},{default:c(()=>[s[6]||(s[6]=a("i",{class:"me-2 bx bx-list-plus"},null,-1)),u(" "+l(o.$t("class_exam.buttons.assign_test")),1)]),_:1,__:[6]})]),a("div",he,[a("div",Ce,[a("div",Se,[m(b,{class:"navigator-item navigator-active",to:{name:""}},{default:c(()=>[u(l(o.$t("class_index.navigators.exam")),1)]),_:1}),m(b,{class:"navigator-item",to:{name:"User_Class_Quiz"}},{default:c(()=>[u(l(o.$t("class_index.navigators.quiz")),1)]),_:1}),m(b,{class:"navigator-item",to:{name:"User_Class_Student"}},{default:c(()=>[u(l(o.$t("class_index.navigators.member")),1)]),_:1})])]),m(N,{value:e.pageParams.status,"onUpdate:value":s[0]||(s[0]=i=>e.pageParams.status=i),style:{width:"200px"},onChange:e.getData},{default:c(()=>[(g(!0),C(A,null,M(e.exam_status_options,i=>(g(),D(y,{value:i.value},{default:c(()=>[u(l(i.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),a("div",ye,[m(e.Input,{onInput:e.getData,modelValue:e.pageParams.testName,"onUpdate:modelValue":s[1]||(s[1]=i=>e.pageParams.testName=i),placeholder:e.t("class_exam.other.search_placeholder")},{icon:c(()=>s[7]||(s[7]=[a("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.exam_data.length>0?(g(),C("div",xe,[(g(!0),C(A,null,M(e.exam_data,i=>(g(),C("div",Te,[s[11]||(s[11]=a("i",{class:"bx bx-book-open exam-item-icon"},null,-1)),a("div",null,[a("div",Ne,[u(l(i.name)+" ",1),m(x,{color:e.getTagColor(i.status)},{default:c(()=>[u(l(o.$t(`class_exam.select_option.${i.status}`)),1)]),_:2},1032,["color"])]),a("div",Ie,[a("div",null,[s[8]||(s[8]=a("i",{class:"bx bx-calendar"},null,-1)),u(" "+l(e.dayjs(i.timeStart).format("DD/MM/YYYY HH:mm A")),1)])]),a("div",Oe,[a("div",ze,[s[9]||(s[9]=a("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),u(" "+l(i.numberOfQuestions)+" "+l(o.$t("dashboards.list_items.quiz.questions")),1)]),a("div",Ae,[s[10]||(s[10]=a("i",{class:"bx bx-time-five"},null,-1)),u(" "+l(i.timeLimit)+" "+l(o.$t("class_exam.other.min")),1)]),a("span",De,l(i.numberOfCompletion)+" "+l(o.$t("class_exam.other.completions")),1),a("span",Pe,l(o.$t("class_exam.other.assigned"))+" "+l(e.getFormattedRelativeTime(i.relativeTime)),1)])]),a("div",Ue,[i.status===e.CLASS_EXAM_STATUS.ACTIVE?(g(),D(p,{key:0,type:"primary",class:"main-color-btn",onClick:f=>e.onRedirectToAttempt(i.testId)},{default:c(()=>[u(l(o.$t("class_exam.buttons.attempt")),1)]),_:2},1032,["onClick"])):P("v-if",!0),e.userRoleInClass!==e.CLASS_STUDENT_POSITION.STUDENT?(g(),C(A,{key:1},[i.status===e.CLASS_EXAM_STATUS.UPCOMING?(g(),D(n,{key:0},{title:c(()=>[u(l(o.$t("question_sets_index.buttons.edit")),1)]),default:c(()=>[a("i",{class:"bx bx-edit",onClick:f=>e.onRedirectToUpdate(i.testId)},null,8,Ee)]),_:2},1024)):P("v-if",!0),m(n,null,{title:c(()=>[u(l(o.$t("class_member.buttons.history_test")),1)]),default:c(()=>[a("i",null,[m(e.FileDoneOutlined)])]),_:1}),m(n,null,{title:c(()=>[u(l(o.$t("question_sets_index.buttons.delete")),1)]),default:c(()=>[a("i",{class:"text-danger bx bx-trash-alt",onClick:f=>e.onDeleteTest(i.testId)},null,8,we)]),_:2},1024)],64)):P("v-if",!0)])]))),256))])):(g(),C("div",ke,[m(I,null,{description:c(()=>[a("span",null,l(o.$t("class_index.other.no_data_matches")),1)]),_:1})])),a("div",Me,[m(O,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":s[2]||(s[2]=i=>e.pageParams.pageNumber=i),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(i,f)=>`${f[0]}-${f[1]} of ${i} ${e.t("class_exam.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])])}const Be=se(ce,[["render",Le],["__scopeId","data-v-1afc52c6"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/exam.vue"]]);export{Be as default};
