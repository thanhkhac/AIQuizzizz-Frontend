import{d as W,u as Z,q as ee,l as te,i as _,B as se,s as ne,P as ae,M as oe,k as D,Q as ie,_ as le,r as g,a as o,o as a,b as t,c as r,w as u,f as m,t as i,e as T,F as y,D as w,E as re}from"./index-DhrrK0Mu.js";import{u as de}from"./user-zaK1_Zi8.js";import{A as V}from"./ApiQuestionSet-CCKPOHyK.js";import{Q as E}from"./questionTypes-CS3lcRlq.js";import{I as ce}from"./Input-BvI-y3AG.js";import{T as ue}from"./TransferQuestionData-BxcXdBjq.js";import{V as _e}from"./Validator-CWeiTIFe.js";import{S as me}from"./ShareModal-BnjR5EyV.js";import{V as ve}from"./visibility-PZlBDoOn.js";import"./ApiTestTemplate-C2cUjulG.js";import"./ApiFolder-BuFDDSFg.js";const fe=W({__name:"detail",setup(v,{expose:s}){s();const{t:p}=Z(),e=ee(),f=te(),Q=_(!1),x=_(e.params.id),c=_({id:"",name:"",description:"",totalQuestionCount:0,completedQuestionCount:0,ratingCount:0,ratingAverage:0,createBy:"",createdAt:"",createdById:"",tags:[],lastAccessByMe:"",visibilityMode:""}),b=_([]),S=_([]),M=["All",E.MULTIPLE_CHOICE,E.MATCHING,E.ORDERING,E.SHORT_TEXT],R=se(()=>M.map(l=>({label:p(`create_QS.type.${l}`),value:l}))),k=_(R.value[0].value),L=_(""),O=async()=>{var l,h;try{Q.value=!0,_e.isValidGuid(x.value.toString())||f.push({name:"404"});const I=await V.GetDetailById(x.value.toString()),q=await V.GetQuestionById(x.value.toString());(!I.data.success||!q.data.success)&&f.push({name:"User_Library"}),c.value=I.data.data,c.value.createBy=I.data.data.createdBy.fullName,b.value=q.data.data.map(K=>ue.transformResponseToRequest(K)),S.value=b.value,await N()}catch(I){ae.QUESTION_SET_NOT_FOUND in(((h=(l=I.response)==null?void 0:l.data)==null?void 0:h.errors)||{})&&f.push({name:"404"})}finally{Q.value=!1}},A=(l,h)=>{$(h).toggleClass("bx-chevron-up bx-chevron-down");const q=$(`#question-item-answer-${l}`);q&&$(q).slideToggle()},n=_(null),C=()=>{var l;(l=n.value)==null||l.openModal()},d=_(null),z=()=>{var l;(l=d.value)==null||l.openModal()},Y=()=>{f.push({name:"User_QuestionSet_Learn",params:{id:c.value.id}})},P=()=>{f.push({name:"User_QuestionSet_Test",params:{id:c.value.id}})},H=()=>{f.push({name:"User_QuestionSet_Update",params:{id:c.value.id}})},F=_(!1),G=_(0),U=_({canEdit:!1,canDelete:!1}),N=async()=>{const l=await V.GetPermissions(c.value.id);l.data.success&&(U.value=l.data.data)},j=()=>{oe.confirm({title:p("detail_QS.modal.delete_title"),content:p("detail_QS.modal.delete_content"),okText:p("sidebar.buttons.ok"),cancelText:p("sidebar.buttons.cancel"),onOk:async()=>{if(!(await V.Delete(c.value.id)).data.success){D.error(p("message.deleted_failed"));return}D.success(p("message.deleted_successfully")),f.push("User_Library")}})},X=l=>{const h=[l];sessionStorage.setItem("selected_tags",JSON.stringify(h)),f.push({name:"User_QuestionSet_Search"})},J=()=>{let l=b.value;l=b.value.filter(h=>{const I=h.questionText.includes(L.value),q=k.value==="All"||k.value===h.type;return I&&q}),S.value=l};ne(async()=>{await O()});const B={t:p,route:e,router:f,loading:Q,question_set_id:x,quiz:c,quiz_questions:b,questions:S,optionKeys:M,question_type_options:R,selected_type_option:k,searchValue:L,getData:O,toggleDisplayAnswer:A,shareModalRef:n,onOpenShareModal:C,shareClassModalRef:d,onOpenShareClassModal:z,onRedirectToLearn:Y,onRedirectToTest:P,onRedirectToEdit:H,modal_rate_open:F,rateValue:G,permission:U,getPermission:N,onDelete:j,onRedirectToSearch:X,onFilter:J,get user_image(){return de},get QUESTION_TYPE(){return E},Input:ce,get dayjs(){return ie},ShareModal:me,get VISIBILITY(){return ve}};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),ge={class:"content"},pe={class:"content-item"},he={key:0},ye={key:1},be={class:"content-item-title"},Ie={key:0,class:"d-flex flex-row align-items-center quiz-header-functions"},Te={class:"quiz-info"},Se={class:"quiz-tag-container"},qe=["onClick"],we={class:"quiz-credit"},xe={class:"share-btn-container"},ke={class:"share-btn-container"},Ce={class:"action-container"},ze={class:"credit-user"},Ee=["src"],Qe={class:"credit-user-info"},Me={class:"d-flex"},Re={class:"content-item"},Le={class:"content-item-title"},Oe={class:"content-item-functions"},Ve={style:{width:"300px",padding:"0"}},Ae={key:0},Ue={key:1,class:"preview-question-container"},Ne={class:"preview-question-item"},Be={class:"question-item-content"},De={class:"d-flex pb-2"},Ye={class:"question-index"},Pe=["innerHTML"],He={key:1,class:"question-text"},Fe=["id"],Ge={key:0,class:"multiple-choice-answer"},je={key:0,class:"text-success"},Xe={class:"pair-answer"},Je={class:"pair-answer-item"},Ke={class:"pair-answer-item"},We={key:2,class:"ordering-answer"},Ze={class:"ordering-answer-item"},$e={class:"ordering-answer-item"},et={class:"ordering-answer-item"},tt={class:"short-text-answer"},st={class:"question-item-toogle-btn"},nt=["onClick"],at={class:"title-container"},ot={class:"modal-rate-container"};function it(v,s,p,e,f,Q){const x=g("RouterLink"),c=g("a-skeleton"),b=g("a-tooltip"),S=g("a-button"),M=g("a-select-option"),R=g("a-select"),k=g("a-col"),L=g("a-row"),O=g("a-rate"),A=g("a-modal");return a(),o(y,null,[t("div",ge,[r(x,{class:"navigator-back-link d-flex align-items-center p-2",to:{name:"User_Library"}},{default:u(()=>[s[5]||(s[5]=t("i",{class:"me-1 bx bx-chevron-left"},null,-1)),m(" "+i(v.$t("detail_QS.other.library")),1)]),_:1,__:[5]}),t("div",pe,[e.loading?(a(),o("div",he,[r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"])])):(a(),o("div",ye,[t("div",be,[t("div",null,[t("span",null,i(e.quiz.name),1),t("span",null,i(e.quiz.description),1)]),e.permission.canEdit||e.permission.canDelete?(a(),o("div",Ie,[r(b,null,{title:u(()=>[m(i(v.$t("question_sets_index.buttons.edit")),1)]),default:u(()=>[e.permission.canEdit?(a(),o("i",{key:0,class:"me-3 bx bx-edit",onClick:e.onRedirectToEdit})):T("v-if",!0)]),_:1}),r(b,null,{title:u(()=>[m(i(v.$t("question_sets_index.buttons.delete")),1)]),default:u(()=>[e.permission.canDelete?(a(),o("i",{key:0,class:"text-danger bx bx-trash-alt",onClick:e.onDelete})):T("v-if",!0)]),_:1})])):T("v-if",!0)]),t("div",Te,[t("div",{class:"quiz-rating",onClick:s[0]||(s[0]=n=>e.modal_rate_open=!0)},i(e.quiz.ratingAverage)+" ⭐️ ("+i(e.quiz.ratingCount)+" "+i(v.$t("detail_QS.other.reviews"))+") ",1),t("div",Se,[(a(!0),o(y,null,w(e.quiz.tags,n=>(a(),o("div",{class:"quiz-tag-item",onClick:C=>e.onRedirectToSearch(n)},i(n.name),9,qe))),256))])]),t("div",we,[t("div",xe,[r(S,{type:"primary",class:"me-3 main-color-btn share-btn",size:"large",onClick:e.onOpenShareClassModal},{default:u(()=>[s[6]||(s[6]=t("i",{class:"bx bx-share-alt"},null,-1)),m(" "+i(v.$t("detail_QS.buttons.share_class")),1)]),_:1,__:[6]})]),t("div",ke,[r(S,{type:"primary",class:"main-color-btn share-btn",size:"large",onClick:e.onOpenShareModal},{default:u(()=>[s[7]||(s[7]=t("i",{class:"bx bx-share-alt"},null,-1)),m(" "+i(v.$t("detail_QS.buttons.share_quiz")),1)]),_:1,__:[7]})])]),t("div",Ce,[t("div",ze,[t("img",{class:"user-image",src:e.user_image,alt:""},null,8,Ee),t("div",Qe,[t("span",null,i(v.$t("detail_QS.other.created_by",{username:e.quiz.createBy})),1),t("span",null,i(e.dayjs(e.quiz.createdAt).format("DD/MM/YYYY")),1)])]),t("div",Me,[t("div",{class:"action-item",onClick:e.onRedirectToLearn},[m(i(v.$t("detail_QS.buttons.learn"))+" ",1),s[8]||(s[8]=t("i",{class:"bx bx-analyse"},null,-1))]),t("div",{class:"action-item",onClick:e.onRedirectToTest},[m(i(v.$t("detail_QS.buttons.test"))+" ",1),s[9]||(s[9]=t("i",{class:"bx bx-detail"},null,-1))])])])]))]),t("div",Re,[t("div",Le,[t("div",null,[t("span",null,i(v.$t("detail_QS.other.questions",{number:e.quiz_questions.length})),1)])]),t("div",Oe,[r(R,{class:"me-3",value:e.selected_type_option,"onUpdate:value":s[1]||(s[1]=n=>e.selected_type_option=n),style:{width:"200px"},onChange:e.onFilter},{default:u(()=>[(a(!0),o(y,null,w(e.question_type_options,n=>(a(),re(M,{value:n.value},{default:u(()=>[m(i(n.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",Ve,[r(e.Input,{onInput:e.onFilter,modelValue:e.searchValue,"onUpdate:modelValue":s[2]||(s[2]=n=>e.searchValue=n),placeholder:e.t("question_sets_index.search_placeholder")},{icon:u(()=>s[10]||(s[10]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(a(),o("div",Ae,[r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"]),r(c,{loading:e.loading,active:""},null,8,["loading"])])):(a(),o("div",Ue,[(a(!0),o(y,null,w(e.questions,(n,C)=>(a(),o("div",Ne,[t("div",Be,[t("div",De,[t("div",Ye,i(C+1),1),n.questionHTML?(a(),o("div",{key:0,class:"question-html",innerHTML:n.questionHTML},null,8,Pe)):(a(),o("div",He,i(n.questionText),1))]),t("div",{class:"question-item-answer",id:`question-item-answer-${C}`,style:{display:"none"}},[n.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(a(),o("div",Ge,[t("ul",null,[(a(!0),o(y,null,w(n.multipleChoices,d=>(a(),o("li",null,[m(i(d.text)+" ",1),d.isAnswer?(a(),o("span",je," ("+i(d.isAnswer)+") ",1)):T("v-if",!0)]))),256))])])):T("v-if",!0),n.type===e.QUESTION_TYPE.MATCHING?(a(!0),o(y,{key:1},w(n.matchingPairs,d=>(a(),o("div",Xe,[t("span",Je,i(d.leftItem),1),s[11]||(s[11]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("span",Ke,i(d.rightItem),1)]))),256)):T("v-if",!0),n.type===e.QUESTION_TYPE.ORDERING?(a(),o("div",We,[t("div",Ze,[(a(!0),o(y,null,w(n.orderingItems,d=>(a(),o("div",null,i(d.text),1))),256))]),s[12]||(s[12]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("div",$e,[(a(!0),o(y,null,w(n.orderingItems.sort((d,z)=>d.correctOrder-z.correctOrder),(d,z)=>(a(),o("div",et,[t("span",null,"#"+i(z+1),1),m(" - "+i(d.text),1)]))),256))])])):T("v-if",!0),n.type===e.QUESTION_TYPE.SHORT_TEXT?(a(),o(y,{key:3},[s[13]||(s[13]=t("span",null,"Answer:",-1)),t("div",tt,i(n.shortAnswer),1)],64)):T("v-if",!0)],8,Fe)]),t("div",st,[t("i",{class:"bx bx-chevron-down",onClick:d=>e.toggleDisplayAnswer(C,d.currentTarget)},null,8,nt)])]))),256))]))])]),r(e.ShareModal,{ref:"shareModalRef",id:e.quiz.id,name:e.quiz.name,mode:"quiz",options:[e.VISIBILITY.PUBLIC,e.VISIBILITY.PRIVATE],visibility:e.quiz.visibilityMode},null,8,["id","name","options","visibility"]),r(e.ShareModal,{ref:"shareClassModalRef",id:e.quiz.id,name:e.quiz.name,mode:"quiz",options:[e.VISIBILITY.IN_CLASS],visibility:e.VISIBILITY.IN_CLASS},null,8,["id","name","options","visibility"]),r(A,{"wrap-class-name":"medium-modal",open:e.modal_rate_open},{footer:u(()=>[r(S,{type:"primary",class:"main-color-btn"},{default:u(()=>s[16]||(s[16]=[m("Send")])),_:1,__:[16]})]),default:u(()=>[t("div",at,[r(L,{class:"w-100 d-flex align-items-center justify-content-between"},{default:u(()=>[r(k,{span:1},{default:u(()=>[t("div",{onClick:s[3]||(s[3]=n=>e.modal_rate_open=!1)},s[14]||(s[14]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)]))]),_:1}),r(k,{class:"main-title",span:20},{default:u(()=>s[15]||(s[15]=[t("span",null,"Rate the question set",-1),m(),t("br",null,null,-1)])),_:1,__:[15]})]),_:1})]),t("div",ot,[r(O,{value:e.rateValue,"onUpdate:value":s[4]||(s[4]=n=>e.rateValue=n),style:{"font-size":"40px"}},null,8,["value"])])]),_:1},8,["open"])],64)}const ht=le(fe,[["render",it],["__scopeId","data-v-307050af"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/question_sets/detail.vue"]]);export{ht as default};
