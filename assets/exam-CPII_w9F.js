import{a as u,I as W,d as Z,q as K,l as ee,u as te,i as S,z as ae,j as se,E as ne,s as oe,M as le,k as ie,D as re,S as ce,_ as ue,r as f,c as b,o as _,b as a,w as c,f as d,t as i,F as I,B as L,C as A,e as q}from"./index-Bl_qeBx0.js";import{A as U}from"./ApiClass-IRHgEt2T.js";import{A as me}from"./ApiTest-Bc5vSxsT.js";import{C as de}from"./classStudentPosition-B7ChrNvq.js";import{I as _e}from"./Input-C6nJoIqP.js";import{V as pe}from"./Validator-CWeiTIFe.js";import{U as ge}from"./UserTestAttempts-CPtfpt3s.js";import"./lodash-B1oX-x6R.js";var ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm376 116c-119.3 0-216 96.7-216 216s96.7 216 216 216 216-96.7 216-216-96.7-216-216-216zm107.5 323.5C750.8 868.2 712.6 884 672 884s-78.8-15.8-107.5-44.5C535.8 810.8 520 772.6 520 732s15.8-78.8 44.5-107.5C593.2 595.8 631.4 580 672 580s78.8 15.8 107.5 44.5C808.2 653.2 824 691.4 824 732s-15.8 78.8-44.5 107.5zM761 656h-44.3c-2.6 0-5 1.2-6.5 3.3l-63.5 87.8-23.1-31.9a7.92 7.92 0 00-6.5-3.3H573c-6.5 0-10.3 7.4-6.5 12.7l73.8 102.1c3.2 4.4 9.7 4.4 12.9 0l114.2-158c3.9-5.3.1-12.7-6.4-12.7zM440 852H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"file-done",theme:"outlined"};function F(o){for(var s=1;s<arguments.length;s++){var p=arguments[s]!=null?Object(arguments[s]):{},e=Object.keys(p);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(p).filter(function(m){return Object.getOwnPropertyDescriptor(p,m).enumerable}))),e.forEach(function(m){fe(o,m,p[m])})}return o}function fe(o,s,p){return s in o?Object.defineProperty(o,s,{value:p,enumerable:!0,configurable:!0,writable:!0}):o[s]=p,o}var D=function(s,p){var e=F({},s,p.attrs);return u(W,F({},e,{icon:ve}),null)};D.displayName="FileDoneOutlined";D.inheritAttrs=!1;const x={ALL:"All",UPCOMING:"Upcoming",ACTIVE:"Active",COMPLETED:"Completed"},be=Z({__name:"exam",emits:["updateSidebar"],setup(o,{expose:s,emit:p}){var w;s();const e=K(),m=ee(),{t:h}=te(),C=p,g=S(e.params.id||""),N=S({classId:"",name:"",topic:""}),z=Object.values(x),T=ae(()=>z.map(t=>({label:h(`class_exam.select_option.${t}`),value:t!==x.ALL?t:""}))),l=se({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,testName:((w=e.query.testName)==null?void 0:w.toString())||"",status:e.query.status||T.value[0].value,totalCount:0,statusFilter:!1}),y=S([]),E=S(""),O=S(!1),n=async()=>{try{const t=await U.GetUserPermission(N.value.classId);t.data.success&&(E.value=t.data.data)}catch(t){console.log(t)}},v=async()=>{try{if(!pe.isValidGuid(g.value.toString())){m.push({name:"404"});return}g.value||m.push({name:"404"});let t=await U.GetById(g.value.toString());t.data.success||m.push({name:"404"}),N.value=t.data.data}catch(t){console.log("ERROR: GETBYID class: "+t)}},k=async()=>{try{O.value=!0;let t=await U.GetAllExamByLimit(g.value.toString(),l);if(t.data.success){let r=t.data.data;y.value=r.items,l.pageNumber=r.pageNumber,l.pageSize=r.pageSize,l.totalCount=r.totalCount,l.statusFilter&&(l.pageNumber>r.totalPages&&l.totalCount>0?(l.pageNumber=1,m.push({name:"User_Class_Exam",params:{id:g.value},query:{pageNumber:1,pageSize:l.pageSize,testName:l.testName,status:l.status}})):m.push({name:"User_Class_Exam",params:{id:g.value},query:{pageNumber:l.pageNumber,pageSize:l.pageSize,testName:l.testName,status:l.status}}),l.statusFilter=!l.statusFilter)}}catch(t){console.log("ERROR: GETALLEXAMBYLIMIT class exam: "+t)}finally{O.value=!1}};ne(()=>Object.keys(e.query).length,()=>{var t;l.pageNumber=e.query.pageNumber||1,l.pageSize=e.query.pageSize||10,l.testName=((t=e.query.testName)==null?void 0:t.toString())||"",l.status=e.query.status||T.value[0].value,l.statusFilter=!0,k()});const V=(t,r)=>{l.pageNumber=t,l.pageSize=r,l.statusFilter=!0,k()},j=t=>{if(t<24)return`${t} hour${t!==1?"s":""} ago`;if(t<24*7){const r=Math.floor(t/24);return`${r} day${r!==1?"s":""} ago`}else if(t<24*30){const r=Math.floor(t/168);return`${r} week${r!==1?"s":""} ago`}else if(t<24*365){const r=Math.floor(t/720);return`${r} month${r!==1?"s":""} ago`}else{const r=Math.floor(t/8760);return`${r} year${r!==1?"s":""} ago`}},H=t=>{switch(t){case x.COMPLETED:return"#3b82f6";case x.ACTIVE:return"#22C55E";case x.UPCOMING:return"#f59e0b"}},B=()=>{m.push({name:"User_Test_Create",params:{id:g.value}})},G=t=>{m.push({name:"User_Test_Update",params:{id:t}})},Y=t=>{le.confirm({title:h("class_exam.modal.delete_title"),content:h("class_exam.modal.delete_content"),okText:h("sidebar.buttons.ok"),cancelText:h("sidebar.buttons.cancel"),onOk:async()=>{(await me.Delete(t)).data.success&&(ie.success(h("message.deleted_successfully")),k())}})},Q=t=>{m.push({name:"User_Test_Attempt",params:{id:t}})},X=t=>{m.push({name:"User_Class_Exam_Result",params:{classId:g.value,testId:t}})},$=S({studentId:"",studentName:"",studentEmail:"",score:0,status:""}),M=S(y.value[0]||{testId:"",name:"",timeStart:"",timeLimit:0,numberOfQuestions:0,status:x.ACTIVE,relativeTime:0}),P=S(null),J=async t=>{var r;M.value=t,await re(),(r=P.value)==null||r.openModal()};oe(async()=>{C("updateSidebar","class"),await v(),await n(),await k()});const R={route:e,router:m,t:h,emit:C,classId:g,classData:N,optionKeys:z,exam_status_options:T,pageParams:l,exam_data:y,userRoleInClass:E,loading:O,getPermission:n,getClassData:v,getData:k,onPaginationChange:V,getFormattedRelativeTime:j,getTagColor:H,onRedirectToCreate:B,onRedirectToUpdate:G,onDeleteTest:Y,onRedirectToAttempt:Q,onRedirectToResult:X,chosenUser:$,chosenExam:M,userHistoryModalRef:P,onOpenHistoryModal:J,get CLASS_STUDENT_POSITION(){return de},get CLASS_EXAM_STATUS(){return x},get dayjs(){return ce},Input:_e,get FileDoneOutlined(){return D},UserTestAttempts:ge};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),he={class:"page-container"},Ce={class:"title-container"},ye={class:"breadcrumb-container"},Se={class:"title-breadcrumb-item"},Te={class:"title-breadcrumb-item"},xe={class:"breadcrumb-item-topic"},Ie={class:"content"},Ne={class:"content-item"},Oe={class:"content-item-title"},ke={class:"content-item-functions"},ze={class:"content-item-navigators"},Ee={class:"navigator-container"},Ae={style:{width:"300px",padding:"0px"}},Ue={key:0,class:"exam-item-container"},De={class:"exam-item"},Me={class:"exam-item-title"},Pe={class:"exam-item-info exam-item-date"},Re={class:"exam-item-info exam-info-detail"},we={class:"exam-item-questions"},Le={class:"exam-item-time"},qe={class:"exam-item-assigned completion"},Fe={class:"exam-item-assigned"},Ve={class:"exam-item-actions"},je=["onClick"],He=["onClick"],Be=["onClick"],Ge=["onClick"],Ye={key:1,class:"w-100 d-flex justify-content-center"},Qe={class:"pagination-container"};function Xe(o,s,p,e,m,h){const C=f("RouterLink"),g=f("a-button"),N=f("a-select-option"),z=f("a-select"),T=f("a-skeleton"),l=f("a-tag"),y=f("a-tooltip"),E=f("a-empty"),O=f("a-pagination");return _(),b(I,null,[a("div",he,[a("div",Ce,[a("div",ye,[a("ul",null,[a("li",Se,[u(C,{to:{name:"User_Class"}},{default:c(()=>[a("span",null,i(o.$t("class_index.title")),1),s[3]||(s[3]=d()),s[4]||(s[4]=a("br",null,null,-1))]),_:1,__:[3,4]}),s[5]||(s[5]=a("i",{class:"bx bx-chevron-right"},null,-1))]),a("li",Te,[u(C,{to:{name:""},class:"breadcrumb-item-class"},{default:c(()=>[a("span",null,i(e.classData.name),1),a("span",xe,i(e.classData.topic),1)]),_:1})])])])]),a("div",Ie,[a("div",Ne,[a("div",Oe,[a("div",null,[a("span",null,i(o.$t("class_index.title")),1),a("span",null,i(o.$t("class_exam.sub_title")),1)]),u(g,{type:"primary",class:"main-color-btn",onClick:e.onRedirectToCreate},{default:c(()=>[s[6]||(s[6]=a("i",{class:"me-2 bx bx-list-plus"},null,-1)),d(" "+i(o.$t("class_exam.buttons.assign_test")),1)]),_:1,__:[6]})]),a("div",ke,[a("div",ze,[a("div",Ee,[u(C,{class:"navigator-item navigator-active",to:{name:""}},{default:c(()=>[d(i(o.$t("class_index.navigators.exam")),1)]),_:1}),u(C,{class:"navigator-item",to:{name:"User_Class_Quiz"}},{default:c(()=>[d(i(o.$t("class_index.navigators.quiz")),1)]),_:1}),u(C,{class:"navigator-item",to:{name:"User_Class_Student"}},{default:c(()=>[d(i(o.$t("class_index.navigators.member")),1)]),_:1})])]),u(z,{class:"me-3",value:e.pageParams.status,"onUpdate:value":s[0]||(s[0]=n=>e.pageParams.status=n),style:{width:"200px"},onChange:e.getData},{default:c(()=>[(_(!0),b(I,null,L(e.exam_status_options,n=>(_(),A(N,{value:n.value},{default:c(()=>[d(i(n.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),a("div",Ae,[u(e.Input,{onInput:e.getData,modelValue:e.pageParams.testName,"onUpdate:modelValue":s[1]||(s[1]=n=>e.pageParams.testName=n),placeholder:e.t("class_exam.other.search_placeholder")},{icon:c(()=>s[7]||(s[7]=[a("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(_(),b(I,{key:0},[u(T,{active:"",loading:e.loading},null,8,["loading"]),u(T,{active:"",loading:e.loading},null,8,["loading"]),u(T,{active:"",loading:e.loading},null,8,["loading"])],64)):(_(),b(I,{key:1},[e.exam_data.length>0?(_(),b("div",Ue,[(_(!0),b(I,null,L(e.exam_data,n=>(_(),b("div",De,[s[11]||(s[11]=a("i",{class:"bx bx-book-open exam-item-icon"},null,-1)),a("div",null,[a("div",Me,[d(i(n.name)+" ",1),u(l,{color:e.getTagColor(n.status)},{default:c(()=>[d(i(o.$t(`class_exam.select_option.${n.status}`)),1)]),_:2},1032,["color"])]),a("div",Pe,[a("div",null,[s[8]||(s[8]=a("i",{class:"bx bx-calendar"},null,-1)),d(" "+i(e.dayjs(n.timeStart).format("DD/MM/YYYY HH:mm A")),1)])]),a("div",Re,[a("div",we,[s[9]||(s[9]=a("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),d(" "+i(n.numberOfQuestions)+" "+i(o.$t("dashboards.list_items.quiz.questions")),1)]),a("div",Le,[s[10]||(s[10]=a("i",{class:"bx bx-time-five"},null,-1)),d(" "+i(n.timeLimit)+" "+i(o.$t("class_exam.other.min")),1)]),a("span",qe,i(n.numberOfCompletion)+" "+i(o.$t("class_exam.other.completions")),1),a("span",Fe,i(o.$t("class_exam.other.assigned"))+" "+i(e.getFormattedRelativeTime(n.relativeTime)),1)])]),a("div",Ve,[n.status===e.CLASS_EXAM_STATUS.ACTIVE?(_(),A(g,{key:0,type:"primary",class:"main-color-btn",onClick:v=>e.onRedirectToAttempt(n.testId)},{default:c(()=>[d(i(o.$t("class_exam.buttons.attempt")),1)]),_:2},1032,["onClick"])):q("v-if",!0),e.userRoleInClass!==e.CLASS_STUDENT_POSITION.STUDENT?(_(),b(I,{key:1},[n.status===e.CLASS_EXAM_STATUS.UPCOMING?(_(),A(y,{key:0},{title:c(()=>[d(i(o.$t("question_sets_index.buttons.edit")),1)]),default:c(()=>[a("i",{class:"bx bx-edit",onClick:v=>e.onRedirectToUpdate(n.testId)},null,8,je)]),_:2},1024)):q("v-if",!0),u(y,null,{title:c(()=>[d(i(o.$t("class_member.buttons.history_test")),1)]),default:c(()=>[a("i",{onClick:v=>e.onRedirectToResult(n.testId)},[u(e.FileDoneOutlined)],8,He)]),_:2},1024),u(y,null,{title:c(()=>[d(i(o.$t("question_sets_index.buttons.delete")),1)]),default:c(()=>[a("i",{class:"text-danger bx bx-trash-alt",onClick:v=>e.onDeleteTest(n.testId)},null,8,Be)]),_:2},1024)],64)):(_(),A(y,{key:2},{title:c(()=>[d(i(o.$t("class_member.buttons.history_test")),1)]),default:c(()=>[a("i",{onClick:v=>e.onOpenHistoryModal(n)},[u(e.FileDoneOutlined)],8,Ge)]),_:2},1024))])]))),256))])):(_(),b("div",Ye,[u(E,null,{description:c(()=>[a("span",null,i(o.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),a("div",Qe,[u(O,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":s[2]||(s[2]=n=>e.pageParams.pageNumber=n),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(n,v)=>`${v[0]}-${v[1]} of ${n} ${e.t("class_exam.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])]),u(e.UserTestAttempts,{ref:"userHistoryModalRef","test-id":e.chosenExam.testId.toString(),"user-id":null,"test-name":e.chosenExam.name,"passing-score":0,"student-name":null},null,8,["test-id","test-name"])],64)}const st=ue(be,[["render",Xe],["__scopeId","data-v-1afc52c6"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/exam.vue"]]);export{st as default};
