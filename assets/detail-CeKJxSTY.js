import{d as E,q as Q,l as Y,u as G,i as f,j as P,O as H,s as J,M as B,k as T,v as K,_ as W,r as _,a as h,o as z,b as t,c as n,f as v,t as s,w as u,F as k,D as X}from"./index-BhCEM7Qr.js";import{A as w}from"./ApiFolder-BZCwdVbU.js";import{V as Z}from"./Validator-CWeiTIFe.js";import{I as $}from"./Input-pAeduOdR.js";import{S as ee}from"./ShareModal-sacErCxr.js";import{V as te}from"./visibility-PZlBDoOn.js";import"./ApiQuestionSet-DcHTXIEH.js";import"./ApiTestTemplate-GdvjRZpe.js";const ae=E({__name:"detail",emits:["updateSidebar"],setup(m,{expose:a,emit:D}){var M;a();const e=Q(),b=Y(),{t:i}=G(),p=D,c=f(e.params.id.toString()||""),y=f({folderTestId:"",name:"",createBy:""}),o=P({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,testTemplateName:((M=e.query.testTemplateName)==null?void 0:M.toString())||"",totalCount:0,statusFilter:!1}),x=f([]),S=f(!1),g=async()=>{try{if(S.value=!0,!Z.isValidGuid(c.value.toString())){b.push({name:"404"});return}c.value||b.push({name:"404"});let l=await w.GetAllTestTemplateByLimit(c.value.toString(),o);if(l.data.success){let d=l.data.data;x.value=d.testTemplates.items,y.value.name=d.folderName,o.pageNumber=d.testTemplates.pageNumber,o.pageSize=d.testTemplates.pageSize,o.totalCount=d.testTemplates.totalCount,o.statusFilter&&(o.pageNumber>d.totalPages&&o.totalCount>0?(o.pageNumber=1,b.push({name:"User_Folder_Detail",params:{id:c.value},query:{pageNumber:1,pageSize:o.pageSize,testTemplateName:o.testTemplateName}})):b.push({name:"User_Folder_Detail",params:{id:c.value},query:{pageNumber:o.pageNumber,pageSize:o.pageSize,testTemplateName:o.testTemplateName}}),o.statusFilter=!o.statusFilter)}}catch(l){console.log("ERROR: GETALLBYLIMIT testtemplate: "+l)}finally{S.value=!1}};H(()=>{var l;Object.keys(e.query).length===0&&(o.pageNumber=e.query.pageNumber||1,o.pageSize=e.query.pageSize||10,o.testTemplateName=((l=e.query.testTemplateName)==null?void 0:l.toString())||"",o.statusFilter=!0,g())});const F=(l,d)=>{o.pageNumber=l,o.pageSize=d,o.statusFilter=!0,g()},q=l=>{B.confirm({title:i("folder_detail.modal.delete_template_warning"),content:i("folder_detail.modal.delete_template_ins"),okText:i("sidebar.buttons.ok"),cancelText:i("sidebar.buttons.cancel"),onOk:async()=>{if(!(await w.DeleteTestTemplate(y.value.folderTestId,l)).data.success){T.error(i("message.removed_failed"));return}T.success(i("message.removed_successylly")),await g()}})},r=()=>{B.confirm({title:i("folder_detail.modal.delete_folder_warning"),content:K("div",{style:"color: red"},i("folder_detail.danger_zone.warning_explain")),centered:!0,okText:i("sidebar.buttons.ok"),cancelText:i("sidebar.buttons.cancel"),onOk:async()=>{if(!(await w.DeleteFolder(c.value.toString())).data.success){T.error(i("message.deleted_failed"));return}T.success(i("message.deleted_successfully")),b.push({name:"User_Folder"})}})},I={name:[{required:!0,message:"This field is required.",trigger:"change"},{max:100,message:"Limit 100.",trigger:"change"}]},N=f(!1),C=f(),V=P({name:y.value.name}),O=()=>{var l;N.value=!0,V.name=y.value.name,(l=C.value)==null||l.validate()},R=f(!1),A=async()=>{var l;R.value=!0;try{if((l=C.value)==null||l.validate(),!(await w.Update(c.value.toString(),{folderId:c.value,name:V.name})).data.success){T.error(i("message.updated_failed"));return}T.success(i("message.updated_successfully")),N.value=!1,await g()}catch(d){console.log(d)}finally{R.value=!1}},L=f(null),j=l=>{var d;(d=L.value)==null||d.openModal()};J(async()=>{p("updateSidebar","folder"),await g()});const U={route:e,router:b,t:i,emit:p,folderId:c,folderData:y,pageParams:o,test_template_data:x,loading:S,getData:g,onPaginationChange:F,onRemoveTestTemplate:q,onOpenConfirmDelete:r,rules:I,modal_update_open:N,updateFolderFormRef:C,updateFolderFormState:V,openUpdateModal:O,isUpdateLoading:R,onUpdateFolder:A,shareModalRef:L,onOpenShareModal:j,Input:$,ShareModal:ee,get VISIBILITY(){return te}};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),oe={class:"page-container"},le={class:"title-container"},ne={class:"main-title"},se={class:"title-button-container"},ie={class:"content"},re={class:"content-item"},de={class:"content-item-title"},me={class:"content-item-functions"},ue={class:"filter-container"},ce={style:{width:"300px",padding:"0px"}},_e={key:0,class:"quiz-item-container"},pe={class:"quiz-item"},ge={class:"quiz-item-title"},fe={class:"quiz-item-info quiz-info-detail"},ve={class:"quiz-item-questions"},be={class:"quiz-item-created-by"},ye={class:"exam-item-actions"},he=["onClick"],ze={key:1,class:"w-100 d-flex justify-content-center"},Se={class:"pagination-container"},Te={class:"mt-4 content-item"},Ie={class:"content-item-title"},xe={class:"text-danger"},ke={class:"danger-zone mt-3 p-4"},we={class:"text-danger fs-6 fw-bold"},Fe={class:"text-secondary"},qe={class:"modal-container"},Ne={class:"modal-title-container"};function Ce(m,a,D,e,b,i){const p=_("a-button"),c=_("a-skeleton"),y=_("a-empty"),o=_("a-pagination"),x=_("RouterLink"),S=_("a-col"),g=_("a-row"),F=_("a-form"),q=_("a-modal");return z(),h(k,null,[t("div",oe,[t("div",le,[t("div",ne,[t("span",null,s(m.$t("folder_detail.title")),1),a[5]||(a[5]=v()),a[6]||(a[6]=t("br",null,null,-1))]),t("div",se,[n(p,{type:"primary",class:"ms-3 main-color-btn",size:"large",onClick:e.onOpenShareModal},{default:u(()=>[a[7]||(a[7]=t("i",{class:"me-2 bx bx-share-alt"},null,-1)),v(" "+s(m.$t("detail_QS.buttons.share_quiz")),1)]),_:1,__:[7]}),n(p,{type:"primary",class:"ms-3 main-color-btn",size:"large"},{default:u(()=>[a[8]||(a[8]=t("i",{class:"me-2 bx bx-plus"},null,-1)),v(" "+s(m.$t("folder_detail.buttons.create_new_template")),1)]),_:1,__:[8]})])]),t("div",ie,[t("div",re,[t("div",de,[t("span",null,[v(s(e.folderData.name)+" ",1),t("i",{class:"bx bx-edit",onClick:e.openUpdateModal})])]),t("div",me,[t("div",ue,[t("div",ce,[n(e.Input,{onInput:e.getData,modelValue:e.pageParams.testTemplateName,"onUpdate:modelValue":a[0]||(a[0]=r=>e.pageParams.testTemplateName=r),placeholder:e.t("class_index.other.search_class_placeholder")},{icon:u(()=>a[9]||(a[9]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])])]),e.loading?(z(),h(k,{key:0},[n(c,{loading:e.loading},null,8,["loading"]),n(c,{loading:e.loading},null,8,["loading"]),n(c,{loading:e.loading},null,8,["loading"])],64)):(z(),h(k,{key:1},[e.test_template_data.length>0?(z(),h("div",_e,[(z(!0),h(k,null,X(e.test_template_data,r=>(z(),h("div",pe,[a[11]||(a[11]=t("i",{class:"bx bx-book-open quiz-item-icon"},null,-1)),t("div",null,[t("div",ge,s(r.name),1),t("div",fe,[t("div",ve,[a[10]||(a[10]=t("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),v(" "+s(r.numberOfQuestion)+" "+s(m.$t("dashboards.list_items.quiz.questions")),1)]),t("div",be,s(m.$t("class_question_set.other.created_by"))+" "+s(r.createdBy),1)])]),t("div",ye,[n(p,{type:"primary",class:"me-3 main-color-btn"},{default:u(()=>[v(s(m.$t("class_question_set.buttons.view")),1)]),_:1}),t("i",{class:"text-danger bx bx-trash-alt",onClick:I=>e.onRemoveTestTemplate(r.testTemplateId)},null,8,he)])]))),256))])):(z(),h("div",ze,[n(y,null,{description:u(()=>[t("span",null,s(m.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),t("div",Se,[n(o,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":a[1]||(a[1]=r=>e.pageParams.pageNumber=r),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(r,I)=>`${I[0]}-${I[1]} of ${r} ${e.t("folder_index.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("folder_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])]),t("div",Te,[t("div",Ie,[t("div",null,[t("span",xe,s(m.$t("folder_detail.danger_zone.title")),1),t("span",null,s(m.$t("folder_detail.danger_zone.sub_title")),1)])]),t("div",ke,[t("div",we,s(m.$t("folder_detail.danger_zone.warning")),1),t("div",Fe,s(m.$t("folder_detail.danger_zone.warning_explain")),1),n(p,{class:"mt-3",type:"primary",danger:"",size:"large",onClick:e.onOpenConfirmDelete},{default:u(()=>[v(s(m.$t("folder_detail.danger_zone.warning")),1)]),_:1})])])])]),n(q,{centered:"","wrap-class-name":"medium-modal",open:e.modal_update_open,onCancel:a[4]||(a[4]=r=>e.modal_update_open=!1)},{footer:u(()=>[n(p,{loading:e.isUpdateLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onUpdateFolder},{default:u(()=>[v(s(m.$t("update_QS.buttons.update")),1)]),_:1},8,["loading"])]),default:u(()=>[t("div",qe,[t("div",Ne,[n(g,{class:"w-100 d-flex align-items-center"},{default:u(()=>[n(S,{span:4},{default:u(()=>[n(x,{onClick:a[2]||(a[2]=r=>e.modal_update_open=!1),to:{name:""}},{default:u(()=>a[12]||(a[12]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[12]})]),_:1}),n(S,{class:"main-title",span:20},{default:u(()=>[t("span",null,s(e.t("folder_detail.modal.create_title")),1)]),_:1})]),_:1})]),n(F,{ref:"updateFolderFormRef",layout:"vertical",rules:e.rules,model:e.updateFolderFormState},{default:u(()=>[n(e.Input,{label:"Folder name",name:"name",modelValue:e.updateFolderFormState.name,"onUpdate:modelValue":a[3]||(a[3]=r=>e.updateFolderFormState.name=r),placeholder:e.t("folder_index.modal.create_folder_name_placeholder"),"is-required":!0,"max-length":100},null,8,["modelValue","placeholder"])]),_:1},8,["model"])])]),_:1},8,["open"]),n(e.ShareModal,{ref:"shareModalRef",id:e.folderId,name:e.folderData.name,mode:"folder",options:[e.VISIBILITY.PRIVATE],visibility:e.VISIBILITY.PRIVATE},null,8,["id","name","options","visibility"])],64)}const Oe=W(ae,[["render",Ce],["__scopeId","data-v-2d07fd31"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/folder/detail.vue"]]);export{Oe as default};
