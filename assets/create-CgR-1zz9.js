import{d as B,u as G,i as I,j as N,N as W,s as j,O as Y,k as p,M as y,_ as J,r as S,a as w,o as f,b as t,c,w as g,f as x,t as d,F as A,B as D,C as X,D as K}from"./index-Dd8-myui.js";import{A as Z}from"./ApiQuestionSet-wCWw8J7f.js";import{I as $}from"./Input-BtmZP41X.js";import{T as ee}from"./TextArea-DyOic0o8.js";import{S as te,O as ne,M as oe,a as ie}from"./ShortText-B2lmwy7J.js";import{G as re,I as se}from"./GenerateQSModal-BLpofKFx.js";import{Q as b}from"./questionTypes-CS3lcRlq.js";import"./vue-draggable-plus-CKvOH8GT.js";import"./ApiTestTemplate-x2TAPrW4.js";const ae=B({__name:"create",setup(l,{expose:o}){o();const{t:Q}=G(),e=I(),r=N({name:"",description:"",tags:[],questions:[]}),O={title:[{required:"true",message:"This field is required",trigger:"change"},{length:100,message:"Limit 100",trigger:"change"}],description:[{length:200,message:"Limit 200",trigger:"change"}],tags:[{validator:(n,u)=>u&&u.length>5?Promise.reject("You can only add up to 5 tags."):Promise.resolve(),trigger:"change"}],questions:[{validator:(n,u)=>u&&u.length>500?Promise.reject("You can only add up to 5 questions."):Promise.resolve(),trigger:"change"}]},_={MultipleChoice:ie,Matching:oe,Ordering:ne,ShortText:te},q=[{id:"q1",type:"MultipleChoice",questionText:"What is the capital of France ?",questionHTML:"<p><strong>What</strong> is <br/> the <em>capital</em> of <u>France</u>? <code>// geography</code></p>",explainText:"Paris is the capital city of France.",score:10,multipleChoices:[{id:"1",text:"Paris",isAnswer:!0},{id:"2",text:"London",isAnswer:!1},{id:"3",text:"Berlin",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q2",type:"Matching",questionText:"Match the countries to their capitals.",questionHTML:"<p><u>Match</u> the <strong>countries</strong> to their <em>capitals</em>. <code>// matching task</code></p>",explainText:"Each country must be paired with its capital.",score:10,multipleChoices:[],matchingPairs:[{id:"1",leftItem:"Japan",rightItem:"Tokyo"},{id:"2",leftItem:"Italy",rightItem:"Rome"},{id:"3",leftItem:"Vietnam",rightItem:"Hanoi"}],orderingItems:[],shortAnswer:""},{id:"q3",type:"Ordering",questionText:"Arrange the steps of the water cycle in the correct order.",questionHTML:"<p><strong>Arrange</strong> the steps of the <u>water cycle</u> in the <em>correct order</em>. <code>// science</code></p>",explainText:"The correct order is: Evaporation → Condensation → Precipitation → Collection.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[{id:"1",text:"Evaporation",correctOrder:0},{id:"2",text:"Condensation",correctOrder:1},{id:"3",text:"Precipitation",correctOrder:2},{id:"4",text:"Collection",correctOrder:3}],shortAnswer:""},{id:"q4",type:"ShortText",questionText:"What is the chemical symbol for water?",questionHTML:"<p><em>What</em> is the chemical <strong>symbol</strong> for <u>water</u>? <code>H2O</code></p>",explainText:"H2O is the formula for water.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[],shortAnswer:"H2O"},{id:"q5",type:"MultipleChoice",questionText:"Which planet is known as the Red Planet?",questionHTML:"<p>Which <strong>planet</strong> is known as the <em>Red Planet</em>? <u>Mars</u> <pre><code>// astronomy</code></pre></p>",explainText:"Mars is often called the Red Planet due to its reddish appearance.",score:10,multipleChoices:[{id:"1",text:"Mars",isAnswer:!0},{id:"2",text:"Venus",isAnswer:!1},{id:"3",text:"Jupiter",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""}],h=I(""),T=()=>{if(r.tags.length>=5){p.warning("Limit : 5 tags");return}h.value&&h.value.trim().length<=50?(r.tags.push(h.value),h.value=""):p.warning("Invalid tag content")},a=n=>{r.tags.splice(n,1)},m=()=>({id:Date.now().toString(),type:"MultipleChoice",questionText:"",questionHTML:"",explainText:"",score:10,multipleChoices:[{id:(Date.now()+1).toString(),text:"",isAnswer:!0},{id:(Date.now()+2).toString(),text:"",isAnswer:!1},{id:(Date.now()+3).toString(),text:"",isAnswer:!1},{id:(Date.now()+4).toString(),text:"",isAnswer:!1}],matchingPairs:[{id:(Date.now()+1).toString(),leftItem:"",rightItem:""},{id:(Date.now()+2).toString(),leftItem:"",rightItem:""}],orderingItems:[{id:(Date.now()+1).toString(),text:"",correctOrder:0},{id:(Date.now()+2).toString(),text:"",correctOrder:1},{id:(Date.now()+3).toString(),text:"",correctOrder:2},{id:(Date.now()+4).toString(),text:"",correctOrder:3}],shortAnswer:""}),M=()=>{if(r.questions.length>=10){p.warning("Each question set could have at most 100 questions");return}r.questions.push(m())},V=n=>{if(r.questions.length<=1){p.warning("Each question set must have at least 1 questions");return}r.questions.splice(n,1)},z=()=>{let n=!1,u="Invalid question.",v=new Set;if(r.name.trim().length>100||r.name.trim().length===0){n=!0,u="Invalid title.",p.error(u);return}if(r.description.trim().length>250){n=!0,u="Invalid description.",p.error(u);return}[r.questions.filter(i=>{const s=i.questionText.replace(/^<p>/,"").replace(/<\/p>$/,"").trim();return s.length===0||s.length>=500}),r.questions.filter(i=>i.explainText.replace(/^<p>/,"").replace(/<\/p>$/,"").trim().length>=500),r.questions.filter(i=>i.type===b.MULTIPLE_CHOICE&&(i.multipleChoices.some(s=>s.text.trim().length===0||s.text.trim().length>500)||i.multipleChoices.filter(s=>s.isAnswer).length===0)),r.questions.filter(i=>i.type===b.MATCHING&&(i.matchingPairs.some(s=>s.leftItem.trim().length===0||s.leftItem.trim().length>500)||i.matchingPairs.some(s=>s.rightItem.trim().length===0||s.rightItem.trim().length>500))),r.questions.filter(i=>i.type===b.ORDERING&&i.orderingItems.some(s=>s.text.trim().length===0||s.text.trim().length>500)),r.questions.filter(i=>i.type===b.SHORT_TEXT&&(i.shortAnswer.trim().length===0||i.shortAnswer.trim().length>500))].forEach(i=>{i.length>0&&(n=!0,i.forEach(s=>v.add(s)))});let U=Array.from(v).map(i=>r.questions.indexOf(i)+1);n?y.error({title:"Cannot create new question set!",content:"There are errors at questions: "+U.sort().join(", ")}):k()},k=()=>{y.confirm({title:"Create new quiz!",content:"Make sure to review your contents before proceeding.",centered:!0,onOk:async()=>{let n=await Z.Create(r);n.data.success&&p.success(n.data.data)}})},P=I(null),E=()=>{var n;(n=P.value)==null||n.openImportModal()},L=I(null),H=()=>{var n;(n=L.value)==null||n.openGenerateAIModal()},F=n=>{r.questions.push(...n),p.success(`Imported ${n.length} questions.`)};W((n,u,v)=>{y.confirm({title:"Leave already?",content:"You have unsaved changes.",onOk:()=>{v()},onCancel:()=>v(!1)})});function C(n){n.preventDefault(),n.returnValue=""}j(()=>{r.questions.push(...q),window.addEventListener("beforeunload",C)}),Y(()=>{window.removeEventListener("beforeunload",C)});const R={t:Q,formRef:e,formState:r,rules:O,componentMap:_,question_data_raw:q,tagContent:h,addTag:T,removeTag:a,createQuestionTemplate:m,onAddQuestion:M,onRemoveQuestion:V,onFinish:z,showModalConfirmation:k,importModalRef:P,onOpenImportModal:E,generateModalRef:L,openGenerateAIModal:H,onModalImport:F,handleBeforeUnload:C,Input:$,TextArea:ee,ImportQSModal:se,GenerateQSModal:re};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),le={class:"page-container"},de={class:"title-container"},ce={class:"content"},ue={class:"content-item"},me={class:"content-item-title"},pe={class:"d-flex"},ge={class:"form-item"},he={class:"tag-container"},fe=["onClick"],_e={class:"tag-inputter"},qe={class:"content-item"},ve={class:"content-item-title"},we={class:"content-item-buttons"},xe={class:"import-button"},Ie={class:"list-question-container"};function Se(l,o,Q,e,r,O){const _=S("RouterLink"),q=S("a-col"),h=S("a-row"),T=S("a-form");return f(),w(A,null,[t("div",le,[t("div",de,[c(h,{class:"w-100 d-flex align-items-center"},{default:g(()=>[c(q,{span:1},{default:g(()=>[c(_,{to:{name:"User_Library"}},{default:g(()=>o[4]||(o[4]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[4]})]),_:1}),c(q,{class:"main-title",span:23},{default:g(()=>[t("span",null,d(l.$t("create_QS.title")),1),o[5]||(o[5]=x()),o[6]||(o[6]=t("br",null,null,-1)),t("span",null,d(l.$t("create_QS.sub_title")),1)]),_:1,__:[5,6]})]),_:1})]),t("div",ce,[c(T,{layout:"vertical",modelValue:e.formState,"onUpdate:modelValue":o[3]||(o[3]=a=>e.formState=a),rules:e.rules,ref:"formRef"},{default:g(()=>[t("div",ue,[t("div",me,[t("div",null,[t("span",null,d(l.$t("create_QS.quiz.question_detail_title")),1),t("span",null,d(l.$t("create_QS.quiz.question_detail_sub_title")),1)])]),c(e.Input,{class:"question-input-item",modelValue:e.formState.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.formState.name=a),isRequired:!0,placeholder:e.t("question_sets_index.search_placeholder"),label:e.t("create_QS.quiz.title"),"max-length":100},null,8,["modelValue","placeholder","label"]),t("div",pe,[c(e.TextArea,{class:"question-input-item",modelValue:e.formState.description,"onUpdate:modelValue":o[1]||(o[1]=a=>e.formState.description=a),placeholder:"textarea with clear icon","max-length":250,label:e.t("create_QS.quiz.description")},null,8,["modelValue","label"]),t("div",ge,[t("label",null,d(l.$t("create_QS.quiz.tag")),1),t("div",he,[(f(!0),w(A,null,D(e.formState.tags,(a,m)=>(f(),w("div",{class:"tag-item",key:m},[x(d(a)+" ",1),t("i",{class:"bx bx-x",onClick:M=>e.removeTag(m)},null,8,fe)]))),128))]),t("div",_e,[c(e.Input,{modelValue:e.tagContent,"onUpdate:modelValue":o[2]||(o[2]=a=>e.tagContent=a),placeholder:e.t("question_sets_index.search_placeholder"),"max-length":50},{icon:g(()=>o[7]||(o[7]=[t("i",{class:"bx bx-purchase-tag-alt"},null,-1)])),_:1},8,["modelValue","placeholder"]),t("i",{class:"bx bx-plus tag-inputter-button",onClick:e.addTag})])])])]),t("div",qe,[t("div",ve,[t("div",null,[t("span",null,d(l.$t("create_QS.quiz.question_question_title")),1),t("span",null,d(l.$t("create_QS.quiz.question_question_sub_title")),1)]),t("div",we,[c(_,{onClick:e.onOpenImportModal,class:"import-button",to:{name:""}},{default:g(()=>[x(d(l.$t("create_QS.buttons.import"))+" ",1),o[8]||(o[8]=t("i",{class:"bx bx-download"},null,-1))]),_:1,__:[8]}),c(_,{onClick:e.openGenerateAIModal,class:"import-button",to:{name:""}},{default:g(()=>[x(d(l.$t("create_QS.buttons.generated_by_ai"))+" ",1),o[9]||(o[9]=t("i",{class:"bx bx-upload"},null,-1))]),_:1,__:[9]}),t("div",{class:"import-button",onClick:e.onFinish},d(l.$t("create_QS.buttons.create")),1),t("div",xe,d(l.$t("create_QS.quiz.total",{number:e.formState.questions.length.toString().padStart(3,"0")})),1)])]),t("div",Ie,[(f(!0),w(A,null,D(e.formState.questions,(a,m)=>(f(),w("div",{key:a.id},[(f(),X(K(e.componentMap[a.type]),{question:a,index:m+1,displayScore:!1,onDeleteQuestion:M=>e.onRemoveQuestion(m)},null,40,["question","index","onDeleteQuestion"]))]))),128)),t("div",{class:"add-question-btn",onClick:e.onAddQuestion},[o[10]||(o[10]=t("i",{class:"bx bx-plus"},null,-1)),x(" "+d(l.$t("create_QS.buttons.add_question")),1)])])])]),_:1},8,["modelValue"])])]),c(e.ImportQSModal,{ref:"importModalRef",title:e.formState.name,onImport:e.onModalImport},null,8,["title"]),c(e.GenerateQSModal,{ref:"generateModalRef",title:e.formState.name,onImport:e.onModalImport},null,8,["title"])],64)}const Le=J(ae,[["render",Se],["__scopeId","data-v-b7d6bbaa"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/question_sets/create.vue"]]);export{Le as default};
