import{d as F,u as G,i as b,j as U,X as N,Y as B,s as J,k as g,Q as C,M as Q,_ as j,r as T,a as X,o as O,b as n,c as d,w as h,f as I,t as m,E as L,N as Y,F as K}from"./index-BhCEM7Qr.js";import{A as Z}from"./ApiTestTemplate-GdvjRZpe.js";import{I as $}from"./Input-pAeduOdR.js";import{T as ee}from"./TextArea-WM5cwCwM.js";import{S as te,O as oe,M as ne,a as re,s as ie,b as se}from"./vue-virtual-scroller.esm-7uu7mpKW.js";import{G as ae,I as le}from"./GenerateQSModal-DsgyAhI_.js";import{Q as S}from"./questionTypes-CS3lcRlq.js";/* empty css                                                                 */import"./vue-draggable-plus-CRg8kvXS.js";import"./languages-DtYW231W.js";const ce=F({__name:"create",setup(c,{expose:a}){a();const{t:o}=G(),t=b(),r=U({name:"",description:"",questions:[]}),k={title:[{required:"true",message:o("message.required"),trigger:"change"},{length:100,message:o("message.out_of_range",{max_length:100}),trigger:"change"}],description:[{length:200,message:o("message.out_of_range",{max_length:100}),trigger:"change"}],questions:[{validator:(e,l)=>l&&l.length>500?Promise.reject(o("message.maximum_tag.limit_question",{number:500})):Promise.resolve(),trigger:"change"}]},f={MultipleChoice:re,Matching:ne,Ordering:oe,ShortText:te},_=[{id:"q1",type:"MultipleChoice",questionText:"What is the capital of France ?",questionHTML:"<p><strong>What</strong> is <br/> the <em>capital</em> of <u>France</u>? <code>// geography</code></p>",explainText:"Paris is the capital city of France.",score:20,multipleChoices:[{id:"1",text:"Paris",isAnswer:!0},{id:"2",text:"London",isAnswer:!1},{id:"3",text:"Berlin",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q2",type:"Matching",questionText:"Match the countries to their capitals.",questionHTML:"<p><u>Match</u> the <strong>countries</strong> to their <em>capitals</em>. <code>// matching task</code></p>",explainText:"Each country must be paired with its capital.",score:10,multipleChoices:[],matchingPairs:[{id:"1",leftItem:"Japan",rightItem:"Tokyo"},{id:"2",leftItem:"Italy",rightItem:"Rome"},{id:"3",leftItem:"Vietnam",rightItem:"Hanoi"}],orderingItems:[],shortAnswer:""},{id:"q3",type:"Ordering",questionText:"Arrange the steps of the water cycle in the correct order.",questionHTML:"<p><strong>Arrange</strong> the steps of the <u>water cycle</u> in the <em>correct order</em>. <code>// science</code></p>",explainText:"The correct order is: Evaporation → Condensation → Precipitation → Collection.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[{id:"1",text:"Evaporation",correctOrder:0},{id:"2",text:"Condensation",correctOrder:1},{id:"3",text:"Precipitation",correctOrder:2},{id:"4",text:"Collection",correctOrder:3}],shortAnswer:""},{id:"q4",type:"ShortText",questionText:"What is the chemical symbol for water?",questionHTML:"<p><em>What</em> is the chemical <strong>symbol</strong> for <u>water</u>? <code>H2O</code></p>",explainText:"H2O is the formula for water.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[],shortAnswer:"H2O"},{id:"q5",type:"MultipleChoice",questionText:"Which planet is known as the Red Planet?",questionHTML:"<p>Which <strong>planet</strong> is known as the <em>Red Planet</em>? <u>Mars</u> <pre><code>// astronomy</code></pre></p>",explainText:"Mars is often called the Red Planet due to its reddish appearance.",score:30,multipleChoices:[{id:"1",text:"Mars",isAnswer:!0},{id:"2",text:"Venus",isAnswer:!1},{id:"3",text:"Jupiter",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q6",type:"MultipleChoice",questionText:"Which language is primarily used for web development?",questionHTML:"<p>Which <strong>language</strong> is primarily used for <em>web development</em>? <code>// programming</code></p>",explainText:"JavaScript is the most commonly used language for web development.",score:20,multipleChoices:[{id:"1",text:"JavaScript",isAnswer:!0},{id:"2",text:"Python",isAnswer:!1},{id:"3",text:"C++",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q7",type:"Matching",questionText:"Match the authors to their famous works.",questionHTML:"<p>Match the <strong>authors</strong> to their <em>famous works</em>. <code>// literature</code></p>",explainText:"Each author is known for a specific famous book.",score:15,multipleChoices:[],matchingPairs:[{id:"1",leftItem:"George Orwell",rightItem:"1984"},{id:"2",leftItem:"J.K. Rowling",rightItem:"Harry Potter"},{id:"3",leftItem:"Leo Tolstoy",rightItem:"War and Peace"}],orderingItems:[],shortAnswer:""},{id:"q8",type:"Ordering",questionText:"Arrange the historical periods in chronological order.",questionHTML:"<p><strong>Arrange</strong> the <em>historical periods</em> in <u>chronological</u> order. <code>// history</code></p>",explainText:"The order is: Ancient → Medieval → Renaissance → Modern.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[{id:"1",text:"Ancient",correctOrder:0},{id:"2",text:"Medieval",correctOrder:1},{id:"3",text:"Renaissance",correctOrder:2},{id:"4",text:"Modern",correctOrder:3}],shortAnswer:""},{id:"q9",type:"ShortText",questionText:"What is the square root of 144?",questionHTML:"<p>What is the <strong>square root</strong> of <em>144</em>? <code>// math</code></p>",explainText:"The square root of 144 is 12.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[],shortAnswer:"12"},{id:"q10",type:"MultipleChoice",questionText:"Which gas do plants absorb from the atmosphere?",questionHTML:"<p>Which <strong>gas</strong> do <u>plants</u> absorb from the <em>atmosphere</em>? <code>// biology</code></p>",explainText:"Plants absorb carbon dioxide (CO₂) during photosynthesis.",score:20,multipleChoices:[{id:"1",text:"Oxygen",isAnswer:!1},{id:"2",text:"Carbon Dioxide",isAnswer:!0},{id:"3",text:"Nitrogen",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""}],q=()=>({id:Date.now().toString(),type:"MultipleChoice",questionText:"",questionHTML:"",explainText:"",score:10,multipleChoices:[{id:(Date.now()+1).toString(),text:"",isAnswer:!0},{id:(Date.now()+2).toString(),text:"",isAnswer:!1},{id:(Date.now()+3).toString(),text:"",isAnswer:!1},{id:(Date.now()+4).toString(),text:"",isAnswer:!1}],matchingPairs:[{id:(Date.now()+1).toString(),leftItem:"",rightItem:""},{id:(Date.now()+2).toString(),leftItem:"",rightItem:""}],orderingItems:[{id:(Date.now()+1).toString(),text:"",correctOrder:0},{id:(Date.now()+2).toString(),text:"",correctOrder:1},{id:(Date.now()+3).toString(),text:"",correctOrder:2},{id:(Date.now()+4).toString(),text:"",correctOrder:3}],shortAnswer:""}),v=()=>{if(r.questions.length>=500){g.warning(o("message.limit_question",{number:500}));return}r.questions=[...r.questions,q()],C(()=>{var e,l;(l=(e=w.value)==null?void 0:e.forceUpdate)==null||l.call(e),C(()=>{const p=r.questions.length;requestAnimationFrame(()=>{var A;(A=w.value)==null||A.scrollToItem(p)})})})},u=e=>{if(r.questions.length<=1){g.warning(o("message.minimum_question",{number:1}));return}r.questions=[...r.questions.slice(0,e),...r.questions.slice(e+1)]},x=()=>{let e=!1,l=o("message.invalid_question"),p=new Set;if(r.name.trim().length>100||r.name.trim().length===0){e=!0,l=o("message.invalid_title"),g.error(l);return}if(r.description.trim().length>250){e=!0,l=o("message.invalid_description"),g.error(l);return}[r.questions.filter(i=>{const s=i.questionText.replace(/^<p>/,"").replace(/<\/p>$/,"").trim();return s.length===0||s.length>=500}),r.questions.filter(i=>i.explainText.replace(/^<p>/,"").replace(/<\/p>$/,"").trim().length>=500),r.questions.filter(i=>i.type===S.MULTIPLE_CHOICE&&(i.multipleChoices.some(s=>s.text.trim().length===0||s.text.trim().length>500)||i.multipleChoices.filter(s=>s.isAnswer).length===0)),r.questions.filter(i=>i.type===S.MATCHING&&(i.matchingPairs.some(s=>s.leftItem.trim().length===0||s.leftItem.trim().length>500)||i.matchingPairs.some(s=>s.rightItem.trim().length===0||s.rightItem.trim().length>500))),r.questions.filter(i=>i.type===S.ORDERING&&i.orderingItems.some(s=>s.text.trim().length===0||s.text.trim().length>500)),r.questions.filter(i=>i.type===S.SHORT_TEXT&&(i.shortAnswer.trim().length===0||i.shortAnswer.trim().length>500))].forEach(i=>{i.length>0&&(e=!0,i.forEach(s=>p.add(s)))});let V=Array.from(p).map(i=>r.questions.indexOf(i)+1);e?Q.error({title:o("create_QS.modal.invalid.title"),content:o("create_QS.modal.invalid.content")+V.sort().join(", "),okText:o("sidebar.buttons.ok"),cancelText:o("sidebar.buttons.cancel")}):M()},M=()=>{Q.confirm({title:o("create_template.modal.valid.title"),content:o("create_QS.modal.valid.content"),okText:o("sidebar.buttons.ok"),cancelText:o("sidebar.buttons.cancel"),centered:!0,onOk:async()=>{(await Z.Create(r)).data.success&&g.success(o("message.created_successfully"))}})},P=b(null),H=()=>{var e;(e=P.value)==null||e.openImportModal()},R=b(null),z=()=>{var e;(e=R.value)==null||e.openGenerateAIModal()},E=e=>{r.questions.push(...e.map((l,p)=>({...l,id:`new_${r.questions.length+p}`}))),g.success(`${o("message.imported_question",{number:e.length})}`)};N((e,l,p)=>{Q.confirm({title:o("create_QS.modal.leave.title"),content:o("create_QS.modal.leave.content"),okText:o("sidebar.buttons.ok"),cancelText:o("sidebar.buttons.cancel"),onOk:()=>{p()},onCancel:()=>p(!1)})});function y(e){e.preventDefault(),e.returnValue=""}B(()=>{window.removeEventListener("beforeunload",y)});const w=b(null),W=()=>{C(()=>{var e,l;(l=(e=w.value)==null?void 0:e.forceUpdate)==null||l.call(e)})};J(()=>{r.questions.push(..._),window.addEventListener("beforeunload",y)});const D={t:o,formRef:t,formState:r,rules:k,componentMap:f,question_data_raw:_,createQuestionTemplate:q,onAddQuestion:v,onRemoveQuestion:u,onFinish:x,showModalConfirmation:M,importModalRef:P,onOpenImportModal:H,generateModalRef:R,openGenerateAIModal:z,onModalImport:E,handleBeforeUnload:y,scrollerRef:w,handleScroll:W,Input:$,TextArea:ee,ImportQSModal:le,GenerateQSModal:ae,get DynamicScroller(){return se},get DynamicScrollerItem(){return ie}};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),de={class:"page-container"},me={class:"title-container"},ue={class:"content"},pe={class:"content-item"},he={class:"content-item-title"},ge={class:"d-flex"},fe={class:"content-item"},_e={class:"content-item-title"},qe={class:"content-item-buttons"},xe={class:"import-button"};function we(c,a,o,t,r,k){const f=T("RouterLink"),_=T("a-col"),q=T("a-row"),v=T("a-form");return O(),X(K,null,[n("div",de,[n("div",me,[d(q,{class:"w-100 d-flex align-items-center"},{default:h(()=>[d(_,{span:1},{default:h(()=>[d(f,{to:{name:"User_TestTemplate"}},{default:h(()=>a[2]||(a[2]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[2]})]),_:1}),d(_,{class:"main-title",span:23},{default:h(()=>[n("span",null,m(c.$t("create_template.title")),1),a[3]||(a[3]=I()),a[4]||(a[4]=n("br",null,null,-1)),n("span",null,m(c.$t("create_QS.sub_title")),1)]),_:1,__:[3,4]})]),_:1})]),n("div",ue,[d(v,{layout:"vertical",model:t.formState,rules:t.rules,ref:"formRef"},{default:h(()=>[n("div",pe,[n("div",he,[n("div",null,[n("span",null,m(c.$t("create_QS.quiz.question_detail_title")),1),n("span",null,m(c.$t("create_QS.quiz.question_detail_sub_title")),1)])]),d(t.Input,{class:"question-input-item",modelValue:t.formState.name,"onUpdate:modelValue":a[0]||(a[0]=u=>t.formState.name=u),isRequired:!0,placeholder:t.t("question_sets_index.search_placeholder"),label:t.t("create_QS.quiz.title"),"max-length":100},null,8,["modelValue","placeholder","label"]),n("div",ge,[d(t.TextArea,{class:"question-input-item",modelValue:t.formState.description,"onUpdate:modelValue":a[1]||(a[1]=u=>t.formState.description=u),placeholder:"textarea with clear icon","max-length":250,label:t.t("create_QS.quiz.description")},null,8,["modelValue","label"])])]),n("div",fe,[n("div",_e,[n("div",null,[n("span",null,m(c.$t("create_QS.quiz.question_question_title")),1),n("span",null,m(c.$t("create_QS.quiz.question_question_sub_title")),1)]),n("div",qe,[d(f,{onClick:t.onOpenImportModal,class:"import-button",to:{name:""}},{default:h(()=>[I(m(c.$t("create_QS.buttons.import"))+" ",1),a[5]||(a[5]=n("i",{class:"bx bx-download"},null,-1))]),_:1,__:[5]}),d(f,{onClick:t.openGenerateAIModal,class:"import-button",to:{name:""}},{default:h(()=>[I(m(c.$t("create_QS.buttons.generated_by_ai"))+" ",1),a[6]||(a[6]=n("i",{class:"bx bx-upload"},null,-1))]),_:1,__:[6]}),n("div",{class:"import-button",onClick:t.onFinish},m(c.$t("create_QS.buttons.create")),1),n("div",xe,m(c.$t("create_QS.quiz.total",{number:t.formState.questions.length.toString().padStart(3,"0")})),1)])]),d(t.DynamicScroller,{ref:"scrollerRef",class:"scroller","key-field":"id",items:t.formState.questions,"min-item-size":650,buffer:800,prerender:10,onScroll:t.handleScroll},{default:h(({item:u,index:x})=>[(O(),L(t.DynamicScrollerItem,{item:u,key:u.id},{default:h(()=>[(O(),L(Y(t.componentMap[u.type]),{question:u,index:x+1,displayScore:!1,onDeleteQuestion:M=>t.onRemoveQuestion(x)},null,40,["question","index","onDeleteQuestion"]))]),_:2},1032,["item"]))]),_:1},8,["items"]),n("div",{class:"add-question-btn",onClick:t.onAddQuestion},[a[7]||(a[7]=n("i",{class:"bx bx-plus"},null,-1)),I(" "+m(c.$t("create_QS.buttons.add_question")),1)])])]),_:1},8,["model"])])]),d(t.ImportQSModal,{ref:"importModalRef",title:t.formState.name,onImport:t.onModalImport},null,8,["title"]),d(t.GenerateQSModal,{ref:"generateModalRef",title:t.formState.name,onImport:t.onModalImport},null,8,["title"])],64)}const Oe=j(ce,[["render",we],["__scopeId","data-v-6115bf3d"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/test_template/create.vue"]]);export{Oe as default};
