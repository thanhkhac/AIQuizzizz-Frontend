import{d as se,u as ae,q as ne,l as ie,i as m,z as oe,s as le,D as re,R as de,k as U,M as ce,S as ue,_ as _e,r as p,c as l,o as a,b as t,C as G,e as y,a as r,w as u,f as v,t as i,F as h,B as k}from"./index-CW61C-sU.js";import{u as me}from"./user-zaK1_Zi8.js";import{A as R}from"./ApiQuestionSet-CDEyOKmc.js";import{Q as E}from"./questionTypes-CS3lcRlq.js";import{I as ve}from"./Input-BFv57ikI.js";import{T as ge}from"./TransferQuestionData-BxcXdBjq.js";import{V as fe}from"./Validator-CWeiTIFe.js";import{S as pe}from"./ShareModal-JknK7q_m.js";import{V as ye}from"./visibility-PZlBDoOn.js";import"./ApiClass-uzTGsytZ.js";import"./ApiTestTemplate-gD2fVfq3.js";import"./ApiFolder-DK1eqV3i.js";const be=se({__name:"detail",setup(_,{expose:s}){s();const{t:g}=ae(),e=ne(),f=ie(),M=m(!1),q=m(e.params.id),d=m({id:"",name:"",description:"",totalQuestionCount:0,completedQuestionCount:0,ratingCount:0,ratingAverage:0,createBy:"",createdAt:"",createdById:"",tags:[],lastAccessByMe:"",visibilityMode:""}),I=m([]),S=m([]),L=["All",E.MULTIPLE_CHOICE,E.MATCHING,E.ORDERING,E.SHORT_TEXT],O=oe(()=>L.map(o=>({label:g(`create_QS.type.${o}`),value:o}))),x=m(O.value[0].value),V=m(""),Q=async()=>{var o,b;try{M.value=!0,fe.isValidGuid(q.value.toString())||f.push({name:"404"});const T=await R.GetDetailById(q.value.toString()),w=await R.GetQuestionById(q.value.toString());(!T.data.success||!w.data.success)&&f.push({name:"User_Library"}),d.value=T.data.data,d.value.createBy=T.data.data.createdBy.fullName,I.value=w.data.data.map(te=>ge.transformResponseToRequest(te)),S.value=I.value,await P(),await re()}catch(T){de.QUESTION_SET_NOT_FOUND in(((b=(o=T.response)==null?void 0:o.data)==null?void 0:b.errors)||{})&&f.push({name:"404"})}finally{M.value=!1}},A=(o,b)=>{$(b).toggleClass("bx-chevron-up bx-chevron-down");const w=$(`#question-item-answer-${o}`);w&&$(w).slideToggle()},n=m(null),C=()=>{var o;(o=n.value)==null||o.openModal()},c=o=>{d.value.visibilityMode=o},z=m(null),F=()=>{var o;(o=z.value)==null||o.openModal()},j=()=>{f.push({name:"User_QuestionSet_Learn",params:{id:d.value.id}})},X=()=>{f.push({name:"User_QuestionSet_Test",params:{id:d.value.id}})},J=()=>{f.push({name:"User_QuestionSet_Update",params:{id:d.value.id}})},B=m(!1),N=m(0),D=async()=>{const o=await R.GetRating(d.value.id);o.data.success&&(N.value=o.data.data.rating)},K=async()=>{(await R.UpdateRating(d.value.id,{questionSetId:d.value.id,rating:N.value})).data.success?(U.success(g("message.updated_successfully")),B.value=!1,await Q()):U.error(g("message.updated_failed"))},Y=m({canEdit:!1,canDelete:!1}),P=async()=>{const o=await R.GetPermissions(d.value.id);o.data.success&&(Y.value=o.data.data)},W=()=>{ce.confirm({title:g("detail_QS.modal.delete_title"),content:g("detail_QS.modal.delete_content"),okText:g("sidebar.buttons.ok"),cancelText:g("sidebar.buttons.cancel"),onOk:async()=>{if(!(await R.Delete(d.value.id)).data.success){U.error(g("message.deleted_failed"));return}U.success(g("message.deleted_successfully")),f.push({name:"User_Library"})}})},Z=o=>{const b=[o];sessionStorage.setItem("selected_tags",JSON.stringify(b)),f.push({name:"User_QuestionSet_Search"})},ee=()=>{let o=I.value;o=I.value.filter(b=>{const T=b.questionText.includes(V.value),w=x.value==="All"||x.value===b.type;return T&&w}),S.value=o};le(async()=>{await Q(),D()});const H={t:g,route:e,router:f,loading:M,question_set_id:q,quiz:d,quiz_questions:I,questions:S,optionKeys:L,question_type_options:O,selected_type_option:x,searchValue:V,getData:Q,toggleDisplayAnswer:A,shareModalRef:n,onOpenShareModal:C,onUpdateVisibility:c,shareClassModalRef:z,onOpenShareClassModal:F,onRedirectToLearn:j,onRedirectToTest:X,onRedirectToEdit:J,modal_rate_open:B,rateValue:N,getRating:D,updateRating:K,permission:Y,getPermission:P,onDelete:W,onRedirectToSearch:Z,onFilter:ee,get user_image(){return me},get QUESTION_TYPE(){return E},Input:ve,get dayjs(){return ue},ShareModal:pe,get VISIBILITY(){return ye}};return Object.defineProperty(H,"__isScriptSetup",{enumerable:!1,value:!0}),H}}),he={class:"content"},Ie={class:"content-item"},Te={key:0},Se={key:1},we={class:"content-item-title"},ke={key:0,class:"d-flex flex-row align-items-center quiz-header-functions"},qe={class:"quiz-info"},xe={class:"quiz-tag-container"},Ce=["onClick"],ze={key:0,class:"quiz-credit"},Re={class:"share-btn-container"},Qe={class:"share-btn-container"},Ee={class:"action-container"},Me={class:"credit-user"},Le=["src"],Oe={class:"credit-user-info"},Ve={class:"d-flex"},Ue={class:"content-item"},Ae={class:"content-item-title"},Ne={class:"content-item-functions"},Be={style:{width:"300px",padding:"0"}},De={key:0},Ye={key:1,class:"preview-question-container"},Pe={class:"preview-question-item"},He={class:"question-item-content"},Ge={class:"d-flex pb-2"},Fe={class:"question-index"},je=["innerHTML"],Xe={key:1,class:"question-text"},Je=["id"],Ke={key:0,class:"multiple-choice-answer"},We={key:0,class:"text-success"},Ze={class:"pair-answer"},$e={class:"pair-answer-item"},et={class:"pair-answer-item"},tt={key:2,class:"ordering-answer"},st={class:"ordering-answer-item"},at={class:"ordering-answer-item"},nt={class:"ordering-answer-item"},it={class:"short-text-answer"},ot={class:"question-item-toogle-btn"},lt=["onClick"],rt={class:"title-container"},dt={class:"modal-rate-container"};function ct(_,s,g,e,f,M){const q=p("RouterLink"),d=p("a-skeleton"),I=p("a-tooltip"),S=p("a-button"),L=p("a-select-option"),O=p("a-select"),x=p("a-col"),V=p("a-row"),Q=p("a-rate"),A=p("a-modal");return a(),l(h,null,[t("div",he,[r(q,{class:"navigator-back-link d-flex align-items-center p-2",to:{name:"User_Library"}},{default:u(()=>[s[5]||(s[5]=t("i",{class:"me-1 bx bx-chevron-left"},null,-1)),v(" "+i(_.$t("detail_QS.other.library")),1)]),_:1,__:[5]}),t("div",Ie,[e.loading?(a(),l("div",Te,[r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"])])):(a(),l("div",Se,[t("div",we,[t("div",null,[t("span",null,i(e.quiz.name),1),t("span",null,i(e.quiz.description),1)]),e.permission.canEdit||e.permission.canDelete?(a(),l("div",ke,[r(I,null,{title:u(()=>[v(i(_.$t("question_sets_index.buttons.edit")),1)]),default:u(()=>[e.permission.canEdit?(a(),l("i",{key:0,class:"me-3 bx bx-edit",onClick:e.onRedirectToEdit})):y("v-if",!0)]),_:1}),r(I,null,{title:u(()=>[v(i(_.$t("question_sets_index.buttons.delete")),1)]),default:u(()=>[e.permission.canDelete?(a(),l("i",{key:0,class:"text-danger bx bx-trash-alt",onClick:e.onDelete})):y("v-if",!0)]),_:1})])):y("v-if",!0)]),t("div",qe,[t("div",{class:"quiz-rating",onClick:s[0]||(s[0]=n=>e.modal_rate_open=!0)},i(e.quiz.ratingAverage)+" ⭐️ ("+i(e.quiz.ratingCount)+" "+i(_.$t("detail_QS.other.reviews"))+") ",1),t("div",xe,[(a(!0),l(h,null,k(e.quiz.tags,n=>(a(),l("div",{class:"quiz-tag-item",onClick:C=>e.onRedirectToSearch(n)},i(n.name),9,Ce))),256))])]),e.permission.canDelete?(a(),l("div",ze,[t("div",Re,[r(S,{type:"primary",class:"me-3 main-color-btn share-btn",size:"large",onClick:e.onOpenShareClassModal},{default:u(()=>[s[6]||(s[6]=t("i",{class:"bx bx-share-alt"},null,-1)),v(" "+i(_.$t("detail_QS.buttons.share_class")),1)]),_:1,__:[6]})]),t("div",Qe,[r(S,{type:"primary",class:"main-color-btn share-btn",size:"large",onClick:e.onOpenShareModal},{default:u(()=>[s[7]||(s[7]=t("i",{class:"bx bx-share-alt"},null,-1)),v(" "+i(_.$t("detail_QS.buttons.share_quiz")),1)]),_:1,__:[7]})])])):y("v-if",!0),t("div",Ee,[t("div",Me,[t("img",{class:"user-image",src:e.user_image,alt:""},null,8,Le),t("div",Oe,[t("span",null,i(_.$t("detail_QS.other.created_by",{username:e.quiz.createBy})),1),t("span",null,i(e.dayjs(e.quiz.createdAt).format("DD/MM/YYYY")),1)])]),t("div",Ve,[t("div",{class:"action-item",onClick:e.onRedirectToLearn},[v(i(_.$t("detail_QS.buttons.learn"))+" ",1),s[8]||(s[8]=t("i",{class:"bx bx-analyse"},null,-1))]),t("div",{class:"action-item",onClick:e.onRedirectToTest},[v(i(_.$t("detail_QS.buttons.test"))+" ",1),s[9]||(s[9]=t("i",{class:"bx bx-detail"},null,-1))])])])]))]),t("div",Ue,[t("div",Ae,[t("div",null,[t("span",null,i(_.$t("detail_QS.other.questions",{number:e.quiz_questions.length})),1)])]),t("div",Ne,[r(O,{class:"me-3",value:e.selected_type_option,"onUpdate:value":s[1]||(s[1]=n=>e.selected_type_option=n),style:{width:"200px"},onChange:e.onFilter},{default:u(()=>[(a(!0),l(h,null,k(e.question_type_options,n=>(a(),G(L,{value:n.value},{default:u(()=>[v(i(n.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",Be,[r(e.Input,{onInput:e.onFilter,modelValue:e.searchValue,"onUpdate:modelValue":s[2]||(s[2]=n=>e.searchValue=n),placeholder:e.t("question_sets_index.search_placeholder")},{icon:u(()=>s[10]||(s[10]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(a(),l("div",De,[r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"])])):(a(),l("div",Ye,[(a(!0),l(h,null,k(e.questions,(n,C)=>(a(),l("div",Pe,[t("div",He,[t("div",Ge,[t("div",Fe,i(C+1),1),n.questionHTML?(a(),l("div",{key:0,class:"question-html",innerHTML:n.questionHTML},null,8,je)):(a(),l("div",Xe,i(n.questionText),1))]),t("div",{class:"question-item-answer",id:`question-item-answer-${C}`,style:{display:"none"}},[n.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(a(),l("div",Ke,[t("ul",null,[(a(!0),l(h,null,k(n.multipleChoices,c=>(a(),l("li",null,[v(i(c.text)+" ",1),c.isAnswer?(a(),l("span",We," ("+i(c.isAnswer)+") ",1)):y("v-if",!0)]))),256))])])):y("v-if",!0),n.type===e.QUESTION_TYPE.MATCHING?(a(!0),l(h,{key:1},k(n.matchingPairs,c=>(a(),l("div",Ze,[t("span",$e,i(c.leftItem),1),s[11]||(s[11]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("span",et,i(c.rightItem),1)]))),256)):y("v-if",!0),n.type===e.QUESTION_TYPE.ORDERING?(a(),l("div",tt,[t("div",st,[(a(!0),l(h,null,k(n.orderingItems,c=>(a(),l("div",null,i(c.text),1))),256))]),s[12]||(s[12]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("div",at,[(a(!0),l(h,null,k(n.orderingItems.sort((c,z)=>c.correctOrder-z.correctOrder),(c,z)=>(a(),l("div",nt,[t("span",null,"#"+i(z+1),1),v(" - "+i(c.text),1)]))),256))])])):y("v-if",!0),n.type===e.QUESTION_TYPE.SHORT_TEXT?(a(),l(h,{key:3},[s[13]||(s[13]=t("span",null,"Answer:",-1)),t("div",it,i(n.shortAnswer),1)],64)):y("v-if",!0)],8,Je)]),t("div",ot,[t("i",{class:"bx bx-chevron-down",onClick:c=>e.toggleDisplayAnswer(C,c.currentTarget)},null,8,lt)])]))),256))])),s[14]||(s[14]=t("a",{href:"#top",class:"up-button"},[t("i",{class:"bx bx-up-arrow-alt"})],-1))])]),e.loading?y("v-if",!0):(a(),G(e.ShareModal,{key:0,ref:"shareModalRef",id:e.quiz.id,name:e.quiz.name,mode:"quiz",options:[e.VISIBILITY.PUBLIC,e.VISIBILITY.PRIVATE],visibility:e.quiz.visibilityMode},null,8,["id","name","options","visibility"])),r(e.ShareModal,{ref:"shareClassModalRef",id:e.quiz.id,name:e.quiz.name,mode:"quiz",options:[e.VISIBILITY.IN_CLASS],visibility:e.VISIBILITY.IN_CLASS},null,8,["id","name","options","visibility"]),r(A,{"wrap-class-name":"medium-modal",open:e.modal_rate_open},{footer:u(()=>[r(S,{type:"primary",class:"main-color-btn",onClick:e.updateRating},{default:u(()=>[v(i(_.$t("auth.buttons.send")),1)]),_:1})]),default:u(()=>[t("div",rt,[r(V,{class:"w-100 d-flex align-items-center justify-content-between"},{default:u(()=>[r(x,{span:1},{default:u(()=>[t("div",{onClick:s[3]||(s[3]=n=>e.modal_rate_open=!1)},s[15]||(s[15]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)]))]),_:1}),r(x,{class:"main-title",span:20},{default:u(()=>[t("span",null,i(_.$t("detail_QS.modal.rate_title")),1),s[16]||(s[16]=v()),s[17]||(s[17]=t("br",null,null,-1))]),_:1,__:[16,17]})]),_:1})]),t("div",dt,[r(Q,{value:e.rateValue,"onUpdate:value":s[4]||(s[4]=n=>e.rateValue=n),style:{"font-size":"40px"}},null,8,["value"])])]),_:1},8,["open"])],64)}const St=_e(be,[["render",ct],["__scopeId","data-v-307050af"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/question_sets/detail.vue"]]);export{St as default};
