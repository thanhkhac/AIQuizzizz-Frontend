import{d as U,u as G,l as N,i as b,j as B,X as J,Y as j,s as X,k as g,R as A,M as C,_ as Y,r as T,a as K,o as Q,b as n,c as d,w as h,f as S,t as m,E as H,N as Z,F as $}from"./index-DhrrK0Mu.js";import{A as ee}from"./ApiTestTemplate-C2cUjulG.js";import{I as te}from"./Input-BvI-y3AG.js";import{T as oe}from"./TextArea-CfE5AIa4.js";import{S as ne,O as re,M as ie,a as se,s as ae,b as le}from"./vue-virtual-scroller.esm-CYTKZvaH.js";import{G as ce,I as de}from"./GenerateQSModal-v77-P2ko.js";import{Q as I}from"./questionTypes-CS3lcRlq.js";/* empty css                                                                 */import"./vue-draggable-plus-CN4f4UR9.js";import"./languages-DtYW231W.js";const me=U({__name:"create",setup(c,{expose:a}){a();const{t:o}=G(),t=N(),O=b(),r=B({name:"",description:"",questions:[]}),f={title:[{required:"true",message:o("message.required"),trigger:"change"},{length:100,message:o("message.out_of_range",{max_length:100}),trigger:"change"}],description:[{length:200,message:o("message.out_of_range",{max_length:100}),trigger:"change"}],questions:[{validator:(e,l)=>l&&l.length>500?Promise.reject(o("message.maximum_tag.limit_question",{number:500})):Promise.resolve(),trigger:"change"}]},q={MultipleChoice:se,Matching:ie,Ordering:re,ShortText:ne},v=[{id:"q1",type:"MultipleChoice",questionText:"What is the capital of France ?",questionHTML:"<p><strong>What</strong> is <br/> the <em>capital</em> of <u>France</u>? <code>// geography</code></p>",explainText:"Paris is the capital city of France.",score:20,multipleChoices:[{id:"1",text:"Paris",isAnswer:!0},{id:"2",text:"London",isAnswer:!1},{id:"3",text:"Berlin",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q2",type:"Matching",questionText:"Match the countries to their capitals.",questionHTML:"<p><u>Match</u> the <strong>countries</strong> to their <em>capitals</em>. <code>// matching task</code></p>",explainText:"Each country must be paired with its capital.",score:10,multipleChoices:[],matchingPairs:[{id:"1",leftItem:"Japan",rightItem:"Tokyo"},{id:"2",leftItem:"Italy",rightItem:"Rome"},{id:"3",leftItem:"Vietnam",rightItem:"Hanoi"}],orderingItems:[],shortAnswer:""},{id:"q3",type:"Ordering",questionText:"Arrange the steps of the water cycle in the correct order.",questionHTML:"<p><strong>Arrange</strong> the steps of the <u>water cycle</u> in the <em>correct order</em>. <code>// science</code></p>",explainText:"The correct order is: Evaporation → Condensation → Precipitation → Collection.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[{id:"1",text:"Evaporation",correctOrder:0},{id:"2",text:"Condensation",correctOrder:1},{id:"3",text:"Precipitation",correctOrder:2},{id:"4",text:"Collection",correctOrder:3}],shortAnswer:""},{id:"q4",type:"ShortText",questionText:"What is the chemical symbol for water?",questionHTML:"<p><em>What</em> is the chemical <strong>symbol</strong> for <u>water</u>? <code>H2O</code></p>",explainText:"H2O is the formula for water.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[],shortAnswer:"H2O"},{id:"q5",type:"MultipleChoice",questionText:"Which planet is known as the Red Planet?",questionHTML:"<p>Which <strong>planet</strong> is known as the <em>Red Planet</em>? <u>Mars</u> <pre><code>// astronomy</code></pre></p>",explainText:"Mars is often called the Red Planet due to its reddish appearance.",score:30,multipleChoices:[{id:"1",text:"Mars",isAnswer:!0},{id:"2",text:"Venus",isAnswer:!1},{id:"3",text:"Jupiter",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q6",type:"MultipleChoice",questionText:"Which language is primarily used for web development?",questionHTML:"<p>Which <strong>language</strong> is primarily used for <em>web development</em>? <code>// programming</code></p>",explainText:"JavaScript is the most commonly used language for web development.",score:20,multipleChoices:[{id:"1",text:"JavaScript",isAnswer:!0},{id:"2",text:"Python",isAnswer:!1},{id:"3",text:"C++",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""},{id:"q7",type:"Matching",questionText:"Match the authors to their famous works.",questionHTML:"<p>Match the <strong>authors</strong> to their <em>famous works</em>. <code>// literature</code></p>",explainText:"Each author is known for a specific famous book.",score:15,multipleChoices:[],matchingPairs:[{id:"1",leftItem:"George Orwell",rightItem:"1984"},{id:"2",leftItem:"J.K. Rowling",rightItem:"Harry Potter"},{id:"3",leftItem:"Leo Tolstoy",rightItem:"War and Peace"}],orderingItems:[],shortAnswer:""},{id:"q8",type:"Ordering",questionText:"Arrange the historical periods in chronological order.",questionHTML:"<p><strong>Arrange</strong> the <em>historical periods</em> in <u>chronological</u> order. <code>// history</code></p>",explainText:"The order is: Ancient → Medieval → Renaissance → Modern.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[{id:"1",text:"Ancient",correctOrder:0},{id:"2",text:"Medieval",correctOrder:1},{id:"3",text:"Renaissance",correctOrder:2},{id:"4",text:"Modern",correctOrder:3}],shortAnswer:""},{id:"q9",type:"ShortText",questionText:"What is the square root of 144?",questionHTML:"<p>What is the <strong>square root</strong> of <em>144</em>? <code>// math</code></p>",explainText:"The square root of 144 is 12.",score:10,multipleChoices:[],matchingPairs:[],orderingItems:[],shortAnswer:"12"},{id:"q10",type:"MultipleChoice",questionText:"Which gas do plants absorb from the atmosphere?",questionHTML:"<p>Which <strong>gas</strong> do <u>plants</u> absorb from the <em>atmosphere</em>? <code>// biology</code></p>",explainText:"Plants absorb carbon dioxide (CO₂) during photosynthesis.",score:20,multipleChoices:[{id:"1",text:"Oxygen",isAnswer:!1},{id:"2",text:"Carbon Dioxide",isAnswer:!0},{id:"3",text:"Nitrogen",isAnswer:!1}],matchingPairs:[],orderingItems:[],shortAnswer:""}],_=()=>({id:Date.now().toString(),type:"MultipleChoice",questionText:"",questionHTML:"",explainText:"",score:10,multipleChoices:[{id:(Date.now()+1).toString(),text:"",isAnswer:!0},{id:(Date.now()+2).toString(),text:"",isAnswer:!1},{id:(Date.now()+3).toString(),text:"",isAnswer:!1},{id:(Date.now()+4).toString(),text:"",isAnswer:!1}],matchingPairs:[{id:(Date.now()+1).toString(),leftItem:"",rightItem:""},{id:(Date.now()+2).toString(),leftItem:"",rightItem:""}],orderingItems:[{id:(Date.now()+1).toString(),text:"",correctOrder:0},{id:(Date.now()+2).toString(),text:"",correctOrder:1},{id:(Date.now()+3).toString(),text:"",correctOrder:2},{id:(Date.now()+4).toString(),text:"",correctOrder:3}],shortAnswer:""}),u=()=>{if(r.questions.length>=500){g.warning(o("message.limit_question",{number:500}));return}r.questions=[...r.questions,_()],A(()=>{var e,l;(l=(e=w.value)==null?void 0:e.forceUpdate)==null||l.call(e),A(()=>{const p=r.questions.length;requestAnimationFrame(()=>{var y;(y=w.value)==null||y.scrollToItem(p)})})})},x=e=>{if(r.questions.length<=1){g.warning(o("message.minimum_question",{number:1}));return}r.questions=[...r.questions.slice(0,e),...r.questions.slice(e+1)]},k=()=>{let e=!1,l=o("message.invalid_question"),p=new Set;if(r.name.trim().length>100||r.name.trim().length===0){e=!0,l=o("message.invalid_title"),g.error(l);return}if(r.description.trim().length>250){e=!0,l=o("message.invalid_description"),g.error(l);return}[r.questions.filter(i=>{const s=i.questionText.replace(/^<p>/,"").replace(/<\/p>$/,"").trim();return s.length===0||s.length>=500}),r.questions.filter(i=>i.explainText.replace(/^<p>/,"").replace(/<\/p>$/,"").trim().length>=500),r.questions.filter(i=>i.type===I.MULTIPLE_CHOICE&&(i.multipleChoices.some(s=>s.text.trim().length===0||s.text.trim().length>500)||i.multipleChoices.filter(s=>s.isAnswer).length===0)),r.questions.filter(i=>i.type===I.MATCHING&&(i.matchingPairs.some(s=>s.leftItem.trim().length===0||s.leftItem.trim().length>500)||i.matchingPairs.some(s=>s.rightItem.trim().length===0||s.rightItem.trim().length>500))),r.questions.filter(i=>i.type===I.ORDERING&&i.orderingItems.some(s=>s.text.trim().length===0||s.text.trim().length>500)),r.questions.filter(i=>i.type===I.SHORT_TEXT&&(i.shortAnswer.trim().length===0||i.shortAnswer.trim().length>500))].forEach(i=>{i.length>0&&(e=!0,i.forEach(s=>p.add(s)))});let F=Array.from(p).map(i=>r.questions.indexOf(i)+1);e?C.error({title:o("create_QS.modal.invalid.title"),content:o("create_QS.modal.invalid.content")+F.sort().join(", "),okText:o("sidebar.buttons.ok"),cancelText:o("sidebar.buttons.cancel")}):P()},P=()=>{C.confirm({title:o("create_template.modal.valid.title"),content:o("create_QS.modal.valid.content"),okText:o("sidebar.buttons.ok"),cancelText:o("sidebar.buttons.cancel"),centered:!0,onOk:async()=>{let e=await ee.Create(r);e.data.success&&(g.success(o("message.created_successfully")),t.push({name:"User_TestTemplate_Detail",params:{id:e.data.data}}))}})},R=b(null),z=()=>{var e;(e=R.value)==null||e.openImportModal()},D=b(null),E=()=>{var e;(e=D.value)==null||e.openGenerateAIModal()},W=e=>{r.questions.push(...e.map((l,p)=>({...l,id:`new_${r.questions.length+p}`}))),g.success(`${o("message.imported_question",{number:e.length})}`)};J((e,l,p)=>{C.confirm({title:o("create_QS.modal.leave.title"),content:o("create_QS.modal.leave.content"),okText:o("sidebar.buttons.ok"),cancelText:o("sidebar.buttons.cancel"),onOk:()=>{p()},onCancel:()=>p(!1)})});function M(e){e.preventDefault(),e.returnValue=""}j(()=>{window.removeEventListener("beforeunload",M)});const w=b(null),V=()=>{A(()=>{var e,l;(l=(e=w.value)==null?void 0:e.forceUpdate)==null||l.call(e)})};X(()=>{r.questions.push(_()),window.addEventListener("beforeunload",M)});const L={t:o,router:t,formRef:O,formState:r,rules:f,componentMap:q,question_data_raw:v,createQuestionTemplate:_,onAddQuestion:u,onRemoveQuestion:x,onFinish:k,showModalConfirmation:P,importModalRef:R,onOpenImportModal:z,generateModalRef:D,openGenerateAIModal:E,onModalImport:W,handleBeforeUnload:M,scrollerRef:w,handleScroll:V,Input:te,TextArea:oe,ImportQSModal:de,GenerateQSModal:ce,get DynamicScroller(){return le},get DynamicScrollerItem(){return ae}};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}}),ue={class:"page-container"},pe={class:"title-container"},he={class:"content"},ge={class:"content-item"},fe={class:"content-item-title"},_e={class:"d-flex"},qe={class:"content-item"},xe={class:"content-item-title"},we={class:"content-item-buttons"},be={class:"import-button"};function Te(c,a,o,t,O,r){const f=T("RouterLink"),q=T("a-col"),v=T("a-row"),_=T("a-form");return Q(),K($,null,[n("div",ue,[n("div",pe,[d(v,{class:"w-100 d-flex align-items-center"},{default:h(()=>[d(q,{span:1},{default:h(()=>[d(f,{to:{name:"User_TestTemplate"}},{default:h(()=>a[2]||(a[2]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[2]})]),_:1}),d(q,{class:"main-title",span:23},{default:h(()=>[n("span",null,m(c.$t("create_template.title")),1),a[3]||(a[3]=S()),a[4]||(a[4]=n("br",null,null,-1)),n("span",null,m(c.$t("create_QS.sub_title")),1)]),_:1,__:[3,4]})]),_:1})]),n("div",he,[d(_,{layout:"vertical",model:t.formState,rules:t.rules,ref:"formRef"},{default:h(()=>[n("div",ge,[n("div",fe,[n("div",null,[n("span",null,m(c.$t("create_QS.quiz.question_detail_title")),1),n("span",null,m(c.$t("create_QS.quiz.question_detail_sub_title")),1)])]),d(t.Input,{class:"question-input-item",modelValue:t.formState.name,"onUpdate:modelValue":a[0]||(a[0]=u=>t.formState.name=u),isRequired:!0,placeholder:t.t("question_sets_index.search_placeholder"),label:t.t("create_QS.quiz.title"),"max-length":100},null,8,["modelValue","placeholder","label"]),n("div",_e,[d(t.TextArea,{class:"question-input-item",modelValue:t.formState.description,"onUpdate:modelValue":a[1]||(a[1]=u=>t.formState.description=u),placeholder:"textarea with clear icon","max-length":250,label:t.t("create_QS.quiz.description")},null,8,["modelValue","label"])])]),n("div",qe,[n("div",xe,[n("div",null,[n("span",null,m(c.$t("create_QS.quiz.question_question_title")),1),n("span",null,m(c.$t("create_QS.quiz.question_question_sub_title")),1)]),n("div",we,[d(f,{onClick:t.onOpenImportModal,class:"import-button",to:{name:""}},{default:h(()=>[S(m(c.$t("create_QS.buttons.import"))+" ",1),a[5]||(a[5]=n("i",{class:"bx bx-download"},null,-1))]),_:1,__:[5]}),d(f,{onClick:t.openGenerateAIModal,class:"import-button",to:{name:""}},{default:h(()=>[S(m(c.$t("create_QS.buttons.generated_by_ai"))+" ",1),a[6]||(a[6]=n("i",{class:"bx bx-upload"},null,-1))]),_:1,__:[6]}),n("div",{class:"import-button",onClick:t.onFinish},m(c.$t("create_QS.buttons.create")),1),n("div",be,m(c.$t("create_QS.quiz.total",{number:t.formState.questions.length.toString().padStart(3,"0")})),1)])]),d(t.DynamicScroller,{ref:"scrollerRef",class:"scroller","key-field":"id",items:t.formState.questions,"min-item-size":650,buffer:800,prerender:10,onScroll:t.handleScroll},{default:h(({item:u,index:x})=>[(Q(),H(t.DynamicScrollerItem,{item:u,key:u.id},{default:h(()=>[(Q(),H(Z(t.componentMap[u.type]),{question:u,index:x+1,displayScore:!1,onDeleteQuestion:k=>t.onRemoveQuestion(x)},null,40,["question","index","onDeleteQuestion"]))]),_:2},1032,["item"]))]),_:1},8,["items"]),n("div",{class:"add-question-btn",onClick:t.onAddQuestion},[a[7]||(a[7]=n("i",{class:"bx bx-plus"},null,-1)),S(" "+m(c.$t("create_QS.buttons.add_question")),1)])])]),_:1},8,["model"])])]),d(t.ImportQSModal,{ref:"importModalRef",title:t.formState.name,"number-of-question":t.formState.questions.length,onImport:t.onModalImport},null,8,["title","number-of-question"]),d(t.GenerateQSModal,{ref:"generateModalRef",title:t.formState.name,onImport:t.onModalImport,"number-of-question":t.formState.questions.length},null,8,["title","number-of-question"])],64)}const Pe=Y(me,[["render",Te],["__scopeId","data-v-6115bf3d"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/test_template/create.vue"]]);export{Pe as default};
