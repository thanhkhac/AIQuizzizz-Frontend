var j=Object.defineProperty;var U=(l,a,i)=>a in l?j(l,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[a]=i;var A=(l,a,i)=>U(l,typeof a!="symbol"?a+"":a,i);import{J as G,d as M,q as J,l as Y,u as K,B as X,i as f,j as D,C as E,s as H,_ as W,r as v,a as m,o as d,b as e,c as _,w as g,f as S,t as r,F as q,D as k,E as Z,e as O,p as $}from"./index-KxB5OZZe.js";import{A as ee}from"./ApiQuestionSet-3u2-Mit_.js";import{Q as te}from"./questionSetSortCate-BudA85fH.js";/* empty css                                                                 */import{I as ae}from"./Input-Bom7uKgt.js";/* empty css                                                              */const se={GET_ALL_BY_LIMIT:"Tag"};class ne{constructor(){A(this,"GetAllByLimit",async a=>await G.get(`${se.GET_ALL_BY_LIMIT}`,{params:{name:a.name,pageSize:a.pageSize}}))}}const oe=new ne,le=M({__name:"search",setup(l,{expose:a}){var R;a();const i=J(),t=Y(),{t:w}=K(),N=Object.values(te),z=X(()=>N.map(o=>({label:w(`question_sets_search.sort_category.${o}`),value:o}))),y=f(!1),I=f([]),s=D({pageNumber:i.query.pageNumber||1,pageSize:i.query.pageSize||10,name:((R=i.query.name)==null?void 0:R.toString())||"",sortBy:i.query.sortBy||z.value[0].value,tagIds:i.query.tags?i.query.tags.toString().split(","):[],totalCount:0,statusFilter:!1}),h=async()=>{try{y.value=!0;let o=await ee.GetPublicByLimit(s);if(o.data.success){let c=o.data.data;I.value=c.items,s.pageNumber=c.pageNumber,s.pageSize=c.pageSize,s.totalCount=c.totalCount,s.statusFilter&&(s.pageNumber>c.totalPages&&s.totalCount>0?(s.pageNumber=1,t.push({name:"User_QuestionSet_Search",query:{pageNumber:1,pageSize:s.pageSize,name:s.name,sortBy:s.sortBy,tagIds:s.tagIds.join(",")}})):t.push({name:"User_QuestionSet_Search",query:{pageNumber:s.pageNumber,pageSize:s.pageSize,name:s.name,sortBy:s.sortBy,tagIds:s.tagIds.join(",")}}),s.statusFilter=!s.statusFilter)}}catch(o){console.log("ERROR: GETALLEXAMBYLIMIT search qs: "+o)}finally{y.value=!1}};E(()=>Object.keys(i.query).length,()=>{var o;s.pageNumber=i.query.pageNumber||1,s.pageSize=i.query.pageSize||10,s.name=((o=i.query.name)==null?void 0:o.toString())||"",s.sortBy=i.query.sortBy||z.value[0].value,s.tagIds=i.query.tags?i.query.tags.toString().split(","):u.value.map(c=>c.id),s.statusFilter=!0,h()});const T=(o,c)=>{s.pageNumber=o,s.pageSize=c,s.statusFilter=!0,h()},u=f([]),b=f([]),C=()=>{const o=sessionStorage.getItem("selected_tags");o&&u.value.push(...JSON.parse(o)),s.tagIds=u.value.map(c=>c.id)},n=D({name:"",pageSize:10}),p=async()=>{const o=await oe.GetAllByLimit(n);o.data.success&&(b.value=o.data.data,B.value=o.data.data)},P=o=>{u.value.map(c=>c.id).includes(o.id)||u.value.push(o),sessionStorage.setItem("selected_tags",JSON.stringify(u.value))},F=o=>{u.value.splice(o,1),sessionStorage.setItem("selected_tags",JSON.stringify(u.value))};E(()=>u.value.length,()=>{s.tagIds=u.value.map(o=>o.id),h()});const Q=f(null),B=f([]);function L(o){var c;!n.name||!((c=Q.value)!=null&&c.contains(o.target))?b.value=[]:b.value=[...B.value]}const V=o=>{t.push({name:"User_QuestionSet_Detail",params:{id:o}})};H(async()=>{document.addEventListener("click",L),C(),await h()});const x={route:i,router:t,t:w,optionKeys:N,sort_options:z,loading:y,quiz_data:I,pageParams:s,getData:h,onPaginationChange:T,selectedTags:u,tag_search_data:b,getSessionSelectedTag:C,searchTagPageParams:n,getSearchTagData:p,addTag:P,removeTag:F,searchResultRef:Q,lastSearchResult:B,handleMouseClickOutside:L,onRedirectToDetail:V,Input:ae};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),ie={class:"page-container"},re={class:"title-container"},ce={class:"content"},ue={class:"content-item"},de={class:"content-item-title"},_e={class:"d-flex justify-content-between"},me={class:"form-item"},ge={class:"form-item form-item-sort"},pe={class:"d-flex justify-content-between"},ve={class:"form-item form-item-tag"},he={class:"tag-container"},ye={class:"tag-item-qs-count"},be=["onClick"],fe={class:"search-bar",ref:"searchResultRef"},Se={key:0,class:$(["search-result-container"])},qe={class:"search-result"},ze={class:"search-result-tag"},Ie={class:"result-tag"},Te={class:"result-tag-qs-count"},Ce={class:"result-item-action"},ke={class:"content-item-title"},we={key:0,class:"quiz-item-container"},Ne={class:"quiz-item"},Be={class:"quiz-item-title"},Pe={class:"quiz-item-description"},Qe={class:"quiz-item-info quiz-info-detail"},Le={class:"quiz-item-questions"},xe={class:"quiz-item-created-by"},Re={class:"exam-item-actions"},Ae={key:1,class:"w-100 d-flex align-items-center justify-content-center quiz-item-container"},De={class:"pagination-container"};function Ee(l,a,i,t,w,N){const z=v("RouterLink"),y=v("a-col"),I=v("a-row"),s=v("a-select-option"),h=v("a-select"),T=v("a-button"),u=v("a-skeleton"),b=v("a-empty"),C=v("a-pagination");return d(),m("div",ie,[e("div",re,[_(I,{class:"w-100 d-flex align-items-center"},{default:g(()=>[_(y,{span:1},{default:g(()=>[_(z,{to:{name:"User_Library"}},{default:g(()=>a[4]||(a[4]=[e("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[4]})]),_:1}),_(y,{class:"main-title",span:23},{default:g(()=>[e("span",null,r(l.$t("detail_QS.other.library")),1),a[5]||(a[5]=S()),a[6]||(a[6]=e("br",null,null,-1))]),_:1,__:[5,6]})]),_:1})]),e("div",ce,[e("div",ue,[e("div",de,[e("div",null,[e("span",null,r(l.$t("search_QS.title")),1),e("span",null,r(l.$t("search_QS.sub_title")),1)])]),e("div",_e,[e("div",me,[e("label",null,r(l.$t("search_QS.form.key_word")),1),_(t.Input,{onInput:t.getData,modelValue:t.pageParams.name,"onUpdate:modelValue":a[0]||(a[0]=n=>t.pageParams.name=n),placeholder:t.t("search_QS.form.key_word_placeholder")},{icon:g(()=>a[7]||(a[7]=[e("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])]),e("div",ge,[e("label",null,r(l.$t("search_QS.form.sort_by")),1),_(h,{value:t.pageParams.sortBy,"onUpdate:value":a[1]||(a[1]=n=>t.pageParams.sortBy=n),style:{width:"200px"},onChange:t.getData},{default:g(()=>[(d(!0),m(q,null,k(t.sort_options,n=>(d(),Z(s,{value:n.value},{default:g(()=>[S(r(n.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])]),e("div",pe,[O(` <div class="form-item form-item-sort">
                        <label>Sort by</label>
                        <a-select
                            v-model:value="pageParams.sortBy"
                            style="width: 200px"
                            @change="getData"
                        >
                            <a-select-option v-for="option in sort_options" :value="option.value">
                                {{ option.label }}
                            </a-select-option>
                        </a-select>
                    </div> `),e("div",ve,[e("label",null,r(l.$t("create_QS.quiz.tag")),1),e("div",he,[(d(!0),m(q,null,k(t.selectedTags,(n,p)=>(d(),m("div",{class:"result-tag",key:p},[S(r(n.name)+" ",1),e("span",ye,r(n.questionSetCount),1),e("i",{class:"bx bx-x",onClick:P=>t.removeTag(p)},null,8,be)]))),128))]),e("div",fe,[_(t.Input,{onInput:t.getSearchTagData,modelValue:t.searchTagPageParams.name,"onUpdate:modelValue":a[2]||(a[2]=n=>t.searchTagPageParams.name=n),placeholder:t.t("search_QS.form.tag_placeholder")},null,8,["modelValue","placeholder"]),t.tag_search_data.length>0?(d(),m("div",Se,[e("div",qe,[(d(!0),m(q,null,k(t.tag_search_data,n=>(d(),m("div",ze,[e("div",Ie,[S(r(n.name)+" ",1),e("div",Te,r(n.questionSetCount),1)]),e("div",Ce,[_(T,{type:"primary",class:"main-color-btn",size:"small",onClick:p=>t.addTag(n)},{default:g(()=>[...a[8]||(a[8]=[e("i",{class:"bx bx-plus"},null,-1)])]),_:2,__:[8]},1032,["onClick"])])]))),256))])])):O("v-if",!0)],512)])]),e("div",ke,[e("div",null,[e("span",null,r(l.$t("search_QS.other.result_title",{number:t.quiz_data.length})),1)])]),t.loading?(d(),m(q,{key:0},[_(u,{loading:t.loading},null,8,["loading"]),_(u,{loading:t.loading},null,8,["loading"]),_(u,{loading:t.loading},null,8,["loading"])],64)):(d(),m(q,{key:1},[t.quiz_data.length>0?(d(),m("div",we,[(d(!0),m(q,null,k(t.quiz_data,n=>(d(),m("div",Ne,[a[10]||(a[10]=e("i",{class:"bx bx-book-open quiz-item-icon"},null,-1)),e("div",null,[e("div",Be,r(n.name),1),e("div",Pe,r(l.$t("search_QS.other.rating",{average:n.ratingAverage,count:n.ratingCount})),1),e("div",Qe,[e("div",Le,[a[9]||(a[9]=e("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),S(" "+r(n.totalQuestionCount)+" "+r(l.$t("dashboards.list_items.quiz.questions")),1)]),e("div",xe,r(l.$t("class_question_set.other.created_by"))+" "+r(n.createBy),1)])]),e("div",Re,[_(T,{type:"primary",class:"me-3 main-color-btn",onClick:p=>t.onRedirectToDetail(n.id)},{default:g(()=>[S(r(l.$t("class_question_set.buttons.view")),1)]),_:2},1032,["onClick"])])]))),256))])):(d(),m("div",Ae,[_(b,null,{description:g(()=>[e("span",null,r(l.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),e("div",De,[_(C,{onChange:t.onPaginationChange,current:t.pageParams.pageNumber,"onUpdate:current":a[3]||(a[3]=n=>t.pageParams.pageNumber=n),total:t.pageParams.totalCount,pageSize:t.pageParams.pageSize,"show-total":(n,p)=>`${p[0]}-${p[1]} of ${n} ${t.t("class_question_set.other.items")}`,"show-size-changer":"",class:"crud-layout-pagination",locale:{items_per_page:t.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])])}const Je=W(le,[["render",Ee],["__scopeId","data-v-27ebb566"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/question_sets/search.vue"]]);export{Je as default};
