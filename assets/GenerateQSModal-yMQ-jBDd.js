var Te=Object.defineProperty;var Ie=(l,t,f)=>t in l?Te(l,t,{enumerable:!0,configurable:!0,writable:!0,value:f}):l[t]=f;var ne=(l,t,f)=>Ie(l,typeof t!="symbol"?t+"":t,f);import{a as i,I as Ee,d as fe,u as pe,i as w,j as de,B as ye,C as ge,s as ke,k as z,M as K,_ as ve,r as y,E as le,o as c,w as d,b as n,f as k,t as s,ao as se,p as j,c as u,F as D,D as R,e as M,J as oe,v as Se,L as we,G as ue,ap as xe,aq as Ce,T as Ae}from"./index-CuKhGwID.js";import{A as De}from"./ApiTestTemplate-DhEjMX_C.js";import{A as Oe}from"./ApiQuestionSet-BQFtHQod.js";import{Q as _e}from"./questionTypes-CS3lcRlq.js";import{S as ae}from"./languages-DtYW231W.js";import{T as Me}from"./vue-draggable-plus-34Ou4kzX.js";var Le={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};function be(l){for(var t=1;t<arguments.length;t++){var f=arguments[t]!=null?Object(arguments[t]):{},e=Object.keys(f);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(f).filter(function(L){return Object.getOwnPropertyDescriptor(f,L).enumerable}))),e.forEach(function(L){qe(l,L,f[L])})}return l}function qe(l,t,f){return t in l?Object.defineProperty(l,t,{value:f,enumerable:!0,configurable:!0,writable:!0}):l[t]=f,l}var ie=function(t,f){var e=be({},t,f.attrs);return i(Ee,be({},e,{icon:Le}),null)};ie.displayName="InboxOutlined";ie.inheritAttrs=!1;const re={ALL:"all",VALID:"valid",IN_VALID:"invalid"},Ge=fe({__name:"ImportQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(l,{expose:t,emit:f}){const{t:e}=pe(),L=l,J=f,q=w(!1),h=w([]),T=w([]),O=w([]),g=w(""),A=async()=>{if(!g.value)try{const r=await Oe.DownloadFileImport();r.data.success&&(g.value=r.data.data)}catch(r){console.log(r)}},p=de({checkAll:!1,indeterminate:!1,checkedList:[]}),x=async()=>{await A(),p.checkedList=[],q.value=!0},S=()=>{q.value=!1};t({openImportModal:x});const o=w([]),G=w(null),P=w(!1),E=()=>{var r;(r=G.value)==null||r.click()},_=async r=>{if(r){if(r.type!=="application/vnd.ms-excel"&&r.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"){z.error(e("message.file_support_only",{fileTypes:"XLS, XLSX"}));return}o.value=[],z.success(e("message.uploaded_successfully",{name:r.name})),o.value.push(r);const m=await De.ImportFile(o.value[0]);m.data.success&&(h.value=[...m.data.data.validQuestions,...m.data.data.invalidQuestions],T.value=[...m.data.data.validQuestions,...m.data.data.invalidQuestions],O.value=m.data.data.invalidQuestions,p.checkedList=[]);return}z.error(e("message.uploaded_failed"))},N=async r=>{var v;const m=r.target,a=(v=m.files)==null?void 0:v[0];a&&(_(a),m.value="")},C=r=>{var a;const m=((a=r.dataTransfer)==null?void 0:a.types)||[];Array.from(m).includes("files")&&(P.value=!0)},B=r=>{var a;const m=(a=r.dataTransfer)==null?void 0:a.files[0];P.value=!1,m&&_(m)},Y=r=>{var m;(m=o.value)==null||m.splice(r,1),p.checkedList=[],h.value=[],O.value=[],T.value=[]},H=Object.values(re),X=ye(()=>H.map(r=>({label:e(`import_qs_modal.uploaded_question_status.${r}`),value:r}))),V=w(X.value[0].value),ee=()=>{var m,a;p.checkedList=[];let r=h.value;switch(V.value){case re.VALID:{r=(m=h.value)==null?void 0:m.filter(v=>{var U;return!((U=O.value)!=null&&U.includes(v))});break}case re.IN_VALID:{r=(a=h.value)==null?void 0:a.filter(v=>{var U;return(U=O.value)==null?void 0:U.includes(v)});break}}T.value=r||[]},W=r=>{Object.assign(p,{checkedList:r.target.checked?T.value:[],indeterminate:!1})};ge(()=>p.checkedList,r=>{var m;p.indeterminate=!!r.length&&r.length<T.value.length,p.checkAll=r.length===((m=T.value)==null?void 0:m.length)});const Z=(r,m)=>{$(m).toggleClass("bx-chevron-up bx-chevron-down");const v=$(`#question-item-answer-${r}`);v&&$(v).slideToggle()},I=()=>{if(p.checkedList.length===0){z.warning(e("message.minimum_question",{number:1}));return}if(p.checkedList.length+L.numberOfQuestion>500){z.warning(e("message.limit_question",{number:500}));return}K.confirm({title:e("import_qs_modal.confirm_modal.title"),content:e("import_qs_modal.confirm_modal.content",{number:p.checkedList.length}),okText:e("create_QS.buttons.ok"),cancelText:e("create_QS.buttons.cancel"),onOk:()=>{var m;const r=(m=T.value)==null?void 0:m.filter(a=>p.checkedList.includes(a));J("import",r),S()}})},Q=async()=>{window.open(g.value,"_blank")};ke(()=>{});const b={t:e,props:L,emit:J,modal_import_open:q,question_data:h,uploadedQuestions:T,uploadedInvalidQuestions:O,download_link:g,getLink:A,importModalState:p,openImportModal:x,closeImportModal:S,files:o,fileInput:G,isDragging:P,openFileExplorer:E,onFileChange:_,handleFileChange:N,handleDragEnter:C,handleDrop:B,onRemoveUploadedFile:Y,optionKeys:H,select_options:X,selected_option:V,onFilter:ee,onCheckAll:W,toggleDisplayAnswer:Z,handleModalImport:I,onDownloadTemplate:Q,get InboxOutlined(){return ie},get QUESTION_TYPE(){return _e}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),Qe={class:"modal-container"},Ue={class:"modal-title-container"},Pe={class:"modal-content-item"},Ne={class:"content-item-section upload-section"},Fe={class:"section-title"},ze={class:"section-content"},Re={class:"customized-file-upload-icons"},Be={class:"customized-file-upload-ins"},Je={class:"customized-file-upload-hint"},je={class:"file-container"},He={class:"file-item"},Ve=["onClick"],Ye={class:"content-item-section preview-section"},$e={class:"section-title"},Xe={class:"section-content"},Ke={key:0,class:"section-content-header"},We={class:"d-flex"},Ze={class:"preview-question-container"},et={class:"question-item-content"},tt=["innerHTML"],nt={key:1,class:"question-text"},at=["id"],ot={key:0,class:"multiple-choice-answer"},lt={key:0,class:"result-correct"},st={class:"pair-answer"},it={class:"pair-answer-item"},rt={class:"pair-answer-item"},ct={key:2,class:"ordering-answer"},dt={class:"ordering-answer-item"},ut={class:"ordering-answer-item"},_t={class:"ordering-answer-item"},mt={key:3,class:"short-text-answer"},ft={class:"question-item-toogle-btn"},pt=["onClick"],gt={class:"mt-4 d-flex align-items-center"},vt={class:"header-item"};function ht(l,t,f,e,L,J){const q=y("RouterLink"),h=y("a-col"),T=y("a-row"),O=y("a-button"),g=y("a-checkbox"),A=y("a-select-option"),p=y("a-select"),x=y("a-checkbox-group"),S=y("a-modal");return c(),le(S,{centered:"",width:"100%","wrap-class-name":"full-modal",open:e.modal_import_open,onCancel:e.closeImportModal},{footer:d(()=>[n("div",gt,[n("div",vt,s(l.$t("import_qs_modal.other.total_question",{number:e.importModalState.checkedList.length})),1),i(O,{class:"main-color-btn",size:"large",key:"submit",type:"primary",onClick:e.handleModalImport},{default:d(()=>[k(s(l.$t("import_qs_modal.buttons.import")),1)]),_:1})])]),default:d(()=>[n("div",Qe,[n("div",Ue,[i(T,{class:"w-100 d-flex align-items-center"},{default:d(()=>[i(h,{span:1},{default:d(()=>[i(q,{onClick:e.closeImportModal,to:{name:""}},{default:d(()=>t[5]||(t[5]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[5]})]),_:1}),i(h,{class:"main-title",span:23},{default:d(()=>[n("span",null,s(l.$t("import_qs_modal.title")),1),t[6]||(t[6]=k()),t[7]||(t[7]=n("br",null,null,-1)),n("span",null,s(l.$t("import_qs_modal.sub_title")),1)]),_:1,__:[6,7]})]),_:1})]),n("div",Pe,[n("div",Ne,[n("div",Fe,[n("span",null,s(l.$t("import_qs_modal.upload_section")),1),i(O,{class:"main-color-btn",type:"primary",onClick:e.onDownloadTemplate},{default:d(()=>[k(s(l.$t("import_qs_modal.buttons.download")),1)]),_:1})]),n("div",ze,[n("input",{onChange:e.handleFileChange,class:"d-none",type:"file",ref:"fileInput",accept:".xls,.xlsx"},null,544),n("div",{class:j(["customized-file-upload",e.isDragging?"is-dragging":""]),onClick:e.openFileExplorer,onDragenter:e.handleDragEnter,onDragover:t[0]||(t[0]=se(o=>e.isDragging=!0,["prevent"])),onDragleave:t[1]||(t[1]=o=>e.isDragging=!1),onDrop:se(e.handleDrop,["prevent"])},[n("div",Re,[n("i",{class:j(["bx","bx-down-arrow-alt","bx-fade-up",e.isDragging?"":"d-none"])},null,2),i(e.InboxOutlined,{class:j([e.isDragging?"d-none":""])},null,8,["class"])]),n("div",Be,s(l.$t("import_qs_modal.upload_area.title")),1),n("div",Je,[k(s(l.$t("import_qs_modal.upload_area.content"))+" ",1),t[8]||(t[8]=n("br",null,null,-1)),k(" "+s(l.$t("import_qs_modal.upload_area.sub_content")),1)])],34)]),n("div",je,[(c(!0),u(D,null,R(e.files,(o,G)=>(c(),u("div",He,[n("span",null,s(o.name),1),n("i",{class:"bx bx-trash text-danger",onClick:P=>e.onRemoveUploadedFile(G)},null,8,Ve)]))),256))])]),n("div",Ye,[n("div",$e,s(l.$t("import_qs_modal.preview_section")),1),n("div",Xe,[e.question_data.length>0?(c(),u("div",Ke,[i(g,{class:j(["header-item",e.importModalState.checkAll?"check-all":""]),onClick:e.onCheckAll,checked:e.importModalState.checkAll,"onUpdate:checked":t[2]||(t[2]=o=>e.importModalState.checkAll=o),indeterminate:e.importModalState.indeterminate},{default:d(()=>[k(s(l.$t("share_modal.buttons.check_all",{number:e.importModalState.checkedList.length})),1)]),_:1},8,["class","checked","indeterminate"]),n("div",We,[i(p,{size:"large",class:"me-3",value:e.selected_option,"onUpdate:value":t[3]||(t[3]=o=>e.selected_option=o),style:{width:"200px"},onChange:e.onFilter},{default:d(()=>[(c(!0),u(D,null,R(e.select_options,o=>(c(),le(A,{value:o.value},{default:d(()=>[k(s(o.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])])])):M("v-if",!0),i(x,{value:e.importModalState.checkedList,"onUpdate:value":t[4]||(t[4]=o=>e.importModalState.checkedList=o)},{default:d(()=>[n("div",Ze,[(c(!0),u(D,null,R(e.uploadedQuestions,(o,G)=>{var P;return c(),u("div",{class:j(["preview-question-item",(P=e.uploadedInvalidQuestions)!=null&&P.includes(o)?"invalid":""])},[i(g,{value:o},null,8,["value"]),n("div",et,[o.questionHTML?(c(),u("div",{key:0,class:"question-html",innerHTML:o.questionHTML},null,8,tt)):(c(),u("div",nt,s(o.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${G}`},[o.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(c(),u("div",ot,[n("ul",null,[(c(!0),u(D,null,R(o.multipleChoices,E=>(c(),u("li",null,[k(s(E.text)+" ",1),E.isAnswer?(c(),u("span",lt," ("+s(E.isAnswer)+") ",1)):M("v-if",!0)]))),256))])])):M("v-if",!0),o.type===e.QUESTION_TYPE.MATCHING?(c(!0),u(D,{key:1},R(o.matchingPairs,E=>(c(),u("div",st,[n("span",it,s(E.leftItem),1),t[9]||(t[9]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",rt,s(E.rightItem),1)]))),256)):M("v-if",!0),o.type===e.QUESTION_TYPE.ORDERING?(c(),u("div",ct,[n("div",dt,[(c(!0),u(D,null,R(o.orderingItems,E=>(c(),u("div",null,s(E.text),1))),256))]),t[10]||(t[10]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",ut,[(c(!0),u(D,null,R(o.orderingItems,(E,_)=>(c(),u("div",_t,[n("span",null,"#"+s(_+1),1),k(" - "+s(E.text),1)]))),256))])])):M("v-if",!0),o.type===e.QUESTION_TYPE.SHORT_TEXT?(c(),u("div",mt,s(o.shortAnswer),1)):M("v-if",!0)],8,at)]),n("div",ft,[n("i",{class:"bx bx-chevron-up",onClick:E=>e.toggleDisplayAnswer(G,E.currentTarget)},null,8,pt)])],2)}),256))])]),_:1},8,["value"])])])])])]),_:1},8,["open"])}const Gn=ve(Ge,[["render",ht],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/ImportQSModal.vue"]]),bt={HARD:"Hard",MEDIUM:"Medium",EASY:"Easy"},ce={GENERATE_QUESTION:"AiGenerate/GenerateQuestion",GENERATE_DOCUMENT_STRUCTURE:"AiGenerate/GenerateDocumentStructure",GET_COST_TO_GENERATE:"AiGenerate/DocumentStructure/GetCostToGenerate"};class yt{constructor(){ne(this,"GenerateQuestion",async t=>await oe.post(ce.GENERATE_QUESTION,t,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0}));ne(this,"GenerateDocumentStructure",async t=>{const f=new FormData;return f.append("file",t),await oe.post(ce.GENERATE_DOCUMENT_STRUCTURE,f,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})});ne(this,"GetCostToGenerate",async t=>{const f=new FormData;return f.append("file",t),await oe.post(ce.GET_COST_TO_GENERATE,f,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})})}}const me=new yt,kt={GET_PDF_STRUCTURE:"PdfService/GetPdfStructure"};class St{constructor(){ne(this,"GetPdfStructure",async t=>{const f=new FormData;return f.append("file",t),await oe.post(kt.GET_PDF_STRUCTURE,f,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0})})}}const wt=new St,Tt=fe({__name:"GenerateFileStructure",props:{file:{type:null,required:!0}},emits:["import"],setup(l,{expose:t,emit:f}){const{t:e}=pe(),L=l,J=Se(we,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),q=w(),h=w([]);function T(I){return I?Array.isArray(I)?I:[I]:[]}function O(I){return T(I).map(b=>{const r=T(b==null?void 0:b.children);return{...b,title:String((b==null?void 0:b.title)??""),key:crypto.randomUUID(),children:r.length?O(r):void 0}})}const g=w([]),A=w([]);function p(I,Q){const b=[];for(const r of I){const m=Q.includes(r.key),a=r.children?p(r.children,Q):[];(m||a.length>0)&&b.push({title:r.title,key:r.key,children:a.length?a:void 0})}return b}const x=ye(()=>p(g.value,A.value));ge(g,async()=>{g.value.length>0&&(await ue(),q.value&&(q.value.scrollTop=0))});const S=w(null),o=w(!1),G=w(!1),P=async()=>{try{G.value=!0;const I=await me.GetCostToGenerate(L.file);if(!I.data.success)return K.error({title:"Error",content:I.data.message||e("message.failed_to_get_cost")}),null;const Q=I.data.data;if(!Q){z.error(e("message.failed_to_get_cost"));return}S.value=Q,Y.value=!0}catch(I){return console.error(I),null}finally{G.value=!1}},E=async(I,Q)=>{try{G.value=!0;const b=await I(L.file);if(!b.data.success){K.error({title:"Error",content:b.data.message||e("message.failed_to_generate_file_structure")});return}const r=typeof b.data=="string"?JSON.parse(b.data):b.data,m=r==null?void 0:r.data,a=T(m==null?void 0:m.children);h.value=a,g.value=O(h.value)}catch(b){console.error(b)}finally{G.value=!1,Q&&(Y.value=!1)}},_=()=>{E(me.GenerateDocumentStructure,!0)},N=()=>{E(wt.GetPdfStructure,!1)},C=async()=>{o.value=!0,!(h.value.length>0||S.value)&&N()},B=()=>{o.value=!1,V()},Y=w(!1),H=async()=>{S.value&&_()},X=f,V=()=>{var m,a;if(g.value.length===0||x.value.length===0)return;const I=(m=g.value)==null?void 0:m[0],Q=JSON.stringify({title:I.title,children:I.children}),b=(a=x.value)==null?void 0:a[0],r=JSON.stringify({title:b.title,children:b.children});X("import",Q,r)},ee=()=>{if(x.value.length===0){K.error({title:"Error",content:"Please choose at least one section in your document to proceed.",centered:!0});return}V(),B()},W=()=>{h.value=[],g.value=[],S.value=null};t({openModal:C,closeModal:B,clearData:W});const Z={t:e,props:L,indicator:J,modalContentRef:q,serverData:h,toArray:T,addRandomKeys:O,treeData:g,checked:A,filterTree:p,selectedTree:x,cost:S,modal_open:o,loading:G,getCostToGenerate:P,fetchTreeData:E,generateTreeData:_,getTreeData:N,openModal:C,closeModal:B,modal_confirm_generate_structure_open:Y,onConfirmGenerateFileStructure:H,emit:X,onEmitImport:V,onConfirmImportStructure:ee,clearData:W,get ExclamationCircleFilled(){return Ce},get ATree(){return xe}};return Object.defineProperty(Z,"__isScriptSetup",{enumerable:!1,value:!0}),Z}}),It={class:"modal-container"},Et={class:"modal-title-container"},xt={class:"modal-content-item",ref:"modalContentRef"},Ct={key:0,class:"loading-container"},At={key:0},Dt={key:1,class:"content-wrapper"},Ot={key:0,class:"tree-container"},Mt={class:"button-container"},Lt={class:"button-container"},qt={class:"fs-6 mb-3"},Gt={class:"d-flex align-items-center justify-content-between"},Qt={class:"confirm-modal-container"},Ut={class:"d-flex align-items-center"},Pt={class:"fs-6 fw-bold"},Nt={class:"fs-6 ms-5 mt-3"},Ft={class:"fw-bold text-danger"};function zt(l,t,f,e,L,J){const q=y("RouterLink"),h=y("a-col"),T=y("a-row"),O=y("a-spin"),g=y("a-button"),A=y("a-modal");return c(),u(D,null,[i(A,{centered:"",width:"100%","wrap-class-name":"medium-modal large",open:e.modal_open,onCancel:e.closeModal},{footer:d(()=>[i(g,{class:"main-color-btn",type:"primary",onClick:e.onConfirmImportStructure},{default:d(()=>[k(s(l.$t("generate_file_structure.buttons.confirm")),1)]),_:1})]),default:d(()=>[n("div",It,[n("div",Et,[i(T,{class:"w-100 d-flex align-items-center"},{default:d(()=>[i(h,{span:1},{default:d(()=>[i(q,{onClick:e.closeModal,to:{name:""}},{default:d(()=>t[3]||(t[3]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[3]})]),_:1}),i(h,{class:"main-title",span:23},{default:d(()=>[n("span",null,s(l.$t("generate_file_structure.title")),1),t[4]||(t[4]=k()),t[5]||(t[5]=n("br",null,null,-1)),n("span",null,s(l.$t("generate_file_structure.sub_title")),1)]),_:1,__:[4,5]})]),_:1})]),n("div",xt,[e.loading?(c(),u("div",Ct,[i(O,{size:"large",indicator:e.indicator},null,8,["indicator"]),e.cost?M("v-if",!0):(c(),u("div",At,s(l.$t("generate_file_structure.other.analyzing")),1))])):(c(),u("div",Dt,[e.treeData.length>0?(c(),u("div",Ot,[i(e.ATree,{checkedKeys:e.checked,"onUpdate:checkedKeys":t[0]||(t[0]=p=>e.checked=p),"tree-data":e.treeData,checkable:"","show-icon":!1,"show-line":!0,"field-names":{title:"title",key:"key",children:"children"},defaultExpandAll:!0,style:{width:"100%"}},null,8,["checkedKeys","tree-data"])])):e.cost?(c(),u(D,{key:1},[M(" get cost success but cancel "),n("div",Mt,[i(g,{size:"large",type:"primary",class:"main-color-btn",onClick:t[1]||(t[1]=p=>e.modal_confirm_generate_structure_open=!0)},{default:d(()=>[k(s(l.$t("generate_file_structure.buttons.generate_structure")),1)]),_:1})])],2112)):(c(),u(D,{key:2},[M(" get structure but failed "),n("div",Lt,[n("div",qt,s(l.$t("generate_file_structure.other.invalid_structure")),1),n("div",Gt,[i(g,{loading:e.loading,class:"me-3 main-color-btn-ghost",type:"primary",onClick:e.getTreeData},{default:d(()=>[k(s(l.$t("generate_file_structure.buttons.re_load")),1)]),_:1},8,["loading"]),i(g,{size:"large",type:"primary",class:"main-color-btn",onClick:e.getCostToGenerate},{default:d(()=>[k(s(l.$t("generate_file_structure.buttons.generate_structure")),1)]),_:1})])])],2112))]))],512)])]),_:1},8,["open"]),i(A,{"wrap-class-name":"medium-modal",centered:"",open:e.modal_confirm_generate_structure_open,closable:!1},{footer:d(()=>[i(g,{class:j(["main-color-btn-ghost",e.loading?"main-color-btn-disabled":""]),type:"ghost",onClick:t[2]||(t[2]=p=>e.modal_confirm_generate_structure_open=!1)},{default:d(()=>[k(s(l.$t("sidebar.buttons.cancel")),1)]),_:1},8,["class"]),i(g,{loading:e.loading,class:"main-color-btn",type:"primary",onClick:e.onConfirmGenerateFileStructure},{default:d(()=>[k(s(l.$t("generate_file_structure.buttons.confirm")),1)]),_:1},8,["loading"])]),default:d(()=>{var p;return[n("div",Qt,[n("div",Ut,[i(e.ExclamationCircleFilled,{class:"fs-4 me-3 text-warning"}),n("div",Pt,s(l.$t("generate_file_structure.confirm_modal.title")),1)]),n("div",Nt,[k(s(l.$t("generate_file_structure.confirm_modal.content"))+" ",1),n("span",Ft,s((p=e.cost)==null?void 0:p.miniumPointToGenerate),1),k(" "+s(l.$t("generate_file_structure.confirm_modal.content_tail")),1)])])]}),_:1},8,["open"])],64)}const Rt=ve(Tt,[["render",zt],["__scopeId","data-v-8be2b719"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateFileStructure.vue"]]),Bt=fe({__name:"GenerateQSModal",props:{title:{type:String,required:!0},numberOfQuestion:{type:Number,required:!0}},emits:["import"],setup(l,{expose:t,emit:f}){const{t:e}=pe(),L=l,J=f,q=w(!1),h=()=>{S.checkedList=[],q.value=!0},T=()=>{q.value=!1};t({openGenerateAIModal:h});const O=()=>{if(S.checkedList.length===0){z.warning(e("message.minimum_question",{number:1}));return}if(S.checkedList.length+L.numberOfQuestion>500){z.warning(e("message.limit_question",{number:500}));return}K.confirm({title:e("import_qs_modal.confirm_modal.title"),content:e("import_qs_modal.confirm_modal.content",{number:S.checkedList.length}),okText:e("create_QS.buttons.ok"),cancelText:e("create_QS.buttons.cancel"),onOk:()=>{const a=x.value.filter(v=>S.checkedList.includes(v));J("import",a),T()}})},g=Object.values(_e).map(a=>({label:e(`create_QS.type.${a}`),value:a})),A=Object.values(bt).map(a=>({label:a,value:a})),p=w([]);for(let a=10;a<=50;a+=10)p.value.push({label:a,value:a});const x=w([]),S=de({checkAll:!1,indeterminate:!1,checkedList:[]}),o=de({file:null,isGenerateExplain:!0,language:ae[0].code,questionCount:p.value[0].value,questionTypes:[g[0]],documentStructureJson:null,selectedPartJson:null,title:""}),G=a=>{o.questionTypes.length===0&&(z.warning(e("message.minimun_question_type")),o.questionTypes.push(a))},P=w(!1),E=Se(we,{style:{fontSize:"100px",color:"var(--main-color)"},spin:!0}),_=async()=>{var a;try{if(P.value=!0,!o.title&&o.isGenerateExplain){z.error(e("message.invalid_reference"));return}if(o.documentStructureJson===null||o.selectedPartJson===null){K.error({title:e("generate_qs_modal.invalid_structure_modal.title"),content:e("generate_qs_modal.invalid_structure_modal.content"),centered:!0}),b();return}const v=JSON.parse(o.documentStructureJson),U=JSON.parse(o.selectedPartJson);o.isGenerateExplain&&o.title&&(o.documentStructureJson=JSON.stringify({...v,title:o.title}),o.selectedPartJson=JSON.stringify({...U,title:o.title}));const F=new FormData;F.append("file",N.value[0]),F.append("isGenerateExplain",o.isGenerateExplain?"true":"false"),F.append("language",((a=ae.find(te=>te.code===o.language))==null?void 0:a.label)||ae[0].label),F.append("questionCount",o.questionCount),F.append("questionTypes",JSON.stringify(o.questionTypes.map(te=>te))),F.append("documentStructureJson",o.documentStructureJson),F.append("selectedPartJson",o.selectedPartJson);const he=await me.GenerateQuestion(F);if(!he.data.success){z.error("Generate failed!");return}x.value=[...x.value||[],...he.data.data.map(te=>({...te,questionId:Ae().valueOf()}))],await ue(),S.checkedList=[],S.indeterminate=!1,S.checkAll=!1}catch(v){console.log(v)}finally{P.value=!1}},N=w([]),C=w(null),B=w(!1),Y=()=>{var a;(a=C.value)==null||a.click()},H=async a=>{if(a){if(a.type!=="application/pdf"){z.error(e("message.file_support_only",{fileTypes:"PDF"}));return}N.value=[],z.success(e("message.uploaded_successfully",{name:a.name})),N.value.push(a);const v=a.name.replace(/\.[^/.]+$/,"");o.title=v,await ue(),b();return}z.error(e("message.uploaded_failed"))},X=a=>{var F;const v=a.target,U=(F=v.files)==null?void 0:F[0];U&&(H(U),v.value="")},V=a=>{var U;const v=((U=a.dataTransfer)==null?void 0:U.types)||[];Array.from(v).includes("files")&&(B.value=!0)},ee=async a=>{var U;const v=(U=a.dataTransfer)==null?void 0:U.files[0];B.value=!1,v&&H(v)},W=()=>{K.confirm({title:e("generate_qs_modal.confirm_delete_file_modal.title"),content:e("generate_qs_modal.confirm_delete_file_modal.content"),onOk:()=>{var a;N.value=[],(a=Q.value)==null||a.clearData()}})},Z=a=>{Object.assign(S,{checkedList:a.target.checked?x.value:[],indeterminate:!1})};ge(()=>S.checkedList,a=>{S.indeterminate=!!a.length&&a.length<x.value.length,S.checkAll=a.length===x.value.length});const I=(a,v)=>{$(v).toggleClass("bx-chevron-up bx-chevron-down");const F=$(`#question-item-answer-${a}`);F&&$(F).slideToggle()},Q=w(null),b=()=>{Q.value&&Q.value.openModal()},r=(a,v)=>{o.documentStructureJson=a,o.selectedPartJson=v};ke(()=>{});const m={t:e,props:L,emit:J,modal_generate_ai_open:q,openGenerateAIModal:h,closeGenerateAIModal:T,handleModalImport:O,questionTypeOptions:g,questionDifficultyOptions:A,questionMaximumOptions:p,generatedQuestions:x,generateModalState:S,generateByAIModalState:o,onDeselectQuestionType:G,loading:P,indicator:E,onGenerateQuestions:_,files:N,fileInput:C,isDragging:B,openFileExplorer:Y,onFileChange:H,handleFileChange:X,handleDragEnter:V,handleDrop:ee,onRemoveUploadedFile:W,onCheckAll:Z,toggleDisplayAnswer:I,generateFileStructureRef:Q,openFileStructureModal:b,handleImportStructure:r,get QUESTION_TYPE(){return _e},get SUPPORTED_LOCALES(){return ae},get InboxOutlined(){return ie},TextArea:Me,GenerateFileStructure:Rt};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}}),Jt={class:"modal-container"},jt={class:"modal-title-container"},Ht={class:"modal-content-item"},Vt={class:"content-item-section upload-section"},Yt={class:"section-title"},$t={key:0,class:"section-content mb-2"},Xt={class:"customized-file-upload-icons"},Kt={class:"customized-file-upload-ins"},Wt={class:"customized-file-upload-hint"},Zt={key:1,class:"file-container"},en={class:"file-item"},tn={class:"content-item-section preview-section"},nn={class:"section-title"},an={class:"section-content"},on={key:0,class:"section-content-header"},ln={class:"header-item"},sn={class:"preview-question-container"},rn={class:"preview-question-item"},cn={class:"question-item-content"},dn=["innerHTML"],un={key:1,class:"question-text"},_n=["id"],mn={key:0,class:"multiple-choice-answer"},fn={key:0,class:"result-correct"},pn={class:"pair-answer"},gn={class:"pair-answer-item"},vn={class:"pair-answer-item"},hn={key:2,class:"ordering-answer"},bn={class:"ordering-answer-item"},yn={class:"ordering-answer-item"},kn={class:"ordering-answer-item"},Sn={class:"short-text-answer"},wn={class:"question-item-toogle-btn"},Tn=["onClick"],In={class:"modal-generate-by-ai-warning"},En={class:"w-100 d-flex justify-content-end"};function xn(l,t,f,e,L,J){const q=y("RouterLink"),h=y("a-col"),T=y("a-row"),O=y("a-select-option"),g=y("a-select"),A=y("a-form-item"),p=y("a-switch"),x=y("a-button"),S=y("a-form"),o=y("a-checkbox"),G=y("a-checkbox-group"),P=y("a-spin"),E=y("a-modal");return c(),u(D,null,[i(E,{centered:"",width:"100%",closable:!1,"wrap-class-name":"full-modal",open:e.modal_generate_ai_open,onCancel:e.closeGenerateAIModal},{footer:d(()=>t[19]||(t[19]=[])),default:d(()=>[i(P,{spinning:e.loading,size:"large",indicator:e.indicator},{default:d(()=>[n("div",Jt,[n("div",jt,[i(T,{class:"w-100 d-flex align-items-center"},{default:d(()=>[i(h,{span:1},{default:d(()=>[i(q,{onClick:e.closeGenerateAIModal,to:{name:""}},{default:d(()=>t[10]||(t[10]=[n("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[10]})]),_:1}),i(h,{class:"main-title",span:23},{default:d(()=>[n("span",null,s(l.$t("generate_qs_modal.title")),1),t[11]||(t[11]=k()),t[12]||(t[12]=n("br",null,null,-1)),n("span",null,s(l.$t("generate_qs_modal.sub_title")),1)]),_:1,__:[11,12]})]),_:1})]),n("div",Ht,[n("div",Vt,[n("div",Yt,[n("span",null,s(l.$t("import_qs_modal.upload_section")),1)]),e.files.length?M("v-if",!0):(c(),u("div",$t,[n("input",{onChange:e.handleFileChange,class:"d-none",type:"file",ref:"fileInput",accept:".pdf"},null,544),n("div",{class:j(["customized-file-upload",e.isDragging?"is-dragging":""]),onClick:e.openFileExplorer,onDragenter:e.handleDragEnter,onDragover:t[0]||(t[0]=se(_=>e.isDragging=!0,["prevent"])),onDragleave:t[1]||(t[1]=_=>e.isDragging=!1),onDrop:se(e.handleDrop,["prevent"])},[n("div",Xt,[n("i",{class:j(["bx","bx-down-arrow-alt","bx-fade-up",e.isDragging?"":"d-none"])},null,2),i(e.InboxOutlined,{class:j([e.isDragging?"d-none":""])},null,8,["class"])]),n("div",Kt,s(l.$t("import_qs_modal.upload_area.title")),1),n("div",Wt,[k(s(l.$t("import_qs_modal.upload_area.content"))+" ",1),t[13]||(t[13]=n("br",null,null,-1)),k(" "+s(l.$t("import_qs_modal.upload_area.sub_content")),1)])],34)])),e.files.length?(c(),u("div",Zt,[(c(!0),u(D,null,R(e.files,_=>(c(),u("div",en,[n("div",null,s(_.name),1),n("i",{class:"bx bx-trash text-danger",onClick:t[2]||(t[2]=N=>e.onRemoveUploadedFile())})]))),256)),n("div",{class:"file-structure",onClick:e.openFileStructureModal},[t[14]||(t[14]=n("i",{class:"bx bx-file"},null,-1)),n("div",null,s(l.$t("generate_qs_modal.form.structure")),1)])])):M("v-if",!0),i(S,{layout:"vertical",class:"generate-ai-form"},{default:d(()=>[i(T,{class:"d-flex justify-content-between"},{default:d(()=>[i(h,{span:12},{default:d(()=>[i(A,{l:"",label:e.t("generate_qs_modal.form.language")},{default:d(()=>[i(g,{class:"language-select",value:e.generateByAIModalState.language,"onUpdate:value":t[3]||(t[3]=_=>e.generateByAIModalState.language=_)},{default:d(()=>[(c(!0),u(D,null,R(e.SUPPORTED_LOCALES,_=>(c(),le(O,{key:`locale-${_.code}`,value:_.code},{default:d(()=>[k(s(_.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),i(h,{span:11},{default:d(()=>[i(A,{label:e.t("generate_qs_modal.form.maximum_question")},{default:d(()=>[i(g,{value:e.generateByAIModalState.questionCount,"onUpdate:value":t[4]||(t[4]=_=>e.generateByAIModalState.questionCount=_),style:{width:"100%"},placeholder:"Maximum number of question",options:e.questionMaximumOptions},null,8,["value","options"])]),_:1},8,["label"])]),_:1})]),_:1}),i(A,{label:e.t("generate_qs_modal.form.question_types")},{default:d(()=>[i(g,{onDeselect:e.onDeselectQuestionType,value:e.generateByAIModalState.questionTypes,"onUpdate:value":t[5]||(t[5]=_=>e.generateByAIModalState.questionTypes=_),mode:"multiple",style:{width:"100%"},placeholder:"Select multiple",options:e.questionTypeOptions},null,8,["value","options"])]),_:1},8,["label"]),i(T,{class:"d-flex justify-content-between"},{default:d(()=>[i(h,{span:7},{default:d(()=>[i(A,{label:e.t("generate_qs_modal.form.enable_explaination")},{default:d(()=>[i(p,{checked:e.generateByAIModalState.isGenerateExplain,"onUpdate:checked":t[6]||(t[6]=_=>e.generateByAIModalState.isGenerateExplain=_)},null,8,["checked"])]),_:1},8,["label"])]),_:1}),e.generateByAIModalState.isGenerateExplain?(c(),le(h,{key:0,span:16},{default:d(()=>[i(A,{label:e.t("generate_qs_modal.form.reference_name")},{default:d(()=>[i(e.TextArea,{modelValue:e.generateByAIModalState.title,"onUpdate:modelValue":t[7]||(t[7]=_=>e.generateByAIModalState.title=_),"is-required":e.generateByAIModalState.isGenerateExplain,"max-length":200,placeholder:e.t("generate_qs_modal.form.reference_name_placeholder"),readonly:!e.generateByAIModalState.isGenerateExplain},null,8,["modelValue","is-required","placeholder","readonly"])]),_:1},8,["label"])]),_:1})):M("v-if",!0)]),_:1}),i(A,{style:{"margin-top":"7px"},class:"generate-ai-btn-container"},{default:d(()=>[i(x,{loading:e.loading,size:"large",class:"w-100 main-color-btn generate_ai",type:"primary",onClick:e.onGenerateQuestions},{default:d(()=>[k(s(l.$t("generate_qs_modal.buttons.generate")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),n("div",tn,[n("div",nn,s(l.$t("import_qs_modal.preview_section")),1),n("div",an,[e.generatedQuestions.length>0?(c(),u("div",on,[i(o,{class:j(["header-item",e.generateModalState.checkAll?"check-all":""]),onClick:e.onCheckAll,checked:e.generateModalState.checkAll,"onUpdate:checked":t[8]||(t[8]=_=>e.generateModalState.checkAll=_),indeterminate:e.generateModalState.indeterminate},{default:d(()=>[k(s(l.$t("share_modal.buttons.check_all",{number:e.generateModalState.checkedList.length})),1)]),_:1},8,["class","checked","indeterminate"]),n("div",ln,s(l.$t("import_qs_modal.other.total_question",{number:e.generateModalState.checkedList.length})),1)])):M("v-if",!0),i(G,{value:e.generateModalState.checkedList,"onUpdate:value":t[9]||(t[9]=_=>e.generateModalState.checkedList=_)},{default:d(()=>[n("div",sn,[(c(!0),u(D,null,R(e.generatedQuestions,(_,N)=>(c(),u("div",rn,[i(o,{value:_},null,8,["value"]),n("div",cn,[_.questionHTML?(c(),u("div",{key:0,class:"question-html",innerHTML:_.questionHTML},null,8,dn)):(c(),u("div",un,s(_.questionText),1)),n("div",{class:"question-item-answer",id:`question-item-answer-${N}`},[_.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(c(),u("div",mn,[n("ul",null,[(c(!0),u(D,null,R(_.multipleChoices,C=>(c(),u("li",null,[k(s(C.text)+" ",1),C.isAnswer?(c(),u("span",fn," ("+s(C.isAnswer)+") ",1)):M("v-if",!0)]))),256))])])):M("v-if",!0),_.type===e.QUESTION_TYPE.MATCHING?(c(!0),u(D,{key:1},R(_.matchingPairs,C=>(c(),u("div",pn,[n("span",gn,s(C.leftItem),1),t[15]||(t[15]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("span",vn,s(C.rightItem),1)]))),256)):M("v-if",!0),_.type===e.QUESTION_TYPE.ORDERING?(c(),u("div",hn,[n("div",bn,[(c(!0),u(D,null,R(_.orderingItems,C=>(c(),u("div",null,s(C.text),1))),256))]),t[16]||(t[16]=n("i",{class:"bx bx-right-arrow-alt"},null,-1)),n("div",yn,[(c(!0),u(D,null,R(_.orderingItems,(C,B)=>(c(),u("div",kn,[n("span",null,"#"+s(B+1),1),k(" - "+s(C.text),1)]))),256))])])):M("v-if",!0),_.type===e.QUESTION_TYPE.SHORT_TEXT?(c(),u(D,{key:3},[t[17]||(t[17]=n("span",null,"Answer:",-1)),n("div",Sn,s(_.shortAnswer),1)],64)):M("v-if",!0)],8,_n)]),n("div",wn,[n("i",{class:"bx bx-chevron-up",onClick:C=>e.toggleDisplayAnswer(N,C.currentTarget)},null,8,Tn)])]))),256))])]),_:1},8,["value"])]),n("div",In,[n("span",null,[t[18]||(t[18]=n("i",{class:"bx bx-info-circle"},null,-1)),k(" "+s(l.$t("generate_qs_modal.other.ai_warning")),1)])]),n("div",En,[i(x,{class:"main-color-btn",key:"submit",type:"primary",size:"large",onClick:e.handleModalImport},{default:d(()=>[k(s(l.$t("import_qs_modal.buttons.import")),1)]),_:1})])])])])]),_:1},8,["spinning","indicator"])]),_:1},8,["open"]),i(e.GenerateFileStructure,{file:e.files[0],ref:"generateFileStructureRef",onImport:e.handleImportStructure},null,8,["file"])],64)}const Qn=ve(Bt,[["render",xn],["__scopeId","data-v-23b34ba3"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/GenerateQSModal.vue"]]);export{Qn as G,Gn as I};
