import{d as J,q as W,l as Z,u as $,H as j,i as N,j as G,K as ee,s as te,k as b,M as Q,v as ae,_ as oe,r as m,a as I,o as C,b as t,f as A,c as o,w as n,g as c,t as r,F as P,B as K,C as Y}from"./index-CBe-xg3B.js";import{A as R}from"./ApiClass-BnupEivQ.js";import{I as ne}from"./Input-CA0GHANl.js";const se={FULL_NAME:"FullName",EMAIL:"Email"},le=J({__name:"student",emits:["updateSidebar"],setup(d,{expose:a,emit:V}){var B;a();const e=W(),g=Z(),{t:S}=$(),p=V,k=Object.values(se),w=j(()=>k.map(s=>({label:S(`class_member.select_option.${s}`),value:s}))),u=N(e.params.id||""),h=N({classId:"",name:"",topic:""}),l=G({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,keyword:((B=e.query.keyword)==null?void 0:B.toString())||"",fieldName:e.query.fieldName||w.value[0].value,totalCount:0,statusFilter:!1}),z=N([]),D=async()=>{try{u.value||g.push({name:"404"});let s=await R.GetById(u.value.toString());s.data.success||g.push({name:"404"}),h.value=s.data.data}catch(s){console.log("ERROR: GETBYID class: "+s)}},f=async()=>{try{let s=await R.GetAllStudentByLimit(u.value.toString(),l);if(s.data.success){let _=s.data.data;z.value=_.items,l.pageNumber=_.pageNumber,l.pageSize=_.pageSize,l.totalCount=_.totalCount,l.statusFilter&&(l.pageNumber>_.totalPages&&l.totalCount>0?(l.pageNumber=1,g.push({name:"User_Class_Student",params:{id:u.value},query:{pageNumber:1,pageSize:l.pageSize,keyword:l.keyword,fieldName:l.fieldName}})):g.push({name:"User_Class_Student",params:{id:u.value},query:{pageNumber:l.pageNumber,pageSize:l.pageSize,keyword:l.keyword,fieldName:l.fieldName}}),l.statusFilter=!l.statusFilter)}}catch(s){console.log("ERROR: GETALLEXAMBYLIMIT class exam: "+s)}};ee(()=>{var s;Object.keys(e.query).length===0&&(l.pageNumber=e.query.pageNumber||1,l.pageSize=e.query.pageSize||10,l.keyword=((s=e.query.keyword)==null?void 0:s.toString())||"",l.fieldName=e.query.fieldName||w.value[0].value,l.statusFilter=!0,f())});const T=(s,_)=>{l.pageNumber=s,l.pageSize=_,l.statusFilter=!0,f()},F=[{title:"No",key:"no",customRender:s=>s.index+1},{title:"FullName",dataIndex:"fullName",key:"fullName",sorter:(s,_)=>s.fullName.localeCompare(_.fullName)},{title:"Email",dataIndex:"email",key:"email",sorter:(s,_)=>s.email.localeCompare(_.email)},{title:"Position",dataIndex:"position",key:"position"},{key:"action"}],q=[1,3,5,7,30],L=j(()=>q.map(s=>({label:s+S(s===1?"class_member.other.day_singular":"class_member.other.day_plural"),value:s}))),y=N(!1),x=G({classId:u.value,code:"e3m3TR41fk+t",expiredTime:L.value[0].value}),E=N(!1),U=()=>{y.value=!0},i=()=>{},v=()=>{navigator.clipboard.writeText(x.code).then(()=>{b.success("Copied")}).catch(()=>{b.error("code empty")})},M=()=>{navigator.clipboard.writeText(x.code).then(()=>{b.success("Copied")}).catch(()=>{b.error("code empty")})},H=s=>{Q.confirm({title:"Are you sure to remove this user from class?",content:"This action is inreversible, every related data will be erased forever. Careful!",centered:!0,okText:"Confirm",onOk:async()=>{if(!(await R.DeleteClassMember(u.value.toString(),s.toString())).data.success){b.success("Remove failed.");return}b.success("Remove successfully."),await f()}})},X=()=>{Q.confirm({title:"Are you sure to delete this class?",content:ae("div",{style:"color: red"},"This action is inreversible, every related data will be erased forever. Careful!"),centered:!0,okText:"Confirm",onOk:async()=>{if(!(await R.Delete(u.value.toString())).data.success){b.success("Delete class failed.");return}b.success("Delete class successfully."),g.push({name:"User_Class"})}})};te(async()=>{p("updateSidebar","class"),await D(),await f()});const O={route:e,router:g,t:S,emit:p,optionKeys:k,class_position_options:w,classId:u,classData:h,pageParams:l,student_data:z,getClassData:D,getData:f,onPaginationChange:T,columns:F,optionDays:q,code_limit_time:L,modal_invitation_open:y,invitationFormState:x,isInvitaionLoading:E,onOpenInvitationModal:U,onResetInvitation:i,onCopyInvitationCode:v,onCopyInvitationLink:M,onConfirmDeleteMember:H,onOpenConfirmDelete:X,Input:ne};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}}),ie={class:"page-container"},re={class:"title-container"},de={class:"breadcrumb-container"},me={class:"title-breadcrumb-item"},ce={class:"title-breadcrumb-item"},ue={class:"breadcrumb-item-topic"},_e={class:"content"},pe={class:"content-item"},ve={class:"content-item-title"},be={class:"content-item-functions"},ge={class:"content-item-navigators"},fe={class:"navigator-container"},ye={style:{width:"300px",padding:"0px"}},Ce={key:0,class:"student-name-container"},ke=["src"],we={class:"student-name"},he={key:1,class:"student-action"},xe={class:"d-flex align-items-center"},Se={class:"pagination-container"},Ne={class:"mt-4 content-item"},Ie={class:"content-item-title"},ze={class:"text-danger"},De={class:"danger-zone mt-3 p-4"},Fe={class:"text-danger fs-6 fw-bold"},qe={class:"text-secondary"},Le={class:"modal-container"},Re={class:"modal-title-container"},Te={class:"modal-invitation-body"},Ee={class:"invitation-code-container"},Ue={class:"invitation-code-container"};function Ae(d,a,V,e,g,S){const p=m("RouterLink"),k=m("a-button"),w=m("a-select-option"),u=m("a-select"),h=m("a-menu-item"),l=m("a-menu-divider"),z=m("a-menu"),D=m("a-dropdown"),f=m("a-table"),T=m("a-pagination"),F=m("a-col"),q=m("a-row"),L=m("a-qrcode"),y=m("a-form-item"),x=m("a-form"),E=m("a-divider"),U=m("a-modal");return C(),I(P,null,[t("div",ie,[t("div",re,[t("div",de,[t("ul",null,[t("li",me,[o(p,{to:{name:"User_Class"}},{default:n(()=>[t("span",null,r(d.$t("class_index.title")),1),a[8]||(a[8]=c()),a[9]||(a[9]=t("br",null,null,-1))]),_:1,__:[8,9]}),a[10]||(a[10]=t("i",{class:"bx bx-chevron-right"},null,-1))]),t("li",ce,[o(p,{to:{name:""},class:"breadcrumb-item-class"},{default:n(()=>[t("span",null,r(e.classData.name),1),t("span",ue,r(e.classData.topic),1)]),_:1})])])])]),t("div",_e,[t("div",pe,[t("div",ve,[t("div",null,[t("span",null,r(d.$t("class_member.title")),1),t("span",null,r(d.$t("class_member.sub_title")),1)]),o(k,{class:"main-color-btn",type:"primary",size:"large",onClick:e.onOpenInvitationModal},{default:n(()=>[a[11]||(a[11]=t("i",{class:"me-2 bx bx-user-plus"},null,-1)),c(" "+r(d.$t("class_member.buttons.invite_member")),1)]),_:1,__:[11]})]),t("div",be,[t("div",ge,[t("div",fe,[o(p,{class:"navigator-item",to:{name:"User_Class_Exam"}},{default:n(()=>[c(r(d.$t("class_index.navigators.exam")),1)]),_:1}),o(p,{class:"navigator-item",to:{name:"User_Class_Quiz"}},{default:n(()=>[c(r(d.$t("class_index.navigators.quiz")),1)]),_:1}),o(p,{class:"navigator-item navigator-active",to:{name:""}},{default:n(()=>[c(r(d.$t("class_index.navigators.member")),1)]),_:1})])]),o(u,{value:e.pageParams.fieldName,"onUpdate:value":a[0]||(a[0]=i=>e.pageParams.fieldName=i),style:{width:"200px"},onChange:e.getData},{default:n(()=>[(C(!0),I(P,null,K(e.class_position_options,i=>(C(),Y(w,{value:i.value},{default:n(()=>[c(r(i.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",ye,[o(e.Input,{onInput:e.getData,modelValue:e.pageParams.keyword,"onUpdate:modelValue":a[1]||(a[1]=i=>e.pageParams.keyword=i),placeholder:e.t("class_member.other.search_placeholder")},{icon:n(()=>a[12]||(a[12]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),o(f,{columns:e.columns,"data-source":e.student_data,"row-key":"studentId",pagination:!1},{bodyCell:n(({column:i,record:v})=>[i.key==="fullName"?(C(),I("div",Ce,[t("img",{class:"student-image",src:v.image,alt:""},null,8,ke),t("div",we,r(v.fullName),1)])):A("v-if",!0),i.key==="action"?(C(),I("div",he,[o(D,{trigger:["click"],placement:"bottomRight"},{overlay:n(()=>[o(z,{class:"drop-down-container"},{default:n(()=>[o(h,{key:"1"},{default:n(()=>[a[13]||(a[13]=t("i",{class:"bx bxs-id-card"},null,-1)),c(" "+r(d.$t("class_member.buttons.assign_lecturer")),1)]),_:1,__:[13]}),o(h,{key:"2"},{default:n(()=>[a[14]||(a[14]=t("i",{class:"bx bx-history"},null,-1)),c(" "+r(d.$t("class_member.buttons.history_test")),1)]),_:1,__:[14]}),o(l,{style:{"background-color":"#ddd"}}),o(h,{key:"3",onClick:M=>e.onConfirmDeleteMember(v.studentId)},{default:n(()=>[t("span",xe,[a[15]||(a[15]=t("i",{class:"bx bx-trash-alt"},null,-1)),c(" "+r(d.$t("question_sets_index.buttons.delete")),1)])]),_:2},1032,["onClick"])]),_:2},1024)]),default:n(()=>[a[16]||(a[16]=t("i",{class:"bx bx-dots-vertical-rounded student-action-dropdown"},null,-1))]),_:2,__:[16]},1024)])):A("v-if",!0)]),_:1},8,["data-source"]),t("div",Se,[o(T,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":a[2]||(a[2]=i=>e.pageParams.pageNumber=i),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(i,v)=>`${v[0]}-${v[1]} of ${i} ${e.t("class_member.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])]),t("div",Ne,[t("div",Ie,[t("div",null,[t("span",ze,r(d.$t("class_member.danger_zone.title")),1),t("span",null,r(d.$t("class_member.danger_zone.sub_title")),1)])]),t("div",De,[t("div",Fe,r(d.$t("class_member.danger_zone.warning")),1),t("div",qe,r(d.$t("class_member.danger_zone.warning_explain")),1),o(k,{class:"mt-3",type:"primary",danger:"",size:"large",onClick:e.onOpenConfirmDelete},{default:n(()=>[c(r(d.$t("class_member.buttons.delete_class")),1)]),_:1})])])])]),A(" invitation modal "),o(U,{width:"750px",centered:"","wrap-class-name":"medium-modal",open:e.modal_invitation_open,onCancel:a[7]||(a[7]=i=>e.modal_invitation_open=!1)},{footer:n(()=>[o(x,{layout:"vertical",class:"w-100 d-flex align-items-end justify-content-between"},{default:n(()=>[o(y,{label:e.t("class_member.modal.time_limit_label")},{default:n(()=>[o(u,{value:e.invitationFormState.expiredTime,"onUpdate:value":a[6]||(a[6]=i=>e.invitationFormState.expiredTime=i),style:{width:"200px"},onChange:e.getData},{default:n(()=>[(C(!0),I(P,null,K(e.code_limit_time,i=>(C(),Y(w,{value:i.value},{default:n(()=>[c(r(i.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1},8,["label"]),o(y,null,{default:n(()=>[o(k,{loading:e.isInvitaionLoading,class:"main-color-btn",key:"submit",type:"primary",onClick:e.onResetInvitation},{default:n(()=>[c(r(d.$t("class_member.buttons.reset_code")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),default:n(()=>[t("div",Le,[t("div",Re,[o(q,{class:"w-100 d-flex align-items-center"},{default:n(()=>[o(F,{span:2},{default:n(()=>[o(p,{onClick:a[3]||(a[3]=i=>e.modal_invitation_open=!1),to:{name:""}},{default:n(()=>a[17]||(a[17]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[17]})]),_:1}),o(F,{class:"main-title",span:22},{default:n(()=>[t("span",null,r(d.$t("class_member.modal.title")),1),a[18]||(a[18]=c()),a[19]||(a[19]=t("br",null,null,-1)),t("span",null,r(d.$t("class_member.modal.sub_title")),1)]),_:1,__:[18,19]})]),_:1})]),t("div",Te,[o(L,{value:e.invitationFormState.code,class:"invitation-body-qrcode"},null,8,["value"]),o(x,{layout:"vertical",class:"invitation-body-link"},{default:n(()=>[o(y,{label:e.t("class_member.modal.class_code_label")},{default:n(()=>[t("div",Ee,[o(e.Input,{modelValue:e.invitationFormState.code,"onUpdate:modelValue":a[4]||(a[4]=i=>e.invitationFormState.code=i),"is-required":!0,"max-length":100,readonly:!0},null,8,["modelValue"]),t("i",{class:"bx bx-copy",onClick:e.onCopyInvitationCode})])]),_:1},8,["label"]),o(y,{label:e.t("class_member.modal.invitation_link")},{default:n(()=>[t("div",Ue,[o(e.Input,{modelValue:e.invitationFormState.code,"onUpdate:modelValue":a[5]||(a[5]=i=>e.invitationFormState.code=i),"is-required":!0,"max-length":100,readonly:!0},null,8,["modelValue"]),t("i",{class:"bx bx-copy",onClick:e.onCopyInvitationLink})])]),_:1},8,["label"])]),_:1})]),o(E,null,{default:n(()=>[c(r(d.$t("class_member.modal.or")),1)]),_:1})])]),_:1},8,["open"])],64)}const Oe=oe(le,[["render",Ae],["__scopeId","data-v-6a35c450"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/student.vue"]]);export{Oe as default};
