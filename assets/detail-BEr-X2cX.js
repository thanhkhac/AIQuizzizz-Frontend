import{d as ee,u as te,q as se,l as ne,i as _,B as ae,s as ie,S as oe,k as U,M as le,T as re,_ as de,r as p,a as i,o as a,b as t,c as r,w as u,f as m,t as o,e as y,F as b,D as q,E as ce}from"./index-BCAnCLfr.js";import{u as ue}from"./user-zaK1_Zi8.js";import{A as z}from"./ApiQuestionSet-CU3LbYSs.js";import{Q as E}from"./questionTypes-CS3lcRlq.js";import{I as _e}from"./Input-BPu-Dvk0.js";import{T as me}from"./TransferQuestionData-BxcXdBjq.js";import{V as ve}from"./Validator-CWeiTIFe.js";import{S as ge}from"./ShareModal-CoIRtcyk.js";import{V as fe}from"./visibility-PZlBDoOn.js";import"./ApiClass-Ba3vEbi0.js";import"./ApiTestTemplate-FLskaAZ8.js";import"./ApiFolder-bEaIERoo.js";const pe=ee({__name:"detail",setup(v,{expose:s}){s();const{t:g}=te(),e=se(),f=ne(),Q=_(!1),x=_(e.params.id),d=_({id:"",name:"",description:"",totalQuestionCount:0,completedQuestionCount:0,ratingCount:0,ratingAverage:0,createBy:"",createdAt:"",createdById:"",tags:[],lastAccessByMe:"",visibilityMode:""}),I=_([]),S=_([]),M=["All",E.MULTIPLE_CHOICE,E.MATCHING,E.ORDERING,E.SHORT_TEXT],L=ae(()=>M.map(l=>({label:g(`create_QS.type.${l}`),value:l}))),k=_(L.value[0].value),O=_(""),V=async()=>{var l,h;try{Q.value=!0,ve.isValidGuid(x.value.toString())||f.push({name:"404"});const T=await z.GetDetailById(x.value.toString()),w=await z.GetQuestionById(x.value.toString());(!T.data.success||!w.data.success)&&f.push({name:"User_Library"}),d.value=T.data.data,d.value.createBy=T.data.data.createdBy.fullName,I.value=w.data.data.map(Z=>me.transformResponseToRequest(Z)),S.value=I.value,await P()}catch(T){oe.QUESTION_SET_NOT_FOUND in(((h=(l=T.response)==null?void 0:l.data)==null?void 0:h.errors)||{})&&f.push({name:"404"})}finally{Q.value=!1}},A=(l,h)=>{$(h).toggleClass("bx-chevron-up bx-chevron-down");const w=$(`#question-item-answer-${l}`);w&&$(w).slideToggle()},n=_(null),C=()=>{var l;(l=n.value)==null||l.openModal()},c=_(null),R=()=>{var l;(l=c.value)==null||l.openModal()},G=()=>{f.push({name:"User_QuestionSet_Learn",params:{id:d.value.id}})},F=()=>{f.push({name:"User_QuestionSet_Test",params:{id:d.value.id}})},j=()=>{f.push({name:"User_QuestionSet_Update",params:{id:d.value.id}})},B=_(!1),N=_(0),D=async()=>{const l=await z.GetRating(d.value.id);l.data.success&&(N.value=l.data.data.rating)},X=async()=>{(await z.UpdateRating(d.value.id,{questionSetId:d.value.id,rating:N.value})).data.success?(U.success(g("message.updated_successfully")),B.value=!1):U.error(g("message.updated_failed"))},Y=_({canEdit:!1,canDelete:!1}),P=async()=>{const l=await z.GetPermissions(d.value.id);l.data.success&&(Y.value=l.data.data)},J=()=>{le.confirm({title:g("detail_QS.modal.delete_title"),content:g("detail_QS.modal.delete_content"),okText:g("sidebar.buttons.ok"),cancelText:g("sidebar.buttons.cancel"),onOk:async()=>{if(!(await z.Delete(d.value.id)).data.success){U.error(g("message.deleted_failed"));return}U.success(g("message.deleted_successfully")),f.push("User_Library")}})},K=l=>{const h=[l];sessionStorage.setItem("selected_tags",JSON.stringify(h)),f.push({name:"User_QuestionSet_Search"})},W=()=>{let l=I.value;l=I.value.filter(h=>{const T=h.questionText.includes(O.value),w=k.value==="All"||k.value===h.type;return T&&w}),S.value=l};ie(async()=>{await V(),D()});const H={t:g,route:e,router:f,loading:Q,question_set_id:x,quiz:d,quiz_questions:I,questions:S,optionKeys:M,question_type_options:L,selected_type_option:k,searchValue:O,getData:V,toggleDisplayAnswer:A,shareModalRef:n,onOpenShareModal:C,shareClassModalRef:c,onOpenShareClassModal:R,onRedirectToLearn:G,onRedirectToTest:F,onRedirectToEdit:j,modal_rate_open:B,rateValue:N,getRating:D,updateRating:X,permission:Y,getPermission:P,onDelete:J,onRedirectToSearch:K,onFilter:W,get user_image(){return ue},get QUESTION_TYPE(){return E},Input:_e,get dayjs(){return re},ShareModal:ge,get VISIBILITY(){return fe}};return Object.defineProperty(H,"__isScriptSetup",{enumerable:!1,value:!0}),H}}),he={class:"content"},ye={class:"content-item"},be={key:0},Ie={key:1},Te={class:"content-item-title"},Se={key:0,class:"d-flex flex-row align-items-center quiz-header-functions"},we={class:"quiz-info"},qe={class:"quiz-tag-container"},xe=["onClick"],ke={key:0,class:"quiz-credit"},Ce={class:"share-btn-container"},ze={class:"share-btn-container"},Re={class:"action-container"},Ee={class:"credit-user"},Qe=["src"],Me={class:"credit-user-info"},Le={class:"d-flex"},Oe={class:"content-item"},Ve={class:"content-item-title"},Ue={class:"content-item-functions"},Ae={style:{width:"300px",padding:"0"}},Ne={key:0},Be={key:1,class:"preview-question-container"},De={class:"preview-question-item"},Ye={class:"question-item-content"},Pe={class:"d-flex pb-2"},He={class:"question-index"},Ge=["innerHTML"],Fe={key:1,class:"question-text"},je=["id"],Xe={key:0,class:"multiple-choice-answer"},Je={key:0,class:"text-success"},Ke={class:"pair-answer"},We={class:"pair-answer-item"},Ze={class:"pair-answer-item"},$e={key:2,class:"ordering-answer"},et={class:"ordering-answer-item"},tt={class:"ordering-answer-item"},st={class:"ordering-answer-item"},nt={class:"short-text-answer"},at={class:"question-item-toogle-btn"},it=["onClick"],ot={class:"title-container"},lt={class:"modal-rate-container"};function rt(v,s,g,e,f,Q){const x=p("RouterLink"),d=p("a-skeleton"),I=p("a-tooltip"),S=p("a-button"),M=p("a-select-option"),L=p("a-select"),k=p("a-col"),O=p("a-row"),V=p("a-rate"),A=p("a-modal");return a(),i(b,null,[t("div",he,[r(x,{class:"navigator-back-link d-flex align-items-center p-2",to:{name:"User_Library"}},{default:u(()=>[s[5]||(s[5]=t("i",{class:"me-1 bx bx-chevron-left"},null,-1)),m(" "+o(v.$t("detail_QS.other.library")),1)]),_:1,__:[5]}),t("div",ye,[e.loading?(a(),i("div",be,[r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"])])):(a(),i("div",Ie,[t("div",Te,[t("div",null,[t("span",null,o(e.quiz.name),1),t("span",null,o(e.quiz.description),1)]),e.permission.canEdit||e.permission.canDelete?(a(),i("div",Se,[r(I,null,{title:u(()=>[m(o(v.$t("question_sets_index.buttons.edit")),1)]),default:u(()=>[e.permission.canEdit?(a(),i("i",{key:0,class:"me-3 bx bx-edit",onClick:e.onRedirectToEdit})):y("v-if",!0)]),_:1}),r(I,null,{title:u(()=>[m(o(v.$t("question_sets_index.buttons.delete")),1)]),default:u(()=>[e.permission.canDelete?(a(),i("i",{key:0,class:"text-danger bx bx-trash-alt",onClick:e.onDelete})):y("v-if",!0)]),_:1})])):y("v-if",!0)]),t("div",we,[t("div",{class:"quiz-rating",onClick:s[0]||(s[0]=n=>e.modal_rate_open=!0)},o(e.quiz.ratingAverage)+" ⭐️ ("+o(e.quiz.ratingCount)+" "+o(v.$t("detail_QS.other.reviews"))+") ",1),t("div",qe,[(a(!0),i(b,null,q(e.quiz.tags,n=>(a(),i("div",{class:"quiz-tag-item",onClick:C=>e.onRedirectToSearch(n)},o(n.name),9,xe))),256))])]),e.permission.canDelete?(a(),i("div",ke,[t("div",Ce,[r(S,{type:"primary",class:"me-3 main-color-btn share-btn",size:"large",onClick:e.onOpenShareClassModal},{default:u(()=>[s[6]||(s[6]=t("i",{class:"bx bx-share-alt"},null,-1)),m(" "+o(v.$t("detail_QS.buttons.share_class")),1)]),_:1,__:[6]})]),t("div",ze,[r(S,{type:"primary",class:"main-color-btn share-btn",size:"large",onClick:e.onOpenShareModal},{default:u(()=>[s[7]||(s[7]=t("i",{class:"bx bx-share-alt"},null,-1)),m(" "+o(v.$t("detail_QS.buttons.share_quiz")),1)]),_:1,__:[7]})])])):y("v-if",!0),t("div",Re,[t("div",Ee,[t("img",{class:"user-image",src:e.user_image,alt:""},null,8,Qe),t("div",Me,[t("span",null,o(v.$t("detail_QS.other.created_by",{username:e.quiz.createBy})),1),t("span",null,o(e.dayjs(e.quiz.createdAt).format("DD/MM/YYYY")),1)])]),t("div",Le,[t("div",{class:"action-item",onClick:e.onRedirectToLearn},[m(o(v.$t("detail_QS.buttons.learn"))+" ",1),s[8]||(s[8]=t("i",{class:"bx bx-analyse"},null,-1))]),t("div",{class:"action-item",onClick:e.onRedirectToTest},[m(o(v.$t("detail_QS.buttons.test"))+" ",1),s[9]||(s[9]=t("i",{class:"bx bx-detail"},null,-1))])])])]))]),t("div",Oe,[t("div",Ve,[t("div",null,[t("span",null,o(v.$t("detail_QS.other.questions",{number:e.quiz_questions.length})),1)])]),t("div",Ue,[r(L,{class:"me-3",value:e.selected_type_option,"onUpdate:value":s[1]||(s[1]=n=>e.selected_type_option=n),style:{width:"200px"},onChange:e.onFilter},{default:u(()=>[(a(!0),i(b,null,q(e.question_type_options,n=>(a(),ce(M,{value:n.value},{default:u(()=>[m(o(n.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),t("div",Ae,[r(e.Input,{onInput:e.onFilter,modelValue:e.searchValue,"onUpdate:modelValue":s[2]||(s[2]=n=>e.searchValue=n),placeholder:e.t("question_sets_index.search_placeholder")},{icon:u(()=>s[10]||(s[10]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(a(),i("div",Ne,[r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"]),r(d,{loading:e.loading,active:""},null,8,["loading"])])):(a(),i("div",Be,[(a(!0),i(b,null,q(e.questions,(n,C)=>(a(),i("div",De,[t("div",Ye,[t("div",Pe,[t("div",He,o(C+1),1),n.questionHTML?(a(),i("div",{key:0,class:"question-html",innerHTML:n.questionHTML},null,8,Ge)):(a(),i("div",Fe,o(n.questionText),1))]),t("div",{class:"question-item-answer",id:`question-item-answer-${C}`,style:{display:"none"}},[n.type===e.QUESTION_TYPE.MULTIPLE_CHOICE?(a(),i("div",Xe,[t("ul",null,[(a(!0),i(b,null,q(n.multipleChoices,c=>(a(),i("li",null,[m(o(c.text)+" ",1),c.isAnswer?(a(),i("span",Je," ("+o(c.isAnswer)+") ",1)):y("v-if",!0)]))),256))])])):y("v-if",!0),n.type===e.QUESTION_TYPE.MATCHING?(a(!0),i(b,{key:1},q(n.matchingPairs,c=>(a(),i("div",Ke,[t("span",We,o(c.leftItem),1),s[11]||(s[11]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("span",Ze,o(c.rightItem),1)]))),256)):y("v-if",!0),n.type===e.QUESTION_TYPE.ORDERING?(a(),i("div",$e,[t("div",et,[(a(!0),i(b,null,q(n.orderingItems,c=>(a(),i("div",null,o(c.text),1))),256))]),s[12]||(s[12]=t("i",{class:"bx bx-right-arrow-alt"},null,-1)),t("div",tt,[(a(!0),i(b,null,q(n.orderingItems.sort((c,R)=>c.correctOrder-R.correctOrder),(c,R)=>(a(),i("div",st,[t("span",null,"#"+o(R+1),1),m(" - "+o(c.text),1)]))),256))])])):y("v-if",!0),n.type===e.QUESTION_TYPE.SHORT_TEXT?(a(),i(b,{key:3},[s[13]||(s[13]=t("span",null,"Answer:",-1)),t("div",nt,o(n.shortAnswer),1)],64)):y("v-if",!0)],8,je)]),t("div",at,[t("i",{class:"bx bx-chevron-down",onClick:c=>e.toggleDisplayAnswer(C,c.currentTarget)},null,8,it)])]))),256))]))])]),r(e.ShareModal,{ref:"shareModalRef",id:e.quiz.id,name:e.quiz.name,mode:"quiz",options:[e.VISIBILITY.PUBLIC,e.VISIBILITY.PRIVATE],visibility:e.quiz.visibilityMode},null,8,["id","name","options","visibility"]),r(e.ShareModal,{ref:"shareClassModalRef",id:e.quiz.id,name:e.quiz.name,mode:"quiz",options:[e.VISIBILITY.IN_CLASS],visibility:e.VISIBILITY.IN_CLASS},null,8,["id","name","options","visibility"]),r(A,{"wrap-class-name":"medium-modal",open:e.modal_rate_open},{footer:u(()=>[r(S,{type:"primary",class:"main-color-btn",onClick:e.updateRating},{default:u(()=>s[16]||(s[16]=[m("Send")])),_:1,__:[16]})]),default:u(()=>[t("div",ot,[r(O,{class:"w-100 d-flex align-items-center justify-content-between"},{default:u(()=>[r(k,{span:1},{default:u(()=>[t("div",{onClick:s[3]||(s[3]=n=>e.modal_rate_open=!1)},s[14]||(s[14]=[t("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)]))]),_:1}),r(k,{class:"main-title",span:20},{default:u(()=>s[15]||(s[15]=[t("span",null,"Rate the question set",-1),m(),t("br",null,null,-1)])),_:1,__:[15]})]),_:1})]),t("div",lt,[r(V,{value:e.rateValue,"onUpdate:value":s[4]||(s[4]=n=>e.rateValue=n),style:{"font-size":"40px"}},null,8,["value"])])]),_:1},8,["open"])],64)}const It=de(pe,[["render",rt],["__scopeId","data-v-307050af"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/question_sets/detail.vue"]]);export{It as default};
