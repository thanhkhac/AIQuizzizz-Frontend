import{d as A,q as E,l as L,u as Q,i as q,j as V,E as B,s as j,R as x,M,k as U,_ as G,r as f,c as b,o as g,b as t,a as r,w as d,f as h,t as o,e as P,F as I,B as K,C as X}from"./index-DQ5VBJ-w.js";import{A as N}from"./ApiClass-Dvf--i2d.js";import{C as Y}from"./classStudentPosition-B7ChrNvq.js";import{I as H}from"./Input-Cgk3a5K5.js";import{V as J}from"./Validator-CWeiTIFe.js";const W=A({__name:"quiz",emits:["updateSidebar"],setup(l,{expose:n,emit:k}){var w;n();const e=E(),_=L(),{t:m}=Q(),p=k,c=q(e.params.id||""),S=q({classId:"",name:"",topic:""}),a=V({pageNumber:e.query.pageNumber||1,pageSize:e.query.pageSize||10,name:((w=e.query.name)==null?void 0:w.toString())||"",totalCount:0,statusFilter:!1}),z=q([]),C=q(""),i=q(!1),v=async()=>{try{const s=await N.GetUserPermission(S.value.classId);s.data.success&&(C.value=s.data.data)}catch(s){console.log(s)}},D=async()=>{try{if(!J.isValidGuid(c.value.toString())){_.push({name:"404"});return}c.value||_.push({name:"404"});let s=await N.GetById(c.value.toString());s.data.success||_.push({name:"404"}),S.value=s.data.data}catch(s){const u=Object.keys(s.response.data.errors);if(u.includes(x.NOT_FOUND_STUDENT_IN_CLASS)||u.includes(x.NOT_FOUND_USER_IN_CLASS)){_.push({name:"User_Class"});return}}},y=async()=>{try{i.value=!0;let s=await N.GetAllQSByLimit(c.value.toString(),a);if(s.data.success){let u=s.data.data;z.value=u.items,a.pageNumber=u.pageNumber,a.pageSize=u.pageSize,a.totalCount=u.totalCount,a.statusFilter&&(a.pageNumber>u.totalPages&&a.totalCount>0?(a.pageNumber=1,_.push({name:"User_Class_Quiz",params:{id:c.value},query:{pageNumber:1,pageSize:a.pageSize,name:a.name}})):_.push({name:"User_Class_Quiz",params:{id:c.value},query:{pageNumber:a.pageNumber,pageSize:a.pageSize,name:a.name}}),a.statusFilter=!a.statusFilter)}}catch(s){console.log("ERROR: GETALLEXAMBYLIMIT class qs: "+s)}finally{i.value=!1}};B(()=>Object.keys(e.query).length,()=>{var s;a.pageNumber=e.query.pageNumber||1,a.pageSize=e.query.pageSize||10,a.name=((s=e.query.name)==null?void 0:s.toString())||"",a.statusFilter=!0,y()});const O=(s,u)=>{a.pageNumber=s,a.pageSize=u,a.statusFilter=!0,y()},R=s=>{M.confirm({title:m("class_question_set.modal.delete_title"),content:m("class_question_set.modal.delete_content"),okText:m("sidebar.buttons.ok"),cancelText:m("sidebar.buttons.cancel"),onOk:async()=>{if(!(await N.DeleteQuestionSetFromClass(S.value.classId,s)).data.success){U.success(m("message.removed_failed"));return}U.success(m("message.removed_successfully")),y()}})},F=s=>{_.push({name:"User_QuestionSet_Detail",params:{id:s}})};j(async()=>{p("updateSidebar","class"),await D(),await v(),await y()});const T={route:e,router:_,t:m,emit:p,classId:c,classData:S,pageParams:a,question_set_data:z,userRoleInClass:C,loading:i,getPermission:v,getClassData:D,getData:y,onPaginationChange:O,onDeleteQSFromClass:R,onRedirectToDetail:F,get CLASS_STUDENT_POSITION(){return Y},Input:H};return Object.defineProperty(T,"__isScriptSetup",{enumerable:!1,value:!0}),T}}),Z={class:"page-container"},$={class:"title-container"},ee={class:"breadcrumb-container"},te={class:"title-breadcrumb-item"},ae={class:"title-breadcrumb-item"},se={class:"breadcrumb-item-topic"},ne={class:"content"},oe={class:"content-item"},ie={class:"content-item-title"},le={class:"content-item-functions"},re={class:"content-item-navigators"},ce={class:"navigator-container"},ue={style:{width:"300px",padding:"0px"}},de={key:0,class:"quiz-item-container"},_e={class:"quiz-item"},me={class:"quiz-item-title"},pe={class:"quiz-item-description"},ge={class:"quiz-item-info quiz-info-detail"},ve={class:"quiz-item-questions"},be={class:"quiz-item-created-by"},he={class:"exam-item-actions"},Se=["onClick"],fe={key:1,class:"w-100 d-flex justify-content-center"},ye={class:"pagination-container"};function qe(l,n,k,e,_,m){const p=f("RouterLink"),c=f("a-skeleton"),S=f("a-button"),a=f("a-tooltip"),z=f("a-empty"),C=f("a-pagination");return g(),b("div",Z,[t("div",$,[t("div",ee,[t("ul",null,[t("li",te,[r(p,{to:{name:"User_Class"}},{default:d(()=>[t("span",null,o(l.$t("class_index.title")),1),n[2]||(n[2]=h()),n[3]||(n[3]=t("br",null,null,-1))]),_:1,__:[2,3]}),n[4]||(n[4]=t("i",{class:"bx bx-chevron-right"},null,-1))]),t("li",ae,[r(p,{to:{name:""},class:"breadcrumb-item-class"},{default:d(()=>[t("span",null,o(e.classData.name),1),t("span",se,o(e.classData.topic),1)]),_:1})])])])]),t("div",ne,[t("div",oe,[t("div",ie,[t("div",null,[t("span",null,o(l.$t("class_question_set.title")),1),t("span",null,o(l.$t("class_question_set.sub_title")),1)])]),t("div",le,[t("div",re,[t("div",ce,[r(p,{class:"navigator-item",to:{name:"User_Class_Exam"}},{default:d(()=>[h(o(l.$t("class_index.navigators.exam")),1)]),_:1}),r(p,{class:"navigator-item navigator-active",to:{name:""}},{default:d(()=>[h(o(l.$t("class_index.navigators.quiz")),1)]),_:1}),r(p,{class:"navigator-item",to:{name:"User_Class_Student"}},{default:d(()=>[h(o(l.$t("class_index.navigators.member")),1)]),_:1})])]),P(` <a-select
                        v-model:value="pageParams.shareMode"
                        style="width: 200px"
                        @change="getData"
                    >
                        <a-select-option v-for="option in share_mode_options" :value="option.value">
                            {{ option.label }}
                        </a-select-option>
                    </a-select> `),t("div",ue,[r(e.Input,{onInput:e.getData,modelValue:e.pageParams.name,"onUpdate:modelValue":n[0]||(n[0]=i=>e.pageParams.name=i),placeholder:e.t("question_sets_index.search_placeholder")},{icon:d(()=>n[5]||(n[5]=[t("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),e.loading?(g(),b(I,{key:0},[r(c,{active:"",loading:e.loading},null,8,["loading"]),r(c,{active:"",loading:e.loading},null,8,["loading"]),r(c,{active:"",loading:e.loading},null,8,["loading"])],64)):(g(),b(I,{key:1},[e.question_set_data.length>0?(g(),b("div",de,[(g(!0),b(I,null,K(e.question_set_data,i=>(g(),b("div",_e,[n[7]||(n[7]=t("i",{class:"bx bx-book-open quiz-item-icon"},null,-1)),t("div",null,[t("div",me,o(i.name),1),t("div",pe,o(i.description),1),t("div",ge,[t("div",ve,[n[6]||(n[6]=t("i",{class:"bx bx-message-square-edit bx-rotate-270"},null,-1)),h(" "+o(i.totalQuestionCount)+" "+o(l.$t("dashboards.list_items.quiz.questions")),1)]),t("div",be,o(l.$t("class_question_set.other.created_by"))+" "+o(i.createBy),1)])]),t("div",he,[r(S,{type:"primary",class:"me-3 main-color-btn",onClick:v=>e.onRedirectToDetail(i.id)},{default:d(()=>[h(o(l.$t("class_question_set.buttons.view")),1)]),_:2},1032,["onClick"]),e.userRoleInClass!==e.CLASS_STUDENT_POSITION.STUDENT?(g(),X(a,{key:0},{title:d(()=>[h(o(l.$t("question_sets_index.buttons.delete")),1)]),default:d(()=>[t("i",{style:{cursor:"pointer"},class:"text-danger bx bx-trash-alt",onClick:v=>e.onDeleteQSFromClass(i.id)},null,8,Se)]),_:2},1024)):P("v-if",!0)])]))),256))])):(g(),b("div",fe,[r(z,null,{description:d(()=>[t("span",null,o(l.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),t("div",ye,[r(C,{onChange:e.onPaginationChange,current:e.pageParams.pageNumber,"onUpdate:current":n[1]||(n[1]=i=>e.pageParams.pageNumber=i),total:e.pageParams.totalCount,pageSize:e.pageParams.pageSize,"show-total":(i,v)=>`${v[0]}-${v[1]} of ${i} ${e.t("class_question_set.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:e.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])])}const De=G(W,[["render",qe],["__scopeId","data-v-b4964186"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/quiz.vue"]]);export{De as default};
