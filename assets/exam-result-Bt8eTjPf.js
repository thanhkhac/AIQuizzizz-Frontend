import{d as O,q as B,l as V,u as Q,i as S,T as E,_ as X,r as c,E as A,o as _,w as o,b as e,c as l,t as s,a as x,e as N,f as M,B as W,j as Z,C as $,s as tt,G as et,F as P,D as at}from"./index-BZibwNZh.js";import{A as st}from"./ApiClass-kQc_Dqx9.js";import{A as Y,T as z}from"./ApiTest-C_piqGFi.js";import{T as nt,a as ot}from"./testGradeQuestionMethod-B_BacNS6.js";import{I as lt}from"./Input-CsLykV0d.js";import{V as G}from"./Validator-CWeiTIFe.js";import"./lodash-BIYebOzu.js";const it=O({__name:"UserTestAttempts",props:{testId:{type:String,required:!0},userId:{type:String,required:!0},testName:{type:String,required:!0},studentName:{type:String,required:!0},passingScore:{type:Number,required:!0}},setup(i,{expose:r}){const k=B(),t=V(),{t:y}=Q(),w=i,b=S(!1),u=async()=>{b.value=!0,await h()},p=()=>{b.value=!1};r({openModal:u,closeModal:p});const I=S([]),f=S(!1),h=async()=>{try{f.value=!0;let a=await Y.GetUserExamHistory(w.testId,w.userId);if(a.data.success){let g=a.data.data;I.value=g.items}}catch(a){console.log("ERROR: GETALLEXAMBYLIMIT user exam result: "+a)}finally{f.value=!1}},v={route:k,router:t,t:y,props:w,modal_open:b,openModal:u,closeModal:p,attemptData:I,loading:f,getData:h,columns:[{title:"No",key:"no",customRender:a=>a.index+1},{title:"Start",dataIndex:"timeStart",key:"timeStart",sorter:(a,g)=>E(a.timeStart).unix()-E(g.timeStart).unix()},{title:"Submit",dataIndex:"timeSubmit",key:"timeSubmit",sorter:(a,g)=>E(a.timeSubmit).unix()-E(g.timeSubmit).unix()},{title:"Student score",dataIndex:"score",key:"score",sorter:(a,g)=>a.score-g.score},{title:"Passing score",dataIndex:"passingScore",key:"passingScore",sorter:(a,g)=>a.score-g.score},{title:"Result",dataIndex:"status",key:"status"},{title:"Action",dataIndex:"action",key:"action"}],getTagColor:a=>{switch(a){case z.PASSED:return"#22C55E";case z.FAILED:return"#cd201f"}},onRedirectToReview:a=>{t.push({name:"User_Test_Review",params:{id:a}})},get dayjs(){return E}};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),rt={class:"modal-container"},ct={class:"modal-title-container"},ut={class:"content"},dt={class:"content-item"},mt={class:"content-item-title"},_t={key:0,class:"text-nowrap"},pt={key:1,class:"text-nowrap"},gt={key:2,class:"text-nowrap"},ft={key:1,class:"w-110 d-flex justify-content-center"};function yt(i,r,k,t,y,w){const b=c("RouterLink"),u=c("a-col"),p=c("a-row"),I=c("a-tag"),f=c("a-button"),h=c("a-table"),T=c("a-config-provider"),C=c("a-empty"),R=c("a-modal");return _(),A(R,{centered:"",width:"100%","wrap-class-name":"medium-modal large",open:t.modal_open,onCancel:t.closeModal},{footer:o(()=>r[2]||(r[2]=[])),default:o(()=>[e("div",rt,[e("div",ct,[l(p,{class:"w-100 d-flex align-items-center"},{default:o(()=>[l(u,{span:1},{default:o(()=>[l(b,{onClick:t.closeModal,to:{name:""}},{default:o(()=>r[0]||(r[0]=[e("i",{class:"bx bx-chevron-left navigator-back-button"},null,-1)])),_:1,__:[0]})]),_:1}),l(u,{class:"main-title",span:23},{default:o(()=>[e("span",null,s(k.testName),1)]),_:1})]),_:1})]),e("div",ut,[e("div",dt,[e("div",mt,[e("div",null,[e("span",null,s(k.studentName),1)])]),t.attemptData.length>0?(_(),A(T,{key:0,locale:{Table:{cancelSort:"",triggerAsc:"",triggerDesc:""}}},{default:o(()=>[l(h,{columns:t.columns,"data-source":t.attemptData,"row-key":"studentId",pagination:!1},{bodyCell:o(({column:v,record:a})=>[v.key==="timeStart"?(_(),x("div",_t,s(t.dayjs(a.timeStart).format("DD/MM/YYYY HH:mm:ss")),1)):N("v-if",!0),v.key==="timeSubmit"?(_(),x("div",pt,s(t.dayjs(a.timeSubmit).format("DD/MM/YYYY HH:mm:ss")),1)):N("v-if",!0),v.key==="passingScore"?(_(),x("div",gt,s(k.passingScore)+"%",1)):N("v-if",!0),v.key==="status"?(_(),A(I,{key:3,color:t.getTagColor(a.status)},{default:o(()=>[M(s(a.status),1)]),_:2},1032,["color"])):N("v-if",!0),v.key==="action"?(_(),A(f,{key:4,type:"ghost",class:"main-color-btn-ghost",onClick:g=>t.onRedirectToReview(a.attemptId)},{default:o(()=>r[1]||(r[1]=[M(" Review ")])),_:2,__:[1]},1032,["onClick"])):N("v-if",!0)]),_:1},8,["data-source"])]),_:1})):(_(),x("div",ft,[l(C,null,{description:o(()=>[e("span",null,s(i.$t("class_index.other.no_data_matches")),1)]),_:1})]))])])])]),_:1},8,["open"])}const vt=X(it,[["render",yt],["__scopeId","data-v-84e7c737"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/shared/modals/UserTestAttempts.vue"]]),bt=O({__name:"exam-result",emits:["updateSidebar"],setup(i,{expose:r,emit:k}){var H,F;r();const t=B(),y=V(),{t:w}=Q(),b=k,u=S(!1),p=S(t.params.classId||""),I=S({classId:"",name:"",topic:""}),f=S(t.params.testId||""),h=S({name:"",classId:t.params.classId.toString()||"",timeLimit:0,startTime:"",endTime:"",questionCount:0,gradeAttemptMethod:ot.HIGHEST_SCORE,gradeQuestionMethod:nt.PARTIAL,isShowCorrectAnswerInReview:!0,isAllowReviewAfterSubmit:!0,numberOfShuffles:0,maxAttempt:0,passingScore:0,totalScore:0}),T=S([]),C=[{title:"No",key:"no",customRender:n=>n.index+1},{title:w("class_member.column.fullName"),dataIndex:"studentName",key:"studentName",sorter:(n,m)=>n.studentName.localeCompare(m.studentName)},{title:w("class_member.column.email"),dataIndex:"studentEmail",key:"email",sorter:(n,m)=>n.studentEmail.localeCompare(m.studentEmail)},{title:"Final score",dataIndex:"score",key:"score",sorter:(n,m)=>n.score-m.score},{title:"Result",dataIndex:"status",key:"status"}],R=Object.values(z),v=W(()=>R.map(n=>({label:w(`exam_result.test_status.${n}`),value:n!==z.ALL?n:""}))),a=Z({pageNumber:t.query.pageNumber||1,pageSize:t.query.pageSize||10,studentName:((H=t.query.studentName)==null?void 0:H.toString())||"",isPassed:((F=t.query.isPassed)==null?void 0:F.toString())||null,totalCount:0,statusFilter:!1}),g=async()=>{try{if(!G.isValidGuid(p.value.toString())){y.push({name:"404"});return}p.value||y.push({name:"404"});let n=await st.GetById(p.value.toString());n.data.success||y.push({name:"404"}),I.value=n.data.data}catch(n){console.log("ERROR: GETBYID class: "+n)}},j=async()=>{try{if(!G.isValidGuid(f.value.toString())){y.push({name:"404"});return}f.value||y.push({name:"404"});let n=await Y.GetById(f.value.toString(),!1);n.data.success||y.push({name:"404"}),h.value=n.data.data}catch(n){console.log("ERROR: GETBYID test: "+n)}},d=async()=>{try{u.value=!0;let n=await Y.GetAllExamResultByLimit(f.value.toString(),a);if(n.data.success){let m=n.data.data;T.value=n.data.data.items,a.pageNumber=m.pageNumber,a.pageSize=m.pageSize,a.totalCount=m.totalCount,a.statusFilter&&(a.pageNumber>m.totalPages&&a.totalCount>0?(a.pageNumber=1,y.push({name:"User_Class_Exam_Result",params:{classId:p.value,testId:f.value},query:{pageNumber:1,pageSize:a.pageSize,studentName:a.studentName,isPassed:a.isPassed}})):y.push({name:"User_Class_Exam_Result",params:{classId:p.value,testId:f.value},query:{pageNumber:a.pageNumber,pageSize:a.pageSize,studentName:a.studentName,isPassed:a.isPassed}}),a.statusFilter=!a.statusFilter)}}catch(n){console.log("ERROR: GETALLEXAMBYLIMIT class exam result: "+n)}finally{u.value=!1}};$(()=>Object.keys(t.query).length,()=>{var n,m;a.pageNumber=t.query.pageNumber||1,a.pageSize=t.query.pageSize||11,a.studentName=((n=t.query.studentName)==null?void 0:n.toString())||"",a.isPassed=((m=t.query.isPassed)==null?void 0:m.toString())||null,a.statusFilter=!0,d()});const D=(n,m)=>{a.pageNumber=n,a.pageSize=m,a.statusFilter=!0,d()},q=S({studentId:"",studentName:"",studentEmail:"",score:0,status:""}),L=S(null),K=async n=>{var m;q.value=n,await et(),(m=L.value)==null||m.openModal()},J=n=>{switch(n){case z.PASSED:return"#22C55E";case z.FAILED:return"#cd201f"}};tt(async()=>{b("updateSidebar","class"),await g(),await j(),await d()});const U={route:t,router:y,t:w,emit:b,loading:u,classId:p,classData:I,testId:f,testData:h,testResultData:T,columns:C,optionKeys:R,test_status_options:v,pageParams:a,getClassData:g,getTestDetail:j,getData:d,onPaginationChange:D,chosenUser:q,userHistoryModalRef:L,openUserHistoryModal:K,getTagColor:J,Input:lt,get dayjs(){return E},UserTestAttempts:vt};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),ht={class:"page-container"},St={class:"title-container"},wt={class:"breadcrumb-container"},xt={class:"title-breadcrumb-item"},It={class:"title-breadcrumb-item"},Dt={class:"breadcrumb-item-topic"},kt={class:"content"},Tt={class:"content-item"},Rt={class:"content-item-title"},Nt={class:"test-info-container"},At={class:"d-flex justify-content-between"},Ct={class:"d-flex justify-content-between"},Et={class:"d-flex justify-content-between"},zt={class:"d-flex justify-content-between"},jt={class:"content-item-functions"},Mt={style:{width:"300px",padding:"0px"}},Pt=["onClick"],qt={key:1,class:"w-110 d-flex justify-content-center"},Yt={class:"pagination-container"};function Lt(i,r,k,t,y,w){var g,j;const b=c("RouterLink"),u=c("a-col"),p=c("a-row"),I=c("a-select-option"),f=c("a-select"),h=c("a-skeleton"),T=c("a-tag"),C=c("a-table"),R=c("a-config-provider"),v=c("a-empty"),a=c("a-pagination");return _(),x(P,null,[e("div",ht,[e("div",St,[e("div",wt,[e("ul",null,[e("li",xt,[l(b,{to:{name:"User_Class"}},{default:o(()=>[e("span",null,s(i.$t("class_index.title")),1),r[3]||(r[3]=M()),r[4]||(r[4]=e("br",null,null,-1))]),_:1,__:[3,4]}),r[5]||(r[5]=e("i",{class:"bx bx-chevron-right"},null,-1))]),e("li",It,[l(b,{to:{name:"User_Class_Exam",params:{id:t.classId}},class:"breadcrumb-item-class"},{default:o(()=>[e("span",null,s(t.classData.name),1),e("span",Dt,s(t.classData.topic),1)]),_:1},8,["to"])])])])]),e("div",kt,[e("div",Tt,[e("div",Rt,[e("div",null,[e("span",null,s(i.$t("exam_result.test_name",{name:t.testData.name})),1),e("span",null,s(i.$t("class_index.title"))+": "+s(t.classData.name),1)])]),e("div",Nt,[l(p,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:o(()=>[l(u,{span:11,class:"test-info-item"},{default:o(()=>[e("div",At,[e("span",null,s(i.$t("exam_result.start_time")),1),e("span",null,s(t.dayjs(t.testData.startTime).format("DD/MM/YYYY HH:mm A")),1)]),e("div",Ct,[e("span",null,s(i.$t("exam_result.end_time")),1),e("span",null,s(t.dayjs(t.testData.endTime).format("DD/MM/YYYY HH:mm A")),1)])]),_:1}),l(u,{span:11,class:"test-info-item"},{default:o(()=>[e("div",Et,[e("span",null,s(i.$t("exam_result.time_limit")),1),e("span",null,s(t.testData.timeLimit)+" "+s(t.testData.timeLimit>1?i.$t("practice_test.other.minute_plural"):i.$t("practice_test.other.minute")),1)]),e("div",zt,[e("span",null,s(i.$t("exam_result.question_count")),1),e("span",null,s(t.testData.questionCount)+" "+s(t.testData.questionCount>1?i.$t("exam_result.other.question_plural"):i.$t("exam_result.other.question")),1)])]),_:1})]),_:1}),l(p,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:o(()=>[l(u,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[e("span",null,s(i.$t("exam_result.grade_attempt_method")),1),e("span",null,s(i.$t("testData.gradeAttemptMethod")),1)]),_:1}),l(u,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[e("span",null,s(i.$t("exam_result.max_attempt")),1),e("span",null,s(t.testData.maxAttempt)+" "+s(t.testData.questionCount>1?i.$t("exam_result.other.time_plural"):i.$t("exam_result.other.time")),1)]),_:1})]),_:1}),l(p,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:o(()=>[l(u,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[e("span",null,s(i.$t("exam_result.grade_question_method")),1),e("span",null,s(t.testData.gradeQuestionMethod),1)]),_:1}),l(u,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[e("span",null,s(i.$t("exam_result.passing_score")),1),e("span",null,s(t.testData.totalScore*(t.testData.passingScore/100))+" ("+s(t.testData.passingScore)+"%) ",1)]),_:1})]),_:1}),l(p,{class:"mb-2 d-flex align-items-center justify-content-between"},{default:o(()=>[l(u,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[e("span",null,s(i.$t("exam_result.show_correct_answer")),1),e("span",null,s(t.testData.isShowCorrectAnswerInReview?"Yes":"No"),1)]),_:1}),l(u,{span:11,class:"d-flex justify-content-between test-info-item"},{default:o(()=>[e("span",null,s(i.$t("exam_result.allow_review")),1),e("span",null,s(t.testData.isAllowReviewAfterSubmit?"Yes":"No"),1)]),_:1})]),_:1})]),e("div",jt,[l(f,{value:t.pageParams.isPassed,"onUpdate:value":r[0]||(r[0]=d=>t.pageParams.isPassed=d),style:{width:"230px","margin-right":"10px"},onChange:t.getData},{default:o(()=>[(_(!0),x(P,null,at(t.test_status_options,d=>(_(),A(I,{value:d.value},{default:o(()=>[M(s(d.label),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"]),e("div",Mt,[l(t.Input,{onInput:t.getData,modelValue:t.pageParams.studentName,"onUpdate:modelValue":r[1]||(r[1]=d=>t.pageParams.studentName=d),placeholder:t.t("class_member.other.search_placeholder")},{icon:o(()=>r[6]||(r[6]=[e("i",{class:"bx bx-search"},null,-1)])),_:1},8,["modelValue","placeholder"])])]),t.loading?(_(),x(P,{key:0},[l(h,{loading:t.loading},null,8,["loading"]),l(h,{loading:t.loading},null,8,["loading"]),l(h,{loading:t.loading},null,8,["loading"])],64)):(_(),x(P,{key:1},[t.testResultData.length>0?(_(),A(R,{key:0,locale:{Table:{cancelSort:"",triggerAsc:"",triggerDesc:""}}},{default:o(()=>[l(C,{columns:t.columns,"data-source":t.testResultData,"row-key":"studentId",pagination:!1},{bodyCell:o(({column:d,record:D})=>[d.key==="studentName"?(_(),x("div",{key:0,class:"student-name",onClick:q=>t.openUserHistoryModal(D)},s(D.studentName),9,Pt)):N("v-if",!0),d.key==="status"?(_(),A(T,{key:1,color:t.getTagColor(D.status)},{default:o(()=>[M(s(D.status),1)]),_:2},1032,["color"])):N("v-if",!0)]),_:1},8,["data-source"])]),_:1})):(_(),x("div",qt,[l(v,null,{description:o(()=>[e("span",null,s(i.$t("class_index.other.no_data_matches")),1)]),_:1})]))],64)),e("div",Yt,[l(a,{onChange:t.onPaginationChange,current:t.pageParams.pageNumber,"onUpdate:current":r[2]||(r[2]=d=>t.pageParams.pageNumber=d),total:t.pageParams.totalCount,pageSize:t.pageParams.pageSize,"show-total":(d,D)=>`${D[0]}-${D[1]} of ${d} ${t.t("class_member.other.items")}`,"show-size-changer":"","show-quick-jumper":"",class:"crud-layout-pagination",locale:{items_per_page:t.t("class_index.other.pages")}},null,8,["current","total","pageSize","show-total","locale"])])])])]),l(t.UserTestAttempts,{ref:"userHistoryModalRef","test-id":t.testId.toString(),"user-id":(g=t.chosenUser)==null?void 0:g.studentId,"test-name":t.testData.name,"passing-score":t.testData.passingScore,"student-name":(j=t.chosenUser)==null?void 0:j.studentEmail},null,8,["test-id","user-id","test-name","passing-score","student-name"])],64)}const Qt=X(bt,[["render",Lt],["__scopeId","data-v-09bf35d5"],["__file","/home/runner/work/AIQuizzizz-Frontend/AIQuizzizz-Frontend/src/views/user/class/exam-result.vue"]]);export{Qt as default};
